2025-04-19 12:52:28,191 - INFO - Saving logs to: train_logs/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32.log
2025-04-19 12:52:28,191 - INFO - Using 72 classes | 28 training batches
2025-04-19 12:52:28,191 - INFO - ======= Stage 3: PromptSG Training =======
2025-04-19 12:52:28,191 - INFO - Experiment Name : stage3_promptsg
2025-04-19 12:52:28,191 - INFO - Model & Dataset : rn50, 11k, dorsal_r
2025-04-19 12:52:28,191 - INFO - Freeze Text Enc.: True
2025-04-19 12:52:28,191 - INFO - Loss Weights    : ID=0.1, Tri=1.0, SupCon=0
2025-04-19 12:52:28,191 - INFO - LR=0.0001 | Epochs=30 | BatchSize=32
2025-04-19 12:52:28,191 - INFO -  Epoch 1/30
2025-04-19 12:52:28,194 - INFO - [Epoch 1] Learning rate: 0.000100
2025-04-19 12:52:55,695 - INFO - [DEBUG] Pooled feature mean L2 norm: 1.0000
2025-04-19 12:52:55,695 - INFO - [DEBUG] ArcFace confidence: 0.0864
2025-04-19 12:52:55,700 - INFO - [DEBUG] Loss Breakdown  ID: 17.7057, SupCon: 3.4500, Tri: 0.1518
2025-04-19 12:52:55,796 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:52:55,796 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:52:55,891 - INFO - [DEBUG] ArcFace confidence: 0.0978
2025-04-19 12:52:55,894 - INFO - [DEBUG] Loss Breakdown  ID: 17.0910, SupCon: 3.5246, Tri: 0.0915
2025-04-19 12:52:56,073 - INFO - [DEBUG] ArcFace confidence: 0.1549
2025-04-19 12:52:56,076 - INFO - [DEBUG] Loss Breakdown  ID: 17.4873, SupCon: 3.4396, Tri: 0.1660
2025-04-19 12:52:56,255 - INFO - [DEBUG] ArcFace confidence: 0.1401
2025-04-19 12:52:56,258 - INFO - [DEBUG] Loss Breakdown  ID: 16.4677, SupCon: 3.4560, Tri: 0.1161
2025-04-19 12:52:56,440 - INFO - [DEBUG] ArcFace confidence: 0.1957
2025-04-19 12:52:56,443 - INFO - [DEBUG] Loss Breakdown  ID: 16.6863, SupCon: 3.4838, Tri: 0.1826
2025-04-19 12:52:56,622 - INFO - [DEBUG] ArcFace confidence: 0.1849
2025-04-19 12:52:56,625 - INFO - [DEBUG] Loss Breakdown  ID: 15.7038, SupCon: 3.4878, Tri: 0.1161
2025-04-19 12:52:56,808 - INFO - [DEBUG] ArcFace confidence: 0.3065
2025-04-19 12:52:56,811 - INFO - [DEBUG] Loss Breakdown  ID: 16.4695, SupCon: 3.4972, Tri: 0.1192
2025-04-19 12:52:56,990 - INFO - [DEBUG] ArcFace confidence: 0.2692
2025-04-19 12:52:56,993 - INFO - [DEBUG] Loss Breakdown  ID: 14.4812, SupCon: 3.4887, Tri: 0.1156
2025-04-19 12:52:57,178 - INFO - [DEBUG] ArcFace confidence: 0.2341
2025-04-19 12:52:57,181 - INFO - [DEBUG] Loss Breakdown  ID: 14.6837, SupCon: 3.4858, Tri: 0.1053
2025-04-19 12:52:57,359 - INFO - [DEBUG] ArcFace confidence: 0.2804
2025-04-19 12:52:57,362 - INFO - [DEBUG] Loss Breakdown  ID: 14.4503, SupCon: 3.4744, Tri: 0.1159
2025-04-19 12:52:57,540 - INFO - [DEBUG] ArcFace confidence: 0.3951
2025-04-19 12:52:57,546 - INFO - [DEBUG] Loss Breakdown  ID: 15.0815, SupCon: 3.5372, Tri: 0.1432
2025-04-19 12:52:57,726 - INFO - [DEBUG] ArcFace confidence: 0.3311
2025-04-19 12:52:57,732 - INFO - [DEBUG] Loss Breakdown  ID: 13.7477, SupCon: 3.5146, Tri: 0.1272
2025-04-19 12:52:57,909 - INFO - [DEBUG] ArcFace confidence: 0.3667
2025-04-19 12:52:57,915 - INFO - [DEBUG] Loss Breakdown  ID: 14.6270, SupCon: 3.5523, Tri: 0.1023
2025-04-19 12:52:58,093 - INFO - [DEBUG] ArcFace confidence: 0.2997
2025-04-19 12:52:58,096 - INFO - [DEBUG] Loss Breakdown  ID: 12.7892, SupCon: 3.5229, Tri: 0.0869
2025-04-19 12:52:58,276 - INFO - [DEBUG] ArcFace confidence: 0.3175
2025-04-19 12:52:58,279 - INFO - [DEBUG] Loss Breakdown  ID: 13.3112, SupCon: 3.5359, Tri: 0.0489
2025-04-19 12:52:58,462 - INFO - [DEBUG] ArcFace confidence: 0.3960
2025-04-19 12:52:58,465 - INFO - [DEBUG] Loss Breakdown  ID: 14.4747, SupCon: 3.5241, Tri: 0.1445
2025-04-19 12:52:58,644 - INFO - [DEBUG] ArcFace confidence: 0.4174
2025-04-19 12:52:58,651 - INFO - [DEBUG] Loss Breakdown  ID: 12.9820, SupCon: 3.5611, Tri: 0.0551
2025-04-19 12:52:58,827 - INFO - [DEBUG] ArcFace confidence: 0.4472
2025-04-19 12:52:58,830 - INFO - [DEBUG] Loss Breakdown  ID: 14.2300, SupCon: 3.5350, Tri: 0.1184
2025-04-19 12:52:59,011 - INFO - [DEBUG] ArcFace confidence: 0.4601
2025-04-19 12:52:59,014 - INFO - [DEBUG] Loss Breakdown  ID: 14.8041, SupCon: 3.5865, Tri: 0.0756
2025-04-19 12:52:59,193 - INFO - [DEBUG] ArcFace confidence: 0.4152
2025-04-19 12:52:59,196 - INFO - [DEBUG] Loss Breakdown  ID: 14.6133, SupCon: 3.6188, Tri: 0.0651
2025-04-19 12:52:59,375 - INFO - [DEBUG] ArcFace confidence: 0.4007
2025-04-19 12:52:59,378 - INFO - [DEBUG] Loss Breakdown  ID: 13.1467, SupCon: 3.5637, Tri: 0.0453
2025-04-19 12:52:59,555 - INFO - [DEBUG] ArcFace confidence: 0.3132
2025-04-19 12:52:59,558 - INFO - [DEBUG] Loss Breakdown  ID: 12.7477, SupCon: 3.5235, Tri: 0.0696
2025-04-19 12:52:59,734 - INFO - [DEBUG] ArcFace confidence: 0.3637
2025-04-19 12:52:59,737 - INFO - [DEBUG] Loss Breakdown  ID: 12.8476, SupCon: 3.5234, Tri: 0.0620
2025-04-19 12:52:59,914 - INFO - [DEBUG] ArcFace confidence: 0.3278
2025-04-19 12:52:59,920 - INFO - [DEBUG] Loss Breakdown  ID: 12.0932, SupCon: 3.5805, Tri: 0.0444
2025-04-19 12:53:00,095 - INFO - [DEBUG] ArcFace confidence: 0.2898
2025-04-19 12:53:00,101 - INFO - [DEBUG] Loss Breakdown  ID: 10.7860, SupCon: 3.5745, Tri: 0.0580
2025-04-19 12:53:00,278 - INFO - [DEBUG] ArcFace confidence: 0.3293
2025-04-19 12:53:00,281 - INFO - [DEBUG] Loss Breakdown  ID: 12.1005, SupCon: 3.5125, Tri: 0.0334
2025-04-19 12:53:00,458 - INFO - [DEBUG] ArcFace confidence: 0.3696
2025-04-19 12:53:00,461 - INFO - [DEBUG] Loss Breakdown  ID: 10.4345, SupCon: 3.5482, Tri: 0.0315
2025-04-19 12:53:00,675 - INFO - [DEBUG] ArcFace confidence: 0.4361
2025-04-19 12:53:00,678 - INFO - [DEBUG] Loss Breakdown  ID: 12.3601, SupCon: 3.2821, Tri: 0.0790
2025-04-19 12:53:01,484 - INFO - [Epoch 1] Total Loss=1.5182
2025-04-19 12:53:01,484 - INFO - Validating epoch 1...
2025-04-19 12:53:31,416 - INFO - [Epoch 1] Avg Train Loss = 1.5182 | 
2025-04-19 12:53:31,418 - INFO - ==================== Epoch 1 Validation ====================
2025-04-19 12:53:31,418 - INFO - Validation rank-1    : 57.26%
2025-04-19 12:53:31,418 - INFO - Validation rank-5    : 80.43%
2025-04-19 12:53:31,418 - INFO - Validation rank-10   : 88.77%
2025-04-19 12:53:31,418 - INFO - Validation mAP      : 67.45%
2025-04-19 12:53:31,418 - INFO - ============================================================
2025-04-19 12:53:31,418 - INFO - Saving best model at epoch 1 (Acc@1=57.26%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:53:32,496 - INFO -  Epoch 2/30
2025-04-19 12:53:32,496 - INFO - [Epoch 2] Learning rate: 0.000100
2025-04-19 12:53:56,929 - INFO - [DEBUG] ArcFace confidence: 0.3147
2025-04-19 12:53:56,935 - INFO - [DEBUG] Loss Breakdown  ID: 10.1397, SupCon: 3.5281, Tri: 0.0104
2025-04-19 12:53:57,019 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:53:57,019 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:53:57,115 - INFO - [DEBUG] ArcFace confidence: 0.4054
2025-04-19 12:53:57,118 - INFO - [DEBUG] Loss Breakdown  ID: 9.9860, SupCon: 3.5243, Tri: 0.0115
2025-04-19 12:53:57,293 - INFO - [DEBUG] ArcFace confidence: 0.4084
2025-04-19 12:53:57,296 - INFO - [DEBUG] Loss Breakdown  ID: 9.8735, SupCon: 3.5204, Tri: 0.0648
2025-04-19 12:53:57,474 - INFO - [DEBUG] ArcFace confidence: 0.4542
2025-04-19 12:53:57,477 - INFO - [DEBUG] Loss Breakdown  ID: 9.9298, SupCon: 3.6015, Tri: 0.0292
2025-04-19 12:53:57,657 - INFO - [DEBUG] ArcFace confidence: 0.4942
2025-04-19 12:53:57,660 - INFO - [DEBUG] Loss Breakdown  ID: 12.4223, SupCon: 3.5190, Tri: 0.0560
2025-04-19 12:53:57,837 - INFO - [DEBUG] ArcFace confidence: 0.4384
2025-04-19 12:53:57,840 - INFO - [DEBUG] Loss Breakdown  ID: 9.5017, SupCon: 3.5510, Tri: 0.0176
2025-04-19 12:53:58,018 - INFO - [DEBUG] ArcFace confidence: 0.4842
2025-04-19 12:53:58,024 - INFO - [DEBUG] Loss Breakdown  ID: 8.8491, SupCon: 3.6602, Tri: 0.0241
2025-04-19 12:53:58,202 - INFO - [DEBUG] ArcFace confidence: 0.3611
2025-04-19 12:53:58,205 - INFO - [DEBUG] Loss Breakdown  ID: 8.4083, SupCon: 3.6523, Tri: 0.0100
2025-04-19 12:53:58,385 - INFO - [DEBUG] ArcFace confidence: 0.4638
2025-04-19 12:53:58,388 - INFO - [DEBUG] Loss Breakdown  ID: 10.5208, SupCon: 3.6089, Tri: 0.0643
2025-04-19 12:53:58,568 - INFO - [DEBUG] ArcFace confidence: 0.3951
2025-04-19 12:53:58,571 - INFO - [DEBUG] Loss Breakdown  ID: 7.0558, SupCon: 3.6510, Tri: 0.0036
2025-04-19 12:53:58,749 - INFO - [DEBUG] ArcFace confidence: 0.4356
2025-04-19 12:53:58,752 - INFO - [DEBUG] Loss Breakdown  ID: 8.8816, SupCon: 3.6268, Tri: 0.0237
2025-04-19 12:53:58,934 - INFO - [DEBUG] ArcFace confidence: 0.5069
2025-04-19 12:53:58,937 - INFO - [DEBUG] Loss Breakdown  ID: 9.9239, SupCon: 3.6200, Tri: 0.0807
2025-04-19 12:53:59,117 - INFO - [DEBUG] ArcFace confidence: 0.4268
2025-04-19 12:53:59,120 - INFO - [DEBUG] Loss Breakdown  ID: 8.4686, SupCon: 3.5544, Tri: 0.0188
2025-04-19 12:53:59,301 - INFO - [DEBUG] ArcFace confidence: 0.4045
2025-04-19 12:53:59,304 - INFO - [DEBUG] Loss Breakdown  ID: 8.1620, SupCon: 3.5578, Tri: 0.0275
2025-04-19 12:53:59,487 - INFO - [DEBUG] ArcFace confidence: 0.5489
2025-04-19 12:53:59,490 - INFO - [DEBUG] Loss Breakdown  ID: 8.6722, SupCon: 3.5146, Tri: 0.0000
2025-04-19 12:53:59,669 - INFO - [DEBUG] ArcFace confidence: 0.4286
2025-04-19 12:53:59,672 - INFO - [DEBUG] Loss Breakdown  ID: 8.6051, SupCon: 3.5267, Tri: 0.0240
2025-04-19 12:53:59,848 - INFO - [DEBUG] ArcFace confidence: 0.4604
2025-04-19 12:53:59,854 - INFO - [DEBUG] Loss Breakdown  ID: 9.0652, SupCon: 3.4827, Tri: 0.0125
2025-04-19 12:54:00,033 - INFO - [DEBUG] ArcFace confidence: 0.4157
2025-04-19 12:54:00,036 - INFO - [DEBUG] Loss Breakdown  ID: 8.3725, SupCon: 3.5036, Tri: 0.0112
2025-04-19 12:54:00,215 - INFO - [DEBUG] ArcFace confidence: 0.4924
2025-04-19 12:54:00,218 - INFO - [DEBUG] Loss Breakdown  ID: 8.2967, SupCon: 3.6350, Tri: 0.0204
2025-04-19 12:54:00,398 - INFO - [DEBUG] ArcFace confidence: 0.4895
2025-04-19 12:54:00,404 - INFO - [DEBUG] Loss Breakdown  ID: 10.1968, SupCon: 3.5493, Tri: 0.0043
2025-04-19 12:54:00,581 - INFO - [DEBUG] ArcFace confidence: 0.5597
2025-04-19 12:54:00,587 - INFO - [DEBUG] Loss Breakdown  ID: 7.2395, SupCon: 3.5811, Tri: 0.0000
2025-04-19 12:54:00,761 - INFO - [DEBUG] ArcFace confidence: 0.4051
2025-04-19 12:54:00,764 - INFO - [DEBUG] Loss Breakdown  ID: 7.9805, SupCon: 3.6550, Tri: 0.0020
2025-04-19 12:54:00,941 - INFO - [DEBUG] ArcFace confidence: 0.4720
2025-04-19 12:54:00,946 - INFO - [DEBUG] Loss Breakdown  ID: 6.7685, SupCon: 3.5879, Tri: 0.0000
2025-04-19 12:54:01,123 - INFO - [DEBUG] ArcFace confidence: 0.5147
2025-04-19 12:54:01,126 - INFO - [DEBUG] Loss Breakdown  ID: 6.1228, SupCon: 3.6318, Tri: 0.0000
2025-04-19 12:54:01,300 - INFO - [DEBUG] ArcFace confidence: 0.4850
2025-04-19 12:54:01,303 - INFO - [DEBUG] Loss Breakdown  ID: 8.4617, SupCon: 3.5345, Tri: 0.0022
2025-04-19 12:54:01,481 - INFO - [DEBUG] ArcFace confidence: 0.5627
2025-04-19 12:54:01,484 - INFO - [DEBUG] Loss Breakdown  ID: 6.5997, SupCon: 3.5591, Tri: 0.0000
2025-04-19 12:54:01,658 - INFO - [DEBUG] ArcFace confidence: 0.5092
2025-04-19 12:54:01,661 - INFO - [DEBUG] Loss Breakdown  ID: 6.8979, SupCon: 3.5621, Tri: 0.0000
2025-04-19 12:54:01,826 - INFO - [DEBUG] ArcFace confidence: 0.4785
2025-04-19 12:54:01,829 - INFO - [DEBUG] Loss Breakdown  ID: 6.7131, SupCon: 3.3255, Tri: 0.0079
2025-04-19 12:54:02,581 - INFO - [Epoch 2] Total Loss=0.8835
2025-04-19 12:54:02,581 - INFO - Validating epoch 2...
2025-04-19 12:54:32,170 - INFO - [Epoch 2] Avg Train Loss = 0.8835 | 
2025-04-19 12:54:32,170 - INFO - ==================== Epoch 2 Validation ====================
2025-04-19 12:54:32,170 - INFO - Validation rank-1    : 67.15%
2025-04-19 12:54:32,170 - INFO - Validation rank-5    : 88.88%
2025-04-19 12:54:32,170 - INFO - Validation rank-10   : 93.41%
2025-04-19 12:54:32,170 - INFO - Validation mAP      : 76.71%
2025-04-19 12:54:32,170 - INFO - ============================================================
2025-04-19 12:54:32,170 - INFO - Saving best model at epoch 2 (Acc@1=67.15%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:54:33,256 - INFO -  Epoch 3/30
2025-04-19 12:54:33,256 - INFO - [Epoch 3] Learning rate: 0.000100
2025-04-19 12:54:59,522 - INFO - [DEBUG] ArcFace confidence: 0.5977
2025-04-19 12:54:59,528 - INFO - [DEBUG] Loss Breakdown  ID: 6.6215, SupCon: 3.5716, Tri: 0.0115
2025-04-19 12:54:59,614 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:54:59,614 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:54:59,713 - INFO - [DEBUG] ArcFace confidence: 0.5648
2025-04-19 12:54:59,716 - INFO - [DEBUG] Loss Breakdown  ID: 5.4042, SupCon: 3.4620, Tri: 0.0000
2025-04-19 12:54:59,896 - INFO - [DEBUG] ArcFace confidence: 0.5691
2025-04-19 12:54:59,899 - INFO - [DEBUG] Loss Breakdown  ID: 6.1293, SupCon: 3.6254, Tri: 0.0000
2025-04-19 12:55:00,086 - INFO - [DEBUG] ArcFace confidence: 0.5556
2025-04-19 12:55:00,092 - INFO - [DEBUG] Loss Breakdown  ID: 6.1424, SupCon: 3.6131, Tri: 0.0006
2025-04-19 12:55:00,273 - INFO - [DEBUG] ArcFace confidence: 0.5328
2025-04-19 12:55:00,276 - INFO - [DEBUG] Loss Breakdown  ID: 5.7884, SupCon: 3.5683, Tri: 0.0010
2025-04-19 12:55:00,455 - INFO - [DEBUG] ArcFace confidence: 0.4205
2025-04-19 12:55:00,458 - INFO - [DEBUG] Loss Breakdown  ID: 4.7091, SupCon: 3.5473, Tri: 0.0000
2025-04-19 12:55:00,635 - INFO - [DEBUG] ArcFace confidence: 0.4993
2025-04-19 12:55:00,641 - INFO - [DEBUG] Loss Breakdown  ID: 9.2269, SupCon: 3.5290, Tri: 0.0004
2025-04-19 12:55:00,819 - INFO - [DEBUG] ArcFace confidence: 0.4971
2025-04-19 12:55:00,822 - INFO - [DEBUG] Loss Breakdown  ID: 5.2768, SupCon: 3.5541, Tri: 0.0006
2025-04-19 12:55:01,005 - INFO - [DEBUG] ArcFace confidence: 0.5803
2025-04-19 12:55:01,008 - INFO - [DEBUG] Loss Breakdown  ID: 5.8586, SupCon: 3.4721, Tri: 0.0402
2025-04-19 12:55:01,187 - INFO - [DEBUG] ArcFace confidence: 0.5398
2025-04-19 12:55:01,193 - INFO - [DEBUG] Loss Breakdown  ID: 4.8736, SupCon: 3.5620, Tri: 0.0012
2025-04-19 12:55:01,372 - INFO - [DEBUG] ArcFace confidence: 0.5828
2025-04-19 12:55:01,375 - INFO - [DEBUG] Loss Breakdown  ID: 5.6413, SupCon: 3.5295, Tri: 0.0007
2025-04-19 12:55:01,555 - INFO - [DEBUG] ArcFace confidence: 0.6258
2025-04-19 12:55:01,558 - INFO - [DEBUG] Loss Breakdown  ID: 5.3436, SupCon: 3.6870, Tri: 0.0000
2025-04-19 12:55:01,735 - INFO - [DEBUG] ArcFace confidence: 0.5352
2025-04-19 12:55:01,741 - INFO - [DEBUG] Loss Breakdown  ID: 5.9161, SupCon: 3.6270, Tri: 0.0022
2025-04-19 12:55:01,918 - INFO - [DEBUG] ArcFace confidence: 0.5668
2025-04-19 12:55:01,924 - INFO - [DEBUG] Loss Breakdown  ID: 4.7053, SupCon: 3.6337, Tri: 0.0000
2025-04-19 12:55:02,101 - INFO - [DEBUG] ArcFace confidence: 0.5611
2025-04-19 12:55:02,104 - INFO - [DEBUG] Loss Breakdown  ID: 5.9309, SupCon: 3.6461, Tri: 0.0026
2025-04-19 12:55:02,281 - INFO - [DEBUG] ArcFace confidence: 0.6204
2025-04-19 12:55:02,284 - INFO - [DEBUG] Loss Breakdown  ID: 3.3807, SupCon: 3.6892, Tri: 0.0000
2025-04-19 12:55:02,461 - INFO - [DEBUG] ArcFace confidence: 0.6628
2025-04-19 12:55:02,464 - INFO - [DEBUG] Loss Breakdown  ID: 3.7299, SupCon: 3.6623, Tri: 0.0000
2025-04-19 12:55:02,644 - INFO - [DEBUG] ArcFace confidence: 0.6322
2025-04-19 12:55:02,647 - INFO - [DEBUG] Loss Breakdown  ID: 4.6348, SupCon: 3.6034, Tri: 0.0000
2025-04-19 12:55:02,825 - INFO - [DEBUG] ArcFace confidence: 0.4950
2025-04-19 12:55:02,831 - INFO - [DEBUG] Loss Breakdown  ID: 6.2811, SupCon: 3.5317, Tri: 0.0191
2025-04-19 12:55:03,005 - INFO - [DEBUG] ArcFace confidence: 0.5876
2025-04-19 12:55:03,008 - INFO - [DEBUG] Loss Breakdown  ID: 4.2900, SupCon: 3.5376, Tri: 0.0000
2025-04-19 12:55:03,184 - INFO - [DEBUG] ArcFace confidence: 0.6080
2025-04-19 12:55:03,190 - INFO - [DEBUG] Loss Breakdown  ID: 5.5601, SupCon: 3.5648, Tri: 0.0000
2025-04-19 12:55:03,364 - INFO - [DEBUG] ArcFace confidence: 0.6017
2025-04-19 12:55:03,367 - INFO - [DEBUG] Loss Breakdown  ID: 3.1438, SupCon: 3.5236, Tri: 0.0000
2025-04-19 12:55:03,542 - INFO - [DEBUG] ArcFace confidence: 0.5555
2025-04-19 12:55:03,548 - INFO - [DEBUG] Loss Breakdown  ID: 6.2255, SupCon: 3.5699, Tri: 0.0386
2025-04-19 12:55:03,723 - INFO - [DEBUG] ArcFace confidence: 0.5556
2025-04-19 12:55:03,726 - INFO - [DEBUG] Loss Breakdown  ID: 4.4914, SupCon: 3.5368, Tri: 0.0000
2025-04-19 12:55:03,901 - INFO - [DEBUG] ArcFace confidence: 0.5934
2025-04-19 12:55:03,904 - INFO - [DEBUG] Loss Breakdown  ID: 4.8791, SupCon: 3.5003, Tri: 0.0000
2025-04-19 12:55:04,081 - INFO - [DEBUG] ArcFace confidence: 0.5533
2025-04-19 12:55:04,084 - INFO - [DEBUG] Loss Breakdown  ID: 5.4146, SupCon: 3.5762, Tri: 0.0159
2025-04-19 12:55:04,260 - INFO - [DEBUG] ArcFace confidence: 0.5916
2025-04-19 12:55:04,266 - INFO - [DEBUG] Loss Breakdown  ID: 4.2397, SupCon: 3.6650, Tri: 0.0000
2025-04-19 12:55:04,428 - INFO - [DEBUG] ArcFace confidence: 0.5149
2025-04-19 12:55:04,431 - INFO - [DEBUG] Loss Breakdown  ID: 5.4284, SupCon: 3.2789, Tri: 0.0000
2025-04-19 12:55:05,190 - INFO - [Epoch 3] Total Loss=0.5379
2025-04-19 12:55:05,190 - INFO - Validating epoch 3...
2025-04-19 12:55:35,913 - INFO - [Epoch 3] Avg Train Loss = 0.5379 | 
2025-04-19 12:55:35,913 - INFO - ==================== Epoch 3 Validation ====================
2025-04-19 12:55:35,916 - INFO - Validation rank-1    : 77.24%
2025-04-19 12:55:35,916 - INFO - Validation rank-5    : 92.69%
2025-04-19 12:55:35,916 - INFO - Validation rank-10   : 96.50%
2025-04-19 12:55:35,916 - INFO - Validation mAP      : 83.77%
2025-04-19 12:55:35,916 - INFO - ============================================================
2025-04-19 12:55:35,916 - INFO - Saving best model at epoch 3 (Acc@1=77.24%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:55:36,999 - INFO -  Epoch 4/30
2025-04-19 12:55:37,002 - INFO - [Epoch 4] Learning rate: 0.000100
2025-04-19 12:56:02,084 - INFO - [DEBUG] ArcFace confidence: 0.5315
2025-04-19 12:56:02,087 - INFO - [DEBUG] Loss Breakdown  ID: 3.2881, SupCon: 3.4875, Tri: 0.0000
2025-04-19 12:56:02,174 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:56:02,174 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:56:02,267 - INFO - [DEBUG] ArcFace confidence: 0.5489
2025-04-19 12:56:02,270 - INFO - [DEBUG] Loss Breakdown  ID: 4.1308, SupCon: 3.5139, Tri: 0.0000
2025-04-19 12:56:02,450 - INFO - [DEBUG] ArcFace confidence: 0.5208
2025-04-19 12:56:02,456 - INFO - [DEBUG] Loss Breakdown  ID: 4.1985, SupCon: 3.5412, Tri: 0.0000
2025-04-19 12:56:02,642 - INFO - [DEBUG] ArcFace confidence: 0.5889
2025-04-19 12:56:02,645 - INFO - [DEBUG] Loss Breakdown  ID: 3.7259, SupCon: 3.5882, Tri: 0.0023
2025-04-19 12:56:02,825 - INFO - [DEBUG] ArcFace confidence: 0.6130
2025-04-19 12:56:02,828 - INFO - [DEBUG] Loss Breakdown  ID: 5.0746, SupCon: 3.5096, Tri: 0.0136
2025-04-19 12:56:03,011 - INFO - [DEBUG] ArcFace confidence: 0.6435
2025-04-19 12:56:03,016 - INFO - [DEBUG] Loss Breakdown  ID: 4.5449, SupCon: 3.5545, Tri: 0.0000
2025-04-19 12:56:03,196 - INFO - [DEBUG] ArcFace confidence: 0.6697
2025-04-19 12:56:03,202 - INFO - [DEBUG] Loss Breakdown  ID: 4.1846, SupCon: 3.5243, Tri: 0.0000
2025-04-19 12:56:03,381 - INFO - [DEBUG] ArcFace confidence: 0.5728
2025-04-19 12:56:03,387 - INFO - [DEBUG] Loss Breakdown  ID: 2.9599, SupCon: 3.5506, Tri: 0.0067
2025-04-19 12:56:03,567 - INFO - [DEBUG] ArcFace confidence: 0.5562
2025-04-19 12:56:03,570 - INFO - [DEBUG] Loss Breakdown  ID: 4.5482, SupCon: 3.5954, Tri: 0.0000
2025-04-19 12:56:03,750 - INFO - [DEBUG] ArcFace confidence: 0.6927
2025-04-19 12:56:03,753 - INFO - [DEBUG] Loss Breakdown  ID: 2.9139, SupCon: 3.6000, Tri: 0.0000
2025-04-19 12:56:03,936 - INFO - [DEBUG] ArcFace confidence: 0.6282
2025-04-19 12:56:03,939 - INFO - [DEBUG] Loss Breakdown  ID: 3.1142, SupCon: 3.5696, Tri: 0.0000
2025-04-19 12:56:04,118 - INFO - [DEBUG] ArcFace confidence: 0.5912
2025-04-19 12:56:04,124 - INFO - [DEBUG] Loss Breakdown  ID: 4.9610, SupCon: 3.5811, Tri: 0.0000
2025-04-19 12:56:04,301 - INFO - [DEBUG] ArcFace confidence: 0.6811
2025-04-19 12:56:04,307 - INFO - [DEBUG] Loss Breakdown  ID: 3.8936, SupCon: 3.6553, Tri: 0.0000
2025-04-19 12:56:04,487 - INFO - [DEBUG] ArcFace confidence: 0.5459
2025-04-19 12:56:04,490 - INFO - [DEBUG] Loss Breakdown  ID: 4.0075, SupCon: 3.6105, Tri: 0.0000
2025-04-19 12:56:04,670 - INFO - [DEBUG] ArcFace confidence: 0.6584
2025-04-19 12:56:04,676 - INFO - [DEBUG] Loss Breakdown  ID: 2.7646, SupCon: 3.5287, Tri: 0.0000
2025-04-19 12:56:04,856 - INFO - [DEBUG] ArcFace confidence: 0.6003
2025-04-19 12:56:04,862 - INFO - [DEBUG] Loss Breakdown  ID: 3.8623, SupCon: 3.4842, Tri: 0.0137
2025-04-19 12:56:05,043 - INFO - [DEBUG] ArcFace confidence: 0.7557
2025-04-19 12:56:05,046 - INFO - [DEBUG] Loss Breakdown  ID: 2.9582, SupCon: 3.5665, Tri: 0.0000
2025-04-19 12:56:05,226 - INFO - [DEBUG] ArcFace confidence: 0.7170
2025-04-19 12:56:05,229 - INFO - [DEBUG] Loss Breakdown  ID: 2.8746, SupCon: 3.5845, Tri: 0.0000
2025-04-19 12:56:05,413 - INFO - [DEBUG] ArcFace confidence: 0.7208
2025-04-19 12:56:05,416 - INFO - [DEBUG] Loss Breakdown  ID: 2.9668, SupCon: 3.6270, Tri: 0.0000
2025-04-19 12:56:05,596 - INFO - [DEBUG] ArcFace confidence: 0.5973
2025-04-19 12:56:05,599 - INFO - [DEBUG] Loss Breakdown  ID: 2.9013, SupCon: 3.5230, Tri: 0.0000
2025-04-19 12:56:05,782 - INFO - [DEBUG] ArcFace confidence: 0.7146
2025-04-19 12:56:05,788 - INFO - [DEBUG] Loss Breakdown  ID: 2.5381, SupCon: 3.5828, Tri: 0.0000
2025-04-19 12:56:05,968 - INFO - [DEBUG] ArcFace confidence: 0.6706
2025-04-19 12:56:05,971 - INFO - [DEBUG] Loss Breakdown  ID: 3.1443, SupCon: 3.4726, Tri: 0.0000
2025-04-19 12:56:06,148 - INFO - [DEBUG] ArcFace confidence: 0.7580
2025-04-19 12:56:06,151 - INFO - [DEBUG] Loss Breakdown  ID: 1.9781, SupCon: 3.6145, Tri: 0.0000
2025-04-19 12:56:06,328 - INFO - [DEBUG] ArcFace confidence: 0.7651
2025-04-19 12:56:06,331 - INFO - [DEBUG] Loss Breakdown  ID: 2.9493, SupCon: 3.5722, Tri: 0.0000
2025-04-19 12:56:06,508 - INFO - [DEBUG] ArcFace confidence: 0.7393
2025-04-19 12:56:06,514 - INFO - [DEBUG] Loss Breakdown  ID: 3.7169, SupCon: 3.5722, Tri: 0.0000
2025-04-19 12:56:06,692 - INFO - [DEBUG] ArcFace confidence: 0.7612
2025-04-19 12:56:06,695 - INFO - [DEBUG] Loss Breakdown  ID: 3.3982, SupCon: 3.6293, Tri: 0.0000
2025-04-19 12:56:06,876 - INFO - [DEBUG] ArcFace confidence: 0.6229
2025-04-19 12:56:06,879 - INFO - [DEBUG] Loss Breakdown  ID: 3.5259, SupCon: 3.4824, Tri: 0.0000
2025-04-19 12:56:07,041 - INFO - [DEBUG] ArcFace confidence: 0.6084
2025-04-19 12:56:07,044 - INFO - [DEBUG] Loss Breakdown  ID: 2.6354, SupCon: 3.4465, Tri: 0.0000
2025-04-19 12:56:07,803 - INFO - [Epoch 4] Total Loss=0.3504
2025-04-19 12:56:07,803 - INFO - Validating epoch 4...
2025-04-19 12:56:37,905 - INFO - [Epoch 4] Avg Train Loss = 0.3504 | 
2025-04-19 12:56:37,905 - INFO - ==================== Epoch 4 Validation ====================
2025-04-19 12:56:37,905 - INFO - Validation rank-1    : 66.53%
2025-04-19 12:56:37,905 - INFO - Validation rank-5    : 81.15%
2025-04-19 12:56:37,905 - INFO - Validation rank-10   : 86.51%
2025-04-19 12:56:37,905 - INFO - Validation mAP      : 73.82%
2025-04-19 12:56:37,905 - INFO - ============================================================
2025-04-19 12:56:37,905 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 12:56:37,905 - INFO -  Epoch 5/30
2025-04-19 12:56:37,908 - INFO - [Epoch 5] Learning rate: 0.000100
2025-04-19 12:57:03,048 - INFO - [DEBUG] ArcFace confidence: 0.7501
2025-04-19 12:57:03,054 - INFO - [DEBUG] Loss Breakdown  ID: 2.6734, SupCon: 3.5714, Tri: 0.0000
2025-04-19 12:57:03,138 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:57:03,138 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:57:03,234 - INFO - [DEBUG] ArcFace confidence: 0.7252
2025-04-19 12:57:03,237 - INFO - [DEBUG] Loss Breakdown  ID: 2.6348, SupCon: 3.5294, Tri: 0.0000
2025-04-19 12:57:03,417 - INFO - [DEBUG] ArcFace confidence: 0.6969
2025-04-19 12:57:03,420 - INFO - [DEBUG] Loss Breakdown  ID: 3.6596, SupCon: 3.6095, Tri: 0.0000
2025-04-19 12:57:03,602 - INFO - [DEBUG] ArcFace confidence: 0.6860
2025-04-19 12:57:03,605 - INFO - [DEBUG] Loss Breakdown  ID: 2.5070, SupCon: 3.6512, Tri: 0.0000
2025-04-19 12:57:03,784 - INFO - [DEBUG] ArcFace confidence: 0.6591
2025-04-19 12:57:03,790 - INFO - [DEBUG] Loss Breakdown  ID: 2.5434, SupCon: 3.5112, Tri: 0.0000
2025-04-19 12:57:03,967 - INFO - [DEBUG] ArcFace confidence: 0.6802
2025-04-19 12:57:03,973 - INFO - [DEBUG] Loss Breakdown  ID: 3.2341, SupCon: 3.5519, Tri: 0.0000
2025-04-19 12:57:04,153 - INFO - [DEBUG] ArcFace confidence: 0.6120
2025-04-19 12:57:04,156 - INFO - [DEBUG] Loss Breakdown  ID: 3.2183, SupCon: 3.6369, Tri: 0.0000
2025-04-19 12:57:04,338 - INFO - [DEBUG] ArcFace confidence: 0.7338
2025-04-19 12:57:04,341 - INFO - [DEBUG] Loss Breakdown  ID: 2.0780, SupCon: 3.6087, Tri: 0.0000
2025-04-19 12:57:04,518 - INFO - [DEBUG] ArcFace confidence: 0.6772
2025-04-19 12:57:04,524 - INFO - [DEBUG] Loss Breakdown  ID: 2.2273, SupCon: 3.5783, Tri: 0.0000
2025-04-19 12:57:04,702 - INFO - [DEBUG] ArcFace confidence: 0.6271
2025-04-19 12:57:04,708 - INFO - [DEBUG] Loss Breakdown  ID: 2.8159, SupCon: 3.5841, Tri: 0.0070
2025-04-19 12:57:04,884 - INFO - [DEBUG] ArcFace confidence: 0.6883
2025-04-19 12:57:04,887 - INFO - [DEBUG] Loss Breakdown  ID: 3.2786, SupCon: 3.6811, Tri: 0.0000
2025-04-19 12:57:05,067 - INFO - [DEBUG] ArcFace confidence: 0.7469
2025-04-19 12:57:05,070 - INFO - [DEBUG] Loss Breakdown  ID: 1.9319, SupCon: 3.5530, Tri: 0.0000
2025-04-19 12:57:05,247 - INFO - [DEBUG] ArcFace confidence: 0.7285
2025-04-19 12:57:05,253 - INFO - [DEBUG] Loss Breakdown  ID: 1.9500, SupCon: 3.5448, Tri: 0.0000
2025-04-19 12:57:05,427 - INFO - [DEBUG] ArcFace confidence: 0.7224
2025-04-19 12:57:05,430 - INFO - [DEBUG] Loss Breakdown  ID: 2.3086, SupCon: 3.5791, Tri: 0.0000
2025-04-19 12:57:05,610 - INFO - [DEBUG] ArcFace confidence: 0.7431
2025-04-19 12:57:05,613 - INFO - [DEBUG] Loss Breakdown  ID: 1.8635, SupCon: 3.5019, Tri: 0.0000
2025-04-19 12:57:05,790 - INFO - [DEBUG] ArcFace confidence: 0.7766
2025-04-19 12:57:05,793 - INFO - [DEBUG] Loss Breakdown  ID: 2.8177, SupCon: 3.5396, Tri: 0.0000
2025-04-19 12:57:05,973 - INFO - [DEBUG] ArcFace confidence: 0.6404
2025-04-19 12:57:05,976 - INFO - [DEBUG] Loss Breakdown  ID: 1.7690, SupCon: 3.5703, Tri: 0.0000
2025-04-19 12:57:06,151 - INFO - [DEBUG] ArcFace confidence: 0.7099
2025-04-19 12:57:06,157 - INFO - [DEBUG] Loss Breakdown  ID: 1.9171, SupCon: 3.5041, Tri: 0.0000
2025-04-19 12:57:06,334 - INFO - [DEBUG] ArcFace confidence: 0.7310
2025-04-19 12:57:06,337 - INFO - [DEBUG] Loss Breakdown  ID: 1.8091, SupCon: 3.5188, Tri: 0.0000
2025-04-19 12:57:06,513 - INFO - [DEBUG] ArcFace confidence: 0.6499
2025-04-19 12:57:06,519 - INFO - [DEBUG] Loss Breakdown  ID: 2.9085, SupCon: 3.5916, Tri: 0.0000
2025-04-19 12:57:06,696 - INFO - [DEBUG] ArcFace confidence: 0.7385
2025-04-19 12:57:06,702 - INFO - [DEBUG] Loss Breakdown  ID: 2.3007, SupCon: 3.6228, Tri: 0.0000
2025-04-19 12:57:06,878 - INFO - [DEBUG] ArcFace confidence: 0.7803
2025-04-19 12:57:06,881 - INFO - [DEBUG] Loss Breakdown  ID: 1.8501, SupCon: 3.5702, Tri: 0.0000
2025-04-19 12:57:07,057 - INFO - [DEBUG] ArcFace confidence: 0.6842
2025-04-19 12:57:07,060 - INFO - [DEBUG] Loss Breakdown  ID: 2.3390, SupCon: 3.5459, Tri: 0.0000
2025-04-19 12:57:07,238 - INFO - [DEBUG] ArcFace confidence: 0.7228
2025-04-19 12:57:07,241 - INFO - [DEBUG] Loss Breakdown  ID: 3.1283, SupCon: 3.4944, Tri: 0.0222
2025-04-19 12:57:07,413 - INFO - [DEBUG] ArcFace confidence: 0.6894
2025-04-19 12:57:07,416 - INFO - [DEBUG] Loss Breakdown  ID: 2.2092, SupCon: 3.5104, Tri: 0.0000
2025-04-19 12:57:07,593 - INFO - [DEBUG] ArcFace confidence: 0.7523
2025-04-19 12:57:07,596 - INFO - [DEBUG] Loss Breakdown  ID: 2.6807, SupCon: 3.5269, Tri: 0.0000
2025-04-19 12:57:07,774 - INFO - [DEBUG] ArcFace confidence: 0.7227
2025-04-19 12:57:07,777 - INFO - [DEBUG] Loss Breakdown  ID: 1.3855, SupCon: 3.5793, Tri: 0.0000
2025-04-19 12:57:07,940 - INFO - [DEBUG] ArcFace confidence: 0.8104
2025-04-19 12:57:07,943 - INFO - [DEBUG] Loss Breakdown  ID: 1.6715, SupCon: 3.3716, Tri: 0.0000
2025-04-19 12:57:08,713 - INFO - [Epoch 5] Total Loss=0.2429
2025-04-19 12:57:08,713 - INFO - Validating epoch 5...
2025-04-19 12:57:38,296 - INFO - [Epoch 5] Avg Train Loss = 0.2429 | 
2025-04-19 12:57:38,296 - INFO - ==================== Epoch 5 Validation ====================
2025-04-19 12:57:38,296 - INFO - Validation rank-1    : 85.99%
2025-04-19 12:57:38,296 - INFO - Validation rank-5    : 95.78%
2025-04-19 12:57:38,296 - INFO - Validation rank-10   : 98.56%
2025-04-19 12:57:38,296 - INFO - Validation mAP      : 90.34%
2025-04-19 12:57:38,296 - INFO - ============================================================
2025-04-19 12:57:38,296 - INFO - Saving best model at epoch 5 (Acc@1=85.99%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:57:39,300 - INFO -  Epoch 6/30
2025-04-19 12:57:39,300 - INFO - [Epoch 6] Learning rate: 0.000100
2025-04-19 12:58:04,046 - INFO - [DEBUG] ArcFace confidence: 0.7088
2025-04-19 12:58:04,049 - INFO - [DEBUG] Loss Breakdown  ID: 1.5651, SupCon: 3.5718, Tri: 0.0000
2025-04-19 12:58:04,130 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:58:04,130 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:58:04,226 - INFO - [DEBUG] ArcFace confidence: 0.7656
2025-04-19 12:58:04,232 - INFO - [DEBUG] Loss Breakdown  ID: 1.1164, SupCon: 3.6400, Tri: 0.0000
2025-04-19 12:58:04,415 - INFO - [DEBUG] ArcFace confidence: 0.7948
2025-04-19 12:58:04,418 - INFO - [DEBUG] Loss Breakdown  ID: 1.8589, SupCon: 3.6306, Tri: 0.0000
2025-04-19 12:58:04,599 - INFO - [DEBUG] ArcFace confidence: 0.7515
2025-04-19 12:58:04,605 - INFO - [DEBUG] Loss Breakdown  ID: 2.4043, SupCon: 3.6102, Tri: 0.0000
2025-04-19 12:58:04,783 - INFO - [DEBUG] ArcFace confidence: 0.7691
2025-04-19 12:58:04,786 - INFO - [DEBUG] Loss Breakdown  ID: 1.7103, SupCon: 3.5712, Tri: 0.0000
2025-04-19 12:58:04,965 - INFO - [DEBUG] ArcFace confidence: 0.8841
2025-04-19 12:58:04,969 - INFO - [DEBUG] Loss Breakdown  ID: 1.7620, SupCon: 3.5135, Tri: 0.0000
2025-04-19 12:58:05,152 - INFO - [DEBUG] ArcFace confidence: 0.7383
2025-04-19 12:58:05,155 - INFO - [DEBUG] Loss Breakdown  ID: 1.4103, SupCon: 3.5106, Tri: 0.0000
2025-04-19 12:58:05,336 - INFO - [DEBUG] ArcFace confidence: 0.7513
2025-04-19 12:58:05,339 - INFO - [DEBUG] Loss Breakdown  ID: 2.7296, SupCon: 3.5059, Tri: 0.0000
2025-04-19 12:58:05,519 - INFO - [DEBUG] ArcFace confidence: 0.8546
2025-04-19 12:58:05,525 - INFO - [DEBUG] Loss Breakdown  ID: 1.6698, SupCon: 3.5504, Tri: 0.0000
2025-04-19 12:58:05,700 - INFO - [DEBUG] ArcFace confidence: 0.7487
2025-04-19 12:58:05,706 - INFO - [DEBUG] Loss Breakdown  ID: 1.6596, SupCon: 3.5822, Tri: 0.0000
2025-04-19 12:58:05,887 - INFO - [DEBUG] ArcFace confidence: 0.7633
2025-04-19 12:58:05,890 - INFO - [DEBUG] Loss Breakdown  ID: 2.5246, SupCon: 3.5964, Tri: 0.0000
2025-04-19 12:58:06,072 - INFO - [DEBUG] ArcFace confidence: 0.8360
2025-04-19 12:58:06,075 - INFO - [DEBUG] Loss Breakdown  ID: 0.9217, SupCon: 3.6515, Tri: 0.0000
2025-04-19 12:58:06,255 - INFO - [DEBUG] ArcFace confidence: 0.7368
2025-04-19 12:58:06,258 - INFO - [DEBUG] Loss Breakdown  ID: 1.5542, SupCon: 3.5888, Tri: 0.0000
2025-04-19 12:58:06,434 - INFO - [DEBUG] ArcFace confidence: 0.7741
2025-04-19 12:58:06,440 - INFO - [DEBUG] Loss Breakdown  ID: 1.2713, SupCon: 3.4828, Tri: 0.0000
2025-04-19 12:58:06,618 - INFO - [DEBUG] ArcFace confidence: 0.7814
2025-04-19 12:58:06,624 - INFO - [DEBUG] Loss Breakdown  ID: 1.6852, SupCon: 3.6240, Tri: 0.0000
2025-04-19 12:58:06,802 - INFO - [DEBUG] ArcFace confidence: 0.8392
2025-04-19 12:58:06,808 - INFO - [DEBUG] Loss Breakdown  ID: 1.1262, SupCon: 3.5688, Tri: 0.0000
2025-04-19 12:58:06,984 - INFO - [DEBUG] ArcFace confidence: 0.8083
2025-04-19 12:58:06,987 - INFO - [DEBUG] Loss Breakdown  ID: 1.5267, SupCon: 3.6247, Tri: 0.0000
2025-04-19 12:58:07,168 - INFO - [DEBUG] ArcFace confidence: 0.8036
2025-04-19 12:58:07,171 - INFO - [DEBUG] Loss Breakdown  ID: 1.4005, SupCon: 3.4661, Tri: 0.0000
2025-04-19 12:58:07,346 - INFO - [DEBUG] ArcFace confidence: 0.7891
2025-04-19 12:58:07,349 - INFO - [DEBUG] Loss Breakdown  ID: 1.4105, SupCon: 3.5918, Tri: 0.0000
2025-04-19 12:58:07,529 - INFO - [DEBUG] ArcFace confidence: 0.7752
2025-04-19 12:58:07,535 - INFO - [DEBUG] Loss Breakdown  ID: 1.9629, SupCon: 3.4727, Tri: 0.0000
2025-04-19 12:58:07,711 - INFO - [DEBUG] ArcFace confidence: 0.8496
2025-04-19 12:58:07,714 - INFO - [DEBUG] Loss Breakdown  ID: 1.0513, SupCon: 3.5081, Tri: 0.0000
2025-04-19 12:58:07,889 - INFO - [DEBUG] ArcFace confidence: 0.7992
2025-04-19 12:58:07,895 - INFO - [DEBUG] Loss Breakdown  ID: 1.2460, SupCon: 3.6836, Tri: 0.0000
2025-04-19 12:58:08,066 - INFO - [DEBUG] ArcFace confidence: 0.8434
2025-04-19 12:58:08,069 - INFO - [DEBUG] Loss Breakdown  ID: 1.5725, SupCon: 3.5743, Tri: 0.0000
2025-04-19 12:58:08,246 - INFO - [DEBUG] ArcFace confidence: 0.8737
2025-04-19 12:58:08,249 - INFO - [DEBUG] Loss Breakdown  ID: 0.9622, SupCon: 3.5686, Tri: 0.0000
2025-04-19 12:58:08,426 - INFO - [DEBUG] ArcFace confidence: 0.8538
2025-04-19 12:58:08,429 - INFO - [DEBUG] Loss Breakdown  ID: 1.3232, SupCon: 3.6814, Tri: 0.0000
2025-04-19 12:58:08,605 - INFO - [DEBUG] ArcFace confidence: 0.8832
2025-04-19 12:58:08,608 - INFO - [DEBUG] Loss Breakdown  ID: 1.3156, SupCon: 3.5598, Tri: 0.0000
2025-04-19 12:58:08,782 - INFO - [DEBUG] ArcFace confidence: 0.7892
2025-04-19 12:58:08,785 - INFO - [DEBUG] Loss Breakdown  ID: 1.1363, SupCon: 3.5587, Tri: 0.0000
2025-04-19 12:58:08,950 - INFO - [DEBUG] ArcFace confidence: 0.7913
2025-04-19 12:58:08,953 - INFO - [DEBUG] Loss Breakdown  ID: 1.2245, SupCon: 3.3930, Tri: 0.0000
2025-04-19 12:58:09,719 - INFO - [Epoch 6] Total Loss=0.1539
2025-04-19 12:58:09,719 - INFO - Validating epoch 6...
2025-04-19 12:58:39,516 - INFO - [Epoch 6] Avg Train Loss = 0.1539 | 
2025-04-19 12:58:39,516 - INFO - ==================== Epoch 6 Validation ====================
2025-04-19 12:58:39,516 - INFO - Validation rank-1    : 87.33%
2025-04-19 12:58:39,516 - INFO - Validation rank-5    : 95.88%
2025-04-19 12:58:39,516 - INFO - Validation rank-10   : 97.63%
2025-04-19 12:58:39,516 - INFO - Validation mAP      : 91.05%
2025-04-19 12:58:39,516 - INFO - ============================================================
2025-04-19 12:58:39,516 - INFO - Saving best model at epoch 6 (Acc@1=87.33%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:58:40,595 - INFO -  Epoch 7/30
2025-04-19 12:58:40,595 - INFO - [Epoch 7] Learning rate: 0.000100
2025-04-19 12:59:04,823 - INFO - [DEBUG] ArcFace confidence: 0.8956
2025-04-19 12:59:04,826 - INFO - [DEBUG] Loss Breakdown  ID: 1.0109, SupCon: 3.4954, Tri: 0.0000
2025-04-19 12:59:04,911 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:59:04,911 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:59:05,010 - INFO - [DEBUG] ArcFace confidence: 0.8672
2025-04-19 12:59:05,013 - INFO - [DEBUG] Loss Breakdown  ID: 1.3499, SupCon: 3.6541, Tri: 0.0000
2025-04-19 12:59:05,190 - INFO - [DEBUG] ArcFace confidence: 0.8775
2025-04-19 12:59:05,196 - INFO - [DEBUG] Loss Breakdown  ID: 1.1106, SupCon: 3.4920, Tri: 0.0000
2025-04-19 12:59:05,373 - INFO - [DEBUG] ArcFace confidence: 0.7608
2025-04-19 12:59:05,376 - INFO - [DEBUG] Loss Breakdown  ID: 1.3590, SupCon: 3.4980, Tri: 0.0000
2025-04-19 12:59:05,558 - INFO - [DEBUG] ArcFace confidence: 0.8080
2025-04-19 12:59:05,561 - INFO - [DEBUG] Loss Breakdown  ID: 1.2942, SupCon: 3.5322, Tri: 0.0000
2025-04-19 12:59:05,738 - INFO - [DEBUG] ArcFace confidence: 0.8521
2025-04-19 12:59:05,741 - INFO - [DEBUG] Loss Breakdown  ID: 1.0970, SupCon: 3.5811, Tri: 0.0000
2025-04-19 12:59:05,919 - INFO - [DEBUG] ArcFace confidence: 0.8717
2025-04-19 12:59:05,922 - INFO - [DEBUG] Loss Breakdown  ID: 1.2998, SupCon: 3.6855, Tri: 0.0000
2025-04-19 12:59:06,098 - INFO - [DEBUG] ArcFace confidence: 0.8524
2025-04-19 12:59:06,104 - INFO - [DEBUG] Loss Breakdown  ID: 1.5140, SupCon: 3.5666, Tri: 0.0000
2025-04-19 12:59:06,284 - INFO - [DEBUG] ArcFace confidence: 0.8492
2025-04-19 12:59:06,287 - INFO - [DEBUG] Loss Breakdown  ID: 1.2144, SupCon: 3.5209, Tri: 0.0000
2025-04-19 12:59:06,465 - INFO - [DEBUG] ArcFace confidence: 0.8152
2025-04-19 12:59:06,468 - INFO - [DEBUG] Loss Breakdown  ID: 1.4191, SupCon: 3.5607, Tri: 0.0000
2025-04-19 12:59:06,646 - INFO - [DEBUG] ArcFace confidence: 0.8320
2025-04-19 12:59:06,652 - INFO - [DEBUG] Loss Breakdown  ID: 1.1470, SupCon: 3.3973, Tri: 0.0000
2025-04-19 12:59:06,828 - INFO - [DEBUG] ArcFace confidence: 0.8787
2025-04-19 12:59:06,831 - INFO - [DEBUG] Loss Breakdown  ID: 0.9310, SupCon: 3.5838, Tri: 0.0000
2025-04-19 12:59:07,013 - INFO - [DEBUG] ArcFace confidence: 0.8522
2025-04-19 12:59:07,016 - INFO - [DEBUG] Loss Breakdown  ID: 1.2034, SupCon: 3.5055, Tri: 0.0000
2025-04-19 12:59:07,192 - INFO - [DEBUG] ArcFace confidence: 0.8453
2025-04-19 12:59:07,195 - INFO - [DEBUG] Loss Breakdown  ID: 0.9029, SupCon: 3.5693, Tri: 0.0000
2025-04-19 12:59:07,372 - INFO - [DEBUG] ArcFace confidence: 0.8329
2025-04-19 12:59:07,375 - INFO - [DEBUG] Loss Breakdown  ID: 1.2587, SupCon: 3.5259, Tri: 0.0000
2025-04-19 12:59:07,552 - INFO - [DEBUG] ArcFace confidence: 0.8419
2025-04-19 12:59:07,555 - INFO - [DEBUG] Loss Breakdown  ID: 0.8932, SupCon: 3.4440, Tri: 0.0000
2025-04-19 12:59:07,732 - INFO - [DEBUG] ArcFace confidence: 0.8451
2025-04-19 12:59:07,735 - INFO - [DEBUG] Loss Breakdown  ID: 1.2758, SupCon: 3.5016, Tri: 0.0000
2025-04-19 12:59:07,911 - INFO - [DEBUG] ArcFace confidence: 0.9075
2025-04-19 12:59:07,917 - INFO - [DEBUG] Loss Breakdown  ID: 1.2059, SupCon: 3.5129, Tri: 0.0000
2025-04-19 12:59:08,090 - INFO - [DEBUG] ArcFace confidence: 0.8337
2025-04-19 12:59:08,096 - INFO - [DEBUG] Loss Breakdown  ID: 1.0557, SupCon: 3.6775, Tri: 0.0000
2025-04-19 12:59:08,275 - INFO - [DEBUG] ArcFace confidence: 0.8551
2025-04-19 12:59:08,278 - INFO - [DEBUG] Loss Breakdown  ID: 1.4774, SupCon: 3.5605, Tri: 0.0000
2025-04-19 12:59:08,454 - INFO - [DEBUG] ArcFace confidence: 0.8708
2025-04-19 12:59:08,457 - INFO - [DEBUG] Loss Breakdown  ID: 1.0619, SupCon: 3.4550, Tri: 0.0000
2025-04-19 12:59:08,633 - INFO - [DEBUG] ArcFace confidence: 0.8587
2025-04-19 12:59:08,636 - INFO - [DEBUG] Loss Breakdown  ID: 1.0184, SupCon: 3.5200, Tri: 0.0000
2025-04-19 12:59:08,810 - INFO - [DEBUG] ArcFace confidence: 0.8399
2025-04-19 12:59:08,813 - INFO - [DEBUG] Loss Breakdown  ID: 1.4448, SupCon: 3.6075, Tri: 0.0000
2025-04-19 12:59:08,990 - INFO - [DEBUG] ArcFace confidence: 0.8204
2025-04-19 12:59:08,993 - INFO - [DEBUG] Loss Breakdown  ID: 1.2738, SupCon: 3.5184, Tri: 0.0000
2025-04-19 12:59:09,171 - INFO - [DEBUG] ArcFace confidence: 0.8270
2025-04-19 12:59:09,176 - INFO - [DEBUG] Loss Breakdown  ID: 0.9463, SupCon: 3.5222, Tri: 0.0000
2025-04-19 12:59:09,350 - INFO - [DEBUG] ArcFace confidence: 0.8817
2025-04-19 12:59:09,353 - INFO - [DEBUG] Loss Breakdown  ID: 1.6409, SupCon: 3.4307, Tri: 0.0000
2025-04-19 12:59:09,531 - INFO - [DEBUG] ArcFace confidence: 0.8907
2025-04-19 12:59:09,534 - INFO - [DEBUG] Loss Breakdown  ID: 0.8785, SupCon: 3.5908, Tri: 0.0000
2025-04-19 12:59:09,696 - INFO - [DEBUG] ArcFace confidence: 0.8470
2025-04-19 12:59:09,702 - INFO - [DEBUG] Loss Breakdown  ID: 1.0029, SupCon: 3.3519, Tri: 0.0000
2025-04-19 12:59:10,455 - INFO - [Epoch 7] Total Loss=0.1189
2025-04-19 12:59:10,458 - INFO - Validating epoch 7...
2025-04-19 12:59:39,425 - INFO - [Epoch 7] Avg Train Loss = 0.1189 | 
2025-04-19 12:59:39,425 - INFO - ==================== Epoch 7 Validation ====================
2025-04-19 12:59:39,425 - INFO - Validation rank-1    : 71.47%
2025-04-19 12:59:39,425 - INFO - Validation rank-5    : 89.29%
2025-04-19 12:59:39,425 - INFO - Validation rank-10   : 96.29%
2025-04-19 12:59:39,425 - INFO - Validation mAP      : 79.14%
2025-04-19 12:59:39,425 - INFO - ============================================================
2025-04-19 12:59:39,425 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 12:59:39,425 - INFO -  Epoch 8/30
2025-04-19 12:59:39,425 - INFO - [Epoch 8] Learning rate: 0.000100
2025-04-19 13:00:03,791 - INFO - [DEBUG] ArcFace confidence: 0.8437
2025-04-19 13:00:03,797 - INFO - [DEBUG] Loss Breakdown  ID: 1.2679, SupCon: 3.6683, Tri: 0.0000
2025-04-19 13:00:03,878 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 13:00:03,881 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 13:00:03,977 - INFO - [DEBUG] ArcFace confidence: 0.8684
2025-04-19 13:00:03,980 - INFO - [DEBUG] Loss Breakdown  ID: 0.9349, SupCon: 3.4742, Tri: 0.0000
2025-04-19 13:00:04,157 - INFO - [DEBUG] ArcFace confidence: 0.8688
2025-04-19 13:00:04,163 - INFO - [DEBUG] Loss Breakdown  ID: 0.9948, SupCon: 3.5261, Tri: 0.0000
2025-04-19 13:00:04,341 - INFO - [DEBUG] ArcFace confidence: 0.8546
2025-04-19 13:00:04,344 - INFO - [DEBUG] Loss Breakdown  ID: 1.1573, SupCon: 3.6223, Tri: 0.0000
2025-04-19 13:00:04,522 - INFO - [DEBUG] ArcFace confidence: 0.8272
2025-04-19 13:00:04,528 - INFO - [DEBUG] Loss Breakdown  ID: 1.0968, SupCon: 3.5284, Tri: 0.0000
2025-04-19 13:00:04,706 - INFO - [DEBUG] ArcFace confidence: 0.8498
2025-04-19 13:00:04,709 - INFO - [DEBUG] Loss Breakdown  ID: 0.9494, SupCon: 3.4493, Tri: 0.0000
2025-04-19 13:00:04,886 - INFO - [DEBUG] ArcFace confidence: 0.8046
2025-04-19 13:00:04,892 - INFO - [DEBUG] Loss Breakdown  ID: 1.6710, SupCon: 3.4112, Tri: 0.0000
2025-04-19 13:00:05,074 - INFO - [DEBUG] ArcFace confidence: 0.8216
2025-04-19 13:00:05,077 - INFO - [DEBUG] Loss Breakdown  ID: 1.5860, SupCon: 3.5340, Tri: 0.0000
2025-04-19 13:00:05,258 - INFO - [DEBUG] ArcFace confidence: 0.8988
2025-04-19 13:00:05,261 - INFO - [DEBUG] Loss Breakdown  ID: 0.8874, SupCon: 3.4961, Tri: 0.0000
2025-04-19 13:00:05,440 - INFO - [DEBUG] ArcFace confidence: 0.8732
2025-04-19 13:00:05,443 - INFO - [DEBUG] Loss Breakdown  ID: 0.9395, SupCon: 3.3803, Tri: 0.0000
2025-04-19 13:00:05,623 - INFO - [DEBUG] ArcFace confidence: 0.8841
2025-04-19 13:00:05,626 - INFO - [DEBUG] Loss Breakdown  ID: 1.3431, SupCon: 3.5681, Tri: 0.0000
2025-04-19 13:00:05,806 - INFO - [DEBUG] ArcFace confidence: 0.8838
2025-04-19 13:00:05,809 - INFO - [DEBUG] Loss Breakdown  ID: 0.9464, SupCon: 3.5320, Tri: 0.0000
2025-04-19 13:00:05,986 - INFO - [DEBUG] ArcFace confidence: 0.8508
2025-04-19 13:00:05,989 - INFO - [DEBUG] Loss Breakdown  ID: 1.2263, SupCon: 3.5236, Tri: 0.0000
2025-04-19 13:00:06,171 - INFO - [DEBUG] ArcFace confidence: 0.8569
2025-04-19 13:00:06,174 - INFO - [DEBUG] Loss Breakdown  ID: 0.9189, SupCon: 3.4972, Tri: 0.0000
2025-04-19 13:00:06,353 - INFO - [DEBUG] ArcFace confidence: 0.8620
2025-04-19 13:00:06,356 - INFO - [DEBUG] Loss Breakdown  ID: 1.0096, SupCon: 3.4640, Tri: 0.0000
2025-04-19 13:00:06,534 - INFO - [DEBUG] ArcFace confidence: 0.9175
2025-04-19 13:00:06,540 - INFO - [DEBUG] Loss Breakdown  ID: 0.8446, SupCon: 3.5536, Tri: 0.0000
2025-04-19 13:00:06,719 - INFO - [DEBUG] ArcFace confidence: 0.8632
2025-04-19 13:00:06,722 - INFO - [DEBUG] Loss Breakdown  ID: 1.2705, SupCon: 3.5973, Tri: 0.0000
2025-04-19 13:00:06,900 - INFO - [DEBUG] ArcFace confidence: 0.8817
2025-04-19 13:00:06,906 - INFO - [DEBUG] Loss Breakdown  ID: 0.8757, SupCon: 3.5317, Tri: 0.0000
2025-04-19 13:00:07,080 - INFO - [DEBUG] ArcFace confidence: 0.8059
2025-04-19 13:00:07,083 - INFO - [DEBUG] Loss Breakdown  ID: 1.3392, SupCon: 3.6407, Tri: 0.0000
2025-04-19 13:00:07,260 - INFO - [DEBUG] ArcFace confidence: 0.8193
2025-04-19 13:00:07,266 - INFO - [DEBUG] Loss Breakdown  ID: 0.9773, SupCon: 3.6292, Tri: 0.0000
2025-04-19 13:00:07,443 - INFO - [DEBUG] ArcFace confidence: 0.7478
2025-04-19 13:00:07,446 - INFO - [DEBUG] Loss Breakdown  ID: 1.2955, SupCon: 3.6996, Tri: 0.0000
2025-04-19 13:00:07,622 - INFO - [DEBUG] ArcFace confidence: 0.8529
2025-04-19 13:00:07,625 - INFO - [DEBUG] Loss Breakdown  ID: 0.8875, SupCon: 3.5743, Tri: 0.0000
2025-04-19 13:00:07,800 - INFO - [DEBUG] ArcFace confidence: 0.8344
2025-04-19 13:00:07,803 - INFO - [DEBUG] Loss Breakdown  ID: 0.9157, SupCon: 3.6253, Tri: 0.0000
2025-04-19 13:00:07,978 - INFO - [DEBUG] ArcFace confidence: 0.8450
2025-04-19 13:00:07,980 - INFO - [DEBUG] Loss Breakdown  ID: 0.8955, SupCon: 3.5453, Tri: 0.0000
2025-04-19 13:00:08,155 - INFO - [DEBUG] ArcFace confidence: 0.8398
2025-04-19 13:00:08,158 - INFO - [DEBUG] Loss Breakdown  ID: 0.9848, SupCon: 3.6401, Tri: 0.0000
2025-04-19 13:00:08,335 - INFO - [DEBUG] ArcFace confidence: 0.8715
2025-04-19 13:00:08,338 - INFO - [DEBUG] Loss Breakdown  ID: 0.8607, SupCon: 3.5224, Tri: 0.0000
2025-04-19 13:00:08,512 - INFO - [DEBUG] ArcFace confidence: 0.8669
2025-04-19 13:00:08,515 - INFO - [DEBUG] Loss Breakdown  ID: 0.8768, SupCon: 3.6775, Tri: 0.0000
2025-04-19 13:00:08,677 - INFO - [DEBUG] ArcFace confidence: 0.8364
2025-04-19 13:00:08,683 - INFO - [DEBUG] Loss Breakdown  ID: 0.9178, SupCon: 3.3969, Tri: 0.0000
2025-04-19 13:00:09,441 - INFO - [Epoch 8] Total Loss=0.1067
2025-04-19 13:00:09,441 - INFO - Validating epoch 8...
2025-04-19 13:00:39,627 - INFO - [Epoch 8] Avg Train Loss = 0.1067 | 
2025-04-19 13:00:39,627 - INFO - ==================== Epoch 8 Validation ====================
2025-04-19 13:00:39,627 - INFO - Validation rank-1    : 81.77%
2025-04-19 13:00:39,627 - INFO - Validation rank-5    : 95.98%
2025-04-19 13:00:39,630 - INFO - Validation rank-10   : 98.87%
2025-04-19 13:00:39,630 - INFO - Validation mAP      : 87.25%
2025-04-19 13:00:39,630 - INFO - ============================================================
2025-04-19 13:00:39,630 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 13:00:39,630 - INFO -  Epoch 9/30
2025-04-19 13:00:39,630 - INFO - [Epoch 9] Learning rate: 0.000100
2025-04-19 13:01:03,770 - INFO - [DEBUG] ArcFace confidence: 0.8820
2025-04-19 13:01:03,774 - INFO - [DEBUG] Loss Breakdown  ID: 0.8724, SupCon: 3.6453, Tri: 0.0000
2025-04-19 13:01:03,857 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 13:01:03,857 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 13:01:03,955 - INFO - [DEBUG] ArcFace confidence: 0.9017
2025-04-19 13:01:03,958 - INFO - [DEBUG] Loss Breakdown  ID: 1.7966, SupCon: 3.6232, Tri: 0.0000
2025-04-19 13:01:04,138 - INFO - [DEBUG] ArcFace confidence: 0.8724
2025-04-19 13:01:04,144 - INFO - [DEBUG] Loss Breakdown  ID: 0.8646, SupCon: 3.5562, Tri: 0.0000
2025-04-19 13:01:04,321 - INFO - [DEBUG] ArcFace confidence: 0.9004
2025-04-19 13:01:04,327 - INFO - [DEBUG] Loss Breakdown  ID: 1.0810, SupCon: 3.6029, Tri: 0.0000
2025-04-19 13:01:04,505 - INFO - [DEBUG] ArcFace confidence: 0.8767
2025-04-19 13:01:04,511 - INFO - [DEBUG] Loss Breakdown  ID: 1.0768, SupCon: 3.6422, Tri: 0.0000
2025-04-19 13:01:04,688 - INFO - [DEBUG] ArcFace confidence: 0.8467
2025-04-19 13:01:04,694 - INFO - [DEBUG] Loss Breakdown  ID: 1.0416, SupCon: 3.6609, Tri: 0.0000
2025-04-19 13:01:04,872 - INFO - [DEBUG] ArcFace confidence: 0.8721
2025-04-19 13:01:04,875 - INFO - [DEBUG] Loss Breakdown  ID: 0.8807, SupCon: 3.5828, Tri: 0.0000
2025-04-19 13:01:05,052 - INFO - [DEBUG] ArcFace confidence: 0.8508
2025-04-19 13:01:05,058 - INFO - [DEBUG] Loss Breakdown  ID: 1.6024, SupCon: 3.5073, Tri: 0.0000
2025-04-19 13:01:05,238 - INFO - [DEBUG] ArcFace confidence: 0.8802
2025-04-19 13:01:05,241 - INFO - [DEBUG] Loss Breakdown  ID: 0.8730, SupCon: 3.5484, Tri: 0.0000
2025-04-19 13:01:05,419 - INFO - [DEBUG] ArcFace confidence: 0.8847
2025-04-19 13:01:05,425 - INFO - [DEBUG] Loss Breakdown  ID: 1.1101, SupCon: 3.5101, Tri: 0.0000
2025-04-19 13:01:05,604 - INFO - [DEBUG] ArcFace confidence: 0.8826
2025-04-19 13:01:05,607 - INFO - [DEBUG] Loss Breakdown  ID: 0.8850, SupCon: 3.5648, Tri: 0.0000
2025-04-19 13:01:05,786 - INFO - [DEBUG] ArcFace confidence: 0.8611
2025-04-19 13:01:05,789 - INFO - [DEBUG] Loss Breakdown  ID: 0.8773, SupCon: 3.6424, Tri: 0.0000
2025-04-19 13:01:05,968 - INFO - [DEBUG] ArcFace confidence: 0.8998
2025-04-19 13:01:05,971 - INFO - [DEBUG] Loss Breakdown  ID: 0.8877, SupCon: 3.5163, Tri: 0.0000
2025-04-19 13:01:06,149 - INFO - [DEBUG] ArcFace confidence: 0.8555
2025-04-19 13:01:06,154 - INFO - [DEBUG] Loss Breakdown  ID: 0.8909, SupCon: 3.6637, Tri: 0.0000
2025-04-19 13:01:06,328 - INFO - [DEBUG] ArcFace confidence: 0.8833
2025-04-19 13:01:06,331 - INFO - [DEBUG] Loss Breakdown  ID: 0.8838, SupCon: 3.5514, Tri: 0.0000
2025-04-19 13:01:06,510 - INFO - [DEBUG] ArcFace confidence: 0.8867
2025-04-19 13:01:06,513 - INFO - [DEBUG] Loss Breakdown  ID: 0.9508, SupCon: 3.4875, Tri: 0.0000
2025-04-19 13:01:06,691 - INFO - [DEBUG] ArcFace confidence: 0.8992
2025-04-19 13:01:06,694 - INFO - [DEBUG] Loss Breakdown  ID: 1.0951, SupCon: 3.5738, Tri: 0.0000
2025-04-19 13:01:06,873 - INFO - [DEBUG] ArcFace confidence: 0.8690
2025-04-19 13:01:06,876 - INFO - [DEBUG] Loss Breakdown  ID: 1.0116, SupCon: 3.4953, Tri: 0.0000
2025-04-19 13:01:07,054 - INFO - [DEBUG] ArcFace confidence: 0.8544
2025-04-19 13:01:07,057 - INFO - [DEBUG] Loss Breakdown  ID: 0.9466, SupCon: 3.6359, Tri: 0.0000
2025-04-19 13:01:07,238 - INFO - [DEBUG] ArcFace confidence: 0.8559
2025-04-19 13:01:07,241 - INFO - [DEBUG] Loss Breakdown  ID: 0.8643, SupCon: 3.5285, Tri: 0.0000
2025-04-19 13:01:07,419 - INFO - [DEBUG] ArcFace confidence: 0.9302
2025-04-19 13:01:07,422 - INFO - [DEBUG] Loss Breakdown  ID: 0.8424, SupCon: 3.5908, Tri: 0.0000
2025-04-19 13:01:07,595 - INFO - [DEBUG] ArcFace confidence: 0.8753
2025-04-19 13:01:07,598 - INFO - [DEBUG] Loss Breakdown  ID: 0.9012, SupCon: 3.6205, Tri: 0.0000
2025-04-19 13:01:07,777 - INFO - [DEBUG] ArcFace confidence: 0.8758
2025-04-19 13:01:07,780 - INFO - [DEBUG] Loss Breakdown  ID: 0.8847, SupCon: 3.6790, Tri: 0.0000
2025-04-19 13:01:07,956 - INFO - [DEBUG] ArcFace confidence: 0.8899
2025-04-19 13:01:07,959 - INFO - [DEBUG] Loss Breakdown  ID: 0.8453, SupCon: 3.5113, Tri: 0.0000
2025-04-19 13:01:08,133 - INFO - [DEBUG] ArcFace confidence: 0.8453
2025-04-19 13:01:08,136 - INFO - [DEBUG] Loss Breakdown  ID: 0.9497, SupCon: 3.5847, Tri: 0.0000
2025-04-19 13:01:08,313 - INFO - [DEBUG] ArcFace confidence: 0.8339
2025-04-19 13:01:08,316 - INFO - [DEBUG] Loss Breakdown  ID: 0.9559, SupCon: 3.5844, Tri: 0.0000
2025-04-19 13:01:08,492 - INFO - [DEBUG] ArcFace confidence: 0.8510
2025-04-19 13:01:08,495 - INFO - [DEBUG] Loss Breakdown  ID: 0.8686, SupCon: 3.4157, Tri: 0.0000
2025-04-19 13:01:08,656 - INFO - [DEBUG] ArcFace confidence: 0.9018
2025-04-19 13:01:08,659 - INFO - [DEBUG] Loss Breakdown  ID: 0.8707, SupCon: 3.3481, Tri: 0.0000
2025-04-19 13:01:09,404 - INFO - [Epoch 9] Total Loss=0.0986
2025-04-19 13:01:09,404 - INFO - Validating epoch 9...
2025-04-19 13:01:38,169 - INFO - [Epoch 9] Avg Train Loss = 0.0986 | 
2025-04-19 13:01:38,169 - INFO - ==================== Epoch 9 Validation ====================
2025-04-19 13:01:38,170 - INFO - Validation rank-1    : 83.11%
2025-04-19 13:01:38,170 - INFO - Validation rank-5    : 94.44%
2025-04-19 13:01:38,170 - INFO - Validation rank-10   : 97.01%
2025-04-19 13:01:38,170 - INFO - Validation mAP      : 88.19%
2025-04-19 13:01:38,170 - INFO - ============================================================
2025-04-19 13:01:38,170 - INFO - No improvement in Acc@1. Patience counter: 3/3
2025-04-19 13:01:38,170 - INFO - Early srankping at epoch 9 due to no improvement in rank-1 accuracy.
2025-04-19 13:01:39,189 - INFO - ====== FINAL SUMMARY ======
2025-04-19 13:01:39,189 - INFO - Total epochs       : 30
2025-04-19 13:01:39,192 - INFO - Avg Loss           : 75.3175
2025-04-19 13:01:39,192 - INFO - Best Acc@1 Epoch   : 6
2025-04-19 13:01:39,192 - INFO - Best Acc@1         : 87.33%
2025-04-19 13:01:39,192 - INFO - Best mAP            : 88.19%
2025-04-19 13:01:39,192 - INFO - ============================
