2025-04-12 02:09:53,475 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 02:09:53,476 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 02:09:53,477 - INFO - [DEBUG] logits std: 0.3424
2025-04-12 02:09:53,477 - INFO - [DEBUG] CE loss: 4.3382, Triplet loss: 0.0000, Total: 4.3382
2025-04-12 02:21:51,152 - INFO - [Epoch 1] Total Loss=4.2930
2025-04-12 02:21:51,157 - INFO - [Epoch 1] Acc@1=3.15% | Acc@5=16.74% | Acc@10=28.31%
2025-04-12 02:22:18,182 - INFO - 
[Classifier Validation]
2025-04-12 02:22:18,182 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 02:22:18,183 - INFO - RANK1: 0.00%
2025-04-12 02:22:18,183 - INFO - RANK5: 0.00%
2025-04-12 02:22:18,183 - INFO - RANK10: 0.00%
2025-04-12 02:22:18,184 - INFO - MAP: 1.39%
2025-04-12 02:22:19,525 - INFO - Saving best model at epoch 1 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_finetune_e1_lr00001_bs32_BEST.pth
2025-04-12 02:23:02,680 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 02:23:02,680 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 02:23:02,681 - INFO - [DEBUG] logits std: 0.6387
2025-04-12 02:23:02,681 - INFO - [DEBUG] CE loss: 4.0112, Triplet loss: 0.1053, Total: 4.1164
2025-04-12 02:34:43,891 - INFO - [Epoch 2] Total Loss=4.2069
2025-04-12 02:34:43,891 - INFO - [Epoch 2] Acc@1=6.52% | Acc@5=20.79% | Acc@10=34.16%
2025-04-12 02:35:10,454 - INFO - 
[Classifier Validation]
2025-04-12 02:35:10,454 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 02:35:10,454 - INFO - RANK1: 0.00%
2025-04-12 02:35:10,454 - INFO - RANK5: 0.00%
2025-04-12 02:35:10,455 - INFO - RANK10: 0.00%
2025-04-12 02:35:10,455 - INFO - MAP: 1.39%
2025-04-12 02:35:10,457 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 02:35:52,592 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 02:35:52,592 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 02:35:52,592 - INFO - [DEBUG] logits std: 0.6373
2025-04-12 02:35:52,593 - INFO - [DEBUG] CE loss: 3.6745, Triplet loss: 0.0766, Total: 3.7511
2025-04-12 02:47:40,207 - INFO - [Epoch 3] Total Loss=4.1056
2025-04-12 02:47:40,207 - INFO - [Epoch 3] Acc@1=6.29% | Acc@5=22.47% | Acc@10=38.54%
2025-04-12 02:48:07,144 - INFO - 
[Classifier Validation]
2025-04-12 02:48:07,145 - INFO - AVG_VAL_LOSS: 4.24%
2025-04-12 02:48:07,145 - INFO - RANK1: 0.00%
2025-04-12 02:48:07,145 - INFO - RANK5: 0.00%
2025-04-12 02:48:07,146 - INFO - RANK10: 0.00%
2025-04-12 02:48:07,146 - INFO - MAP: 1.39%
2025-04-12 02:48:07,147 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 02:48:48,586 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 02:48:48,586 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 02:48:48,587 - INFO - [DEBUG] logits std: 0.7227
2025-04-12 02:48:48,587 - INFO - [DEBUG] CE loss: 3.6689, Triplet loss: 0.0000, Total: 3.6689
2025-04-12 03:00:25,655 - INFO - [Epoch 4] Total Loss=4.1771
2025-04-12 03:00:25,655 - INFO - [Epoch 4] Acc@1=6.18% | Acc@5=19.78% | Acc@10=35.17%
2025-04-12 03:00:52,513 - INFO - 
[Classifier Validation]
2025-04-12 03:00:52,513 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 03:00:52,513 - INFO - RANK1: 0.00%
2025-04-12 03:00:52,514 - INFO - RANK5: 0.00%
2025-04-12 03:00:52,514 - INFO - RANK10: 0.00%
2025-04-12 03:00:52,514 - INFO - MAP: 1.39%
2025-04-12 03:00:52,516 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 03:01:35,807 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 03:01:35,807 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 03:01:35,807 - INFO - [DEBUG] logits std: 0.5992
2025-04-12 03:01:35,808 - INFO - [DEBUG] CE loss: 4.0469, Triplet loss: 0.1187, Total: 4.1656
2025-04-12 03:13:15,421 - INFO - [Epoch 5] Total Loss=4.1689
2025-04-12 03:13:15,421 - INFO - [Epoch 5] Acc@1=5.28% | Acc@5=23.82% | Acc@10=37.08%
2025-04-12 03:13:42,169 - INFO - 
[Classifier Validation]
2025-04-12 03:13:42,170 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 03:13:42,170 - INFO - RANK1: 0.00%
2025-04-12 03:13:42,170 - INFO - RANK5: 0.00%
2025-04-12 03:13:42,170 - INFO - RANK10: 0.00%
2025-04-12 03:13:42,171 - INFO - MAP: 1.39%
2025-04-12 03:13:42,173 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 03:14:25,549 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 03:14:25,550 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 03:14:25,550 - INFO - [DEBUG] logits std: 0.5786
2025-04-12 03:14:25,550 - INFO - [DEBUG] CE loss: 4.1893, Triplet loss: 0.1778, Total: 4.3672
2025-04-12 03:26:01,459 - INFO - [Epoch 6] Total Loss=4.1825
2025-04-12 03:26:01,459 - INFO - [Epoch 6] Acc@1=3.26% | Acc@5=20.00% | Acc@10=35.39%
2025-04-12 03:26:28,181 - INFO - 
[Classifier Validation]
2025-04-12 03:26:28,181 - INFO - AVG_VAL_LOSS: 4.25%
2025-04-12 03:26:28,181 - INFO - RANK1: 0.00%
2025-04-12 03:26:28,182 - INFO - RANK5: 0.00%
2025-04-12 03:26:28,182 - INFO - RANK10: 0.00%
2025-04-12 03:26:28,182 - INFO - MAP: 1.39%
2025-04-12 03:26:28,184 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 03:27:10,446 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 03:27:10,447 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 03:27:10,447 - INFO - [DEBUG] logits std: 0.7557
2025-04-12 03:27:10,448 - INFO - [DEBUG] CE loss: 3.9221, Triplet loss: 0.2061, Total: 4.1282
2025-04-12 03:38:44,598 - INFO - [Epoch 7] Total Loss=4.1006
2025-04-12 03:38:44,598 - INFO - [Epoch 7] Acc@1=3.93% | Acc@5=23.93% | Acc@10=40.90%
2025-04-12 03:39:11,294 - INFO - 
[Classifier Validation]
2025-04-12 03:39:11,294 - INFO - AVG_VAL_LOSS: 4.25%
2025-04-12 03:39:11,295 - INFO - RANK1: 0.00%
2025-04-12 03:39:11,295 - INFO - RANK5: 0.00%
2025-04-12 03:39:11,295 - INFO - RANK10: 0.00%
2025-04-12 03:39:11,295 - INFO - MAP: 1.39%
2025-04-12 03:39:11,297 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 03:39:53,518 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 03:39:53,518 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 03:39:53,518 - INFO - [DEBUG] logits std: 0.7031
2025-04-12 03:39:53,519 - INFO - [DEBUG] CE loss: 3.9052, Triplet loss: 0.0274, Total: 3.9326
2025-04-12 03:51:27,781 - INFO - [Epoch 8] Total Loss=3.9259
2025-04-12 03:51:27,782 - INFO - [Epoch 8] Acc@1=5.96% | Acc@5=26.18% | Acc@10=45.96%
2025-04-12 03:51:53,943 - INFO - 
[Classifier Validation]
2025-04-12 03:51:53,943 - INFO - AVG_VAL_LOSS: 4.23%
2025-04-12 03:51:53,943 - INFO - RANK1: 0.00%
2025-04-12 03:51:53,943 - INFO - RANK5: 0.00%
2025-04-12 03:51:53,943 - INFO - RANK10: 0.00%
2025-04-12 03:51:53,944 - INFO - MAP: 1.39%
2025-04-12 03:51:53,945 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 03:52:35,579 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 03:52:35,580 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 03:52:35,580 - INFO - [DEBUG] logits std: 0.7844
2025-04-12 03:52:35,580 - INFO - [DEBUG] CE loss: 3.7866, Triplet loss: 0.4677, Total: 4.2544
2025-04-12 04:04:12,963 - INFO - [Epoch 9] Total Loss=3.9046
2025-04-12 04:04:12,963 - INFO - [Epoch 9] Acc@1=9.44% | Acc@5=30.67% | Acc@10=45.28%
2025-04-12 04:04:39,231 - INFO - 
[Classifier Validation]
2025-04-12 04:04:39,232 - INFO - AVG_VAL_LOSS: 4.27%
2025-04-12 04:04:39,232 - INFO - RANK1: 0.00%
2025-04-12 04:04:39,232 - INFO - RANK5: 0.00%
2025-04-12 04:04:39,232 - INFO - RANK10: 0.00%
2025-04-12 04:04:39,233 - INFO - MAP: 1.39%
2025-04-12 04:04:39,234 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 04:05:22,503 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 04:05:22,503 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 04:05:22,503 - INFO - [DEBUG] logits std: 0.5465
2025-04-12 04:05:22,503 - INFO - [DEBUG] CE loss: 4.1619, Triplet loss: 0.1522, Total: 4.3140
2025-04-12 04:17:00,822 - INFO - [Epoch 10] Total Loss=4.1559
2025-04-12 04:17:00,822 - INFO - [Epoch 10] Acc@1=4.83% | Acc@5=21.91% | Acc@10=36.18%
2025-04-12 04:17:27,294 - INFO - 
[Classifier Validation]
2025-04-12 04:17:27,295 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 04:17:27,295 - INFO - RANK1: 0.00%
2025-04-12 04:17:27,295 - INFO - RANK5: 0.00%
2025-04-12 04:17:27,295 - INFO - RANK10: 0.00%
2025-04-12 04:17:27,296 - INFO - MAP: 1.39%
2025-04-12 04:17:27,297 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 04:18:09,401 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 04:18:09,402 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 04:18:09,402 - INFO - [DEBUG] logits std: 0.5190
2025-04-12 04:18:09,402 - INFO - [DEBUG] CE loss: 3.9248, Triplet loss: 0.0732, Total: 3.9981
2025-04-12 04:29:46,827 - INFO - [Epoch 11] Total Loss=4.1786
2025-04-12 04:29:46,828 - INFO - [Epoch 11] Acc@1=4.72% | Acc@5=22.36% | Acc@10=38.76%
2025-04-12 04:30:14,058 - INFO - 
[Classifier Validation]
2025-04-12 04:30:14,059 - INFO - AVG_VAL_LOSS: 4.28%
2025-04-12 04:30:14,059 - INFO - RANK1: 0.00%
2025-04-12 04:30:14,059 - INFO - RANK5: 0.00%
2025-04-12 04:30:14,060 - INFO - RANK10: 0.00%
2025-04-12 04:30:14,060 - INFO - MAP: 1.39%
2025-04-12 04:30:14,062 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 04:30:56,893 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 04:30:56,893 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 04:30:56,894 - INFO - [DEBUG] logits std: 1.1701
2025-04-12 04:30:56,894 - INFO - [DEBUG] CE loss: 5.2960, Triplet loss: 0.2634, Total: 5.5595
2025-04-12 04:42:32,030 - INFO - [Epoch 12] Total Loss=4.4558
2025-04-12 04:42:32,031 - INFO - [Epoch 12] Acc@1=3.82% | Acc@5=18.88% | Acc@10=29.44%
2025-04-12 04:42:59,286 - INFO - 
[Classifier Validation]
2025-04-12 04:42:59,286 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 04:42:59,286 - INFO - RANK1: 0.00%
2025-04-12 04:42:59,287 - INFO - RANK5: 0.00%
2025-04-12 04:42:59,287 - INFO - RANK10: 0.00%
2025-04-12 04:42:59,287 - INFO - MAP: 1.39%
2025-04-12 04:42:59,289 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 04:43:41,708 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 04:43:41,708 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 04:43:41,709 - INFO - [DEBUG] logits std: 0.6758
2025-04-12 04:43:41,709 - INFO - [DEBUG] CE loss: 3.9698, Triplet loss: 0.1801, Total: 4.1499
2025-04-12 04:55:20,623 - INFO - [Epoch 13] Total Loss=4.0824
2025-04-12 04:55:20,623 - INFO - [Epoch 13] Acc@1=5.39% | Acc@5=24.27% | Acc@10=40.34%
2025-04-12 04:55:46,808 - INFO - 
[Classifier Validation]
2025-04-12 04:55:46,808 - INFO - AVG_VAL_LOSS: 4.23%
2025-04-12 04:55:46,809 - INFO - RANK1: 0.00%
2025-04-12 04:55:46,809 - INFO - RANK5: 0.00%
2025-04-12 04:55:46,809 - INFO - RANK10: 0.00%
2025-04-12 04:55:46,809 - INFO - MAP: 1.39%
2025-04-12 04:55:46,811 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 04:56:28,960 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 04:56:28,960 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 04:56:28,960 - INFO - [DEBUG] logits std: 0.8510
2025-04-12 04:56:28,961 - INFO - [DEBUG] CE loss: 3.5793, Triplet loss: 0.0627, Total: 3.6420
2025-04-12 05:08:05,641 - INFO - [Epoch 14] Total Loss=4.0612
2025-04-12 05:08:05,641 - INFO - [Epoch 14] Acc@1=7.98% | Acc@5=26.18% | Acc@10=42.13%
2025-04-12 05:08:32,202 - INFO - 
[Classifier Validation]
2025-04-12 05:08:32,202 - INFO - AVG_VAL_LOSS: 4.23%
2025-04-12 05:08:32,202 - INFO - RANK1: 0.00%
2025-04-12 05:08:32,203 - INFO - RANK5: 0.00%
2025-04-12 05:08:32,203 - INFO - RANK10: 0.00%
2025-04-12 05:08:32,203 - INFO - MAP: 1.39%
2025-04-12 05:08:32,205 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 05:09:15,580 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 05:09:15,581 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 05:09:15,581 - INFO - [DEBUG] logits std: 0.7062
2025-04-12 05:09:15,581 - INFO - [DEBUG] CE loss: 3.7267, Triplet loss: 0.0220, Total: 3.7487
2025-04-12 05:20:51,105 - INFO - [Epoch 15] Total Loss=4.2639
2025-04-12 05:20:51,105 - INFO - [Epoch 15] Acc@1=4.83% | Acc@5=20.45% | Acc@10=33.93%
2025-04-12 05:21:17,665 - INFO - 
[Classifier Validation]
2025-04-12 05:21:17,665 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 05:21:17,665 - INFO - RANK1: 0.00%
2025-04-12 05:21:17,665 - INFO - RANK5: 0.00%
2025-04-12 05:21:17,666 - INFO - RANK10: 0.00%
2025-04-12 05:21:17,666 - INFO - MAP: 1.39%
2025-04-12 05:21:17,667 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 05:22:00,380 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 05:22:00,381 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 05:22:00,381 - INFO - [DEBUG] logits std: 0.6643
2025-04-12 05:22:00,382 - INFO - [DEBUG] CE loss: 4.1494, Triplet loss: 0.1252, Total: 4.2746
2025-04-12 05:33:36,978 - INFO - [Epoch 16] Total Loss=4.1182
2025-04-12 05:33:36,979 - INFO - [Epoch 16] Acc@1=4.49% | Acc@5=21.91% | Acc@10=37.08%
2025-04-12 05:34:04,029 - INFO - 
[Classifier Validation]
2025-04-12 05:34:04,030 - INFO - AVG_VAL_LOSS: 4.26%
2025-04-12 05:34:04,030 - INFO - RANK1: 0.00%
2025-04-12 05:34:04,030 - INFO - RANK5: 0.00%
2025-04-12 05:34:04,030 - INFO - RANK10: 0.00%
2025-04-12 05:34:04,031 - INFO - MAP: 1.39%
2025-04-12 05:34:04,032 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 05:34:46,195 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 05:34:46,195 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 05:34:46,196 - INFO - [DEBUG] logits std: 0.7370
2025-04-12 05:34:46,196 - INFO - [DEBUG] CE loss: 3.9947, Triplet loss: 0.0628, Total: 4.0575
2025-04-12 05:46:32,984 - INFO - [Epoch 17] Total Loss=4.0712
2025-04-12 05:46:32,984 - INFO - [Epoch 17] Acc@1=6.52% | Acc@5=26.74% | Acc@10=41.35%
2025-04-12 05:47:00,464 - INFO - 
[Classifier Validation]
2025-04-12 05:47:00,465 - INFO - AVG_VAL_LOSS: 4.24%
2025-04-12 05:47:00,465 - INFO - RANK1: 0.00%
2025-04-12 05:47:00,465 - INFO - RANK5: 0.00%
2025-04-12 05:47:00,466 - INFO - RANK10: 0.00%
2025-04-12 05:47:00,466 - INFO - MAP: 1.39%
2025-04-12 05:47:00,468 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 05:47:43,268 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 05:47:43,269 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 05:47:43,269 - INFO - [DEBUG] logits std: 0.8509
2025-04-12 05:47:43,269 - INFO - [DEBUG] CE loss: 3.6578, Triplet loss: 0.1612, Total: 3.8190
2025-04-12 05:59:24,013 - INFO - [Epoch 18] Total Loss=3.9592
2025-04-12 05:59:24,014 - INFO - [Epoch 18] Acc@1=5.73% | Acc@5=27.64% | Acc@10=44.27%
2025-04-12 05:59:50,729 - INFO - 
[Classifier Validation]
2025-04-12 05:59:50,729 - INFO - AVG_VAL_LOSS: 4.22%
2025-04-12 05:59:50,729 - INFO - RANK1: 0.00%
2025-04-12 05:59:50,730 - INFO - RANK5: 0.00%
2025-04-12 05:59:50,730 - INFO - RANK10: 0.00%
2025-04-12 05:59:50,730 - INFO - MAP: 1.39%
2025-04-12 05:59:50,732 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 06:00:36,657 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 06:00:36,657 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 06:00:36,658 - INFO - [DEBUG] logits std: 0.9993
2025-04-12 06:00:36,658 - INFO - [DEBUG] CE loss: 3.5214, Triplet loss: 0.6281, Total: 4.1496
2025-04-12 06:12:23,660 - INFO - [Epoch 19] Total Loss=3.9940
2025-04-12 06:12:23,661 - INFO - [Epoch 19] Acc@1=6.18% | Acc@5=26.18% | Acc@10=40.67%
2025-04-12 06:12:50,762 - INFO - 
[Classifier Validation]
2025-04-12 06:12:50,762 - INFO - AVG_VAL_LOSS: 4.24%
2025-04-12 06:12:50,762 - INFO - RANK1: 0.00%
2025-04-12 06:12:50,763 - INFO - RANK5: 0.00%
2025-04-12 06:12:50,763 - INFO - RANK10: 0.00%
2025-04-12 06:12:50,763 - INFO - MAP: 1.39%
2025-04-12 06:12:50,764 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 06:13:33,283 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 06:13:33,284 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 06:13:33,284 - INFO - [DEBUG] logits std: 0.7270
2025-04-12 06:13:33,284 - INFO - [DEBUG] CE loss: 3.6828, Triplet loss: 0.0000, Total: 3.6828
2025-04-12 06:25:12,924 - INFO - [Epoch 20] Total Loss=3.8736
2025-04-12 06:25:12,924 - INFO - [Epoch 20] Acc@1=9.10% | Acc@5=31.12% | Acc@10=49.55%
2025-04-12 06:25:39,581 - INFO - 
[Classifier Validation]
2025-04-12 06:25:39,581 - INFO - AVG_VAL_LOSS: 4.21%
2025-04-12 06:25:39,581 - INFO - RANK1: 0.00%
2025-04-12 06:25:39,582 - INFO - RANK5: 0.00%
2025-04-12 06:25:39,582 - INFO - RANK10: 0.00%
2025-04-12 06:25:39,582 - INFO - MAP: 1.39%
2025-04-12 06:25:39,587 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 06:26:21,950 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 06:26:21,950 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 06:26:21,951 - INFO - [DEBUG] logits std: 0.8876
2025-04-12 06:26:21,951 - INFO - [DEBUG] CE loss: 3.4719, Triplet loss: 0.1138, Total: 3.5857
2025-04-12 06:38:08,527 - INFO - [Epoch 21] Total Loss=3.7372
2025-04-12 06:38:08,528 - INFO - [Epoch 21] Acc@1=9.55% | Acc@5=36.97% | Acc@10=54.49%
2025-04-12 06:38:35,382 - INFO - 
[Classifier Validation]
2025-04-12 06:38:35,382 - INFO - AVG_VAL_LOSS: 4.20%
2025-04-12 06:38:35,383 - INFO - RANK1: 0.00%
2025-04-12 06:38:35,383 - INFO - RANK5: 0.00%
2025-04-12 06:38:35,383 - INFO - RANK10: 0.00%
2025-04-12 06:38:35,384 - INFO - MAP: 1.39%
2025-04-12 06:38:35,385 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 06:39:18,827 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 06:39:18,827 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 06:39:18,827 - INFO - [DEBUG] logits std: 0.9461
2025-04-12 06:39:18,828 - INFO - [DEBUG] CE loss: 3.4170, Triplet loss: 0.0000, Total: 3.4170
2025-04-12 06:51:02,236 - INFO - [Epoch 22] Total Loss=3.7094
2025-04-12 06:51:02,236 - INFO - [Epoch 22] Acc@1=12.36% | Acc@5=37.75% | Acc@10=57.53%
2025-04-12 06:51:29,037 - INFO - 
[Classifier Validation]
2025-04-12 06:51:29,038 - INFO - AVG_VAL_LOSS: 4.18%
2025-04-12 06:51:29,038 - INFO - RANK1: 0.00%
2025-04-12 06:51:29,038 - INFO - RANK5: 0.00%
2025-04-12 06:51:29,039 - INFO - RANK10: 0.00%
2025-04-12 06:51:29,039 - INFO - MAP: 1.39%
2025-04-12 06:51:29,041 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 06:52:14,789 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 06:52:14,789 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 06:52:14,790 - INFO - [DEBUG] logits std: 1.1421
2025-04-12 06:52:14,790 - INFO - [DEBUG] CE loss: 3.5194, Triplet loss: 0.0000, Total: 3.5194
2025-04-12 07:04:28,881 - INFO - [Epoch 23] Total Loss=3.5298
2025-04-12 07:04:28,881 - INFO - [Epoch 23] Acc@1=12.70% | Acc@5=41.80% | Acc@10=59.44%
2025-04-12 07:04:55,726 - INFO - 
[Classifier Validation]
2025-04-12 07:04:55,726 - INFO - AVG_VAL_LOSS: 4.17%
2025-04-12 07:04:55,726 - INFO - RANK1: 0.00%
2025-04-12 07:04:55,727 - INFO - RANK5: 0.00%
2025-04-12 07:04:55,727 - INFO - RANK10: 0.00%
2025-04-12 07:04:55,727 - INFO - MAP: 1.39%
2025-04-12 07:04:55,729 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 07:05:38,275 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 07:05:38,275 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 07:05:38,276 - INFO - [DEBUG] logits std: 1.4889
2025-04-12 07:05:38,276 - INFO - [DEBUG] CE loss: 2.9017, Triplet loss: 0.4333, Total: 3.3350
2025-04-12 07:17:14,328 - INFO - [Epoch 24] Total Loss=3.3460
2025-04-12 07:17:14,328 - INFO - [Epoch 24] Acc@1=15.28% | Acc@5=46.07% | Acc@10=64.38%
2025-04-12 07:17:41,058 - INFO - 
[Classifier Validation]
2025-04-12 07:17:41,058 - INFO - AVG_VAL_LOSS: 4.17%
2025-04-12 07:17:41,058 - INFO - RANK1: 0.00%
2025-04-12 07:17:41,058 - INFO - RANK5: 0.00%
2025-04-12 07:17:41,059 - INFO - RANK10: 0.00%
2025-04-12 07:17:41,059 - INFO - MAP: 1.39%
2025-04-12 07:17:41,061 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 07:18:24,138 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 07:18:24,138 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 07:18:24,139 - INFO - [DEBUG] logits std: 1.5458
2025-04-12 07:18:24,139 - INFO - [DEBUG] CE loss: 3.3869, Triplet loss: 0.0000, Total: 3.3869
2025-04-12 07:29:59,805 - INFO - [Epoch 25] Total Loss=3.1619
2025-04-12 07:29:59,805 - INFO - [Epoch 25] Acc@1=18.31% | Acc@5=50.00% | Acc@10=70.34%
2025-04-12 07:30:27,890 - INFO - 
[Classifier Validation]
2025-04-12 07:30:27,890 - INFO - AVG_VAL_LOSS: 4.14%
2025-04-12 07:30:27,890 - INFO - RANK1: 0.00%
2025-04-12 07:30:27,890 - INFO - RANK5: 0.00%
2025-04-12 07:30:27,891 - INFO - RANK10: 0.00%
2025-04-12 07:30:27,891 - INFO - MAP: 1.39%
2025-04-12 07:30:27,893 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 07:31:11,803 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 07:31:11,803 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 07:31:11,804 - INFO - [DEBUG] logits std: 1.9105
2025-04-12 07:31:11,804 - INFO - [DEBUG] CE loss: 3.0010, Triplet loss: 0.3990, Total: 3.4000
2025-04-12 07:42:48,821 - INFO - [Epoch 26] Total Loss=3.3800
2025-04-12 07:42:48,821 - INFO - [Epoch 26] Acc@1=14.27% | Acc@5=47.19% | Acc@10=66.40%
2025-04-12 07:43:15,660 - INFO - 
[Classifier Validation]
2025-04-12 07:43:15,660 - INFO - AVG_VAL_LOSS: 4.15%
2025-04-12 07:43:15,661 - INFO - RANK1: 0.00%
2025-04-12 07:43:15,661 - INFO - RANK5: 0.00%
2025-04-12 07:43:15,661 - INFO - RANK10: 0.00%
2025-04-12 07:43:15,661 - INFO - MAP: 1.39%
2025-04-12 07:43:15,663 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 07:43:58,098 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 07:43:58,098 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 07:43:58,099 - INFO - [DEBUG] logits std: 1.8316
2025-04-12 07:43:58,099 - INFO - [DEBUG] CE loss: 2.9104, Triplet loss: 0.1086, Total: 3.0191
2025-04-12 07:55:44,020 - INFO - [Epoch 27] Total Loss=3.3054
2025-04-12 07:55:44,021 - INFO - [Epoch 27] Acc@1=15.73% | Acc@5=45.39% | Acc@10=64.83%
2025-04-12 07:56:11,010 - INFO - 
[Classifier Validation]
2025-04-12 07:56:11,010 - INFO - AVG_VAL_LOSS: 4.14%
2025-04-12 07:56:11,010 - INFO - RANK1: 0.00%
2025-04-12 07:56:11,010 - INFO - RANK5: 0.00%
2025-04-12 07:56:11,011 - INFO - RANK10: 0.00%
2025-04-12 07:56:11,011 - INFO - MAP: 1.39%
2025-04-12 07:56:11,013 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 07:56:53,712 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 07:56:53,712 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 07:56:53,713 - INFO - [DEBUG] logits std: 1.9494
2025-04-12 07:56:53,713 - INFO - [DEBUG] CE loss: 2.7682, Triplet loss: 0.0000, Total: 2.7682
2025-04-12 08:08:35,363 - INFO - [Epoch 28] Total Loss=3.4870
2025-04-12 08:08:35,363 - INFO - [Epoch 28] Acc@1=13.15% | Acc@5=41.24% | Acc@10=60.00%
2025-04-12 08:09:02,323 - INFO - 
[Classifier Validation]
2025-04-12 08:09:02,323 - INFO - AVG_VAL_LOSS: 4.17%
2025-04-12 08:09:02,323 - INFO - RANK1: 0.00%
2025-04-12 08:09:02,323 - INFO - RANK5: 0.00%
2025-04-12 08:09:02,324 - INFO - RANK10: 0.00%
2025-04-12 08:09:02,324 - INFO - MAP: 1.39%
2025-04-12 08:09:02,326 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 08:09:45,388 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 08:09:45,388 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 08:09:45,388 - INFO - [DEBUG] logits std: 1.4332
2025-04-12 08:09:45,389 - INFO - [DEBUG] CE loss: 3.3684, Triplet loss: 0.2282, Total: 3.5966
2025-04-12 08:21:25,169 - INFO - [Epoch 29] Total Loss=3.2245
2025-04-12 08:21:25,169 - INFO - [Epoch 29] Acc@1=16.97% | Acc@5=47.64% | Acc@10=69.33%
2025-04-12 08:21:52,154 - INFO - 
[Classifier Validation]
2025-04-12 08:21:52,154 - INFO - AVG_VAL_LOSS: 4.13%
2025-04-12 08:21:52,154 - INFO - RANK1: 0.00%
2025-04-12 08:21:52,154 - INFO - RANK5: 0.00%
2025-04-12 08:21:52,155 - INFO - RANK10: 0.00%
2025-04-12 08:21:52,155 - INFO - MAP: 1.39%
2025-04-12 08:21:52,156 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 08:22:35,332 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-12 08:22:35,333 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-12 08:22:35,333 - INFO - [DEBUG] logits std: 1.8959
2025-04-12 08:22:35,333 - INFO - [DEBUG] CE loss: 2.9410, Triplet loss: 2.0038, Total: 4.9448
2025-04-12 08:34:11,147 - INFO - [Epoch 30] Total Loss=3.1767
2025-04-12 08:34:11,147 - INFO - [Epoch 30] Acc@1=16.85% | Acc@5=50.11% | Acc@10=70.22%
2025-04-12 08:34:37,392 - INFO - 
[Classifier Validation]
2025-04-12 08:34:37,393 - INFO - AVG_VAL_LOSS: 4.12%
2025-04-12 08:34:37,393 - INFO - RANK1: 0.00%
2025-04-12 08:34:37,393 - INFO - RANK5: 0.00%
2025-04-12 08:34:37,393 - INFO - RANK10: 0.00%
2025-04-12 08:34:37,393 - INFO - MAP: 1.39%
2025-04-12 08:34:37,395 - INFO - [INFO] No improvement in Rank-1 (0.00%), skipping checkpoint.
2025-04-12 08:34:38,578 - INFO - Model saved to: saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_finetune_e30_lr00001_bs32_FINAL.pth
