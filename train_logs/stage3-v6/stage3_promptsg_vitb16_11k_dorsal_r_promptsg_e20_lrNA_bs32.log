2025-04-19 10:51:23,010 - INFO - Saving logs to: train_logs/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32.log
2025-04-19 10:51:23,010 - INFO - Using 72 classes | 28 training batches
2025-04-19 10:51:23,013 - INFO - ======= Stage 3: PromptSG Training =======
2025-04-19 10:51:23,013 - INFO - Experiment Name : stage3_promptsg
2025-04-19 10:51:23,013 - INFO - Model & Dataset : vitb16, 11k, dorsal_r
2025-04-19 10:51:23,013 - INFO - Freeze Text Enc.: True
2025-04-19 10:51:23,013 - INFO - Loss Weights    : ID=1.0, Tri=1.0, SupCon=0
2025-04-19 10:51:23,013 - INFO - LR=2.2e-06 | Epochs=20 | BatchSize=32
2025-04-19 10:51:23,013 - INFO -  Epoch 1/20
2025-04-19 10:51:23,013 - INFO - [Epoch 1] Learning rate: 0.000002
2025-04-19 10:51:50,572 - INFO - [DEBUG] Pooled feature mean L2 norm: 1.0000
2025-04-19 10:51:50,575 - INFO - [DEBUG] ArcFace confidence: 0.2458
2025-04-19 10:51:50,578 - INFO - [DEBUG] Loss Breakdown — ID: 18.4946, SupCon: 3.5241, Tri: 0.1216
2025-04-19 10:51:50,824 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:51:50,824 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:51:51,001 - INFO - [DEBUG] ArcFace confidence: 0.2398
2025-04-19 10:51:51,004 - INFO - [DEBUG] Loss Breakdown — ID: 19.1768, SupCon: 3.4938, Tri: 0.1402
2025-04-19 10:51:51,420 - INFO - [DEBUG] ArcFace confidence: 0.2169
2025-04-19 10:51:51,426 - INFO - [DEBUG] Loss Breakdown — ID: 17.9654, SupCon: 3.4840, Tri: 0.1237
2025-04-19 10:51:51,836 - INFO - [DEBUG] ArcFace confidence: 0.2383
2025-04-19 10:51:51,842 - INFO - [DEBUG] Loss Breakdown — ID: 17.7851, SupCon: 3.5028, Tri: 0.0730
2025-04-19 10:51:52,253 - INFO - [DEBUG] ArcFace confidence: 0.2582
2025-04-19 10:51:52,256 - INFO - [DEBUG] Loss Breakdown — ID: 18.1728, SupCon: 3.5102, Tri: 0.1140
2025-04-19 10:51:52,665 - INFO - [DEBUG] ArcFace confidence: 0.2144
2025-04-19 10:51:52,671 - INFO - [DEBUG] Loss Breakdown — ID: 18.1479, SupCon: 3.4998, Tri: 0.1298
2025-04-19 10:51:53,080 - INFO - [DEBUG] ArcFace confidence: 0.2475
2025-04-19 10:51:53,083 - INFO - [DEBUG] Loss Breakdown — ID: 17.7659, SupCon: 3.5219, Tri: 0.1145
2025-04-19 10:51:53,495 - INFO - [DEBUG] ArcFace confidence: 0.2619
2025-04-19 10:51:53,501 - INFO - [DEBUG] Loss Breakdown — ID: 17.5297, SupCon: 3.5029, Tri: 0.1519
2025-04-19 10:51:53,911 - INFO - [DEBUG] ArcFace confidence: 0.2565
2025-04-19 10:51:53,914 - INFO - [DEBUG] Loss Breakdown — ID: 17.3147, SupCon: 3.5447, Tri: 0.1647
2025-04-19 10:51:54,331 - INFO - [DEBUG] ArcFace confidence: 0.2380
2025-04-19 10:51:54,334 - INFO - [DEBUG] Loss Breakdown — ID: 17.5344, SupCon: 3.5202, Tri: 0.1494
2025-04-19 10:51:54,746 - INFO - [DEBUG] ArcFace confidence: 0.2363
2025-04-19 10:51:54,749 - INFO - [DEBUG] Loss Breakdown — ID: 17.5471, SupCon: 3.5576, Tri: 0.0576
2025-04-19 10:51:55,167 - INFO - [DEBUG] ArcFace confidence: 0.2381
2025-04-19 10:51:55,170 - INFO - [DEBUG] Loss Breakdown — ID: 16.3690, SupCon: 3.5678, Tri: 0.1220
2025-04-19 10:51:55,583 - INFO - [DEBUG] ArcFace confidence: 0.2538
2025-04-19 10:51:55,586 - INFO - [DEBUG] Loss Breakdown — ID: 16.2111, SupCon: 3.5595, Tri: 0.1298
2025-04-19 10:51:55,998 - INFO - [DEBUG] ArcFace confidence: 0.2243
2025-04-19 10:51:56,001 - INFO - [DEBUG] Loss Breakdown — ID: 16.2336, SupCon: 3.5616, Tri: 0.1708
2025-04-19 10:51:56,414 - INFO - [DEBUG] ArcFace confidence: 0.2566
2025-04-19 10:51:56,417 - INFO - [DEBUG] Loss Breakdown — ID: 16.1970, SupCon: 3.5135, Tri: 0.1808
2025-04-19 10:51:56,828 - INFO - [DEBUG] ArcFace confidence: 0.2578
2025-04-19 10:51:56,831 - INFO - [DEBUG] Loss Breakdown — ID: 15.5681, SupCon: 3.6007, Tri: 0.1452
2025-04-19 10:51:57,242 - INFO - [DEBUG] ArcFace confidence: 0.2066
2025-04-19 10:51:57,248 - INFO - [DEBUG] Loss Breakdown — ID: 16.2665, SupCon: 3.5813, Tri: 0.1212
2025-04-19 10:51:57,662 - INFO - [DEBUG] ArcFace confidence: 0.2297
2025-04-19 10:51:57,665 - INFO - [DEBUG] Loss Breakdown — ID: 15.3499, SupCon: 3.5637, Tri: 0.1404
2025-04-19 10:51:58,077 - INFO - [DEBUG] ArcFace confidence: 0.2317
2025-04-19 10:51:58,083 - INFO - [DEBUG] Loss Breakdown — ID: 15.7600, SupCon: 3.5700, Tri: 0.1523
2025-04-19 10:51:58,496 - INFO - [DEBUG] ArcFace confidence: 0.2381
2025-04-19 10:51:58,499 - INFO - [DEBUG] Loss Breakdown — ID: 15.6502, SupCon: 3.6607, Tri: 0.0528
2025-04-19 10:51:58,912 - INFO - [DEBUG] ArcFace confidence: 0.2459
2025-04-19 10:51:58,915 - INFO - [DEBUG] Loss Breakdown — ID: 15.2546, SupCon: 3.5783, Tri: 0.1204
2025-04-19 10:51:59,331 - INFO - [DEBUG] ArcFace confidence: 0.2584
2025-04-19 10:51:59,337 - INFO - [DEBUG] Loss Breakdown — ID: 15.5939, SupCon: 3.6031, Tri: 0.0688
2025-04-19 10:51:59,749 - INFO - [DEBUG] ArcFace confidence: 0.2182
2025-04-19 10:51:59,752 - INFO - [DEBUG] Loss Breakdown — ID: 14.6902, SupCon: 3.5433, Tri: 0.0875
2025-04-19 10:52:00,161 - INFO - [DEBUG] ArcFace confidence: 0.2733
2025-04-19 10:52:00,164 - INFO - [DEBUG] Loss Breakdown — ID: 15.6707, SupCon: 3.5610, Tri: 0.0924
2025-04-19 10:52:00,577 - INFO - [DEBUG] ArcFace confidence: 0.2420
2025-04-19 10:52:00,583 - INFO - [DEBUG] Loss Breakdown — ID: 15.3531, SupCon: 3.5321, Tri: 0.1070
2025-04-19 10:52:00,996 - INFO - [DEBUG] ArcFace confidence: 0.2248
2025-04-19 10:52:00,999 - INFO - [DEBUG] Loss Breakdown — ID: 14.6295, SupCon: 3.5582, Tri: 0.0958
2025-04-19 10:52:01,416 - INFO - [DEBUG] ArcFace confidence: 0.2515
2025-04-19 10:52:01,419 - INFO - [DEBUG] Loss Breakdown — ID: 14.1589, SupCon: 3.5811, Tri: 0.0804
2025-04-19 10:52:01,806 - INFO - [DEBUG] ArcFace confidence: 0.2304
2025-04-19 10:52:01,812 - INFO - [DEBUG] Loss Breakdown — ID: 14.5548, SupCon: 3.3877, Tri: 0.0815
2025-04-19 10:52:02,715 - INFO - [Epoch 1] Total Loss=16.5798
2025-04-19 10:52:02,715 - INFO - Validating epoch 1...
2025-04-19 10:52:33,655 - INFO - [Epoch 1] Avg Train Loss = 16.5798 | 
2025-04-19 10:52:33,655 - INFO - ==================== Epoch 1 Validation ====================
2025-04-19 10:52:33,655 - INFO - Validation rank-1    : 71.06%
2025-04-19 10:52:33,655 - INFO - Validation rank-5    : 89.80%
2025-04-19 10:52:33,655 - INFO - Validation rank-10   : 94.64%
2025-04-19 10:52:33,655 - INFO - Validation mAP      : 79.41%
2025-04-19 10:52:33,655 - INFO - ============================================================
2025-04-19 10:52:33,655 - INFO - Saving best model at epoch 1 (Acc@1=71.06%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:52:35,048 - INFO -  Epoch 2/20
2025-04-19 10:52:35,048 - INFO - [Epoch 2] Learning rate: 0.000002
2025-04-19 10:52:59,674 - INFO - [DEBUG] ArcFace confidence: 0.2425
2025-04-19 10:52:59,680 - INFO - [DEBUG] Loss Breakdown — ID: 13.7645, SupCon: 3.5554, Tri: 0.1168
2025-04-19 10:52:59,919 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:52:59,919 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:53:00,094 - INFO - [DEBUG] ArcFace confidence: 0.2519
2025-04-19 10:53:00,097 - INFO - [DEBUG] Loss Breakdown — ID: 13.4721, SupCon: 3.6610, Tri: 0.0972
2025-04-19 10:53:00,515 - INFO - [DEBUG] ArcFace confidence: 0.2303
2025-04-19 10:53:00,518 - INFO - [DEBUG] Loss Breakdown — ID: 12.8593, SupCon: 3.6097, Tri: 0.0601
2025-04-19 10:53:00,935 - INFO - [DEBUG] ArcFace confidence: 0.2452
2025-04-19 10:53:00,938 - INFO - [DEBUG] Loss Breakdown — ID: 13.4363, SupCon: 3.6039, Tri: 0.1024
2025-04-19 10:53:01,353 - INFO - [DEBUG] ArcFace confidence: 0.2514
2025-04-19 10:53:01,359 - INFO - [DEBUG] Loss Breakdown — ID: 12.8980, SupCon: 3.6296, Tri: 0.0902
2025-04-19 10:53:01,773 - INFO - [DEBUG] ArcFace confidence: 0.2556
2025-04-19 10:53:01,776 - INFO - [DEBUG] Loss Breakdown — ID: 12.5290, SupCon: 3.5731, Tri: 0.0742
2025-04-19 10:53:02,188 - INFO - [DEBUG] ArcFace confidence: 0.2836
2025-04-19 10:53:02,194 - INFO - [DEBUG] Loss Breakdown — ID: 12.9765, SupCon: 3.5349, Tri: 0.0297
2025-04-19 10:53:02,608 - INFO - [DEBUG] ArcFace confidence: 0.2354
2025-04-19 10:53:02,611 - INFO - [DEBUG] Loss Breakdown — ID: 12.4672, SupCon: 3.6126, Tri: 0.0660
2025-04-19 10:53:03,025 - INFO - [DEBUG] ArcFace confidence: 0.2066
2025-04-19 10:53:03,028 - INFO - [DEBUG] Loss Breakdown — ID: 12.3758, SupCon: 3.6225, Tri: 0.0570
2025-04-19 10:53:03,444 - INFO - [DEBUG] ArcFace confidence: 0.2687
2025-04-19 10:53:03,447 - INFO - [DEBUG] Loss Breakdown — ID: 12.9388, SupCon: 3.6147, Tri: 0.0636
2025-04-19 10:53:03,861 - INFO - [DEBUG] ArcFace confidence: 0.2439
2025-04-19 10:53:03,864 - INFO - [DEBUG] Loss Breakdown — ID: 12.3874, SupCon: 3.5901, Tri: 0.0484
2025-04-19 10:53:04,281 - INFO - [DEBUG] ArcFace confidence: 0.2032
2025-04-19 10:53:04,284 - INFO - [DEBUG] Loss Breakdown — ID: 12.6726, SupCon: 3.6082, Tri: 0.0522
2025-04-19 10:53:04,698 - INFO - [DEBUG] ArcFace confidence: 0.2718
2025-04-19 10:53:04,701 - INFO - [DEBUG] Loss Breakdown — ID: 13.2591, SupCon: 3.5772, Tri: 0.0451
2025-04-19 10:53:05,113 - INFO - [DEBUG] ArcFace confidence: 0.2431
2025-04-19 10:53:05,119 - INFO - [DEBUG] Loss Breakdown — ID: 12.1943, SupCon: 3.6015, Tri: 0.0444
2025-04-19 10:53:05,532 - INFO - [DEBUG] ArcFace confidence: 0.2729
2025-04-19 10:53:05,538 - INFO - [DEBUG] Loss Breakdown — ID: 12.3785, SupCon: 3.6295, Tri: 0.0858
2025-04-19 10:53:05,951 - INFO - [DEBUG] ArcFace confidence: 0.2538
2025-04-19 10:53:05,957 - INFO - [DEBUG] Loss Breakdown — ID: 11.8365, SupCon: 3.6646, Tri: 0.0806
2025-04-19 10:53:06,373 - INFO - [DEBUG] ArcFace confidence: 0.2731
2025-04-19 10:53:06,376 - INFO - [DEBUG] Loss Breakdown — ID: 12.4087, SupCon: 3.5672, Tri: 0.0362
2025-04-19 10:53:06,791 - INFO - [DEBUG] ArcFace confidence: 0.2788
2025-04-19 10:53:06,794 - INFO - [DEBUG] Loss Breakdown — ID: 11.5964, SupCon: 3.5731, Tri: 0.1055
2025-04-19 10:53:07,212 - INFO - [DEBUG] ArcFace confidence: 0.2640
2025-04-19 10:53:07,215 - INFO - [DEBUG] Loss Breakdown — ID: 12.5612, SupCon: 3.6286, Tri: 0.0794
2025-04-19 10:53:07,633 - INFO - [DEBUG] ArcFace confidence: 0.2241
2025-04-19 10:53:07,636 - INFO - [DEBUG] Loss Breakdown — ID: 11.4974, SupCon: 3.6056, Tri: 0.0594
2025-04-19 10:53:08,053 - INFO - [DEBUG] ArcFace confidence: 0.1862
2025-04-19 10:53:08,057 - INFO - [DEBUG] Loss Breakdown — ID: 10.3940, SupCon: 3.6729, Tri: 0.0280
2025-04-19 10:53:08,471 - INFO - [DEBUG] ArcFace confidence: 0.2392
2025-04-19 10:53:08,474 - INFO - [DEBUG] Loss Breakdown — ID: 11.9016, SupCon: 3.7010, Tri: 0.0560
2025-04-19 10:53:08,890 - INFO - [DEBUG] ArcFace confidence: 0.2530
2025-04-19 10:53:08,893 - INFO - [DEBUG] Loss Breakdown — ID: 11.4677, SupCon: 3.6382, Tri: 0.0410
2025-04-19 10:53:09,306 - INFO - [DEBUG] ArcFace confidence: 0.3003
2025-04-19 10:53:09,309 - INFO - [DEBUG] Loss Breakdown — ID: 12.4174, SupCon: 3.5912, Tri: 0.0818
2025-04-19 10:53:09,723 - INFO - [DEBUG] ArcFace confidence: 0.2543
2025-04-19 10:53:09,726 - INFO - [DEBUG] Loss Breakdown — ID: 11.5959, SupCon: 3.6598, Tri: 0.0150
2025-04-19 10:53:10,139 - INFO - [DEBUG] ArcFace confidence: 0.2375
2025-04-19 10:53:10,142 - INFO - [DEBUG] Loss Breakdown — ID: 11.4276, SupCon: 3.6281, Tri: 0.0482
2025-04-19 10:53:10,555 - INFO - [DEBUG] ArcFace confidence: 0.2614
2025-04-19 10:53:10,558 - INFO - [DEBUG] Loss Breakdown — ID: 11.1450, SupCon: 3.6270, Tri: 0.0339
2025-04-19 10:53:10,943 - INFO - [DEBUG] ArcFace confidence: 0.2065
2025-04-19 10:53:10,949 - INFO - [DEBUG] Loss Breakdown — ID: 9.8880, SupCon: 3.4443, Tri: 0.0096
2025-04-19 10:53:11,849 - INFO - [Epoch 2] Total Loss=12.3019
2025-04-19 10:53:11,849 - INFO - Validating epoch 2...
2025-04-19 10:53:44,135 - INFO - [Epoch 2] Avg Train Loss = 12.3019 | 
2025-04-19 10:53:44,135 - INFO - ==================== Epoch 2 Validation ====================
2025-04-19 10:53:44,135 - INFO - Validation rank-1    : 78.27%
2025-04-19 10:53:44,135 - INFO - Validation rank-5    : 93.92%
2025-04-19 10:53:44,135 - INFO - Validation rank-10   : 96.50%
2025-04-19 10:53:44,135 - INFO - Validation mAP      : 85.03%
2025-04-19 10:53:44,135 - INFO - ============================================================
2025-04-19 10:53:44,135 - INFO - Saving best model at epoch 2 (Acc@1=78.27%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:53:45,510 - INFO -  Epoch 3/20
2025-04-19 10:53:45,510 - INFO - [Epoch 3] Learning rate: 0.000002
2025-04-19 10:54:10,262 - INFO - [DEBUG] ArcFace confidence: 0.2734
2025-04-19 10:54:10,265 - INFO - [DEBUG] Loss Breakdown — ID: 10.6234, SupCon: 3.6560, Tri: 0.0558
2025-04-19 10:54:10,506 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:54:10,506 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:54:10,686 - INFO - [DEBUG] ArcFace confidence: 0.2726
2025-04-19 10:54:10,689 - INFO - [DEBUG] Loss Breakdown — ID: 10.2937, SupCon: 3.6678, Tri: 0.0138
2025-04-19 10:54:11,106 - INFO - [DEBUG] ArcFace confidence: 0.2502
2025-04-19 10:54:11,109 - INFO - [DEBUG] Loss Breakdown — ID: 10.3091, SupCon: 3.5158, Tri: 0.0442
2025-04-19 10:54:11,524 - INFO - [DEBUG] ArcFace confidence: 0.2388
2025-04-19 10:54:11,527 - INFO - [DEBUG] Loss Breakdown — ID: 8.3989, SupCon: 3.6082, Tri: 0.0170
2025-04-19 10:54:11,941 - INFO - [DEBUG] ArcFace confidence: 0.2213
2025-04-19 10:54:11,947 - INFO - [DEBUG] Loss Breakdown — ID: 8.9563, SupCon: 3.6175, Tri: 0.0141
2025-04-19 10:54:12,363 - INFO - [DEBUG] ArcFace confidence: 0.2094
2025-04-19 10:54:12,366 - INFO - [DEBUG] Loss Breakdown — ID: 8.6633, SupCon: 3.6982, Tri: 0.0101
2025-04-19 10:54:12,779 - INFO - [DEBUG] ArcFace confidence: 0.2492
2025-04-19 10:54:12,782 - INFO - [DEBUG] Loss Breakdown — ID: 9.2481, SupCon: 3.6053, Tri: 0.0227
2025-04-19 10:54:13,196 - INFO - [DEBUG] ArcFace confidence: 0.2347
2025-04-19 10:54:13,202 - INFO - [DEBUG] Loss Breakdown — ID: 9.5183, SupCon: 3.5462, Tri: 0.0287
2025-04-19 10:54:13,618 - INFO - [DEBUG] ArcFace confidence: 0.2408
2025-04-19 10:54:13,621 - INFO - [DEBUG] Loss Breakdown — ID: 8.1739, SupCon: 3.5983, Tri: 0.0024
2025-04-19 10:54:14,036 - INFO - [DEBUG] ArcFace confidence: 0.2540
2025-04-19 10:54:14,039 - INFO - [DEBUG] Loss Breakdown — ID: 9.3089, SupCon: 3.5842, Tri: 0.0724
2025-04-19 10:54:14,454 - INFO - [DEBUG] ArcFace confidence: 0.2482
2025-04-19 10:54:14,457 - INFO - [DEBUG] Loss Breakdown — ID: 9.0970, SupCon: 3.6399, Tri: 0.0364
2025-04-19 10:54:14,867 - INFO - [DEBUG] ArcFace confidence: 0.2477
2025-04-19 10:54:14,873 - INFO - [DEBUG] Loss Breakdown — ID: 10.2256, SupCon: 3.5815, Tri: 0.0399
2025-04-19 10:54:15,283 - INFO - [DEBUG] ArcFace confidence: 0.2710
2025-04-19 10:54:15,286 - INFO - [DEBUG] Loss Breakdown — ID: 8.3668, SupCon: 3.5663, Tri: 0.0294
2025-04-19 10:54:15,697 - INFO - [DEBUG] ArcFace confidence: 0.2636
2025-04-19 10:54:15,700 - INFO - [DEBUG] Loss Breakdown — ID: 8.3825, SupCon: 3.6221, Tri: 0.0085
2025-04-19 10:54:16,115 - INFO - [DEBUG] ArcFace confidence: 0.2851
2025-04-19 10:54:16,121 - INFO - [DEBUG] Loss Breakdown — ID: 9.5805, SupCon: 3.6180, Tri: 0.0080
2025-04-19 10:54:16,533 - INFO - [DEBUG] ArcFace confidence: 0.2742
2025-04-19 10:54:16,536 - INFO - [DEBUG] Loss Breakdown — ID: 10.3430, SupCon: 3.6029, Tri: 0.0078
2025-04-19 10:54:16,956 - INFO - [DEBUG] ArcFace confidence: 0.2775
2025-04-19 10:54:16,959 - INFO - [DEBUG] Loss Breakdown — ID: 10.2853, SupCon: 3.5931, Tri: 0.0420
2025-04-19 10:54:17,371 - INFO - [DEBUG] ArcFace confidence: 0.2839
2025-04-19 10:54:17,377 - INFO - [DEBUG] Loss Breakdown — ID: 7.7663, SupCon: 3.6444, Tri: 0.0183
2025-04-19 10:54:17,789 - INFO - [DEBUG] ArcFace confidence: 0.2760
2025-04-19 10:54:17,792 - INFO - [DEBUG] Loss Breakdown — ID: 7.4815, SupCon: 3.6034, Tri: 0.0028
2025-04-19 10:54:18,207 - INFO - [DEBUG] ArcFace confidence: 0.2417
2025-04-19 10:54:18,210 - INFO - [DEBUG] Loss Breakdown — ID: 8.5387, SupCon: 3.6435, Tri: 0.0087
2025-04-19 10:54:18,623 - INFO - [DEBUG] ArcFace confidence: 0.2554
2025-04-19 10:54:18,626 - INFO - [DEBUG] Loss Breakdown — ID: 7.9121, SupCon: 3.5015, Tri: 0.0304
2025-04-19 10:54:19,038 - INFO - [DEBUG] ArcFace confidence: 0.2265
2025-04-19 10:54:19,041 - INFO - [DEBUG] Loss Breakdown — ID: 8.5987, SupCon: 3.5082, Tri: 0.0104
2025-04-19 10:54:19,455 - INFO - [DEBUG] ArcFace confidence: 0.2763
2025-04-19 10:54:19,458 - INFO - [DEBUG] Loss Breakdown — ID: 8.7746, SupCon: 3.6068, Tri: 0.0407
2025-04-19 10:54:19,871 - INFO - [DEBUG] ArcFace confidence: 0.2459
2025-04-19 10:54:19,877 - INFO - [DEBUG] Loss Breakdown — ID: 8.4505, SupCon: 3.5681, Tri: 0.0094
2025-04-19 10:54:20,287 - INFO - [DEBUG] ArcFace confidence: 0.2759
2025-04-19 10:54:20,293 - INFO - [DEBUG] Loss Breakdown — ID: 7.7301, SupCon: 3.6655, Tri: 0.0448
2025-04-19 10:54:20,707 - INFO - [DEBUG] ArcFace confidence: 0.2837
2025-04-19 10:54:20,710 - INFO - [DEBUG] Loss Breakdown — ID: 8.0249, SupCon: 3.5858, Tri: 0.0093
2025-04-19 10:54:21,123 - INFO - [DEBUG] ArcFace confidence: 0.2968
2025-04-19 10:54:21,126 - INFO - [DEBUG] Loss Breakdown — ID: 7.9169, SupCon: 3.5936, Tri: 0.0084
2025-04-19 10:54:21,508 - INFO - [DEBUG] ArcFace confidence: 0.2548
2025-04-19 10:54:21,510 - INFO - [DEBUG] Loss Breakdown — ID: 7.9524, SupCon: 3.4146, Tri: 0.0241
2025-04-19 10:54:22,378 - INFO - [Epoch 3] Total Loss=8.9136
2025-04-19 10:54:22,378 - INFO - Validating epoch 3...
2025-04-19 10:54:54,041 - INFO - [Epoch 3] Avg Train Loss = 8.9136 | 
2025-04-19 10:54:54,041 - INFO - ==================== Epoch 3 Validation ====================
2025-04-19 10:54:54,041 - INFO - Validation rank-1    : 82.29%
2025-04-19 10:54:54,041 - INFO - Validation rank-5    : 94.54%
2025-04-19 10:54:54,041 - INFO - Validation rank-10   : 97.01%
2025-04-19 10:54:54,041 - INFO - Validation mAP      : 88.15%
2025-04-19 10:54:54,041 - INFO - ============================================================
2025-04-19 10:54:54,041 - INFO - Saving best model at epoch 3 (Acc@1=82.29%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:54:55,407 - INFO -  Epoch 4/20
2025-04-19 10:54:55,407 - INFO - [Epoch 4] Learning rate: 0.000002
2025-04-19 10:55:21,037 - INFO - [DEBUG] ArcFace confidence: 0.3368
2025-04-19 10:55:21,040 - INFO - [DEBUG] Loss Breakdown — ID: 6.9473, SupCon: 3.6755, Tri: 0.0165
2025-04-19 10:55:21,281 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:55:21,281 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:55:21,458 - INFO - [DEBUG] ArcFace confidence: 0.2362
2025-04-19 10:55:21,464 - INFO - [DEBUG] Loss Breakdown — ID: 7.5130, SupCon: 3.6553, Tri: 0.0115
2025-04-19 10:55:21,880 - INFO - [DEBUG] ArcFace confidence: 0.2923
2025-04-19 10:55:21,883 - INFO - [DEBUG] Loss Breakdown — ID: 7.0472, SupCon: 3.5747, Tri: 0.0000
2025-04-19 10:55:22,301 - INFO - [DEBUG] ArcFace confidence: 0.2636
2025-04-19 10:55:22,304 - INFO - [DEBUG] Loss Breakdown — ID: 6.7905, SupCon: 3.5311, Tri: 0.0000
2025-04-19 10:55:22,719 - INFO - [DEBUG] ArcFace confidence: 0.2680
2025-04-19 10:55:22,722 - INFO - [DEBUG] Loss Breakdown — ID: 6.8503, SupCon: 3.6200, Tri: 0.0066
2025-04-19 10:55:23,138 - INFO - [DEBUG] ArcFace confidence: 0.3146
2025-04-19 10:55:23,140 - INFO - [DEBUG] Loss Breakdown — ID: 7.0465, SupCon: 3.5936, Tri: 0.0094
2025-04-19 10:55:23,554 - INFO - [DEBUG] ArcFace confidence: 0.3358
2025-04-19 10:55:23,560 - INFO - [DEBUG] Loss Breakdown — ID: 7.1650, SupCon: 3.5466, Tri: 0.0143
2025-04-19 10:55:23,973 - INFO - [DEBUG] ArcFace confidence: 0.3251
2025-04-19 10:55:23,974 - INFO - [DEBUG] Loss Breakdown — ID: 6.7540, SupCon: 3.6105, Tri: 0.0080
2025-04-19 10:55:24,389 - INFO - [DEBUG] ArcFace confidence: 0.2960
2025-04-19 10:55:24,395 - INFO - [DEBUG] Loss Breakdown — ID: 5.8791, SupCon: 3.5442, Tri: 0.0024
2025-04-19 10:55:24,811 - INFO - [DEBUG] ArcFace confidence: 0.2923
2025-04-19 10:55:24,814 - INFO - [DEBUG] Loss Breakdown — ID: 6.3894, SupCon: 3.6352, Tri: 0.0322
2025-04-19 10:55:25,230 - INFO - [DEBUG] ArcFace confidence: 0.3423
2025-04-19 10:55:25,233 - INFO - [DEBUG] Loss Breakdown — ID: 6.7601, SupCon: 3.5552, Tri: 0.0229
2025-04-19 10:55:25,652 - INFO - [DEBUG] ArcFace confidence: 0.3096
2025-04-19 10:55:25,655 - INFO - [DEBUG] Loss Breakdown — ID: 6.2349, SupCon: 3.5861, Tri: 0.0000
2025-04-19 10:55:26,069 - INFO - [DEBUG] ArcFace confidence: 0.2663
2025-04-19 10:55:26,072 - INFO - [DEBUG] Loss Breakdown — ID: 6.0152, SupCon: 3.6738, Tri: 0.0108
2025-04-19 10:55:26,492 - INFO - [DEBUG] ArcFace confidence: 0.3421
2025-04-19 10:55:26,495 - INFO - [DEBUG] Loss Breakdown — ID: 6.0351, SupCon: 3.5494, Tri: 0.0000
2025-04-19 10:55:26,913 - INFO - [DEBUG] ArcFace confidence: 0.3347
2025-04-19 10:55:26,916 - INFO - [DEBUG] Loss Breakdown — ID: 6.4645, SupCon: 3.6087, Tri: 0.0117
2025-04-19 10:55:27,333 - INFO - [DEBUG] ArcFace confidence: 0.2947
2025-04-19 10:55:27,336 - INFO - [DEBUG] Loss Breakdown — ID: 6.2652, SupCon: 3.6554, Tri: 0.0054
2025-04-19 10:55:27,754 - INFO - [DEBUG] ArcFace confidence: 0.3692
2025-04-19 10:55:27,757 - INFO - [DEBUG] Loss Breakdown — ID: 6.2328, SupCon: 3.6258, Tri: 0.0021
2025-04-19 10:55:28,175 - INFO - [DEBUG] ArcFace confidence: 0.3027
2025-04-19 10:55:28,178 - INFO - [DEBUG] Loss Breakdown — ID: 5.5105, SupCon: 3.6300, Tri: 0.0026
2025-04-19 10:55:28,593 - INFO - [DEBUG] ArcFace confidence: 0.3438
2025-04-19 10:55:28,599 - INFO - [DEBUG] Loss Breakdown — ID: 6.2851, SupCon: 3.6160, Tri: 0.0001
2025-04-19 10:55:29,015 - INFO - [DEBUG] ArcFace confidence: 0.3449
2025-04-19 10:55:29,018 - INFO - [DEBUG] Loss Breakdown — ID: 6.6992, SupCon: 3.6153, Tri: 0.0155
2025-04-19 10:55:29,439 - INFO - [DEBUG] ArcFace confidence: 0.3444
2025-04-19 10:55:29,442 - INFO - [DEBUG] Loss Breakdown — ID: 5.0816, SupCon: 3.5311, Tri: 0.0000
2025-04-19 10:55:29,861 - INFO - [DEBUG] ArcFace confidence: 0.3086
2025-04-19 10:55:29,864 - INFO - [DEBUG] Loss Breakdown — ID: 7.0945, SupCon: 3.6462, Tri: 0.0018
2025-04-19 10:55:30,286 - INFO - [DEBUG] ArcFace confidence: 0.3512
2025-04-19 10:55:30,289 - INFO - [DEBUG] Loss Breakdown — ID: 6.8439, SupCon: 3.5853, Tri: 0.0000
2025-04-19 10:55:30,706 - INFO - [DEBUG] ArcFace confidence: 0.2954
2025-04-19 10:55:30,709 - INFO - [DEBUG] Loss Breakdown — ID: 7.0769, SupCon: 3.6199, Tri: 0.0295
2025-04-19 10:55:31,120 - INFO - [DEBUG] ArcFace confidence: 0.3121
2025-04-19 10:55:31,126 - INFO - [DEBUG] Loss Breakdown — ID: 4.9314, SupCon: 3.5698, Tri: 0.0009
2025-04-19 10:55:31,539 - INFO - [DEBUG] ArcFace confidence: 0.3449
2025-04-19 10:55:31,542 - INFO - [DEBUG] Loss Breakdown — ID: 4.8193, SupCon: 3.6709, Tri: 0.0104
2025-04-19 10:55:31,957 - INFO - [DEBUG] ArcFace confidence: 0.3245
2025-04-19 10:55:31,960 - INFO - [DEBUG] Loss Breakdown — ID: 5.1274, SupCon: 3.6526, Tri: 0.0118
2025-04-19 10:55:32,346 - INFO - [DEBUG] ArcFace confidence: 0.3234
2025-04-19 10:55:32,349 - INFO - [DEBUG] Loss Breakdown — ID: 5.2602, SupCon: 3.5868, Tri: 0.0003
2025-04-19 10:55:33,227 - INFO - [Epoch 4] Total Loss=6.3338
2025-04-19 10:55:33,227 - INFO - Validating epoch 4...
2025-04-19 10:56:04,858 - INFO - [Epoch 4] Avg Train Loss = 6.3338 | 
2025-04-19 10:56:04,858 - INFO - ==================== Epoch 4 Validation ====================
2025-04-19 10:56:04,858 - INFO - Validation rank-1    : 84.86%
2025-04-19 10:56:04,858 - INFO - Validation rank-5    : 95.88%
2025-04-19 10:56:04,858 - INFO - Validation rank-10   : 97.94%
2025-04-19 10:56:04,858 - INFO - Validation mAP      : 89.80%
2025-04-19 10:56:04,858 - INFO - ============================================================
2025-04-19 10:56:04,858 - INFO - Saving best model at epoch 4 (Acc@1=84.86%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:56:06,210 - INFO -  Epoch 5/20
2025-04-19 10:56:06,210 - INFO - [Epoch 5] Learning rate: 0.000002
2025-04-19 10:56:31,210 - INFO - [DEBUG] ArcFace confidence: 0.3218
2025-04-19 10:56:31,216 - INFO - [DEBUG] Loss Breakdown — ID: 5.5222, SupCon: 3.6942, Tri: 0.0004
2025-04-19 10:56:31,458 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:56:31,458 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:56:31,636 - INFO - [DEBUG] ArcFace confidence: 0.3809
2025-04-19 10:56:31,642 - INFO - [DEBUG] Loss Breakdown — ID: 4.5397, SupCon: 3.5954, Tri: 0.0023
2025-04-19 10:56:32,057 - INFO - [DEBUG] ArcFace confidence: 0.3208
2025-04-19 10:56:32,060 - INFO - [DEBUG] Loss Breakdown — ID: 6.1438, SupCon: 3.7238, Tri: 0.0139
2025-04-19 10:56:32,474 - INFO - [DEBUG] ArcFace confidence: 0.3130
2025-04-19 10:56:32,477 - INFO - [DEBUG] Loss Breakdown — ID: 5.2804, SupCon: 3.5686, Tri: 0.0016
2025-04-19 10:56:32,895 - INFO - [DEBUG] ArcFace confidence: 0.3244
2025-04-19 10:56:32,898 - INFO - [DEBUG] Loss Breakdown — ID: 4.5385, SupCon: 3.5227, Tri: 0.0087
2025-04-19 10:56:33,313 - INFO - [DEBUG] ArcFace confidence: 0.2752
2025-04-19 10:56:33,316 - INFO - [DEBUG] Loss Breakdown — ID: 5.4577, SupCon: 3.6403, Tri: 0.0093
2025-04-19 10:56:33,733 - INFO - [DEBUG] ArcFace confidence: 0.3518
2025-04-19 10:56:33,736 - INFO - [DEBUG] Loss Breakdown — ID: 6.0600, SupCon: 3.7367, Tri: 0.0042
2025-04-19 10:56:34,151 - INFO - [DEBUG] ArcFace confidence: 0.3947
2025-04-19 10:56:34,154 - INFO - [DEBUG] Loss Breakdown — ID: 4.8692, SupCon: 3.5791, Tri: 0.0000
2025-04-19 10:56:34,566 - INFO - [DEBUG] ArcFace confidence: 0.4259
2025-04-19 10:56:34,569 - INFO - [DEBUG] Loss Breakdown — ID: 4.8377, SupCon: 3.7159, Tri: 0.0096
2025-04-19 10:56:34,987 - INFO - [DEBUG] ArcFace confidence: 0.3505
2025-04-19 10:56:34,990 - INFO - [DEBUG] Loss Breakdown — ID: 3.5862, SupCon: 3.6265, Tri: 0.0010
2025-04-19 10:56:35,405 - INFO - [DEBUG] ArcFace confidence: 0.3495
2025-04-19 10:56:35,411 - INFO - [DEBUG] Loss Breakdown — ID: 4.9827, SupCon: 3.6225, Tri: 0.0107
2025-04-19 10:56:35,828 - INFO - [DEBUG] ArcFace confidence: 0.3759
2025-04-19 10:56:35,833 - INFO - [DEBUG] Loss Breakdown — ID: 5.7114, SupCon: 3.5851, Tri: 0.0264
2025-04-19 10:56:36,249 - INFO - [DEBUG] ArcFace confidence: 0.3579
2025-04-19 10:56:36,252 - INFO - [DEBUG] Loss Breakdown — ID: 3.9338, SupCon: 3.5834, Tri: 0.0000
2025-04-19 10:56:36,668 - INFO - [DEBUG] ArcFace confidence: 0.3419
2025-04-19 10:56:36,671 - INFO - [DEBUG] Loss Breakdown — ID: 5.1532, SupCon: 3.5348, Tri: 0.0000
2025-04-19 10:56:37,089 - INFO - [DEBUG] ArcFace confidence: 0.3570
2025-04-19 10:56:37,092 - INFO - [DEBUG] Loss Breakdown — ID: 4.0410, SupCon: 3.6207, Tri: 0.0018
2025-04-19 10:56:37,507 - INFO - [DEBUG] ArcFace confidence: 0.4163
2025-04-19 10:56:37,513 - INFO - [DEBUG] Loss Breakdown — ID: 3.5434, SupCon: 3.5983, Tri: 0.0000
2025-04-19 10:56:37,927 - INFO - [DEBUG] ArcFace confidence: 0.2964
2025-04-19 10:56:37,933 - INFO - [DEBUG] Loss Breakdown — ID: 4.9996, SupCon: 3.6492, Tri: 0.0000
2025-04-19 10:56:38,348 - INFO - [DEBUG] ArcFace confidence: 0.3870
2025-04-19 10:56:38,351 - INFO - [DEBUG] Loss Breakdown — ID: 4.4515, SupCon: 3.7092, Tri: 0.0000
2025-04-19 10:56:38,766 - INFO - [DEBUG] ArcFace confidence: 0.3627
2025-04-19 10:56:38,771 - INFO - [DEBUG] Loss Breakdown — ID: 4.2382, SupCon: 3.6816, Tri: 0.0000
2025-04-19 10:56:39,187 - INFO - [DEBUG] ArcFace confidence: 0.3385
2025-04-19 10:56:39,190 - INFO - [DEBUG] Loss Breakdown — ID: 4.1654, SupCon: 3.5807, Tri: 0.0000
2025-04-19 10:56:39,607 - INFO - [DEBUG] ArcFace confidence: 0.4382
2025-04-19 10:56:39,610 - INFO - [DEBUG] Loss Breakdown — ID: 3.6994, SupCon: 3.7670, Tri: 0.0000
2025-04-19 10:56:40,029 - INFO - [DEBUG] ArcFace confidence: 0.4430
2025-04-19 10:56:40,032 - INFO - [DEBUG] Loss Breakdown — ID: 4.6333, SupCon: 3.6621, Tri: 0.0000
2025-04-19 10:56:40,448 - INFO - [DEBUG] ArcFace confidence: 0.4987
2025-04-19 10:56:40,451 - INFO - [DEBUG] Loss Breakdown — ID: 3.6977, SupCon: 3.7796, Tri: 0.0003
2025-04-19 10:56:40,867 - INFO - [DEBUG] ArcFace confidence: 0.3774
2025-04-19 10:56:40,870 - INFO - [DEBUG] Loss Breakdown — ID: 3.2580, SupCon: 3.6516, Tri: 0.0000
2025-04-19 10:56:41,288 - INFO - [DEBUG] ArcFace confidence: 0.3657
2025-04-19 10:56:41,291 - INFO - [DEBUG] Loss Breakdown — ID: 3.8298, SupCon: 3.6244, Tri: 0.0000
2025-04-19 10:56:41,709 - INFO - [DEBUG] ArcFace confidence: 0.4322
2025-04-19 10:56:41,712 - INFO - [DEBUG] Loss Breakdown — ID: 3.4552, SupCon: 3.6437, Tri: 0.0000
2025-04-19 10:56:42,133 - INFO - [DEBUG] ArcFace confidence: 0.3371
2025-04-19 10:56:42,136 - INFO - [DEBUG] Loss Breakdown — ID: 4.1734, SupCon: 3.6279, Tri: 0.0025
2025-04-19 10:56:42,523 - INFO - [DEBUG] ArcFace confidence: 0.3295
2025-04-19 10:56:42,526 - INFO - [DEBUG] Loss Breakdown — ID: 4.8841, SupCon: 3.4422, Tri: 0.0000
2025-04-19 10:56:43,423 - INFO - [Epoch 5] Total Loss=4.5635
2025-04-19 10:56:43,423 - INFO - Validating epoch 5...
2025-04-19 10:57:14,825 - INFO - [Epoch 5] Avg Train Loss = 4.5635 | 
2025-04-19 10:57:14,825 - INFO - ==================== Epoch 5 Validation ====================
2025-04-19 10:57:14,825 - INFO - Validation rank-1    : 86.61%
2025-04-19 10:57:14,825 - INFO - Validation rank-5    : 95.78%
2025-04-19 10:57:14,825 - INFO - Validation rank-10   : 97.63%
2025-04-19 10:57:14,825 - INFO - Validation mAP      : 91.09%
2025-04-19 10:57:14,825 - INFO - ============================================================
2025-04-19 10:57:14,825 - INFO - Saving best model at epoch 5 (Acc@1=86.61%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:57:16,231 - INFO -  Epoch 6/20
2025-04-19 10:57:16,231 - INFO - [Epoch 6] Learning rate: 0.000002
2025-04-19 10:57:40,784 - INFO - [DEBUG] ArcFace confidence: 0.4432
2025-04-19 10:57:40,790 - INFO - [DEBUG] Loss Breakdown — ID: 4.0028, SupCon: 3.7338, Tri: 0.0003
2025-04-19 10:57:41,030 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:57:41,033 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:57:41,208 - INFO - [DEBUG] ArcFace confidence: 0.3893
2025-04-19 10:57:41,211 - INFO - [DEBUG] Loss Breakdown — ID: 3.7008, SupCon: 3.5284, Tri: 0.0000
2025-04-19 10:57:41,624 - INFO - [DEBUG] ArcFace confidence: 0.4981
2025-04-19 10:57:41,630 - INFO - [DEBUG] Loss Breakdown — ID: 3.3967, SupCon: 3.6302, Tri: 0.0054
2025-04-19 10:57:42,043 - INFO - [DEBUG] ArcFace confidence: 0.4541
2025-04-19 10:57:42,046 - INFO - [DEBUG] Loss Breakdown — ID: 2.9687, SupCon: 3.6544, Tri: 0.0000
2025-04-19 10:57:42,460 - INFO - [DEBUG] ArcFace confidence: 0.3654
2025-04-19 10:57:42,466 - INFO - [DEBUG] Loss Breakdown — ID: 3.8405, SupCon: 3.6714, Tri: 0.0117
2025-04-19 10:57:42,877 - INFO - [DEBUG] ArcFace confidence: 0.3432
2025-04-19 10:57:42,883 - INFO - [DEBUG] Loss Breakdown — ID: 3.6676, SupCon: 3.6633, Tri: 0.0000
2025-04-19 10:57:43,297 - INFO - [DEBUG] ArcFace confidence: 0.4187
2025-04-19 10:57:43,303 - INFO - [DEBUG] Loss Breakdown — ID: 3.4641, SupCon: 3.7121, Tri: 0.0000
2025-04-19 10:57:43,712 - INFO - [DEBUG] ArcFace confidence: 0.3546
2025-04-19 10:57:43,718 - INFO - [DEBUG] Loss Breakdown — ID: 4.0107, SupCon: 3.6087, Tri: 0.0000
2025-04-19 10:57:44,130 - INFO - [DEBUG] ArcFace confidence: 0.4509
2025-04-19 10:57:44,137 - INFO - [DEBUG] Loss Breakdown — ID: 2.9237, SupCon: 3.6160, Tri: 0.0000
2025-04-19 10:57:44,551 - INFO - [DEBUG] ArcFace confidence: 0.4398
2025-04-19 10:57:44,554 - INFO - [DEBUG] Loss Breakdown — ID: 3.4371, SupCon: 3.5889, Tri: 0.0008
2025-04-19 10:57:44,969 - INFO - [DEBUG] ArcFace confidence: 0.4615
2025-04-19 10:57:44,974 - INFO - [DEBUG] Loss Breakdown — ID: 3.7224, SupCon: 3.6570, Tri: 0.0000
2025-04-19 10:57:45,388 - INFO - [DEBUG] ArcFace confidence: 0.5236
2025-04-19 10:57:45,391 - INFO - [DEBUG] Loss Breakdown — ID: 3.1759, SupCon: 3.5447, Tri: 0.0000
2025-04-19 10:57:45,804 - INFO - [DEBUG] ArcFace confidence: 0.3732
2025-04-19 10:57:45,807 - INFO - [DEBUG] Loss Breakdown — ID: 3.6801, SupCon: 3.6114, Tri: 0.0045
2025-04-19 10:57:46,221 - INFO - [DEBUG] ArcFace confidence: 0.4441
2025-04-19 10:57:46,227 - INFO - [DEBUG] Loss Breakdown — ID: 2.7503, SupCon: 3.6691, Tri: 0.0011
2025-04-19 10:57:46,644 - INFO - [DEBUG] ArcFace confidence: 0.4255
2025-04-19 10:57:46,646 - INFO - [DEBUG] Loss Breakdown — ID: 4.1167, SupCon: 3.6461, Tri: 0.0000
2025-04-19 10:57:47,065 - INFO - [DEBUG] ArcFace confidence: 0.5324
2025-04-19 10:57:47,068 - INFO - [DEBUG] Loss Breakdown — ID: 2.3597, SupCon: 3.6624, Tri: 0.0000
2025-04-19 10:57:47,484 - INFO - [DEBUG] ArcFace confidence: 0.4886
2025-04-19 10:57:47,490 - INFO - [DEBUG] Loss Breakdown — ID: 3.6099, SupCon: 3.6624, Tri: 0.0000
2025-04-19 10:57:47,904 - INFO - [DEBUG] ArcFace confidence: 0.4052
2025-04-19 10:57:47,907 - INFO - [DEBUG] Loss Breakdown — ID: 3.1449, SupCon: 3.5908, Tri: 0.0000
2025-04-19 10:57:48,321 - INFO - [DEBUG] ArcFace confidence: 0.4568
2025-04-19 10:57:48,327 - INFO - [DEBUG] Loss Breakdown — ID: 3.5445, SupCon: 3.6960, Tri: 0.0000
2025-04-19 10:57:48,739 - INFO - [DEBUG] ArcFace confidence: 0.4647
2025-04-19 10:57:48,745 - INFO - [DEBUG] Loss Breakdown — ID: 3.8037, SupCon: 3.6803, Tri: 0.0042
2025-04-19 10:57:49,161 - INFO - [DEBUG] ArcFace confidence: 0.4000
2025-04-19 10:57:49,165 - INFO - [DEBUG] Loss Breakdown — ID: 3.5067, SupCon: 3.5946, Tri: 0.0050
2025-04-19 10:57:49,581 - INFO - [DEBUG] ArcFace confidence: 0.5366
2025-04-19 10:57:49,587 - INFO - [DEBUG] Loss Breakdown — ID: 2.4296, SupCon: 3.6958, Tri: 0.0000
2025-04-19 10:57:50,003 - INFO - [DEBUG] ArcFace confidence: 0.4085
2025-04-19 10:57:50,006 - INFO - [DEBUG] Loss Breakdown — ID: 3.8024, SupCon: 3.5908, Tri: 0.0000
2025-04-19 10:57:50,420 - INFO - [DEBUG] ArcFace confidence: 0.5690
2025-04-19 10:57:50,423 - INFO - [DEBUG] Loss Breakdown — ID: 2.0298, SupCon: 3.7221, Tri: 0.0000
2025-04-19 10:57:50,838 - INFO - [DEBUG] ArcFace confidence: 0.5299
2025-04-19 10:57:50,841 - INFO - [DEBUG] Loss Breakdown — ID: 2.6819, SupCon: 3.6224, Tri: 0.0000
2025-04-19 10:57:51,256 - INFO - [DEBUG] ArcFace confidence: 0.4233
2025-04-19 10:57:51,262 - INFO - [DEBUG] Loss Breakdown — ID: 2.8353, SupCon: 3.6076, Tri: 0.0000
2025-04-19 10:57:51,677 - INFO - [DEBUG] ArcFace confidence: 0.3693
2025-04-19 10:57:51,680 - INFO - [DEBUG] Loss Breakdown — ID: 4.0951, SupCon: 3.6304, Tri: 0.0000
2025-04-19 10:57:52,065 - INFO - [DEBUG] ArcFace confidence: 0.3961
2025-04-19 10:57:52,068 - INFO - [DEBUG] Loss Breakdown — ID: 3.1346, SupCon: 3.4354, Tri: 0.0113
2025-04-19 10:57:52,966 - INFO - [Epoch 6] Total Loss=3.3529
2025-04-19 10:57:52,966 - INFO - Validating epoch 6...
2025-04-19 10:58:24,807 - INFO - [Epoch 6] Avg Train Loss = 3.3529 | 
2025-04-19 10:58:24,807 - INFO - ==================== Epoch 6 Validation ====================
2025-04-19 10:58:24,807 - INFO - Validation rank-1    : 87.95%
2025-04-19 10:58:24,807 - INFO - Validation rank-5    : 95.88%
2025-04-19 10:58:24,807 - INFO - Validation rank-10   : 97.32%
2025-04-19 10:58:24,807 - INFO - Validation mAP      : 91.74%
2025-04-19 10:58:24,807 - INFO - ============================================================
2025-04-19 10:58:24,807 - INFO - Saving best model at epoch 6 (Acc@1=87.95%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:58:26,163 - INFO -  Epoch 7/20
2025-04-19 10:58:26,163 - INFO - [Epoch 7] Learning rate: 0.000002
2025-04-19 10:58:51,176 - INFO - [DEBUG] ArcFace confidence: 0.5512
2025-04-19 10:58:51,179 - INFO - [DEBUG] Loss Breakdown — ID: 2.2697, SupCon: 3.7296, Tri: 0.0000
2025-04-19 10:58:51,422 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 10:58:51,422 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 10:58:51,596 - INFO - [DEBUG] ArcFace confidence: 0.4997
2025-04-19 10:58:51,602 - INFO - [DEBUG] Loss Breakdown — ID: 2.9128, SupCon: 3.6125, Tri: 0.0000
2025-04-19 10:58:52,016 - INFO - [DEBUG] ArcFace confidence: 0.5687
2025-04-19 10:58:52,019 - INFO - [DEBUG] Loss Breakdown — ID: 2.5997, SupCon: 3.5924, Tri: 0.0000
2025-04-19 10:58:52,435 - INFO - [DEBUG] ArcFace confidence: 0.4635
2025-04-19 10:58:52,438 - INFO - [DEBUG] Loss Breakdown — ID: 2.9338, SupCon: 3.5819, Tri: 0.0000
2025-04-19 10:58:52,852 - INFO - [DEBUG] ArcFace confidence: 0.4498
2025-04-19 10:58:52,855 - INFO - [DEBUG] Loss Breakdown — ID: 3.0313, SupCon: 3.6418, Tri: 0.0007
2025-04-19 10:58:53,272 - INFO - [DEBUG] ArcFace confidence: 0.4298
2025-04-19 10:58:53,275 - INFO - [DEBUG] Loss Breakdown — ID: 3.4267, SupCon: 3.6767, Tri: 0.0000
2025-04-19 10:58:53,689 - INFO - [DEBUG] ArcFace confidence: 0.5015
2025-04-19 10:58:53,695 - INFO - [DEBUG] Loss Breakdown — ID: 3.2087, SupCon: 3.6553, Tri: 0.0000
2025-04-19 10:58:54,111 - INFO - [DEBUG] ArcFace confidence: 0.4267
2025-04-19 10:58:54,114 - INFO - [DEBUG] Loss Breakdown — ID: 3.4956, SupCon: 3.6311, Tri: 0.0000
2025-04-19 10:58:54,531 - INFO - [DEBUG] ArcFace confidence: 0.4934
2025-04-19 10:58:54,534 - INFO - [DEBUG] Loss Breakdown — ID: 3.1907, SupCon: 3.6116, Tri: 0.0000
2025-04-19 10:58:54,951 - INFO - [DEBUG] ArcFace confidence: 0.4960
2025-04-19 10:58:54,954 - INFO - [DEBUG] Loss Breakdown — ID: 2.4697, SupCon: 3.5471, Tri: 0.0000
2025-04-19 10:58:55,371 - INFO - [DEBUG] ArcFace confidence: 0.4691
2025-04-19 10:58:55,374 - INFO - [DEBUG] Loss Breakdown — ID: 2.1371, SupCon: 3.7201, Tri: 0.0000
2025-04-19 10:58:55,787 - INFO - [DEBUG] ArcFace confidence: 0.4409
2025-04-19 10:58:55,790 - INFO - [DEBUG] Loss Breakdown — ID: 2.8411, SupCon: 3.6077, Tri: 0.0000
2025-04-19 10:58:56,210 - INFO - [DEBUG] ArcFace confidence: 0.4948
2025-04-19 10:58:56,213 - INFO - [DEBUG] Loss Breakdown — ID: 2.8860, SupCon: 3.5527, Tri: 0.0005
2025-04-19 10:58:56,631 - INFO - [DEBUG] ArcFace confidence: 0.5019
2025-04-19 10:58:56,634 - INFO - [DEBUG] Loss Breakdown — ID: 2.6120, SupCon: 3.6532, Tri: 0.0043
2025-04-19 10:58:57,052 - INFO - [DEBUG] ArcFace confidence: 0.5332
2025-04-19 10:58:57,055 - INFO - [DEBUG] Loss Breakdown — ID: 2.3849, SupCon: 3.7524, Tri: 0.0000
2025-04-19 10:58:57,474 - INFO - [DEBUG] ArcFace confidence: 0.5028
2025-04-19 10:58:57,477 - INFO - [DEBUG] Loss Breakdown — ID: 2.5578, SupCon: 3.5807, Tri: 0.0000
2025-04-19 10:58:57,892 - INFO - [DEBUG] ArcFace confidence: 0.5079
2025-04-19 10:58:57,895 - INFO - [DEBUG] Loss Breakdown — ID: 2.2250, SupCon: 3.6893, Tri: 0.0000
2025-04-19 10:58:58,311 - INFO - [DEBUG] ArcFace confidence: 0.5038
2025-04-19 10:58:58,314 - INFO - [DEBUG] Loss Breakdown — ID: 1.8279, SupCon: 3.6390, Tri: 0.0000
2025-04-19 10:58:58,734 - INFO - [DEBUG] ArcFace confidence: 0.5396
2025-04-19 10:58:58,737 - INFO - [DEBUG] Loss Breakdown — ID: 2.1644, SupCon: 3.6061, Tri: 0.0000
2025-04-19 10:58:59,153 - INFO - [DEBUG] ArcFace confidence: 0.5970
2025-04-19 10:58:59,156 - INFO - [DEBUG] Loss Breakdown — ID: 2.1231, SupCon: 3.6324, Tri: 0.0000
2025-04-19 10:58:59,575 - INFO - [DEBUG] ArcFace confidence: 0.4515
2025-04-19 10:58:59,578 - INFO - [DEBUG] Loss Breakdown — ID: 3.1396, SupCon: 3.7039, Tri: 0.0000
2025-04-19 10:58:59,992 - INFO - [DEBUG] ArcFace confidence: 0.4688
2025-04-19 10:58:59,995 - INFO - [DEBUG] Loss Breakdown — ID: 2.2702, SupCon: 3.7584, Tri: 0.0000
2025-04-19 10:59:00,410 - INFO - [DEBUG] ArcFace confidence: 0.5424
2025-04-19 10:59:00,416 - INFO - [DEBUG] Loss Breakdown — ID: 2.2892, SupCon: 3.6725, Tri: 0.0000
2025-04-19 10:59:00,832 - INFO - [DEBUG] ArcFace confidence: 0.5433
2025-04-19 10:59:00,838 - INFO - [DEBUG] Loss Breakdown — ID: 2.7519, SupCon: 3.6608, Tri: 0.0000
2025-04-19 10:59:01,257 - INFO - [DEBUG] ArcFace confidence: 0.5141
2025-04-19 10:59:01,260 - INFO - [DEBUG] Loss Breakdown — ID: 1.8816, SupCon: 3.7246, Tri: 0.0000
2025-04-19 10:59:01,673 - INFO - [DEBUG] ArcFace confidence: 0.5135
2025-04-19 10:59:01,676 - INFO - [DEBUG] Loss Breakdown — ID: 2.0847, SupCon: 3.7094, Tri: 0.0000
2025-04-19 10:59:02,093 - INFO - [DEBUG] ArcFace confidence: 0.5440
2025-04-19 10:59:02,096 - INFO - [DEBUG] Loss Breakdown — ID: 2.8365, SupCon: 3.6610, Tri: 0.0000
2025-04-19 10:59:02,484 - INFO - [DEBUG] ArcFace confidence: 0.5248
2025-04-19 10:59:02,487 - INFO - [DEBUG] Loss Breakdown — ID: 2.5105, SupCon: 3.1904, Tri: 0.0023
2025-04-19 10:59:03,376 - INFO - [Epoch 7] Total Loss=2.6097
2025-04-19 10:59:03,376 - INFO - Validating epoch 7...
2025-04-19 10:59:35,122 - INFO - [Epoch 7] Avg Train Loss = 2.6097 | 
2025-04-19 10:59:35,122 - INFO - ==================== Epoch 7 Validation ====================
2025-04-19 10:59:35,122 - INFO - Validation rank-1    : 89.19%
2025-04-19 10:59:35,122 - INFO - Validation rank-5    : 96.50%
2025-04-19 10:59:35,122 - INFO - Validation rank-10   : 98.76%
2025-04-19 10:59:35,124 - INFO - Validation mAP      : 92.71%
2025-04-19 10:59:35,124 - INFO - ============================================================
2025-04-19 10:59:35,124 - INFO - Saving best model at epoch 7 (Acc@1=89.19%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 10:59:36,440 - INFO -  Epoch 8/20
2025-04-19 10:59:36,440 - INFO - [Epoch 8] Learning rate: 0.000002
2025-04-19 11:00:01,734 - INFO - [DEBUG] ArcFace confidence: 0.4974
2025-04-19 11:00:01,737 - INFO - [DEBUG] Loss Breakdown — ID: 2.7092, SupCon: 3.6641, Tri: 0.0000
2025-04-19 11:00:01,979 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:00:01,979 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:00:02,156 - INFO - [DEBUG] ArcFace confidence: 0.5200
2025-04-19 11:00:02,159 - INFO - [DEBUG] Loss Breakdown — ID: 2.2529, SupCon: 3.5494, Tri: 0.0000
2025-04-19 11:00:02,575 - INFO - [DEBUG] ArcFace confidence: 0.5661
2025-04-19 11:00:02,578 - INFO - [DEBUG] Loss Breakdown — ID: 1.6341, SupCon: 3.6061, Tri: 0.0000
2025-04-19 11:00:02,992 - INFO - [DEBUG] ArcFace confidence: 0.5831
2025-04-19 11:00:02,995 - INFO - [DEBUG] Loss Breakdown — ID: 2.4213, SupCon: 3.7266, Tri: 0.0000
2025-04-19 11:00:03,410 - INFO - [DEBUG] ArcFace confidence: 0.4874
2025-04-19 11:00:03,413 - INFO - [DEBUG] Loss Breakdown — ID: 2.1341, SupCon: 3.6293, Tri: 0.0000
2025-04-19 11:00:03,828 - INFO - [DEBUG] ArcFace confidence: 0.6354
2025-04-19 11:00:03,831 - INFO - [DEBUG] Loss Breakdown — ID: 1.6952, SupCon: 3.7285, Tri: 0.0000
2025-04-19 11:00:04,249 - INFO - [DEBUG] ArcFace confidence: 0.5146
2025-04-19 11:00:04,252 - INFO - [DEBUG] Loss Breakdown — ID: 2.0499, SupCon: 3.5560, Tri: 0.0000
2025-04-19 11:00:04,669 - INFO - [DEBUG] ArcFace confidence: 0.5599
2025-04-19 11:00:04,672 - INFO - [DEBUG] Loss Breakdown — ID: 2.0205, SupCon: 3.6410, Tri: 0.0000
2025-04-19 11:00:05,087 - INFO - [DEBUG] ArcFace confidence: 0.5628
2025-04-19 11:00:05,090 - INFO - [DEBUG] Loss Breakdown — ID: 2.6695, SupCon: 3.6828, Tri: 0.0000
2025-04-19 11:00:05,506 - INFO - [DEBUG] ArcFace confidence: 0.5530
2025-04-19 11:00:05,509 - INFO - [DEBUG] Loss Breakdown — ID: 1.7655, SupCon: 3.4891, Tri: 0.0000
2025-04-19 11:00:05,924 - INFO - [DEBUG] ArcFace confidence: 0.5287
2025-04-19 11:00:05,927 - INFO - [DEBUG] Loss Breakdown — ID: 2.7850, SupCon: 3.6550, Tri: 0.0099
2025-04-19 11:00:06,346 - INFO - [DEBUG] ArcFace confidence: 0.5380
2025-04-19 11:00:06,349 - INFO - [DEBUG] Loss Breakdown — ID: 2.1559, SupCon: 3.6798, Tri: 0.0000
2025-04-19 11:00:06,769 - INFO - [DEBUG] ArcFace confidence: 0.5479
2025-04-19 11:00:06,772 - INFO - [DEBUG] Loss Breakdown — ID: 2.0241, SupCon: 3.6299, Tri: 0.0000
2025-04-19 11:00:07,189 - INFO - [DEBUG] ArcFace confidence: 0.5501
2025-04-19 11:00:07,192 - INFO - [DEBUG] Loss Breakdown — ID: 2.3320, SupCon: 3.7133, Tri: 0.0000
2025-04-19 11:00:07,607 - INFO - [DEBUG] ArcFace confidence: 0.5935
2025-04-19 11:00:07,610 - INFO - [DEBUG] Loss Breakdown — ID: 2.6840, SupCon: 3.7061, Tri: 0.0000
2025-04-19 11:00:08,027 - INFO - [DEBUG] ArcFace confidence: 0.6158
2025-04-19 11:00:08,030 - INFO - [DEBUG] Loss Breakdown — ID: 1.6224, SupCon: 3.7265, Tri: 0.0051
2025-04-19 11:00:08,444 - INFO - [DEBUG] ArcFace confidence: 0.5593
2025-04-19 11:00:08,447 - INFO - [DEBUG] Loss Breakdown — ID: 1.9144, SupCon: 3.5841, Tri: 0.0000
2025-04-19 11:00:08,867 - INFO - [DEBUG] ArcFace confidence: 0.5645
2025-04-19 11:00:08,873 - INFO - [DEBUG] Loss Breakdown — ID: 1.3059, SupCon: 3.7679, Tri: 0.0000
2025-04-19 11:00:09,289 - INFO - [DEBUG] ArcFace confidence: 0.5487
2025-04-19 11:00:09,292 - INFO - [DEBUG] Loss Breakdown — ID: 1.9898, SupCon: 3.7243, Tri: 0.0000
2025-04-19 11:00:09,713 - INFO - [DEBUG] ArcFace confidence: 0.5153
2025-04-19 11:00:09,716 - INFO - [DEBUG] Loss Breakdown — ID: 2.2944, SupCon: 3.5788, Tri: 0.0000
2025-04-19 11:00:10,134 - INFO - [DEBUG] ArcFace confidence: 0.5121
2025-04-19 11:00:10,137 - INFO - [DEBUG] Loss Breakdown — ID: 2.7052, SupCon: 3.7279, Tri: 0.0000
2025-04-19 11:00:10,555 - INFO - [DEBUG] ArcFace confidence: 0.6543
2025-04-19 11:00:10,559 - INFO - [DEBUG] Loss Breakdown — ID: 1.3034, SupCon: 3.6398, Tri: 0.0000
2025-04-19 11:00:10,977 - INFO - [DEBUG] ArcFace confidence: 0.5630
2025-04-19 11:00:10,980 - INFO - [DEBUG] Loss Breakdown — ID: 2.2689, SupCon: 3.6123, Tri: 0.0070
2025-04-19 11:00:11,398 - INFO - [DEBUG] ArcFace confidence: 0.6126
2025-04-19 11:00:11,404 - INFO - [DEBUG] Loss Breakdown — ID: 2.0928, SupCon: 3.6958, Tri: 0.0000
2025-04-19 11:00:11,817 - INFO - [DEBUG] ArcFace confidence: 0.6268
2025-04-19 11:00:11,823 - INFO - [DEBUG] Loss Breakdown — ID: 1.6985, SupCon: 3.6767, Tri: 0.0000
2025-04-19 11:00:12,239 - INFO - [DEBUG] ArcFace confidence: 0.5834
2025-04-19 11:00:12,241 - INFO - [DEBUG] Loss Breakdown — ID: 1.5146, SupCon: 3.6168, Tri: 0.0000
2025-04-19 11:00:12,660 - INFO - [DEBUG] ArcFace confidence: 0.6171
2025-04-19 11:00:12,663 - INFO - [DEBUG] Loss Breakdown — ID: 2.1423, SupCon: 3.5923, Tri: 0.0041
2025-04-19 11:00:13,057 - INFO - [DEBUG] ArcFace confidence: 0.5559
2025-04-19 11:00:13,060 - INFO - [DEBUG] Loss Breakdown — ID: 2.0095, SupCon: 3.3170, Tri: 0.0000
2025-04-19 11:00:13,940 - INFO - [Epoch 8] Total Loss=2.0793
2025-04-19 11:00:13,940 - INFO - Validating epoch 8...
2025-04-19 11:00:46,942 - INFO - [Epoch 8] Avg Train Loss = 2.0793 | 
2025-04-19 11:00:46,942 - INFO - ==================== Epoch 8 Validation ====================
2025-04-19 11:00:46,942 - INFO - Validation rank-1    : 89.39%
2025-04-19 11:00:46,942 - INFO - Validation rank-5    : 95.88%
2025-04-19 11:00:46,942 - INFO - Validation rank-10   : 98.15%
2025-04-19 11:00:46,942 - INFO - Validation mAP      : 92.77%
2025-04-19 11:00:46,942 - INFO - ============================================================
2025-04-19 11:00:46,942 - INFO - Saving best model at epoch 8 (Acc@1=89.39%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:00:48,314 - INFO -  Epoch 9/20
2025-04-19 11:00:48,317 - INFO - [Epoch 9] Learning rate: 0.000001
2025-04-19 11:01:13,327 - INFO - [DEBUG] ArcFace confidence: 0.6012
2025-04-19 11:01:13,333 - INFO - [DEBUG] Loss Breakdown — ID: 1.8013, SupCon: 3.6408, Tri: 0.0000
2025-04-19 11:01:13,574 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:01:13,574 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:01:13,752 - INFO - [DEBUG] ArcFace confidence: 0.6699
2025-04-19 11:01:13,755 - INFO - [DEBUG] Loss Breakdown — ID: 1.3826, SupCon: 3.6977, Tri: 0.0000
2025-04-19 11:01:14,172 - INFO - [DEBUG] ArcFace confidence: 0.6424
2025-04-19 11:01:14,175 - INFO - [DEBUG] Loss Breakdown — ID: 1.7194, SupCon: 3.6674, Tri: 0.0000
2025-04-19 11:01:14,587 - INFO - [DEBUG] ArcFace confidence: 0.6796
2025-04-19 11:01:14,593 - INFO - [DEBUG] Loss Breakdown — ID: 1.2267, SupCon: 3.5856, Tri: 0.0000
2025-04-19 11:01:15,006 - INFO - [DEBUG] ArcFace confidence: 0.6708
2025-04-19 11:01:15,009 - INFO - [DEBUG] Loss Breakdown — ID: 1.4842, SupCon: 3.6311, Tri: 0.0000
2025-04-19 11:01:15,428 - INFO - [DEBUG] ArcFace confidence: 0.5112
2025-04-19 11:01:15,434 - INFO - [DEBUG] Loss Breakdown — ID: 2.5272, SupCon: 3.5857, Tri: 0.0000
2025-04-19 11:01:15,848 - INFO - [DEBUG] ArcFace confidence: 0.6068
2025-04-19 11:01:15,851 - INFO - [DEBUG] Loss Breakdown — ID: 1.8342, SupCon: 3.4836, Tri: 0.0000
2025-04-19 11:01:16,267 - INFO - [DEBUG] ArcFace confidence: 0.6081
2025-04-19 11:01:16,271 - INFO - [DEBUG] Loss Breakdown — ID: 1.7533, SupCon: 3.6264, Tri: 0.0000
2025-04-19 11:01:16,687 - INFO - [DEBUG] ArcFace confidence: 0.6099
2025-04-19 11:01:16,690 - INFO - [DEBUG] Loss Breakdown — ID: 1.7402, SupCon: 3.5973, Tri: 0.0000
2025-04-19 11:01:17,107 - INFO - [DEBUG] ArcFace confidence: 0.5697
2025-04-19 11:01:17,110 - INFO - [DEBUG] Loss Breakdown — ID: 1.4849, SupCon: 3.5811, Tri: 0.0000
2025-04-19 11:01:17,527 - INFO - [DEBUG] ArcFace confidence: 0.6887
2025-04-19 11:01:17,530 - INFO - [DEBUG] Loss Breakdown — ID: 1.2478, SupCon: 3.6749, Tri: 0.0000
2025-04-19 11:01:17,946 - INFO - [DEBUG] ArcFace confidence: 0.6096
2025-04-19 11:01:17,949 - INFO - [DEBUG] Loss Breakdown — ID: 1.4715, SupCon: 3.7222, Tri: 0.0000
2025-04-19 11:01:18,363 - INFO - [DEBUG] ArcFace confidence: 0.6311
2025-04-19 11:01:18,369 - INFO - [DEBUG] Loss Breakdown — ID: 1.6874, SupCon: 3.5996, Tri: 0.0000
2025-04-19 11:01:18,783 - INFO - [DEBUG] ArcFace confidence: 0.6371
2025-04-19 11:01:18,789 - INFO - [DEBUG] Loss Breakdown — ID: 1.3568, SupCon: 3.7072, Tri: 0.0000
2025-04-19 11:01:19,204 - INFO - [DEBUG] ArcFace confidence: 0.5525
2025-04-19 11:01:19,210 - INFO - [DEBUG] Loss Breakdown — ID: 2.1561, SupCon: 3.6733, Tri: 0.0000
2025-04-19 11:01:19,627 - INFO - [DEBUG] ArcFace confidence: 0.6559
2025-04-19 11:01:19,630 - INFO - [DEBUG] Loss Breakdown — ID: 1.9849, SupCon: 3.6901, Tri: 0.0000
2025-04-19 11:01:20,047 - INFO - [DEBUG] ArcFace confidence: 0.6980
2025-04-19 11:01:20,053 - INFO - [DEBUG] Loss Breakdown — ID: 1.5319, SupCon: 3.7032, Tri: 0.0000
2025-04-19 11:01:20,469 - INFO - [DEBUG] ArcFace confidence: 0.6234
2025-04-19 11:01:20,472 - INFO - [DEBUG] Loss Breakdown — ID: 1.7265, SupCon: 3.6666, Tri: 0.0000
2025-04-19 11:01:20,888 - INFO - [DEBUG] ArcFace confidence: 0.6069
2025-04-19 11:01:20,894 - INFO - [DEBUG] Loss Breakdown — ID: 1.9218, SupCon: 3.7237, Tri: 0.0000
2025-04-19 11:01:21,310 - INFO - [DEBUG] ArcFace confidence: 0.6114
2025-04-19 11:01:21,313 - INFO - [DEBUG] Loss Breakdown — ID: 1.4932, SupCon: 3.6854, Tri: 0.0000
2025-04-19 11:01:21,731 - INFO - [DEBUG] ArcFace confidence: 0.5953
2025-04-19 11:01:21,734 - INFO - [DEBUG] Loss Breakdown — ID: 2.0870, SupCon: 3.6124, Tri: 0.0000
2025-04-19 11:01:22,155 - INFO - [DEBUG] ArcFace confidence: 0.6403
2025-04-19 11:01:22,158 - INFO - [DEBUG] Loss Breakdown — ID: 1.3495, SupCon: 3.5795, Tri: 0.0000
2025-04-19 11:01:22,577 - INFO - [DEBUG] ArcFace confidence: 0.5941
2025-04-19 11:01:22,580 - INFO - [DEBUG] Loss Breakdown — ID: 1.8922, SupCon: 3.6117, Tri: 0.0000
2025-04-19 11:01:22,996 - INFO - [DEBUG] ArcFace confidence: 0.6235
2025-04-19 11:01:22,999 - INFO - [DEBUG] Loss Breakdown — ID: 1.7897, SupCon: 3.6115, Tri: 0.0000
2025-04-19 11:01:23,416 - INFO - [DEBUG] ArcFace confidence: 0.6231
2025-04-19 11:01:23,422 - INFO - [DEBUG] Loss Breakdown — ID: 2.0134, SupCon: 3.6699, Tri: 0.0000
2025-04-19 11:01:23,839 - INFO - [DEBUG] ArcFace confidence: 0.6660
2025-04-19 11:01:23,842 - INFO - [DEBUG] Loss Breakdown — ID: 1.6079, SupCon: 3.8026, Tri: 0.0000
2025-04-19 11:01:24,259 - INFO - [DEBUG] ArcFace confidence: 0.6968
2025-04-19 11:01:24,265 - INFO - [DEBUG] Loss Breakdown — ID: 1.2600, SupCon: 3.5720, Tri: 0.0000
2025-04-19 11:01:24,651 - INFO - [DEBUG] ArcFace confidence: 0.5431
2025-04-19 11:01:24,657 - INFO - [DEBUG] Loss Breakdown — ID: 1.8932, SupCon: 3.4927, Tri: 0.0000
2025-04-19 11:01:25,536 - INFO - [Epoch 9] Total Loss=1.6937
2025-04-19 11:01:25,539 - INFO - Validating epoch 9...
2025-04-19 11:01:56,871 - INFO - [Epoch 9] Avg Train Loss = 1.6937 | 
2025-04-19 11:01:56,871 - INFO - ==================== Epoch 9 Validation ====================
2025-04-19 11:01:56,871 - INFO - Validation rank-1    : 89.50%
2025-04-19 11:01:56,871 - INFO - Validation rank-5    : 97.01%
2025-04-19 11:01:56,871 - INFO - Validation rank-10   : 97.94%
2025-04-19 11:01:56,871 - INFO - Validation mAP      : 92.81%
2025-04-19 11:01:56,871 - INFO - ============================================================
2025-04-19 11:01:56,871 - INFO - Saving best model at epoch 9 (Acc@1=89.50%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:01:58,188 - INFO -  Epoch 10/20
2025-04-19 11:01:58,188 - INFO - [Epoch 10] Learning rate: 0.000001
2025-04-19 11:02:22,914 - INFO - [DEBUG] ArcFace confidence: 0.5358
2025-04-19 11:02:22,917 - INFO - [DEBUG] Loss Breakdown — ID: 1.6208, SupCon: 3.5342, Tri: 0.0000
2025-04-19 11:02:23,160 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:02:23,163 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:02:23,337 - INFO - [DEBUG] ArcFace confidence: 0.6678
2025-04-19 11:02:23,343 - INFO - [DEBUG] Loss Breakdown — ID: 1.7630, SupCon: 3.6110, Tri: 0.0000
2025-04-19 11:02:23,759 - INFO - [DEBUG] ArcFace confidence: 0.6691
2025-04-19 11:02:23,762 - INFO - [DEBUG] Loss Breakdown — ID: 1.5100, SupCon: 3.6641, Tri: 0.0000
2025-04-19 11:02:24,176 - INFO - [DEBUG] ArcFace confidence: 0.7082
2025-04-19 11:02:24,179 - INFO - [DEBUG] Loss Breakdown — ID: 1.5795, SupCon: 3.7467, Tri: 0.0000
2025-04-19 11:02:24,597 - INFO - [DEBUG] ArcFace confidence: 0.5382
2025-04-19 11:02:24,600 - INFO - [DEBUG] Loss Breakdown — ID: 1.6781, SupCon: 3.6243, Tri: 0.0000
2025-04-19 11:02:25,016 - INFO - [DEBUG] ArcFace confidence: 0.6327
2025-04-19 11:02:25,022 - INFO - [DEBUG] Loss Breakdown — ID: 1.5796, SupCon: 3.7944, Tri: 0.0000
2025-04-19 11:02:25,438 - INFO - [DEBUG] ArcFace confidence: 0.6877
2025-04-19 11:02:25,441 - INFO - [DEBUG] Loss Breakdown — ID: 1.1992, SupCon: 3.6610, Tri: 0.0000
2025-04-19 11:02:25,855 - INFO - [DEBUG] ArcFace confidence: 0.6628
2025-04-19 11:02:25,858 - INFO - [DEBUG] Loss Breakdown — ID: 1.2799, SupCon: 3.6352, Tri: 0.0000
2025-04-19 11:02:26,275 - INFO - [DEBUG] ArcFace confidence: 0.5845
2025-04-19 11:02:26,278 - INFO - [DEBUG] Loss Breakdown — ID: 1.6068, SupCon: 3.7155, Tri: 0.0000
2025-04-19 11:02:26,694 - INFO - [DEBUG] ArcFace confidence: 0.7079
2025-04-19 11:02:26,697 - INFO - [DEBUG] Loss Breakdown — ID: 1.2988, SupCon: 3.5988, Tri: 0.0000
2025-04-19 11:02:27,112 - INFO - [DEBUG] ArcFace confidence: 0.6317
2025-04-19 11:02:27,118 - INFO - [DEBUG] Loss Breakdown — ID: 1.6826, SupCon: 3.6159, Tri: 0.0000
2025-04-19 11:02:27,534 - INFO - [DEBUG] ArcFace confidence: 0.7217
2025-04-19 11:02:27,537 - INFO - [DEBUG] Loss Breakdown — ID: 1.3360, SupCon: 3.6955, Tri: 0.0000
2025-04-19 11:02:27,956 - INFO - [DEBUG] ArcFace confidence: 0.6553
2025-04-19 11:02:27,959 - INFO - [DEBUG] Loss Breakdown — ID: 1.7644, SupCon: 3.6224, Tri: 0.0000
2025-04-19 11:02:28,376 - INFO - [DEBUG] ArcFace confidence: 0.6303
2025-04-19 11:02:28,379 - INFO - [DEBUG] Loss Breakdown — ID: 1.3306, SupCon: 3.7179, Tri: 0.0000
2025-04-19 11:02:28,794 - INFO - [DEBUG] ArcFace confidence: 0.6639
2025-04-19 11:02:28,797 - INFO - [DEBUG] Loss Breakdown — ID: 1.3394, SupCon: 3.7034, Tri: 0.0000
2025-04-19 11:02:29,214 - INFO - [DEBUG] ArcFace confidence: 0.6708
2025-04-19 11:02:29,217 - INFO - [DEBUG] Loss Breakdown — ID: 1.2836, SupCon: 3.7008, Tri: 0.0000
2025-04-19 11:02:29,636 - INFO - [DEBUG] ArcFace confidence: 0.6589
2025-04-19 11:02:29,640 - INFO - [DEBUG] Loss Breakdown — ID: 1.4318, SupCon: 3.5659, Tri: 0.0000
2025-04-19 11:02:30,058 - INFO - [DEBUG] ArcFace confidence: 0.6486
2025-04-19 11:02:30,060 - INFO - [DEBUG] Loss Breakdown — ID: 1.4558, SupCon: 3.6805, Tri: 0.0000
2025-04-19 11:02:30,482 - INFO - [DEBUG] ArcFace confidence: 0.7474
2025-04-19 11:02:30,485 - INFO - [DEBUG] Loss Breakdown — ID: 1.3835, SupCon: 3.7052, Tri: 0.0000
2025-04-19 11:02:30,904 - INFO - [DEBUG] ArcFace confidence: 0.6814
2025-04-19 11:02:30,907 - INFO - [DEBUG] Loss Breakdown — ID: 1.4243, SupCon: 3.7620, Tri: 0.0000
2025-04-19 11:02:31,322 - INFO - [DEBUG] ArcFace confidence: 0.6352
2025-04-19 11:02:31,325 - INFO - [DEBUG] Loss Breakdown — ID: 1.7308, SupCon: 3.4733, Tri: 0.0000
2025-04-19 11:02:31,743 - INFO - [DEBUG] ArcFace confidence: 0.6788
2025-04-19 11:02:31,746 - INFO - [DEBUG] Loss Breakdown — ID: 1.4927, SupCon: 3.6264, Tri: 0.0000
2025-04-19 11:02:32,163 - INFO - [DEBUG] ArcFace confidence: 0.6829
2025-04-19 11:02:32,166 - INFO - [DEBUG] Loss Breakdown — ID: 1.3832, SupCon: 3.6919, Tri: 0.0000
2025-04-19 11:02:32,585 - INFO - [DEBUG] ArcFace confidence: 0.6437
2025-04-19 11:02:32,588 - INFO - [DEBUG] Loss Breakdown — ID: 1.7196, SupCon: 3.7142, Tri: 0.0004
2025-04-19 11:02:33,004 - INFO - [DEBUG] ArcFace confidence: 0.7133
2025-04-19 11:02:33,007 - INFO - [DEBUG] Loss Breakdown — ID: 1.0768, SupCon: 3.5951, Tri: 0.0000
2025-04-19 11:02:33,424 - INFO - [DEBUG] ArcFace confidence: 0.7251
2025-04-19 11:02:33,427 - INFO - [DEBUG] Loss Breakdown — ID: 1.3875, SupCon: 3.4642, Tri: 0.0000
2025-04-19 11:02:33,842 - INFO - [DEBUG] ArcFace confidence: 0.5861
2025-04-19 11:02:33,845 - INFO - [DEBUG] Loss Breakdown — ID: 1.7391, SupCon: 3.6483, Tri: 0.0000
2025-04-19 11:02:34,233 - INFO - [DEBUG] ArcFace confidence: 0.6191
2025-04-19 11:02:34,239 - INFO - [DEBUG] Loss Breakdown — ID: 1.4864, SupCon: 3.4022, Tri: 0.0000
2025-04-19 11:02:35,115 - INFO - [Epoch 10] Total Loss=1.4844
2025-04-19 11:02:35,115 - INFO - Validating epoch 10...
2025-04-19 11:03:06,780 - INFO - [Epoch 10] Avg Train Loss = 1.4844 | 
2025-04-19 11:03:06,780 - INFO - ==================== Epoch 10 Validation ====================
2025-04-19 11:03:06,780 - INFO - Validation rank-1    : 90.11%
2025-04-19 11:03:06,780 - INFO - Validation rank-5    : 97.01%
2025-04-19 11:03:06,780 - INFO - Validation rank-10   : 98.25%
2025-04-19 11:03:06,780 - INFO - Validation mAP      : 93.37%
2025-04-19 11:03:06,780 - INFO - ============================================================
2025-04-19 11:03:06,780 - INFO - Saving best model at epoch 10 (Acc@1=90.11%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:03:08,130 - INFO -  Epoch 11/20
2025-04-19 11:03:08,130 - INFO - [Epoch 11] Learning rate: 0.000001
2025-04-19 11:03:32,685 - INFO - [DEBUG] ArcFace confidence: 0.7586
2025-04-19 11:03:32,691 - INFO - [DEBUG] Loss Breakdown — ID: 1.1478, SupCon: 3.5703, Tri: 0.0000
2025-04-19 11:03:32,932 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:03:32,932 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:03:33,109 - INFO - [DEBUG] ArcFace confidence: 0.6995
2025-04-19 11:03:33,112 - INFO - [DEBUG] Loss Breakdown — ID: 1.3028, SupCon: 3.6247, Tri: 0.0000
2025-04-19 11:03:33,529 - INFO - [DEBUG] ArcFace confidence: 0.6262
2025-04-19 11:03:33,532 - INFO - [DEBUG] Loss Breakdown — ID: 1.4638, SupCon: 3.6407, Tri: 0.0000
2025-04-19 11:03:33,949 - INFO - [DEBUG] ArcFace confidence: 0.7241
2025-04-19 11:03:33,952 - INFO - [DEBUG] Loss Breakdown — ID: 1.4997, SupCon: 3.6055, Tri: 0.0000
2025-04-19 11:03:34,365 - INFO - [DEBUG] ArcFace confidence: 0.7459
2025-04-19 11:03:34,371 - INFO - [DEBUG] Loss Breakdown — ID: 1.1672, SupCon: 3.6264, Tri: 0.0000
2025-04-19 11:03:34,784 - INFO - [DEBUG] ArcFace confidence: 0.7781
2025-04-19 11:03:34,787 - INFO - [DEBUG] Loss Breakdown — ID: 0.9882, SupCon: 3.5953, Tri: 0.0000
2025-04-19 11:03:35,201 - INFO - [DEBUG] ArcFace confidence: 0.7037
2025-04-19 11:03:35,204 - INFO - [DEBUG] Loss Breakdown — ID: 1.2631, SupCon: 3.6777, Tri: 0.0000
2025-04-19 11:03:35,622 - INFO - [DEBUG] ArcFace confidence: 0.7203
2025-04-19 11:03:35,625 - INFO - [DEBUG] Loss Breakdown — ID: 1.2046, SupCon: 3.7684, Tri: 0.0000
2025-04-19 11:03:36,040 - INFO - [DEBUG] ArcFace confidence: 0.6669
2025-04-19 11:03:36,046 - INFO - [DEBUG] Loss Breakdown — ID: 1.3655, SupCon: 3.6634, Tri: 0.0000
2025-04-19 11:03:36,463 - INFO - [DEBUG] ArcFace confidence: 0.7698
2025-04-19 11:03:36,466 - INFO - [DEBUG] Loss Breakdown — ID: 0.9975, SupCon: 3.6489, Tri: 0.0000
2025-04-19 11:03:36,881 - INFO - [DEBUG] ArcFace confidence: 0.6717
2025-04-19 11:03:36,884 - INFO - [DEBUG] Loss Breakdown — ID: 1.3846, SupCon: 3.6488, Tri: 0.0000
2025-04-19 11:03:37,297 - INFO - [DEBUG] ArcFace confidence: 0.6770
2025-04-19 11:03:37,303 - INFO - [DEBUG] Loss Breakdown — ID: 1.5666, SupCon: 3.5769, Tri: 0.0000
2025-04-19 11:03:37,716 - INFO - [DEBUG] ArcFace confidence: 0.7610
2025-04-19 11:03:37,719 - INFO - [DEBUG] Loss Breakdown — ID: 1.3531, SupCon: 3.6659, Tri: 0.0000
2025-04-19 11:03:38,138 - INFO - [DEBUG] ArcFace confidence: 0.6938
2025-04-19 11:03:38,141 - INFO - [DEBUG] Loss Breakdown — ID: 1.3974, SupCon: 3.6810, Tri: 0.0000
2025-04-19 11:03:38,561 - INFO - [DEBUG] ArcFace confidence: 0.7013
2025-04-19 11:03:38,564 - INFO - [DEBUG] Loss Breakdown — ID: 1.2889, SupCon: 3.7228, Tri: 0.0000
2025-04-19 11:03:38,981 - INFO - [DEBUG] ArcFace confidence: 0.6673
2025-04-19 11:03:38,984 - INFO - [DEBUG] Loss Breakdown — ID: 1.6243, SupCon: 3.5393, Tri: 0.0000
2025-04-19 11:03:39,401 - INFO - [DEBUG] ArcFace confidence: 0.7458
2025-04-19 11:03:39,404 - INFO - [DEBUG] Loss Breakdown — ID: 1.0145, SupCon: 3.7524, Tri: 0.0000
2025-04-19 11:03:39,821 - INFO - [DEBUG] ArcFace confidence: 0.6980
2025-04-19 11:03:39,827 - INFO - [DEBUG] Loss Breakdown — ID: 1.5006, SupCon: 3.5480, Tri: 0.0000
2025-04-19 11:03:40,245 - INFO - [DEBUG] ArcFace confidence: 0.6308
2025-04-19 11:03:40,248 - INFO - [DEBUG] Loss Breakdown — ID: 1.5158, SupCon: 3.6588, Tri: 0.0000
2025-04-19 11:03:40,667 - INFO - [DEBUG] ArcFace confidence: 0.7054
2025-04-19 11:03:40,670 - INFO - [DEBUG] Loss Breakdown — ID: 1.2256, SupCon: 3.8095, Tri: 0.0000
2025-04-19 11:03:41,087 - INFO - [DEBUG] ArcFace confidence: 0.7130
2025-04-19 11:03:41,090 - INFO - [DEBUG] Loss Breakdown — ID: 1.0855, SupCon: 3.6842, Tri: 0.0000
2025-04-19 11:03:41,506 - INFO - [DEBUG] ArcFace confidence: 0.7372
2025-04-19 11:03:41,509 - INFO - [DEBUG] Loss Breakdown — ID: 1.3713, SupCon: 3.6719, Tri: 0.0000
2025-04-19 11:03:41,925 - INFO - [DEBUG] ArcFace confidence: 0.7464
2025-04-19 11:03:41,928 - INFO - [DEBUG] Loss Breakdown — ID: 1.0217, SupCon: 3.7683, Tri: 0.0000
2025-04-19 11:03:42,342 - INFO - [DEBUG] ArcFace confidence: 0.6635
2025-04-19 11:03:42,345 - INFO - [DEBUG] Loss Breakdown — ID: 1.7939, SupCon: 3.6621, Tri: 0.0000
2025-04-19 11:03:42,759 - INFO - [DEBUG] ArcFace confidence: 0.6626
2025-04-19 11:03:42,762 - INFO - [DEBUG] Loss Breakdown — ID: 1.3569, SupCon: 3.6018, Tri: 0.0000
2025-04-19 11:03:43,180 - INFO - [DEBUG] ArcFace confidence: 0.6587
2025-04-19 11:03:43,183 - INFO - [DEBUG] Loss Breakdown — ID: 1.5483, SupCon: 3.6766, Tri: 0.0000
2025-04-19 11:03:43,599 - INFO - [DEBUG] ArcFace confidence: 0.6613
2025-04-19 11:03:43,602 - INFO - [DEBUG] Loss Breakdown — ID: 1.2794, SupCon: 3.6101, Tri: 0.0000
2025-04-19 11:03:43,991 - INFO - [DEBUG] ArcFace confidence: 0.6748
2025-04-19 11:03:43,994 - INFO - [DEBUG] Loss Breakdown — ID: 1.2773, SupCon: 3.3763, Tri: 0.0000
2025-04-19 11:03:44,864 - INFO - [Epoch 11] Total Loss=1.3216
2025-04-19 11:03:44,864 - INFO - Validating epoch 11...
2025-04-19 11:04:15,853 - INFO - [Epoch 11] Avg Train Loss = 1.3216 | 
2025-04-19 11:04:15,853 - INFO - ==================== Epoch 11 Validation ====================
2025-04-19 11:04:15,853 - INFO - Validation rank-1    : 89.91%
2025-04-19 11:04:15,853 - INFO - Validation rank-5    : 96.91%
2025-04-19 11:04:15,853 - INFO - Validation rank-10   : 97.94%
2025-04-19 11:04:15,853 - INFO - Validation mAP      : 93.19%
2025-04-19 11:04:15,853 - INFO - ============================================================
2025-04-19 11:04:15,853 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 11:04:15,853 - INFO -  Epoch 12/20
2025-04-19 11:04:15,856 - INFO - [Epoch 12] Learning rate: 0.000001
2025-04-19 11:04:40,058 - INFO - [DEBUG] ArcFace confidence: 0.7349
2025-04-19 11:04:40,061 - INFO - [DEBUG] Loss Breakdown — ID: 1.2217, SupCon: 3.6440, Tri: 0.0000
2025-04-19 11:04:40,304 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:04:40,307 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:04:40,481 - INFO - [DEBUG] ArcFace confidence: 0.7624
2025-04-19 11:04:40,484 - INFO - [DEBUG] Loss Breakdown — ID: 0.9703, SupCon: 3.6665, Tri: 0.0000
2025-04-19 11:04:40,901 - INFO - [DEBUG] ArcFace confidence: 0.7602
2025-04-19 11:04:40,904 - INFO - [DEBUG] Loss Breakdown — ID: 1.1094, SupCon: 3.5958, Tri: 0.0000
2025-04-19 11:04:41,320 - INFO - [DEBUG] ArcFace confidence: 0.7398
2025-04-19 11:04:41,326 - INFO - [DEBUG] Loss Breakdown — ID: 1.1388, SupCon: 3.5480, Tri: 0.0000
2025-04-19 11:04:41,740 - INFO - [DEBUG] ArcFace confidence: 0.7486
2025-04-19 11:04:41,746 - INFO - [DEBUG] Loss Breakdown — ID: 1.0333, SupCon: 3.5335, Tri: 0.0000
2025-04-19 11:04:42,160 - INFO - [DEBUG] ArcFace confidence: 0.7195
2025-04-19 11:04:42,163 - INFO - [DEBUG] Loss Breakdown — ID: 1.0467, SupCon: 3.7314, Tri: 0.0000
2025-04-19 11:04:42,580 - INFO - [DEBUG] ArcFace confidence: 0.6917
2025-04-19 11:04:42,583 - INFO - [DEBUG] Loss Breakdown — ID: 1.4899, SupCon: 3.6808, Tri: 0.0000
2025-04-19 11:04:42,999 - INFO - [DEBUG] ArcFace confidence: 0.7137
2025-04-19 11:04:43,002 - INFO - [DEBUG] Loss Breakdown — ID: 1.3320, SupCon: 3.7430, Tri: 0.0000
2025-04-19 11:04:43,419 - INFO - [DEBUG] ArcFace confidence: 0.7371
2025-04-19 11:04:43,422 - INFO - [DEBUG] Loss Breakdown — ID: 1.0637, SupCon: 3.7276, Tri: 0.0000
2025-04-19 11:04:43,838 - INFO - [DEBUG] ArcFace confidence: 0.7847
2025-04-19 11:04:43,844 - INFO - [DEBUG] Loss Breakdown — ID: 1.1114, SupCon: 3.6362, Tri: 0.0000
2025-04-19 11:04:44,261 - INFO - [DEBUG] ArcFace confidence: 0.7251
2025-04-19 11:04:44,264 - INFO - [DEBUG] Loss Breakdown — ID: 1.0666, SupCon: 3.7091, Tri: 0.0000
2025-04-19 11:04:44,680 - INFO - [DEBUG] ArcFace confidence: 0.7176
2025-04-19 11:04:44,683 - INFO - [DEBUG] Loss Breakdown — ID: 1.2358, SupCon: 3.6704, Tri: 0.0000
2025-04-19 11:04:45,099 - INFO - [DEBUG] ArcFace confidence: 0.6461
2025-04-19 11:04:45,102 - INFO - [DEBUG] Loss Breakdown — ID: 1.3464, SupCon: 3.5426, Tri: 0.0000
2025-04-19 11:04:45,519 - INFO - [DEBUG] ArcFace confidence: 0.6892
2025-04-19 11:04:45,522 - INFO - [DEBUG] Loss Breakdown — ID: 1.1117, SupCon: 3.5470, Tri: 0.0000
2025-04-19 11:04:45,940 - INFO - [DEBUG] ArcFace confidence: 0.6671
2025-04-19 11:04:45,943 - INFO - [DEBUG] Loss Breakdown — ID: 1.3565, SupCon: 3.7213, Tri: 0.0000
2025-04-19 11:04:46,360 - INFO - [DEBUG] ArcFace confidence: 0.7414
2025-04-19 11:04:46,366 - INFO - [DEBUG] Loss Breakdown — ID: 1.0585, SupCon: 3.7322, Tri: 0.0000
2025-04-19 11:04:46,783 - INFO - [DEBUG] ArcFace confidence: 0.7462
2025-04-19 11:04:46,786 - INFO - [DEBUG] Loss Breakdown — ID: 1.1553, SupCon: 3.6301, Tri: 0.0000
2025-04-19 11:04:47,202 - INFO - [DEBUG] ArcFace confidence: 0.6356
2025-04-19 11:04:47,205 - INFO - [DEBUG] Loss Breakdown — ID: 1.2303, SupCon: 3.7266, Tri: 0.0005
2025-04-19 11:04:47,624 - INFO - [DEBUG] ArcFace confidence: 0.7411
2025-04-19 11:04:47,627 - INFO - [DEBUG] Loss Breakdown — ID: 1.2445, SupCon: 3.7494, Tri: 0.0000
2025-04-19 11:04:48,051 - INFO - [DEBUG] ArcFace confidence: 0.7541
2025-04-19 11:04:48,054 - INFO - [DEBUG] Loss Breakdown — ID: 1.3503, SupCon: 3.7688, Tri: 0.0000
2025-04-19 11:04:48,472 - INFO - [DEBUG] ArcFace confidence: 0.7552
2025-04-19 11:04:48,475 - INFO - [DEBUG] Loss Breakdown — ID: 1.0600, SupCon: 3.6964, Tri: 0.0000
2025-04-19 11:04:48,893 - INFO - [DEBUG] ArcFace confidence: 0.6699
2025-04-19 11:04:48,896 - INFO - [DEBUG] Loss Breakdown — ID: 1.3048, SupCon: 3.6345, Tri: 0.0000
2025-04-19 11:04:49,317 - INFO - [DEBUG] ArcFace confidence: 0.6809
2025-04-19 11:04:49,320 - INFO - [DEBUG] Loss Breakdown — ID: 1.5820, SupCon: 3.6846, Tri: 0.0000
2025-04-19 11:04:49,737 - INFO - [DEBUG] ArcFace confidence: 0.7482
2025-04-19 11:04:49,740 - INFO - [DEBUG] Loss Breakdown — ID: 1.2116, SupCon: 3.7578, Tri: 0.0000
2025-04-19 11:04:50,159 - INFO - [DEBUG] ArcFace confidence: 0.7397
2025-04-19 11:04:50,162 - INFO - [DEBUG] Loss Breakdown — ID: 1.0176, SupCon: 3.5750, Tri: 0.0000
2025-04-19 11:04:50,579 - INFO - [DEBUG] ArcFace confidence: 0.7463
2025-04-19 11:04:50,582 - INFO - [DEBUG] Loss Breakdown — ID: 1.1208, SupCon: 3.7074, Tri: 0.0000
2025-04-19 11:04:50,999 - INFO - [DEBUG] ArcFace confidence: 0.6869
2025-04-19 11:04:51,002 - INFO - [DEBUG] Loss Breakdown — ID: 1.1655, SupCon: 3.6428, Tri: 0.0000
2025-04-19 11:04:51,391 - INFO - [DEBUG] ArcFace confidence: 0.5866
2025-04-19 11:04:51,394 - INFO - [DEBUG] Loss Breakdown — ID: 1.6342, SupCon: 3.5199, Tri: 0.0000
2025-04-19 11:04:52,288 - INFO - [Epoch 12] Total Loss=1.2061
2025-04-19 11:04:52,288 - INFO - Validating epoch 12...
2025-04-19 11:05:23,385 - INFO - [Epoch 12] Avg Train Loss = 1.2061 | 
2025-04-19 11:05:23,385 - INFO - ==================== Epoch 12 Validation ====================
2025-04-19 11:05:23,385 - INFO - Validation rank-1    : 89.60%
2025-04-19 11:05:23,385 - INFO - Validation rank-5    : 96.91%
2025-04-19 11:05:23,385 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:05:23,385 - INFO - Validation mAP      : 92.96%
2025-04-19 11:05:23,385 - INFO - ============================================================
2025-04-19 11:05:23,385 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 11:05:23,388 - INFO -  Epoch 13/20
2025-04-19 11:05:23,388 - INFO - [Epoch 13] Learning rate: 0.000001
2025-04-19 11:05:47,431 - INFO - [DEBUG] ArcFace confidence: 0.7329
2025-04-19 11:05:47,434 - INFO - [DEBUG] Loss Breakdown — ID: 1.0750, SupCon: 3.7189, Tri: 0.0000
2025-04-19 11:05:47,678 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:05:47,678 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:05:47,852 - INFO - [DEBUG] ArcFace confidence: 0.7156
2025-04-19 11:05:47,858 - INFO - [DEBUG] Loss Breakdown — ID: 1.1736, SupCon: 3.6357, Tri: 0.0000
2025-04-19 11:05:48,271 - INFO - [DEBUG] ArcFace confidence: 0.7518
2025-04-19 11:05:48,276 - INFO - [DEBUG] Loss Breakdown — ID: 1.2515, SupCon: 3.6147, Tri: 0.0000
2025-04-19 11:05:48,693 - INFO - [DEBUG] ArcFace confidence: 0.6891
2025-04-19 11:05:48,696 - INFO - [DEBUG] Loss Breakdown — ID: 1.2367, SupCon: 3.5268, Tri: 0.0000
2025-04-19 11:05:49,109 - INFO - [DEBUG] ArcFace confidence: 0.7233
2025-04-19 11:05:49,112 - INFO - [DEBUG] Loss Breakdown — ID: 1.3385, SupCon: 3.7315, Tri: 0.0000
2025-04-19 11:05:49,524 - INFO - [DEBUG] ArcFace confidence: 0.7486
2025-04-19 11:05:49,531 - INFO - [DEBUG] Loss Breakdown — ID: 1.2360, SupCon: 3.5976, Tri: 0.0000
2025-04-19 11:05:49,946 - INFO - [DEBUG] ArcFace confidence: 0.7378
2025-04-19 11:05:49,949 - INFO - [DEBUG] Loss Breakdown — ID: 1.1003, SupCon: 3.5816, Tri: 0.0000
2025-04-19 11:05:50,363 - INFO - [DEBUG] ArcFace confidence: 0.7580
2025-04-19 11:05:50,366 - INFO - [DEBUG] Loss Breakdown — ID: 1.0176, SupCon: 3.6021, Tri: 0.0000
2025-04-19 11:05:50,782 - INFO - [DEBUG] ArcFace confidence: 0.6805
2025-04-19 11:05:50,784 - INFO - [DEBUG] Loss Breakdown — ID: 1.1525, SupCon: 3.6459, Tri: 0.0000
2025-04-19 11:05:51,200 - INFO - [DEBUG] ArcFace confidence: 0.7833
2025-04-19 11:05:51,203 - INFO - [DEBUG] Loss Breakdown — ID: 0.9929, SupCon: 3.6074, Tri: 0.0000
2025-04-19 11:05:51,618 - INFO - [DEBUG] ArcFace confidence: 0.6121
2025-04-19 11:05:51,621 - INFO - [DEBUG] Loss Breakdown — ID: 1.7430, SupCon: 3.6814, Tri: 0.0000
2025-04-19 11:05:52,035 - INFO - [DEBUG] ArcFace confidence: 0.7569
2025-04-19 11:05:52,041 - INFO - [DEBUG] Loss Breakdown — ID: 1.1789, SupCon: 3.5529, Tri: 0.0000
2025-04-19 11:05:52,456 - INFO - [DEBUG] ArcFace confidence: 0.7663
2025-04-19 11:05:52,462 - INFO - [DEBUG] Loss Breakdown — ID: 1.1584, SupCon: 3.6160, Tri: 0.0000
2025-04-19 11:05:52,878 - INFO - [DEBUG] ArcFace confidence: 0.7450
2025-04-19 11:05:52,881 - INFO - [DEBUG] Loss Breakdown — ID: 1.1673, SupCon: 3.6820, Tri: 0.0000
2025-04-19 11:05:53,300 - INFO - [DEBUG] ArcFace confidence: 0.7504
2025-04-19 11:05:53,303 - INFO - [DEBUG] Loss Breakdown — ID: 1.1630, SupCon: 3.6772, Tri: 0.0000
2025-04-19 11:05:53,720 - INFO - [DEBUG] ArcFace confidence: 0.7309
2025-04-19 11:05:53,726 - INFO - [DEBUG] Loss Breakdown — ID: 1.1804, SupCon: 3.6139, Tri: 0.0000
2025-04-19 11:05:54,141 - INFO - [DEBUG] ArcFace confidence: 0.7983
2025-04-19 11:05:54,144 - INFO - [DEBUG] Loss Breakdown — ID: 0.9384, SupCon: 3.6530, Tri: 0.0000
2025-04-19 11:05:54,561 - INFO - [DEBUG] ArcFace confidence: 0.7859
2025-04-19 11:05:54,564 - INFO - [DEBUG] Loss Breakdown — ID: 1.0524, SupCon: 3.7870, Tri: 0.0000
2025-04-19 11:05:54,979 - INFO - [DEBUG] ArcFace confidence: 0.7665
2025-04-19 11:05:54,982 - INFO - [DEBUG] Loss Breakdown — ID: 1.0205, SupCon: 3.8508, Tri: 0.0000
2025-04-19 11:05:55,399 - INFO - [DEBUG] ArcFace confidence: 0.7665
2025-04-19 11:05:55,405 - INFO - [DEBUG] Loss Breakdown — ID: 1.0008, SupCon: 3.7132, Tri: 0.0000
2025-04-19 11:05:55,816 - INFO - [DEBUG] ArcFace confidence: 0.7741
2025-04-19 11:05:55,822 - INFO - [DEBUG] Loss Breakdown — ID: 0.9882, SupCon: 3.6365, Tri: 0.0000
2025-04-19 11:05:56,236 - INFO - [DEBUG] ArcFace confidence: 0.7831
2025-04-19 11:05:56,239 - INFO - [DEBUG] Loss Breakdown — ID: 0.9784, SupCon: 3.6810, Tri: 0.0000
2025-04-19 11:05:56,657 - INFO - [DEBUG] ArcFace confidence: 0.7833
2025-04-19 11:05:56,660 - INFO - [DEBUG] Loss Breakdown — ID: 1.0839, SupCon: 3.7892, Tri: 0.0000
2025-04-19 11:05:57,077 - INFO - [DEBUG] ArcFace confidence: 0.8154
2025-04-19 11:05:57,080 - INFO - [DEBUG] Loss Breakdown — ID: 0.9899, SupCon: 3.7437, Tri: 0.0000
2025-04-19 11:05:57,498 - INFO - [DEBUG] ArcFace confidence: 0.6739
2025-04-19 11:05:57,501 - INFO - [DEBUG] Loss Breakdown — ID: 1.1493, SupCon: 3.7199, Tri: 0.0000
2025-04-19 11:05:57,918 - INFO - [DEBUG] ArcFace confidence: 0.7271
2025-04-19 11:05:57,921 - INFO - [DEBUG] Loss Breakdown — ID: 1.2490, SupCon: 3.7382, Tri: 0.0000
2025-04-19 11:05:58,335 - INFO - [DEBUG] ArcFace confidence: 0.7421
2025-04-19 11:05:58,341 - INFO - [DEBUG] Loss Breakdown — ID: 1.1139, SupCon: 3.6490, Tri: 0.0000
2025-04-19 11:05:58,725 - INFO - [DEBUG] ArcFace confidence: 0.6923
2025-04-19 11:05:58,728 - INFO - [DEBUG] Loss Breakdown — ID: 1.0650, SupCon: 3.4245, Tri: 0.0000
2025-04-19 11:05:59,602 - INFO - [Epoch 13] Total Loss=1.1355
2025-04-19 11:05:59,602 - INFO - Validating epoch 13...
2025-04-19 11:06:30,430 - INFO - [Epoch 13] Avg Train Loss = 1.1355 | 
2025-04-19 11:06:30,430 - INFO - ==================== Epoch 13 Validation ====================
2025-04-19 11:06:30,430 - INFO - Validation rank-1    : 90.22%
2025-04-19 11:06:30,430 - INFO - Validation rank-5    : 97.01%
2025-04-19 11:06:30,430 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:06:30,430 - INFO - Validation mAP      : 93.29%
2025-04-19 11:06:30,430 - INFO - ============================================================
2025-04-19 11:06:30,430 - INFO - Saving best model at epoch 13 (Acc@1=90.22%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:06:31,831 - INFO -  Epoch 14/20
2025-04-19 11:06:31,831 - INFO - [Epoch 14] Learning rate: 0.000001
2025-04-19 11:06:56,210 - INFO - [DEBUG] ArcFace confidence: 0.7402
2025-04-19 11:06:56,213 - INFO - [DEBUG] Loss Breakdown — ID: 1.0103, SupCon: 3.6971, Tri: 0.0000
2025-04-19 11:06:56,457 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:06:56,457 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:06:56,632 - INFO - [DEBUG] ArcFace confidence: 0.7119
2025-04-19 11:06:56,638 - INFO - [DEBUG] Loss Breakdown — ID: 1.0975, SupCon: 3.6376, Tri: 0.0000
2025-04-19 11:06:57,053 - INFO - [DEBUG] ArcFace confidence: 0.7984
2025-04-19 11:06:57,056 - INFO - [DEBUG] Loss Breakdown — ID: 0.9271, SupCon: 3.7686, Tri: 0.0000
2025-04-19 11:06:57,470 - INFO - [DEBUG] ArcFace confidence: 0.8225
2025-04-19 11:06:57,475 - INFO - [DEBUG] Loss Breakdown — ID: 0.9444, SupCon: 3.6449, Tri: 0.0000
2025-04-19 11:06:57,892 - INFO - [DEBUG] ArcFace confidence: 0.7466
2025-04-19 11:06:57,895 - INFO - [DEBUG] Loss Breakdown — ID: 1.1540, SupCon: 3.5881, Tri: 0.0000
2025-04-19 11:06:58,310 - INFO - [DEBUG] ArcFace confidence: 0.8049
2025-04-19 11:06:58,313 - INFO - [DEBUG] Loss Breakdown — ID: 1.0979, SupCon: 3.7621, Tri: 0.0000
2025-04-19 11:06:58,728 - INFO - [DEBUG] ArcFace confidence: 0.7405
2025-04-19 11:06:58,734 - INFO - [DEBUG] Loss Breakdown — ID: 1.1204, SupCon: 3.7237, Tri: 0.0000
2025-04-19 11:06:59,147 - INFO - [DEBUG] ArcFace confidence: 0.7108
2025-04-19 11:06:59,150 - INFO - [DEBUG] Loss Breakdown — ID: 1.2621, SupCon: 3.6974, Tri: 0.0000
2025-04-19 11:06:59,567 - INFO - [DEBUG] ArcFace confidence: 0.7949
2025-04-19 11:06:59,570 - INFO - [DEBUG] Loss Breakdown — ID: 1.1130, SupCon: 3.7056, Tri: 0.0000
2025-04-19 11:06:59,988 - INFO - [DEBUG] ArcFace confidence: 0.7930
2025-04-19 11:06:59,991 - INFO - [DEBUG] Loss Breakdown — ID: 1.0421, SupCon: 3.6686, Tri: 0.0000
2025-04-19 11:07:00,407 - INFO - [DEBUG] ArcFace confidence: 0.6985
2025-04-19 11:07:00,410 - INFO - [DEBUG] Loss Breakdown — ID: 1.2201, SupCon: 3.7472, Tri: 0.0000
2025-04-19 11:07:00,827 - INFO - [DEBUG] ArcFace confidence: 0.7413
2025-04-19 11:07:00,830 - INFO - [DEBUG] Loss Breakdown — ID: 1.0778, SupCon: 3.5311, Tri: 0.0000
2025-04-19 11:07:01,250 - INFO - [DEBUG] ArcFace confidence: 0.7491
2025-04-19 11:07:01,254 - INFO - [DEBUG] Loss Breakdown — ID: 1.0618, SupCon: 3.5592, Tri: 0.0000
2025-04-19 11:07:01,669 - INFO - [DEBUG] ArcFace confidence: 0.7308
2025-04-19 11:07:01,673 - INFO - [DEBUG] Loss Breakdown — ID: 1.0482, SupCon: 3.6879, Tri: 0.0000
2025-04-19 11:07:02,091 - INFO - [DEBUG] ArcFace confidence: 0.6917
2025-04-19 11:07:02,094 - INFO - [DEBUG] Loss Breakdown — ID: 1.3528, SupCon: 3.6346, Tri: 0.0000
2025-04-19 11:07:02,512 - INFO - [DEBUG] ArcFace confidence: 0.8316
2025-04-19 11:07:02,515 - INFO - [DEBUG] Loss Breakdown — ID: 0.8966, SupCon: 3.7594, Tri: 0.0000
2025-04-19 11:07:02,933 - INFO - [DEBUG] ArcFace confidence: 0.7407
2025-04-19 11:07:02,936 - INFO - [DEBUG] Loss Breakdown — ID: 1.1582, SupCon: 3.6784, Tri: 0.0000
2025-04-19 11:07:03,353 - INFO - [DEBUG] ArcFace confidence: 0.7768
2025-04-19 11:07:03,359 - INFO - [DEBUG] Loss Breakdown — ID: 0.9811, SupCon: 3.8288, Tri: 0.0000
2025-04-19 11:07:03,776 - INFO - [DEBUG] ArcFace confidence: 0.8044
2025-04-19 11:07:03,779 - INFO - [DEBUG] Loss Breakdown — ID: 1.0395, SupCon: 3.6300, Tri: 0.0000
2025-04-19 11:07:04,197 - INFO - [DEBUG] ArcFace confidence: 0.7978
2025-04-19 11:07:04,200 - INFO - [DEBUG] Loss Breakdown — ID: 1.0705, SupCon: 3.6773, Tri: 0.0000
2025-04-19 11:07:04,618 - INFO - [DEBUG] ArcFace confidence: 0.7230
2025-04-19 11:07:04,621 - INFO - [DEBUG] Loss Breakdown — ID: 1.0677, SupCon: 3.7673, Tri: 0.0000
2025-04-19 11:07:05,037 - INFO - [DEBUG] ArcFace confidence: 0.8288
2025-04-19 11:07:05,040 - INFO - [DEBUG] Loss Breakdown — ID: 0.9502, SupCon: 3.6690, Tri: 0.0000
2025-04-19 11:07:05,460 - INFO - [DEBUG] ArcFace confidence: 0.7304
2025-04-19 11:07:05,463 - INFO - [DEBUG] Loss Breakdown — ID: 1.0906, SupCon: 3.7029, Tri: 0.0000
2025-04-19 11:07:05,882 - INFO - [DEBUG] ArcFace confidence: 0.8001
2025-04-19 11:07:05,885 - INFO - [DEBUG] Loss Breakdown — ID: 0.9483, SupCon: 3.7547, Tri: 0.0000
2025-04-19 11:07:06,301 - INFO - [DEBUG] ArcFace confidence: 0.7392
2025-04-19 11:07:06,304 - INFO - [DEBUG] Loss Breakdown — ID: 1.2587, SupCon: 3.6247, Tri: 0.0000
2025-04-19 11:07:06,720 - INFO - [DEBUG] ArcFace confidence: 0.7331
2025-04-19 11:07:06,723 - INFO - [DEBUG] Loss Breakdown — ID: 1.0932, SupCon: 3.4948, Tri: 0.0000
2025-04-19 11:07:07,140 - INFO - [DEBUG] ArcFace confidence: 0.7110
2025-04-19 11:07:07,146 - INFO - [DEBUG] Loss Breakdown — ID: 1.2634, SupCon: 3.6166, Tri: 0.0000
2025-04-19 11:07:07,536 - INFO - [DEBUG] ArcFace confidence: 0.7729
2025-04-19 11:07:07,539 - INFO - [DEBUG] Loss Breakdown — ID: 1.0311, SupCon: 3.5479, Tri: 0.0000
2025-04-19 11:07:08,409 - INFO - [Epoch 14] Total Loss=1.0849
2025-04-19 11:07:08,409 - INFO - Validating epoch 14...
2025-04-19 11:07:40,432 - INFO - [Epoch 14] Avg Train Loss = 1.0849 | 
2025-04-19 11:07:40,432 - INFO - ==================== Epoch 14 Validation ====================
2025-04-19 11:07:40,432 - INFO - Validation rank-1    : 90.32%
2025-04-19 11:07:40,432 - INFO - Validation rank-5    : 96.91%
2025-04-19 11:07:40,432 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:07:40,432 - INFO - Validation mAP      : 93.34%
2025-04-19 11:07:40,432 - INFO - ============================================================
2025-04-19 11:07:40,432 - INFO - Saving best model at epoch 14 (Acc@1=90.32%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:07:41,824 - INFO -  Epoch 15/20
2025-04-19 11:07:41,827 - INFO - [Epoch 15] Learning rate: 0.000000
2025-04-19 11:08:06,773 - INFO - [DEBUG] ArcFace confidence: 0.7983
2025-04-19 11:08:06,776 - INFO - [DEBUG] Loss Breakdown — ID: 0.9221, SupCon: 3.6309, Tri: 0.0000
2025-04-19 11:08:07,021 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:08:07,021 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:08:07,198 - INFO - [DEBUG] ArcFace confidence: 0.7254
2025-04-19 11:08:07,201 - INFO - [DEBUG] Loss Breakdown — ID: 1.2103, SupCon: 3.6015, Tri: 0.0000
2025-04-19 11:08:07,614 - INFO - [DEBUG] ArcFace confidence: 0.7868
2025-04-19 11:08:07,620 - INFO - [DEBUG] Loss Breakdown — ID: 1.1634, SupCon: 3.5909, Tri: 0.0000
2025-04-19 11:08:08,037 - INFO - [DEBUG] ArcFace confidence: 0.7410
2025-04-19 11:08:08,040 - INFO - [DEBUG] Loss Breakdown — ID: 1.2631, SupCon: 3.6682, Tri: 0.0000
2025-04-19 11:08:08,458 - INFO - [DEBUG] ArcFace confidence: 0.7960
2025-04-19 11:08:08,464 - INFO - [DEBUG] Loss Breakdown — ID: 1.0784, SupCon: 3.7385, Tri: 0.0000
2025-04-19 11:08:08,879 - INFO - [DEBUG] ArcFace confidence: 0.8503
2025-04-19 11:08:08,882 - INFO - [DEBUG] Loss Breakdown — ID: 0.8968, SupCon: 3.5685, Tri: 0.0000
2025-04-19 11:08:09,300 - INFO - [DEBUG] ArcFace confidence: 0.8341
2025-04-19 11:08:09,303 - INFO - [DEBUG] Loss Breakdown — ID: 0.9477, SupCon: 3.6808, Tri: 0.0000
2025-04-19 11:08:09,718 - INFO - [DEBUG] ArcFace confidence: 0.7636
2025-04-19 11:08:09,721 - INFO - [DEBUG] Loss Breakdown — ID: 1.1176, SupCon: 3.6941, Tri: 0.0000
2025-04-19 11:08:10,139 - INFO - [DEBUG] ArcFace confidence: 0.7735
2025-04-19 11:08:10,145 - INFO - [DEBUG] Loss Breakdown — ID: 0.9721, SupCon: 3.6743, Tri: 0.0000
2025-04-19 11:08:10,563 - INFO - [DEBUG] ArcFace confidence: 0.7522
2025-04-19 11:08:10,566 - INFO - [DEBUG] Loss Breakdown — ID: 1.2888, SupCon: 3.6721, Tri: 0.0000
2025-04-19 11:08:10,982 - INFO - [DEBUG] ArcFace confidence: 0.8081
2025-04-19 11:08:10,985 - INFO - [DEBUG] Loss Breakdown — ID: 0.9127, SupCon: 3.6943, Tri: 0.0000
2025-04-19 11:08:11,400 - INFO - [DEBUG] ArcFace confidence: 0.7393
2025-04-19 11:08:11,406 - INFO - [DEBUG] Loss Breakdown — ID: 1.1333, SupCon: 3.6418, Tri: 0.0000
2025-04-19 11:08:11,818 - INFO - [DEBUG] ArcFace confidence: 0.7832
2025-04-19 11:08:11,824 - INFO - [DEBUG] Loss Breakdown — ID: 0.9764, SupCon: 3.7211, Tri: 0.0000
2025-04-19 11:08:12,241 - INFO - [DEBUG] ArcFace confidence: 0.7259
2025-04-19 11:08:12,244 - INFO - [DEBUG] Loss Breakdown — ID: 1.1309, SupCon: 3.5894, Tri: 0.0000
2025-04-19 11:08:12,665 - INFO - [DEBUG] ArcFace confidence: 0.8143
2025-04-19 11:08:12,668 - INFO - [DEBUG] Loss Breakdown — ID: 0.9227, SupCon: 3.7145, Tri: 0.0000
2025-04-19 11:08:13,087 - INFO - [DEBUG] ArcFace confidence: 0.7128
2025-04-19 11:08:13,093 - INFO - [DEBUG] Loss Breakdown — ID: 1.0373, SupCon: 3.7735, Tri: 0.0000
2025-04-19 11:08:13,510 - INFO - [DEBUG] ArcFace confidence: 0.7890
2025-04-19 11:08:13,516 - INFO - [DEBUG] Loss Breakdown — ID: 1.0211, SupCon: 3.6029, Tri: 0.0000
2025-04-19 11:08:13,933 - INFO - [DEBUG] ArcFace confidence: 0.7895
2025-04-19 11:08:13,936 - INFO - [DEBUG] Loss Breakdown — ID: 1.0356, SupCon: 3.6690, Tri: 0.0000
2025-04-19 11:08:14,356 - INFO - [DEBUG] ArcFace confidence: 0.7714
2025-04-19 11:08:14,359 - INFO - [DEBUG] Loss Breakdown — ID: 0.9847, SupCon: 3.6676, Tri: 0.0000
2025-04-19 11:08:14,773 - INFO - [DEBUG] ArcFace confidence: 0.7879
2025-04-19 11:08:14,779 - INFO - [DEBUG] Loss Breakdown — ID: 1.0157, SupCon: 3.7219, Tri: 0.0000
2025-04-19 11:08:15,194 - INFO - [DEBUG] ArcFace confidence: 0.7581
2025-04-19 11:08:15,197 - INFO - [DEBUG] Loss Breakdown — ID: 1.1509, SupCon: 3.7088, Tri: 0.0000
2025-04-19 11:08:15,615 - INFO - [DEBUG] ArcFace confidence: 0.7998
2025-04-19 11:08:15,621 - INFO - [DEBUG] Loss Breakdown — ID: 1.0229, SupCon: 3.7240, Tri: 0.0000
2025-04-19 11:08:16,039 - INFO - [DEBUG] ArcFace confidence: 0.7484
2025-04-19 11:08:16,042 - INFO - [DEBUG] Loss Breakdown — ID: 1.1557, SupCon: 3.6270, Tri: 0.0000
2025-04-19 11:08:16,463 - INFO - [DEBUG] ArcFace confidence: 0.8091
2025-04-19 11:08:16,466 - INFO - [DEBUG] Loss Breakdown — ID: 0.9345, SupCon: 3.6566, Tri: 0.0000
2025-04-19 11:08:16,883 - INFO - [DEBUG] ArcFace confidence: 0.7325
2025-04-19 11:08:16,886 - INFO - [DEBUG] Loss Breakdown — ID: 1.0141, SupCon: 3.7350, Tri: 0.0000
2025-04-19 11:08:17,306 - INFO - [DEBUG] ArcFace confidence: 0.7733
2025-04-19 11:08:17,309 - INFO - [DEBUG] Loss Breakdown — ID: 1.0312, SupCon: 3.7512, Tri: 0.0000
2025-04-19 11:08:17,731 - INFO - [DEBUG] ArcFace confidence: 0.8137
2025-04-19 11:08:17,734 - INFO - [DEBUG] Loss Breakdown — ID: 0.9356, SupCon: 3.7123, Tri: 0.0000
2025-04-19 11:08:18,122 - INFO - [DEBUG] ArcFace confidence: 0.7559
2025-04-19 11:08:18,128 - INFO - [DEBUG] Loss Breakdown — ID: 1.0968, SupCon: 3.4704, Tri: 0.0000
2025-04-19 11:08:19,011 - INFO - [Epoch 15] Total Loss=1.0490
2025-04-19 11:08:19,011 - INFO - Validating epoch 15...
2025-04-19 11:08:50,744 - INFO - [Epoch 15] Avg Train Loss = 1.0490 | 
2025-04-19 11:08:50,744 - INFO - ==================== Epoch 15 Validation ====================
2025-04-19 11:08:50,744 - INFO - Validation rank-1    : 90.94%
2025-04-19 11:08:50,744 - INFO - Validation rank-5    : 97.12%
2025-04-19 11:08:50,744 - INFO - Validation rank-10   : 97.94%
2025-04-19 11:08:50,744 - INFO - Validation mAP      : 93.72%
2025-04-19 11:08:50,744 - INFO - ============================================================
2025-04-19 11:08:50,744 - INFO - Saving best model at epoch 15 (Acc@1=90.94%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 11:08:52,052 - INFO -  Epoch 16/20
2025-04-19 11:08:52,052 - INFO - [Epoch 16] Learning rate: 0.000000
2025-04-19 11:09:16,956 - INFO - [DEBUG] ArcFace confidence: 0.7210
2025-04-19 11:09:16,962 - INFO - [DEBUG] Loss Breakdown — ID: 1.0237, SupCon: 3.6383, Tri: 0.0000
2025-04-19 11:09:17,202 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:09:17,202 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:09:17,379 - INFO - [DEBUG] ArcFace confidence: 0.7850
2025-04-19 11:09:17,382 - INFO - [DEBUG] Loss Breakdown — ID: 1.0374, SupCon: 3.6498, Tri: 0.0000
2025-04-19 11:09:17,795 - INFO - [DEBUG] ArcFace confidence: 0.7630
2025-04-19 11:09:17,801 - INFO - [DEBUG] Loss Breakdown — ID: 1.1066, SupCon: 3.7366, Tri: 0.0000
2025-04-19 11:09:18,215 - INFO - [DEBUG] ArcFace confidence: 0.8006
2025-04-19 11:09:18,218 - INFO - [DEBUG] Loss Breakdown — ID: 1.1073, SupCon: 3.6931, Tri: 0.0000
2025-04-19 11:09:18,636 - INFO - [DEBUG] ArcFace confidence: 0.7552
2025-04-19 11:09:18,639 - INFO - [DEBUG] Loss Breakdown — ID: 1.0280, SupCon: 3.6013, Tri: 0.0000
2025-04-19 11:09:19,056 - INFO - [DEBUG] ArcFace confidence: 0.8173
2025-04-19 11:09:19,059 - INFO - [DEBUG] Loss Breakdown — ID: 1.0403, SupCon: 3.7550, Tri: 0.0000
2025-04-19 11:09:19,474 - INFO - [DEBUG] ArcFace confidence: 0.7967
2025-04-19 11:09:19,477 - INFO - [DEBUG] Loss Breakdown — ID: 0.9267, SupCon: 3.5488, Tri: 0.0000
2025-04-19 11:09:19,892 - INFO - [DEBUG] ArcFace confidence: 0.7908
2025-04-19 11:09:19,895 - INFO - [DEBUG] Loss Breakdown — ID: 0.9718, SupCon: 3.6546, Tri: 0.0000
2025-04-19 11:09:20,313 - INFO - [DEBUG] ArcFace confidence: 0.7671
2025-04-19 11:09:20,316 - INFO - [DEBUG] Loss Breakdown — ID: 0.9649, SupCon: 3.6826, Tri: 0.0000
2025-04-19 11:09:20,733 - INFO - [DEBUG] ArcFace confidence: 0.8038
2025-04-19 11:09:20,736 - INFO - [DEBUG] Loss Breakdown — ID: 0.9495, SupCon: 3.7743, Tri: 0.0000
2025-04-19 11:09:21,158 - INFO - [DEBUG] ArcFace confidence: 0.7689
2025-04-19 11:09:21,161 - INFO - [DEBUG] Loss Breakdown — ID: 1.0028, SupCon: 3.6758, Tri: 0.0000
2025-04-19 11:09:21,574 - INFO - [DEBUG] ArcFace confidence: 0.7667
2025-04-19 11:09:21,577 - INFO - [DEBUG] Loss Breakdown — ID: 1.0018, SupCon: 3.7321, Tri: 0.0000
2025-04-19 11:09:21,991 - INFO - [DEBUG] ArcFace confidence: 0.7630
2025-04-19 11:09:21,997 - INFO - [DEBUG] Loss Breakdown — ID: 0.9975, SupCon: 3.6691, Tri: 0.0000
2025-04-19 11:09:22,413 - INFO - [DEBUG] ArcFace confidence: 0.7576
2025-04-19 11:09:22,419 - INFO - [DEBUG] Loss Breakdown — ID: 1.0283, SupCon: 3.6077, Tri: 0.0000
2025-04-19 11:09:22,834 - INFO - [DEBUG] ArcFace confidence: 0.7526
2025-04-19 11:09:22,837 - INFO - [DEBUG] Loss Breakdown — ID: 0.9925, SupCon: 3.6068, Tri: 0.0000
2025-04-19 11:09:23,257 - INFO - [DEBUG] ArcFace confidence: 0.7355
2025-04-19 11:09:23,260 - INFO - [DEBUG] Loss Breakdown — ID: 1.0412, SupCon: 3.6187, Tri: 0.0000
2025-04-19 11:09:23,679 - INFO - [DEBUG] ArcFace confidence: 0.8088
2025-04-19 11:09:23,682 - INFO - [DEBUG] Loss Breakdown — ID: 1.0410, SupCon: 3.5904, Tri: 0.0000
2025-04-19 11:09:24,104 - INFO - [DEBUG] ArcFace confidence: 0.7710
2025-04-19 11:09:24,107 - INFO - [DEBUG] Loss Breakdown — ID: 1.1402, SupCon: 3.7194, Tri: 0.0000
2025-04-19 11:09:24,526 - INFO - [DEBUG] ArcFace confidence: 0.6930
2025-04-19 11:09:24,529 - INFO - [DEBUG] Loss Breakdown — ID: 1.2085, SupCon: 3.6399, Tri: 0.0000
2025-04-19 11:09:24,948 - INFO - [DEBUG] ArcFace confidence: 0.7386
2025-04-19 11:09:24,954 - INFO - [DEBUG] Loss Breakdown — ID: 1.1759, SupCon: 3.6663, Tri: 0.0000
2025-04-19 11:09:25,370 - INFO - [DEBUG] ArcFace confidence: 0.7672
2025-04-19 11:09:25,373 - INFO - [DEBUG] Loss Breakdown — ID: 0.9875, SupCon: 3.7648, Tri: 0.0000
2025-04-19 11:09:25,790 - INFO - [DEBUG] ArcFace confidence: 0.8209
2025-04-19 11:09:25,796 - INFO - [DEBUG] Loss Breakdown — ID: 0.9663, SupCon: 3.6979, Tri: 0.0000
2025-04-19 11:09:26,209 - INFO - [DEBUG] ArcFace confidence: 0.7952
2025-04-19 11:09:26,212 - INFO - [DEBUG] Loss Breakdown — ID: 1.0045, SupCon: 3.6437, Tri: 0.0000
2025-04-19 11:09:26,627 - INFO - [DEBUG] ArcFace confidence: 0.8292
2025-04-19 11:09:26,633 - INFO - [DEBUG] Loss Breakdown — ID: 0.9340, SupCon: 3.6248, Tri: 0.0000
2025-04-19 11:09:27,048 - INFO - [DEBUG] ArcFace confidence: 0.8231
2025-04-19 11:09:27,051 - INFO - [DEBUG] Loss Breakdown — ID: 0.9930, SupCon: 3.7105, Tri: 0.0000
2025-04-19 11:09:27,471 - INFO - [DEBUG] ArcFace confidence: 0.7847
2025-04-19 11:09:27,474 - INFO - [DEBUG] Loss Breakdown — ID: 1.1915, SupCon: 3.6916, Tri: 0.0000
2025-04-19 11:09:27,890 - INFO - [DEBUG] ArcFace confidence: 0.7871
2025-04-19 11:09:27,893 - INFO - [DEBUG] Loss Breakdown — ID: 0.9636, SupCon: 3.5855, Tri: 0.0000
2025-04-19 11:09:28,283 - INFO - [DEBUG] ArcFace confidence: 0.7905
2025-04-19 11:09:28,286 - INFO - [DEBUG] Loss Breakdown — ID: 1.2745, SupCon: 3.5131, Tri: 0.0000
2025-04-19 11:09:29,177 - INFO - [Epoch 16] Total Loss=1.0393
2025-04-19 11:09:29,177 - INFO - Validating epoch 16...
2025-04-19 11:10:00,764 - INFO - [Epoch 16] Avg Train Loss = 1.0393 | 
2025-04-19 11:10:00,764 - INFO - ==================== Epoch 16 Validation ====================
2025-04-19 11:10:00,764 - INFO - Validation rank-1    : 90.22%
2025-04-19 11:10:00,764 - INFO - Validation rank-5    : 97.12%
2025-04-19 11:10:00,764 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:10:00,764 - INFO - Validation mAP      : 93.31%
2025-04-19 11:10:00,764 - INFO - ============================================================
2025-04-19 11:10:00,764 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 11:10:00,764 - INFO -  Epoch 17/20
2025-04-19 11:10:00,767 - INFO - [Epoch 17] Learning rate: 0.000000
2025-04-19 11:10:25,148 - INFO - [DEBUG] ArcFace confidence: 0.7503
2025-04-19 11:10:25,154 - INFO - [DEBUG] Loss Breakdown — ID: 1.0668, SupCon: 3.6590, Tri: 0.0000
2025-04-19 11:10:25,396 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:10:25,396 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:10:25,571 - INFO - [DEBUG] ArcFace confidence: 0.7749
2025-04-19 11:10:25,574 - INFO - [DEBUG] Loss Breakdown — ID: 0.9754, SupCon: 3.5939, Tri: 0.0000
2025-04-19 11:10:25,992 - INFO - [DEBUG] ArcFace confidence: 0.7988
2025-04-19 11:10:25,995 - INFO - [DEBUG] Loss Breakdown — ID: 0.9364, SupCon: 3.6762, Tri: 0.0000
2025-04-19 11:10:26,410 - INFO - [DEBUG] ArcFace confidence: 0.7664
2025-04-19 11:10:26,416 - INFO - [DEBUG] Loss Breakdown — ID: 1.0369, SupCon: 3.5443, Tri: 0.0000
2025-04-19 11:10:26,831 - INFO - [DEBUG] ArcFace confidence: 0.8361
2025-04-19 11:10:26,837 - INFO - [DEBUG] Loss Breakdown — ID: 0.9240, SupCon: 3.6167, Tri: 0.0000
2025-04-19 11:10:27,250 - INFO - [DEBUG] ArcFace confidence: 0.7482
2025-04-19 11:10:27,253 - INFO - [DEBUG] Loss Breakdown — ID: 0.9966, SupCon: 3.6301, Tri: 0.0000
2025-04-19 11:10:27,667 - INFO - [DEBUG] ArcFace confidence: 0.7733
2025-04-19 11:10:27,670 - INFO - [DEBUG] Loss Breakdown — ID: 1.1428, SupCon: 3.6986, Tri: 0.0000
2025-04-19 11:10:28,084 - INFO - [DEBUG] ArcFace confidence: 0.7774
2025-04-19 11:10:28,087 - INFO - [DEBUG] Loss Breakdown — ID: 0.9779, SupCon: 3.5833, Tri: 0.0000
2025-04-19 11:10:28,506 - INFO - [DEBUG] ArcFace confidence: 0.7909
2025-04-19 11:10:28,510 - INFO - [DEBUG] Loss Breakdown — ID: 0.9321, SupCon: 3.7946, Tri: 0.0000
2025-04-19 11:10:28,927 - INFO - [DEBUG] ArcFace confidence: 0.7906
2025-04-19 11:10:28,930 - INFO - [DEBUG] Loss Breakdown — ID: 0.9549, SupCon: 3.6204, Tri: 0.0000
2025-04-19 11:10:29,348 - INFO - [DEBUG] ArcFace confidence: 0.8216
2025-04-19 11:10:29,351 - INFO - [DEBUG] Loss Breakdown — ID: 0.9238, SupCon: 3.6371, Tri: 0.0000
2025-04-19 11:10:29,768 - INFO - [DEBUG] ArcFace confidence: 0.7742
2025-04-19 11:10:29,774 - INFO - [DEBUG] Loss Breakdown — ID: 0.9948, SupCon: 3.7312, Tri: 0.0000
2025-04-19 11:10:30,191 - INFO - [DEBUG] ArcFace confidence: 0.8084
2025-04-19 11:10:30,194 - INFO - [DEBUG] Loss Breakdown — ID: 0.9848, SupCon: 3.7921, Tri: 0.0000
2025-04-19 11:10:30,613 - INFO - [DEBUG] ArcFace confidence: 0.8381
2025-04-19 11:10:30,616 - INFO - [DEBUG] Loss Breakdown — ID: 0.9065, SupCon: 3.6503, Tri: 0.0000
2025-04-19 11:10:31,031 - INFO - [DEBUG] ArcFace confidence: 0.7806
2025-04-19 11:10:31,037 - INFO - [DEBUG] Loss Breakdown — ID: 0.9972, SupCon: 3.6428, Tri: 0.0000
2025-04-19 11:10:31,454 - INFO - [DEBUG] ArcFace confidence: 0.7943
2025-04-19 11:10:31,457 - INFO - [DEBUG] Loss Breakdown — ID: 0.9450, SupCon: 3.7742, Tri: 0.0000
2025-04-19 11:10:31,875 - INFO - [DEBUG] ArcFace confidence: 0.7661
2025-04-19 11:10:31,878 - INFO - [DEBUG] Loss Breakdown — ID: 1.1869, SupCon: 3.7309, Tri: 0.0000
2025-04-19 11:10:32,297 - INFO - [DEBUG] ArcFace confidence: 0.8082
2025-04-19 11:10:32,300 - INFO - [DEBUG] Loss Breakdown — ID: 0.9425, SupCon: 3.7433, Tri: 0.0000
2025-04-19 11:10:32,720 - INFO - [DEBUG] ArcFace confidence: 0.8097
2025-04-19 11:10:32,723 - INFO - [DEBUG] Loss Breakdown — ID: 1.0059, SupCon: 3.6978, Tri: 0.0000
2025-04-19 11:10:33,143 - INFO - [DEBUG] ArcFace confidence: 0.7543
2025-04-19 11:10:33,146 - INFO - [DEBUG] Loss Breakdown — ID: 1.0936, SupCon: 3.6469, Tri: 0.0000
2025-04-19 11:10:33,560 - INFO - [DEBUG] ArcFace confidence: 0.7765
2025-04-19 11:10:33,566 - INFO - [DEBUG] Loss Breakdown — ID: 1.0393, SupCon: 3.8033, Tri: 0.0000
2025-04-19 11:10:33,983 - INFO - [DEBUG] ArcFace confidence: 0.8157
2025-04-19 11:10:33,986 - INFO - [DEBUG] Loss Breakdown — ID: 0.9712, SupCon: 3.6126, Tri: 0.0000
2025-04-19 11:10:34,403 - INFO - [DEBUG] ArcFace confidence: 0.8268
2025-04-19 11:10:34,406 - INFO - [DEBUG] Loss Breakdown — ID: 0.9150, SupCon: 3.6915, Tri: 0.0000
2025-04-19 11:10:34,824 - INFO - [DEBUG] ArcFace confidence: 0.8327
2025-04-19 11:10:34,828 - INFO - [DEBUG] Loss Breakdown — ID: 0.9478, SupCon: 3.6762, Tri: 0.0000
2025-04-19 11:10:35,243 - INFO - [DEBUG] ArcFace confidence: 0.7837
2025-04-19 11:10:35,246 - INFO - [DEBUG] Loss Breakdown — ID: 1.1367, SupCon: 3.7487, Tri: 0.0000
2025-04-19 11:10:35,663 - INFO - [DEBUG] ArcFace confidence: 0.7741
2025-04-19 11:10:35,666 - INFO - [DEBUG] Loss Breakdown — ID: 1.1886, SupCon: 3.6474, Tri: 0.0000
2025-04-19 11:10:36,081 - INFO - [DEBUG] ArcFace confidence: 0.7521
2025-04-19 11:10:36,084 - INFO - [DEBUG] Loss Breakdown — ID: 1.1833, SupCon: 3.5474, Tri: 0.0000
2025-04-19 11:10:36,474 - INFO - [DEBUG] ArcFace confidence: 0.8024
2025-04-19 11:10:36,477 - INFO - [DEBUG] Loss Breakdown — ID: 0.9393, SupCon: 3.5005, Tri: 0.0000
2025-04-19 11:10:37,383 - INFO - [Epoch 17] Total Loss=1.0088
2025-04-19 11:10:37,383 - INFO - Validating epoch 17...
2025-04-19 11:11:08,931 - INFO - [Epoch 17] Avg Train Loss = 1.0088 | 
2025-04-19 11:11:08,931 - INFO - ==================== Epoch 17 Validation ====================
2025-04-19 11:11:08,931 - INFO - Validation rank-1    : 90.32%
2025-04-19 11:11:08,931 - INFO - Validation rank-5    : 97.01%
2025-04-19 11:11:08,931 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:11:08,931 - INFO - Validation mAP      : 93.34%
2025-04-19 11:11:08,931 - INFO - ============================================================
2025-04-19 11:11:08,931 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 11:11:08,931 - INFO -  Epoch 18/20
2025-04-19 11:11:08,931 - INFO - [Epoch 18] Learning rate: 0.000000
2025-04-19 11:11:33,523 - INFO - [DEBUG] ArcFace confidence: 0.7526
2025-04-19 11:11:33,529 - INFO - [DEBUG] Loss Breakdown — ID: 1.0885, SupCon: 3.5721, Tri: 0.0000
2025-04-19 11:11:33,769 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 11:11:33,769 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
2025-04-19 11:11:33,946 - INFO - [DEBUG] ArcFace confidence: 0.7991
2025-04-19 11:11:33,949 - INFO - [DEBUG] Loss Breakdown — ID: 0.9346, SupCon: 3.5879, Tri: 0.0000
2025-04-19 11:11:34,363 - INFO - [DEBUG] ArcFace confidence: 0.7830
2025-04-19 11:11:34,369 - INFO - [DEBUG] Loss Breakdown — ID: 0.9862, SupCon: 3.6954, Tri: 0.0000
2025-04-19 11:11:34,788 - INFO - [DEBUG] ArcFace confidence: 0.7729
2025-04-19 11:11:34,791 - INFO - [DEBUG] Loss Breakdown — ID: 1.1476, SupCon: 3.6430, Tri: 0.0000
2025-04-19 11:11:35,208 - INFO - [DEBUG] ArcFace confidence: 0.6823
2025-04-19 11:11:35,211 - INFO - [DEBUG] Loss Breakdown — ID: 1.1810, SupCon: 3.6633, Tri: 0.0000
2025-04-19 11:11:35,629 - INFO - [DEBUG] ArcFace confidence: 0.8370
2025-04-19 11:11:35,632 - INFO - [DEBUG] Loss Breakdown — ID: 0.9416, SupCon: 3.7195, Tri: 0.0000
2025-04-19 11:11:36,049 - INFO - [DEBUG] ArcFace confidence: 0.8120
2025-04-19 11:11:36,052 - INFO - [DEBUG] Loss Breakdown — ID: 0.9090, SupCon: 3.6183, Tri: 0.0000
2025-04-19 11:11:36,469 - INFO - [DEBUG] ArcFace confidence: 0.7572
2025-04-19 11:11:36,472 - INFO - [DEBUG] Loss Breakdown — ID: 1.0947, SupCon: 3.5569, Tri: 0.0000
2025-04-19 11:11:36,889 - INFO - [DEBUG] ArcFace confidence: 0.7889
2025-04-19 11:11:36,892 - INFO - [DEBUG] Loss Breakdown — ID: 0.9432, SupCon: 3.6478, Tri: 0.0000
2025-04-19 11:11:37,308 - INFO - [DEBUG] ArcFace confidence: 0.8096
2025-04-19 11:11:37,311 - INFO - [DEBUG] Loss Breakdown — ID: 0.9751, SupCon: 3.6976, Tri: 0.0000
2025-04-19 11:11:37,727 - INFO - [DEBUG] ArcFace confidence: 0.8270
2025-04-19 11:11:37,730 - INFO - [DEBUG] Loss Breakdown — ID: 0.9115, SupCon: 3.7248, Tri: 0.0000
2025-04-19 11:11:38,146 - INFO - [DEBUG] ArcFace confidence: 0.8139
2025-04-19 11:11:38,152 - INFO - [DEBUG] Loss Breakdown — ID: 0.9319, SupCon: 3.6956, Tri: 0.0000
2025-04-19 11:11:38,569 - INFO - [DEBUG] ArcFace confidence: 0.7809
2025-04-19 11:11:38,572 - INFO - [DEBUG] Loss Breakdown — ID: 1.0648, SupCon: 3.6464, Tri: 0.0000
2025-04-19 11:11:38,991 - INFO - [DEBUG] ArcFace confidence: 0.7719
2025-04-19 11:11:38,994 - INFO - [DEBUG] Loss Breakdown — ID: 1.0458, SupCon: 3.7593, Tri: 0.0000
2025-04-19 11:11:39,409 - INFO - [DEBUG] ArcFace confidence: 0.8272
2025-04-19 11:11:39,415 - INFO - [DEBUG] Loss Breakdown — ID: 0.9189, SupCon: 3.6712, Tri: 0.0000
2025-04-19 11:11:39,830 - INFO - [DEBUG] ArcFace confidence: 0.8309
2025-04-19 11:11:39,833 - INFO - [DEBUG] Loss Breakdown — ID: 0.9120, SupCon: 3.6098, Tri: 0.0000
2025-04-19 11:11:40,254 - INFO - [DEBUG] ArcFace confidence: 0.7408
2025-04-19 11:11:40,257 - INFO - [DEBUG] Loss Breakdown — ID: 1.0246, SupCon: 3.6849, Tri: 0.0000
2025-04-19 11:11:40,674 - INFO - [DEBUG] ArcFace confidence: 0.8071
2025-04-19 11:11:40,677 - INFO - [DEBUG] Loss Breakdown — ID: 0.9216, SupCon: 3.6144, Tri: 0.0000
2025-04-19 11:11:41,098 - INFO - [DEBUG] ArcFace confidence: 0.7662
2025-04-19 11:11:41,101 - INFO - [DEBUG] Loss Breakdown — ID: 1.0535, SupCon: 3.7462, Tri: 0.0000
2025-04-19 11:11:41,518 - INFO - [DEBUG] ArcFace confidence: 0.7408
2025-04-19 11:11:41,521 - INFO - [DEBUG] Loss Breakdown — ID: 1.0751, SupCon: 3.6919, Tri: 0.0000
2025-04-19 11:11:41,939 - INFO - [DEBUG] ArcFace confidence: 0.7719
2025-04-19 11:11:41,942 - INFO - [DEBUG] Loss Breakdown — ID: 1.0537, SupCon: 3.7011, Tri: 0.0000
2025-04-19 11:11:42,362 - INFO - [DEBUG] ArcFace confidence: 0.8133
2025-04-19 11:11:42,365 - INFO - [DEBUG] Loss Breakdown — ID: 0.9355, SupCon: 3.6976, Tri: 0.0000
2025-04-19 11:11:42,780 - INFO - [DEBUG] ArcFace confidence: 0.8164
2025-04-19 11:11:42,783 - INFO - [DEBUG] Loss Breakdown — ID: 0.9492, SupCon: 3.7004, Tri: 0.0000
2025-04-19 11:11:43,196 - INFO - [DEBUG] ArcFace confidence: 0.7874
2025-04-19 11:11:43,202 - INFO - [DEBUG] Loss Breakdown — ID: 1.0832, SupCon: 3.6583, Tri: 0.0000
2025-04-19 11:11:43,619 - INFO - [DEBUG] ArcFace confidence: 0.7937
2025-04-19 11:11:43,622 - INFO - [DEBUG] Loss Breakdown — ID: 0.9790, SupCon: 3.6224, Tri: 0.0000
2025-04-19 11:11:44,039 - INFO - [DEBUG] ArcFace confidence: 0.8241
2025-04-19 11:11:44,042 - INFO - [DEBUG] Loss Breakdown — ID: 0.9226, SupCon: 3.6425, Tri: 0.0000
2025-04-19 11:11:44,458 - INFO - [DEBUG] ArcFace confidence: 0.8092
2025-04-19 11:11:44,464 - INFO - [DEBUG] Loss Breakdown — ID: 1.0982, SupCon: 3.7511, Tri: 0.0000
2025-04-19 11:11:44,848 - INFO - [DEBUG] ArcFace confidence: 0.7807
2025-04-19 11:11:44,851 - INFO - [DEBUG] Loss Breakdown — ID: 0.9913, SupCon: 3.4471, Tri: 0.0000
2025-04-19 11:11:45,739 - INFO - [Epoch 18] Total Loss=1.0026
2025-04-19 11:11:45,739 - INFO - Validating epoch 18...
2025-04-19 11:12:16,891 - INFO - [Epoch 18] Avg Train Loss = 1.0026 | 
2025-04-19 11:12:16,891 - INFO - ==================== Epoch 18 Validation ====================
2025-04-19 11:12:16,891 - INFO - Validation rank-1    : 90.11%
2025-04-19 11:12:16,891 - INFO - Validation rank-5    : 97.01%
2025-04-19 11:12:16,891 - INFO - Validation rank-10   : 98.04%
2025-04-19 11:12:16,891 - INFO - Validation mAP      : 93.20%
2025-04-19 11:12:16,891 - INFO - ============================================================
2025-04-19 11:12:16,891 - INFO - No improvement in Acc@1. Patience counter: 3/3
2025-04-19 11:12:16,891 - INFO - Early srankping at epoch 18 due to no improvement in rank-1 accuracy.
2025-04-19 11:12:18,226 - INFO - ====== FINAL SUMMARY ======
2025-04-19 11:12:18,226 - INFO - Total epochs       : 20
2025-04-19 11:12:18,226 - INFO - Avg Loss           : 87.2697
2025-04-19 11:12:18,226 - INFO - Best Acc@1 Epoch   : 15
2025-04-19 11:12:18,226 - INFO - Best Acc@1         : 90.94%
2025-04-19 11:12:18,226 - INFO - Best mAP            : 93.20%
2025-04-19 11:12:18,226 - INFO - ============================
