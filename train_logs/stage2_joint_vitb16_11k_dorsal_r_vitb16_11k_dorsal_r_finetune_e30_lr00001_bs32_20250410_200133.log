Cached 890 features

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
Model saved to: saved_models/stage2_joint_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_prompt_nctx8_e0_lr00001_bs32_BEST.pth
 New BEST Prompt model saved at Rank-1 = 1.39%
[Epoch 1/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 2/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 3/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 4/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 5/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 6/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 7/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 8/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 9/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 10/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 11/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 12/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 13/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 14/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 15/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 16/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 17/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 18/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 19/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 20/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 21/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 22/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 23/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 24/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 25/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 26/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 27/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 28/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 29/30] Prompt Loss: 193.6665

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
Model saved to: saved_models/stage2_joint_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_prompt_nctx8_e30_lr00001_bs32_FINAL.pth
[Epoch 30/30] Prompt Loss: 193.6665
Unfroze CLIP image encoder.

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
Model saved to: saved_models/stage2_joint_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_finetune_e0_lr00001_bs32_BEST.pth
cNew BEST Image model saved at Rank-1 = 1.39%
[Epoch 1/30] Image Fine-Tune Loss: 318.2642

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 2/30] Image Fine-Tune Loss: 317.7095

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 3/30] Image Fine-Tune Loss: 318.4624

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 4/30] Image Fine-Tune Loss: 317.7724

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 5/30] Image Fine-Tune Loss: 317.7939

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 6/30] Image Fine-Tune Loss: 318.2236

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 7/30] Image Fine-Tune Loss: 318.0200

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 8/30] Image Fine-Tune Loss: 318.3583

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 9/30] Image Fine-Tune Loss: 318.3097

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 10/30] Image Fine-Tune Loss: 318.2915

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 11/30] Image Fine-Tune Loss: 318.1811

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 12/30] Image Fine-Tune Loss: 318.0682

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 13/30] Image Fine-Tune Loss: 318.4973

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 14/30] Image Fine-Tune Loss: 318.1302

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 15/30] Image Fine-Tune Loss: 318.1680

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 16/30] Image Fine-Tune Loss: 318.0339

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 17/30] Image Fine-Tune Loss: 317.8718

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 18/30] Image Fine-Tune Loss: 317.7717

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 19/30] Image Fine-Tune Loss: 317.8625

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 20/30] Image Fine-Tune Loss: 318.3106

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 21/30] Image Fine-Tune Loss: 318.1554

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 22/30] Image Fine-Tune Loss: 318.2109

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 23/30] Image Fine-Tune Loss: 317.8478

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 24/30] Image Fine-Tune Loss: 317.7156

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 25/30] Image Fine-Tune Loss: 318.3774

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 26/30] Image Fine-Tune Loss: 317.9220

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 27/30] Image Fine-Tune Loss: 317.9613

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 28/30] Image Fine-Tune Loss: 317.8057

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 29/30] Image Fine-Tune Loss: 317.9851

Validation Results:
MAP: 33.97%
RANK1: 1.39%
RANK5: 6.94%
RANK10: 11.11%
MAP: 33.97%
[Epoch 30/30] Image Fine-Tune Loss: 318.0318
Model saved to: saved_models/stage2_joint_vitb16_11k_dorsal_r_vitb16_11k_dorsal_r_finetune_e30_lr00001_bs32_FINAL.pth
