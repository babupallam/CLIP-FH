[DEBUG] CLIP Model = vitb16 → Token Embed Dim: 512, Final LN Dim: 512
[DEBUG] PromptLearner proj layer = Identity | in: 512, out: 512
[DEBUG] Dummy Image Feature Shape: torch.Size([1, 512])
[DEBUG] Text Feature Output (via proj) should match: 512
BNNeck, ArcFace, and Linear Classifier registered.
CLIP text encoder unfrozen.
[Trainable] class_embedding
[Trainable] positional_embedding
[Trainable] proj
[Trainable] conv1.weight
[Trainable] ln_pre.weight
[Trainable] ln_pre.bias
[Trainable] transformer.resblocks.0.attn.in_proj_weight
[Trainable] transformer.resblocks.0.attn.in_proj_bias
[Trainable] transformer.resblocks.0.attn.out_proj.weight
[Trainable] transformer.resblocks.0.attn.out_proj.bias
[Trainable] transformer.resblocks.0.ln_1.weight
[Trainable] transformer.resblocks.0.ln_1.bias
[Trainable] transformer.resblocks.0.mlp.c_fc.weight
[Trainable] transformer.resblocks.0.mlp.c_fc.bias
[Trainable] transformer.resblocks.0.mlp.c_proj.weight
[Trainable] transformer.resblocks.0.mlp.c_proj.bias
[Trainable] transformer.resblocks.0.ln_2.weight
[Trainable] transformer.resblocks.0.ln_2.bias
[Trainable] transformer.resblocks.1.attn.in_proj_weight
[Trainable] transformer.resblocks.1.attn.in_proj_bias
[Trainable] transformer.resblocks.1.attn.out_proj.weight
[Trainable] transformer.resblocks.1.attn.out_proj.bias
[Trainable] transformer.resblocks.1.ln_1.weight
[Trainable] transformer.resblocks.1.ln_1.bias
[Trainable] transformer.resblocks.1.mlp.c_fc.weight
[Trainable] transformer.resblocks.1.mlp.c_fc.bias
[Trainable] transformer.resblocks.1.mlp.c_proj.weight
[Trainable] transformer.resblocks.1.mlp.c_proj.bias
[Trainable] transformer.resblocks.1.ln_2.weight
[Trainable] transformer.resblocks.1.ln_2.bias
[Trainable] transformer.resblocks.2.attn.in_proj_weight
[Trainable] transformer.resblocks.2.attn.in_proj_bias
[Trainable] transformer.resblocks.2.attn.out_proj.weight
[Trainable] transformer.resblocks.2.attn.out_proj.bias
[Trainable] transformer.resblocks.2.ln_1.weight
[Trainable] transformer.resblocks.2.ln_1.bias
[Trainable] transformer.resblocks.2.mlp.c_fc.weight
[Trainable] transformer.resblocks.2.mlp.c_fc.bias
[Trainable] transformer.resblocks.2.mlp.c_proj.weight
[Trainable] transformer.resblocks.2.mlp.c_proj.bias
[Trainable] transformer.resblocks.2.ln_2.weight
[Trainable] transformer.resblocks.2.ln_2.bias
[Trainable] transformer.resblocks.3.attn.in_proj_weight
[Trainable] transformer.resblocks.3.attn.in_proj_bias
[Trainable] transformer.resblocks.3.attn.out_proj.weight
[Trainable] transformer.resblocks.3.attn.out_proj.bias
[Trainable] transformer.resblocks.3.ln_1.weight
[Trainable] transformer.resblocks.3.ln_1.bias
[Trainable] transformer.resblocks.3.mlp.c_fc.weight
[Trainable] transformer.resblocks.3.mlp.c_fc.bias
[Trainable] transformer.resblocks.3.mlp.c_proj.weight
[Trainable] transformer.resblocks.3.mlp.c_proj.bias
[Trainable] transformer.resblocks.3.ln_2.weight
[Trainable] transformer.resblocks.3.ln_2.bias
[Trainable] transformer.resblocks.4.attn.in_proj_weight
[Trainable] transformer.resblocks.4.attn.in_proj_bias
[Trainable] transformer.resblocks.4.attn.out_proj.weight
[Trainable] transformer.resblocks.4.attn.out_proj.bias
[Trainable] transformer.resblocks.4.ln_1.weight
[Trainable] transformer.resblocks.4.ln_1.bias
[Trainable] transformer.resblocks.4.mlp.c_fc.weight
[Trainable] transformer.resblocks.4.mlp.c_fc.bias
[Trainable] transformer.resblocks.4.mlp.c_proj.weight
[Trainable] transformer.resblocks.4.mlp.c_proj.bias
[Trainable] transformer.resblocks.4.ln_2.weight
[Trainable] transformer.resblocks.4.ln_2.bias
[Trainable] transformer.resblocks.5.attn.in_proj_weight
[Trainable] transformer.resblocks.5.attn.in_proj_bias
[Trainable] transformer.resblocks.5.attn.out_proj.weight
[Trainable] transformer.resblocks.5.attn.out_proj.bias
[Trainable] transformer.resblocks.5.ln_1.weight
[Trainable] transformer.resblocks.5.ln_1.bias
[Trainable] transformer.resblocks.5.mlp.c_fc.weight
[Trainable] transformer.resblocks.5.mlp.c_fc.bias
[Trainable] transformer.resblocks.5.mlp.c_proj.weight
[Trainable] transformer.resblocks.5.mlp.c_proj.bias
[Trainable] transformer.resblocks.5.ln_2.weight
[Trainable] transformer.resblocks.5.ln_2.bias
[Trainable] transformer.resblocks.6.attn.in_proj_weight
[Trainable] transformer.resblocks.6.attn.in_proj_bias
[Trainable] transformer.resblocks.6.attn.out_proj.weight
[Trainable] transformer.resblocks.6.attn.out_proj.bias
[Trainable] transformer.resblocks.6.ln_1.weight
[Trainable] transformer.resblocks.6.ln_1.bias
[Trainable] transformer.resblocks.6.mlp.c_fc.weight
[Trainable] transformer.resblocks.6.mlp.c_fc.bias
[Trainable] transformer.resblocks.6.mlp.c_proj.weight
[Trainable] transformer.resblocks.6.mlp.c_proj.bias
[Trainable] transformer.resblocks.6.ln_2.weight
[Trainable] transformer.resblocks.6.ln_2.bias
[Trainable] transformer.resblocks.7.attn.in_proj_weight
[Trainable] transformer.resblocks.7.attn.in_proj_bias
[Trainable] transformer.resblocks.7.attn.out_proj.weight
[Trainable] transformer.resblocks.7.attn.out_proj.bias
[Trainable] transformer.resblocks.7.ln_1.weight
[Trainable] transformer.resblocks.7.ln_1.bias
[Trainable] transformer.resblocks.7.mlp.c_fc.weight
[Trainable] transformer.resblocks.7.mlp.c_fc.bias
[Trainable] transformer.resblocks.7.mlp.c_proj.weight
[Trainable] transformer.resblocks.7.mlp.c_proj.bias
[Trainable] transformer.resblocks.7.ln_2.weight
[Trainable] transformer.resblocks.7.ln_2.bias
[Trainable] transformer.resblocks.8.attn.in_proj_weight
[Trainable] transformer.resblocks.8.attn.in_proj_bias
[Trainable] transformer.resblocks.8.attn.out_proj.weight
[Trainable] transformer.resblocks.8.attn.out_proj.bias
[Trainable] transformer.resblocks.8.ln_1.weight
[Trainable] transformer.resblocks.8.ln_1.bias
[Trainable] transformer.resblocks.8.mlp.c_fc.weight
[Trainable] transformer.resblocks.8.mlp.c_fc.bias
[Trainable] transformer.resblocks.8.mlp.c_proj.weight
[Trainable] transformer.resblocks.8.mlp.c_proj.bias
[Trainable] transformer.resblocks.8.ln_2.weight
[Trainable] transformer.resblocks.8.ln_2.bias
[Trainable] transformer.resblocks.9.attn.in_proj_weight
[Trainable] transformer.resblocks.9.attn.in_proj_bias
[Trainable] transformer.resblocks.9.attn.out_proj.weight
[Trainable] transformer.resblocks.9.attn.out_proj.bias
[Trainable] transformer.resblocks.9.ln_1.weight
[Trainable] transformer.resblocks.9.ln_1.bias
[Trainable] transformer.resblocks.9.mlp.c_fc.weight
[Trainable] transformer.resblocks.9.mlp.c_fc.bias
[Trainable] transformer.resblocks.9.mlp.c_proj.weight
[Trainable] transformer.resblocks.9.mlp.c_proj.bias
[Trainable] transformer.resblocks.9.ln_2.weight
[Trainable] transformer.resblocks.9.ln_2.bias
[Trainable] transformer.resblocks.10.attn.in_proj_weight
[Trainable] transformer.resblocks.10.attn.in_proj_bias
[Trainable] transformer.resblocks.10.attn.out_proj.weight
[Trainable] transformer.resblocks.10.attn.out_proj.bias
[Trainable] transformer.resblocks.10.ln_1.weight
[Trainable] transformer.resblocks.10.ln_1.bias
[Trainable] transformer.resblocks.10.mlp.c_fc.weight
[Trainable] transformer.resblocks.10.mlp.c_fc.bias
[Trainable] transformer.resblocks.10.mlp.c_proj.weight
[Trainable] transformer.resblocks.10.mlp.c_proj.bias
[Trainable] transformer.resblocks.10.ln_2.weight
[Trainable] transformer.resblocks.10.ln_2.bias
[Trainable] transformer.resblocks.11.attn.in_proj_weight
[Trainable] transformer.resblocks.11.attn.in_proj_bias
[Trainable] transformer.resblocks.11.attn.out_proj.weight
[Trainable] transformer.resblocks.11.attn.out_proj.bias
[Trainable] transformer.resblocks.11.ln_1.weight
[Trainable] transformer.resblocks.11.ln_1.bias
[Trainable] transformer.resblocks.11.mlp.c_fc.weight
[Trainable] transformer.resblocks.11.mlp.c_fc.bias
[Trainable] transformer.resblocks.11.mlp.c_proj.weight
[Trainable] transformer.resblocks.11.mlp.c_proj.bias
[Trainable] transformer.resblocks.11.ln_2.weight
[Trainable] transformer.resblocks.11.ln_2.bias
[Trainable] ln_post.weight
[Trainable] ln_post.bias
Total trainable CLIP params: 149695049
[DEBUG] PromptLearner trainable params: 442368
[DEBUG] CLIP trainable params: 149695049
[Prompt] cached 890 frozen image feats
[Epoch 1] Avg Prompt Loss: 2.9872
new best prompt – 2.9872
[Epoch 2] Avg Prompt Loss: 2.9660
new best prompt – 2.9660
[Epoch 3] Avg Prompt Loss: 2.4495
new best prompt – 2.4495
[Epoch 4] Avg Prompt Loss: 2.0843
new best prompt – 2.0843
[Epoch 5] Avg Prompt Loss: 1.8796
new best prompt – 1.8796
[Epoch 6] Avg Prompt Loss: 1.8318
new best prompt – 1.8318
[Epoch 7] Avg Prompt Loss: 1.7330
new best prompt – 1.7330
[Epoch 8] Avg Prompt Loss: 1.6364
new best prompt – 1.6364
[Epoch 9] Avg Prompt Loss: 1.5372
new best prompt – 1.5372
[Epoch 10] Avg Prompt Loss: 1.7217
[Epoch 11] Avg Prompt Loss: 1.5231
new best prompt – 1.5231
[Epoch 12] Avg Prompt Loss: 1.5684
[Epoch 13] Avg Prompt Loss: 1.6973
[Epoch 14] Avg Prompt Loss: 1.4299
new best prompt – 1.4299
[Epoch 15] Avg Prompt Loss: 1.4926
[Epoch 16] Avg Prompt Loss: 1.4127
new best prompt – 1.4127
[Epoch 17] Avg Prompt Loss: 1.4104
new best prompt – 1.4104
[Epoch 18] Avg Prompt Loss: 1.4971
[Epoch 19] Avg Prompt Loss: 1.3698
new best prompt – 1.3698
[Epoch 20] Avg Prompt Loss: 1.4768
[Epoch 21] Avg Prompt Loss: 1.4109
[Epoch 22] Avg Prompt Loss: 1.4296
[Epoch 23] Avg Prompt Loss: 1.3677
new best prompt – 1.3677
[Epoch 24] Avg Prompt Loss: 1.3024
new best prompt – 1.3024
[Epoch 25] Avg Prompt Loss: 1.4648
[Epoch 26] Avg Prompt Loss: 1.2615
new best prompt – 1.2615
[Epoch 27] Avg Prompt Loss: 1.4001
[Epoch 28] Avg Prompt Loss: 1.3578
[Epoch 29] Avg Prompt Loss: 1.4216
[Epoch 30] Avg Prompt Loss: 1.2963
[Epoch 1] Learning Rate: 0.000001
[Epoch 1] Running validation...
[Epoch 1] Loss Breakdown: ID = 16.6545, Triplet = 0.1103, Center = 477.4496, i2t = 0.7320, t2i = 0.7428
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 68.80%
RANK5: 86.92%
RANK10: 91.76%
MAP: 76.86%
 New BEST Image model saved
[Epoch 2] Learning Rate: 0.000001
[Epoch 2] Running validation...
[Epoch 2] Loss Breakdown: ID = 13.2741, Triplet = 0.1211, Center = 478.1122, i2t = 1.3707, t2i = 1.3618
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 77.96%
RANK5: 93.20%
RANK10: 96.50%
MAP: 84.66%
 New BEST Image model saved
[Epoch 3] Learning Rate: 0.000002
[Epoch 3] Running validation...
[Epoch 3] Loss Breakdown: ID = 11.9292, Triplet = 0.0650, Center = 484.6448, i2t = 0.7395, t2i = 0.7428
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 84.45%
RANK5: 94.95%
RANK10: 97.73%
MAP: 89.08%
 New BEST Image model saved
[Epoch 4] Learning Rate: 0.000003
[Epoch 4] Running validation...
[Epoch 4] Loss Breakdown: ID = 6.4220, Triplet = 0.0438, Center = 491.8212, i2t = 1.2234, t2i = 1.2380
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 88.98%
RANK5: 97.43%
RANK10: 99.07%
MAP: 92.62%
 New BEST Image model saved
[Epoch 5] Learning Rate: 0.000005
[Epoch 5] Running validation...
[Epoch 5] Loss Breakdown: ID = 3.2793, Triplet = 0.0300, Center = 491.7758, i2t = 0.8624, t2i = 0.8666
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 91.25%
RANK5: 97.63%
RANK10: 99.18%
MAP: 94.21%
 New BEST Image model saved
[Epoch 6] Learning Rate: 0.000008
[Epoch 6] Running validation...
[Epoch 6] Loss Breakdown: ID = 1.0575, Triplet = 0.0164, Center = 492.9665, i2t = 1.2228, t2i = 1.2380
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 94.54%
RANK5: 98.35%
RANK10: 99.59%
MAP: 96.22%
 New BEST Image model saved
[Epoch 7] Learning Rate: 0.000010
[Epoch 7] Running validation...
[Epoch 7] Loss Breakdown: ID = 0.5060, Triplet = 0.0022, Center = 496.3399, i2t = 0.7419, t2i = 0.7428
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.57%
RANK5: 98.76%
RANK10: 99.38%
MAP: 97.08%
 New BEST Image model saved
[Epoch 8] Learning Rate: 0.000014
[Epoch 8] Running validation...
[Epoch 8] Loss Breakdown: ID = 0.2554, Triplet = 0.0000, Center = 485.2643, i2t = 1.1061, t2i = 1.1142
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 94.44%
RANK5: 99.28%
RANK10: 99.69%
MAP: 96.70%
No improvement in loss. Patience counter: 1/5
[Epoch 9] Learning Rate: 0.000017
[Epoch 9] Running validation...
[Epoch 9] Loss Breakdown: ID = 0.1478, Triplet = 0.0003, Center = 480.0281, i2t = 1.3645, t2i = 1.3618
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.78%
RANK5: 99.59%
RANK10: 99.59%
MAP: 97.43%
 New BEST Image model saved
[Epoch 10] Learning Rate: 0.000021
[Epoch 10] Running validation...
[Epoch 10] Loss Breakdown: ID = 0.0145, Triplet = 0.0002, Center = 472.4265, i2t = 0.7129, t2i = 0.7428
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.98%
RANK5: 99.49%
RANK10: 99.79%
MAP: 97.53%
 New BEST Image model saved
[Epoch 11] Learning Rate: 0.000026
[Epoch 11] Running validation...
[Epoch 11] Loss Breakdown: ID = 0.0130, Triplet = 0.0009, Center = 463.7339, i2t = 0.7815, t2i = 0.7428
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 96.09%
RANK5: 99.38%
RANK10: 99.69%
MAP: 97.60%
 New BEST Image model saved
[Epoch 12] Learning Rate: 0.000030
[Epoch 12] Running validation...
[Epoch 12] Loss Breakdown: ID = 0.0182, Triplet = 0.0072, Center = 445.9091, i2t = 1.1821, t2i = 1.2380
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 96.60%
RANK5: 99.18%
RANK10: 99.59%
MAP: 97.79%
 New BEST Image model saved
[Epoch 13] Learning Rate: 0.000035
[Epoch 13] Running validation...
[Epoch 13] Loss Breakdown: ID = 0.0218, Triplet = 0.0010, Center = 417.5761, i2t = 1.3520, t2i = 1.3618
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.67%
RANK5: 99.38%
RANK10: 99.59%
MAP: 97.43%
No improvement in loss. Patience counter: 1/5
[Epoch 14] Learning Rate: 0.000040
[Epoch 14] Running validation...
[Epoch 14] Loss Breakdown: ID = 0.0283, Triplet = 0.0000, Center = 410.3761, i2t = 1.0235, t2i = 1.1142
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.98%
RANK5: 99.28%
RANK10: 99.69%
MAP: 97.37%
No improvement in loss. Patience counter: 2/5
[Epoch 15] Learning Rate: 0.000045
[Epoch 15] Running validation...
[Epoch 15] Loss Breakdown: ID = 0.0158, Triplet = 0.0000, Center = 413.5124, i2t = 0.3495, t2i = 0.3714
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 96.91%
RANK5: 99.49%
RANK10: 99.59%
MAP: 98.01%
 New BEST Image model saved
[Epoch 16] Learning Rate: 0.000051
[Epoch 16] Running validation...
[Epoch 16] Loss Breakdown: ID = 0.0194, Triplet = 0.0030, Center = 408.0687, i2t = 1.5307, t2i = 1.6094
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.78%
RANK5: 99.38%
RANK10: 99.69%
MAP: 97.27%
No improvement in loss. Patience counter: 1/5
[Epoch 17] Learning Rate: 0.000056
[Epoch 17] Running validation...
[Epoch 17] Loss Breakdown: ID = 0.0141, Triplet = 0.0031, Center = 382.5433, i2t = 1.6750, t2i = 1.7332
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 97.12%
RANK5: 99.38%
RANK10: 99.59%
MAP: 98.18%
 New BEST Image model saved
[Epoch 18] Learning Rate: 0.000061
[Epoch 18] Running validation...
[Epoch 18] Loss Breakdown: ID = 0.0250, Triplet = 0.0001, Center = 371.2296, i2t = 1.5688, t2i = 1.6094
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 95.26%
RANK5: 99.38%
RANK10: 99.69%
MAP: 97.11%
No improvement in loss. Patience counter: 1/5
[Epoch 19] Learning Rate: 0.000066
[Epoch 19] Running validation...
[Epoch 19] Loss Breakdown: ID = 0.0127, Triplet = 0.0102, Center = 372.4661, i2t = 1.0697, t2i = 1.1142
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 96.29%
RANK5: 99.18%
RANK10: 99.79%
MAP: 97.64%
No improvement in loss. Patience counter: 2/5
[Epoch 20] Learning Rate: 0.000071
[Epoch 20] Running validation...
[Epoch 20] Loss Breakdown: ID = 0.0072, Triplet = 0.0039, Center = 355.4359, i2t = 1.0076, t2i = 0.9904
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 97.01%
RANK5: 99.28%
RANK10: 99.59%
MAP: 98.11%
No improvement in loss. Patience counter: 3/5
[Epoch 21] Learning Rate: 0.000075
[Epoch 21] Running validation...
[Epoch 21] Loss Breakdown: ID = 0.0160, Triplet = 0.0110, Center = 335.7907, i2t = 1.8194, t2i = 1.8570
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 97.53%
RANK5: 99.49%
RANK10: 99.79%
MAP: 98.27%
 New BEST Image model saved
[Epoch 22] Learning Rate: 0.000080
[Epoch 22] Running validation...
[Epoch 22] Loss Breakdown: ID = 0.0331, Triplet = 0.0000, Center = 347.4972, i2t = 1.6387, t2i = 1.6094
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 98.66%
RANK5: 99.59%
RANK10: 99.69%
MAP: 99.10%
 New BEST Image model saved
[Epoch 23] Learning Rate: 0.000084
[Epoch 23] Running validation...
[Epoch 23] Loss Breakdown: ID = 14.6646, Triplet = 0.2069, Center = 418.7263, i2t = 1.2272, t2i = 1.2380
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 73.53%
RANK5: 86.82%
RANK10: 92.28%
MAP: 79.79%
No improvement in loss. Patience counter: 1/5
[Epoch 24] Learning Rate: 0.000087
[Epoch 24] Running validation...
[Epoch 24] Loss Breakdown: ID = 4.8115, Triplet = 0.1821, Center = 443.3715, i2t = 1.7162, t2i = 1.7332
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 85.79%
RANK5: 94.23%
RANK10: 96.91%
MAP: 89.64%
No improvement in loss. Patience counter: 2/5
[Epoch 25] Learning Rate: 0.000091
[Epoch 25] Running validation...
[Epoch 25] Loss Breakdown: ID = 2.6069, Triplet = 0.0439, Center = 479.7096, i2t = 1.7281, t2i = 1.7332
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 88.57%
RANK5: 96.09%
RANK10: 97.84%
MAP: 91.97%
No improvement in loss. Patience counter: 3/5
[Epoch 26] Learning Rate: 0.000093
[Epoch 26] Running validation...
[Epoch 26] Loss Breakdown: ID = 0.6333, Triplet = 0.0254, Center = 475.7780, i2t = 1.6795, t2i = 1.7332
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 91.25%
RANK5: 97.73%
RANK10: 98.76%
MAP: 93.78%
No improvement in loss. Patience counter: 4/5
[Epoch 27] Learning Rate: 0.000096
[Epoch 27] Running validation...
[Epoch 27] Loss Breakdown: ID = 0.0436, Triplet = 0.0001, Center = 473.3463, i2t = 0.9675, t2i = 0.9904
[Validation] Extracting features...
[Validation] Evaluating ranks and mAP...

[ReID Validation]
RANK1: 91.04%
RANK5: 97.63%
RANK10: 98.15%
MAP: 93.63%
No improvement in loss. Patience counter: 5/5
Early stopping triggered (prompt stage).
Restored BEST model for evaluation.
[Eval] Starting evaluation across all 10 splits (ReID style)
