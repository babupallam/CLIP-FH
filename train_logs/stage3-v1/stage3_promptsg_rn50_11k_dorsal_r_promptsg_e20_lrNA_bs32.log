2025-04-19 06:30:08,395 - INFO - Saving logs to: train_logs/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32.log
2025-04-19 06:30:08,395 - INFO - Using 72 classes | 28 training batches
2025-04-19 06:30:08,395 - INFO - ======= Stage 3: PromptSG Training =======
2025-04-19 06:30:08,395 - INFO - Experiment Name : stage3_promptsg
2025-04-19 06:30:08,395 - INFO - Model & Dataset : rn50, 11k, dorsal_r
2025-04-19 06:30:08,395 - INFO - Freeze Text Enc.: True
2025-04-19 06:30:08,395 - INFO - Loss Weights    : ID=1.0, Tri=1.0, SupCon=0
2025-04-19 06:30:08,398 - INFO - LR=1e-05 | Epochs=20 | BatchSize=32
2025-04-19 06:30:08,398 - INFO -  Epoch 1/20
2025-04-19 06:30:35,340 - INFO - [DEBUG] Pooled feature mean L2 norm: 1.0000
2025-04-19 06:30:35,342 - INFO - [DEBUG] Loss Breakdown  ID: 4.2758, SupCon: 3.5082, Tri: 0.1118
2025-04-19 06:30:35,436 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:30:35,436 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:30:35,534 - INFO - [DEBUG] Loss Breakdown  ID: 4.2720, SupCon: 3.5172, Tri: 0.1525
2025-04-19 06:30:35,712 - INFO - [DEBUG] Loss Breakdown  ID: 4.2698, SupCon: 3.5003, Tri: 0.1846
2025-04-19 06:30:35,889 - INFO - [DEBUG] Loss Breakdown  ID: 4.2671, SupCon: 3.5455, Tri: 0.1369
2025-04-19 06:30:36,067 - INFO - [DEBUG] Loss Breakdown  ID: 4.2648, SupCon: 3.5402, Tri: 0.1464
2025-04-19 06:30:36,245 - INFO - [DEBUG] Loss Breakdown  ID: 4.2637, SupCon: 3.5340, Tri: 0.0486
2025-04-19 06:30:36,419 - INFO - [DEBUG] Loss Breakdown  ID: 4.2616, SupCon: 3.4836, Tri: 0.0915
2025-04-19 06:30:36,599 - INFO - [DEBUG] Loss Breakdown  ID: 4.2570, SupCon: 3.5243, Tri: 0.1708
2025-04-19 06:30:36,776 - INFO - [DEBUG] Loss Breakdown  ID: 4.2497, SupCon: 3.5219, Tri: 0.1034
2025-04-19 06:30:36,952 - INFO - [DEBUG] Loss Breakdown  ID: 4.2499, SupCon: 3.5552, Tri: 0.0694
2025-04-19 06:30:37,130 - INFO - [DEBUG] Loss Breakdown  ID: 4.2496, SupCon: 3.5071, Tri: 0.1071
2025-04-19 06:30:37,309 - INFO - [DEBUG] Loss Breakdown  ID: 4.2573, SupCon: 3.5427, Tri: 0.1421
2025-04-19 06:30:37,489 - INFO - [DEBUG] Loss Breakdown  ID: 4.2542, SupCon: 3.4981, Tri: 0.1511
2025-04-19 06:30:37,664 - INFO - [DEBUG] Loss Breakdown  ID: 4.2572, SupCon: 3.5469, Tri: 0.0811
2025-04-19 06:30:37,843 - INFO - [DEBUG] Loss Breakdown  ID: 4.2481, SupCon: 3.5514, Tri: 0.0760
2025-04-19 06:30:38,020 - INFO - [DEBUG] Loss Breakdown  ID: 4.2414, SupCon: 3.5559, Tri: 0.1376
2025-04-19 06:30:38,199 - INFO - [DEBUG] Loss Breakdown  ID: 4.2395, SupCon: 3.5409, Tri: 0.1103
2025-04-19 06:30:38,375 - INFO - [DEBUG] Loss Breakdown  ID: 4.2631, SupCon: 3.5465, Tri: 0.0861
2025-04-19 06:30:38,554 - INFO - [DEBUG] Loss Breakdown  ID: 4.2281, SupCon: 3.5204, Tri: 0.1029
2025-04-19 06:30:38,731 - INFO - [DEBUG] Loss Breakdown  ID: 4.2237, SupCon: 3.5378, Tri: 0.0819
2025-04-19 06:30:38,909 - INFO - [DEBUG] Loss Breakdown  ID: 4.2360, SupCon: 3.4651, Tri: 0.0765
2025-04-19 06:30:39,086 - INFO - [DEBUG] Loss Breakdown  ID: 4.2334, SupCon: 3.5507, Tri: 0.0255
2025-04-19 06:30:39,260 - INFO - [DEBUG] Loss Breakdown  ID: 4.2530, SupCon: 3.4685, Tri: 0.0492
2025-04-19 06:30:39,437 - INFO - [DEBUG] Loss Breakdown  ID: 4.2501, SupCon: 3.5445, Tri: 0.0288
2025-04-19 06:30:39,610 - INFO - [DEBUG] Loss Breakdown  ID: 4.2504, SupCon: 3.5189, Tri: 0.1588
2025-04-19 06:30:39,787 - INFO - [DEBUG] Loss Breakdown  ID: 4.2264, SupCon: 3.4231, Tri: 0.1757
2025-04-19 06:30:39,961 - INFO - [DEBUG] Loss Breakdown  ID: 4.2456, SupCon: 3.4263, Tri: 0.0808
2025-04-19 06:30:40,167 - INFO - [DEBUG] Loss Breakdown  ID: 4.2509, SupCon: 3.3070, Tri: 0.0389
2025-04-19 06:30:40,916 - INFO - [Epoch 1] Total Loss=4.3559
2025-04-19 06:30:40,916 - INFO - Validating epoch 1...
2025-04-19 06:31:10,579 - INFO - [Epoch 1] Avg Train Loss = 4.3559 | 
2025-04-19 06:31:10,579 - INFO - ==================== Epoch 1 Validation ====================
2025-04-19 06:31:10,579 - INFO - Validation rank-1    : 52.11%
2025-04-19 06:31:10,579 - INFO - Validation rank-5    : 76.31%
2025-04-19 06:31:10,579 - INFO - Validation rank-10   : 84.24%
2025-04-19 06:31:10,579 - INFO - Validation mAP      : 63.48%
2025-04-19 06:31:10,579 - INFO - ============================================================
2025-04-19 06:31:10,579 - INFO - Saving best model at epoch 1 (Acc@1=52.11%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 06:31:11,491 - INFO -  Epoch 2/20
2025-04-19 06:31:36,150 - INFO - [DEBUG] Loss Breakdown  ID: 4.2175, SupCon: 3.6273, Tri: 0.0834
2025-04-19 06:31:36,228 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:31:36,231 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:31:36,330 - INFO - [DEBUG] Loss Breakdown  ID: 4.2142, SupCon: 3.5444, Tri: 0.1385
2025-04-19 06:31:36,507 - INFO - [DEBUG] Loss Breakdown  ID: 4.2297, SupCon: 3.5749, Tri: 0.0242
2025-04-19 06:31:36,684 - INFO - [DEBUG] Loss Breakdown  ID: 4.2205, SupCon: 3.5706, Tri: 0.0982
2025-04-19 06:31:36,864 - INFO - [DEBUG] Loss Breakdown  ID: 4.2226, SupCon: 3.6078, Tri: 0.1240
2025-04-19 06:31:37,039 - INFO - [DEBUG] Loss Breakdown  ID: 4.2570, SupCon: 3.5331, Tri: 0.0748
2025-04-19 06:31:37,219 - INFO - [DEBUG] Loss Breakdown  ID: 4.2152, SupCon: 3.5863, Tri: 0.1032
2025-04-19 06:31:37,397 - INFO - [DEBUG] Loss Breakdown  ID: 4.2065, SupCon: 3.5142, Tri: 0.1454
2025-04-19 06:31:37,572 - INFO - [DEBUG] Loss Breakdown  ID: 4.2339, SupCon: 3.5003, Tri: 0.0073
2025-04-19 06:31:37,748 - INFO - [DEBUG] Loss Breakdown  ID: 4.2216, SupCon: 3.4735, Tri: 0.0766
2025-04-19 06:31:37,928 - INFO - [DEBUG] Loss Breakdown  ID: 4.2207, SupCon: 3.5201, Tri: 0.1053
2025-04-19 06:31:38,103 - INFO - [DEBUG] Loss Breakdown  ID: 4.2209, SupCon: 3.5609, Tri: 0.0462
2025-04-19 06:31:38,279 - INFO - [DEBUG] Loss Breakdown  ID: 4.2052, SupCon: 3.6045, Tri: 0.0590
2025-04-19 06:31:38,457 - INFO - [DEBUG] Loss Breakdown  ID: 4.2200, SupCon: 3.6620, Tri: 0.0811
2025-04-19 06:31:38,633 - INFO - [DEBUG] Loss Breakdown  ID: 4.2270, SupCon: 3.6347, Tri: 0.0954
2025-04-19 06:31:38,811 - INFO - [DEBUG] Loss Breakdown  ID: 4.2183, SupCon: 3.6491, Tri: 0.0831
2025-04-19 06:31:38,988 - INFO - [DEBUG] Loss Breakdown  ID: 4.2405, SupCon: 3.5733, Tri: 0.0990
2025-04-19 06:31:39,164 - INFO - [DEBUG] Loss Breakdown  ID: 4.2213, SupCon: 3.5777, Tri: 0.0234
2025-04-19 06:31:39,341 - INFO - [DEBUG] Loss Breakdown  ID: 4.2139, SupCon: 3.5979, Tri: 0.0982
2025-04-19 06:31:39,521 - INFO - [DEBUG] Loss Breakdown  ID: 4.2165, SupCon: 3.5825, Tri: 0.0220
2025-04-19 06:31:39,698 - INFO - [DEBUG] Loss Breakdown  ID: 4.2122, SupCon: 3.5152, Tri: 0.0135
2025-04-19 06:31:39,875 - INFO - [DEBUG] Loss Breakdown  ID: 4.1948, SupCon: 3.5948, Tri: 0.1674
2025-04-19 06:31:40,050 - INFO - [DEBUG] Loss Breakdown  ID: 4.2039, SupCon: 3.5493, Tri: 0.0293
2025-04-19 06:31:40,225 - INFO - [DEBUG] Loss Breakdown  ID: 4.1918, SupCon: 3.5463, Tri: 0.0636
2025-04-19 06:31:40,398 - INFO - [DEBUG] Loss Breakdown  ID: 4.2076, SupCon: 3.4883, Tri: 0.0555
2025-04-19 06:31:40,572 - INFO - [DEBUG] Loss Breakdown  ID: 4.1796, SupCon: 3.5549, Tri: 0.0293
2025-04-19 06:31:40,746 - INFO - [DEBUG] Loss Breakdown  ID: 4.1778, SupCon: 3.5941, Tri: 0.0369
2025-04-19 06:31:40,906 - INFO - [DEBUG] Loss Breakdown  ID: 4.1678, SupCon: 3.4362, Tri: 0.0068
2025-04-19 06:31:41,653 - INFO - [Epoch 2] Total Loss=4.2846
2025-04-19 06:31:41,653 - INFO - Validating epoch 2...
2025-04-19 06:32:11,173 - INFO - [Epoch 2] Avg Train Loss = 4.2846 | 
2025-04-19 06:32:11,173 - INFO - ==================== Epoch 2 Validation ====================
2025-04-19 06:32:11,173 - INFO - Validation rank-1    : 63.34%
2025-04-19 06:32:11,173 - INFO - Validation rank-5    : 79.92%
2025-04-19 06:32:11,173 - INFO - Validation rank-10   : 87.74%
2025-04-19 06:32:11,176 - INFO - Validation mAP      : 71.20%
2025-04-19 06:32:11,176 - INFO - ============================================================
2025-04-19 06:32:11,176 - INFO - Saving best model at epoch 2 (Acc@1=63.34%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 06:32:12,174 - INFO -  Epoch 3/20
2025-04-19 06:32:36,525 - INFO - [DEBUG] Loss Breakdown  ID: 4.2081, SupCon: 3.6276, Tri: 0.1329
2025-04-19 06:32:36,606 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:32:36,606 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:32:36,706 - INFO - [DEBUG] Loss Breakdown  ID: 4.2089, SupCon: 3.5901, Tri: 0.0331
2025-04-19 06:32:36,883 - INFO - [DEBUG] Loss Breakdown  ID: 4.1585, SupCon: 3.6249, Tri: 0.0831
2025-04-19 06:32:37,062 - INFO - [DEBUG] Loss Breakdown  ID: 4.1728, SupCon: 3.6341, Tri: 0.0518
2025-04-19 06:32:37,241 - INFO - [DEBUG] Loss Breakdown  ID: 4.1629, SupCon: 3.6459, Tri: 0.0586
2025-04-19 06:32:37,420 - INFO - [DEBUG] Loss Breakdown  ID: 4.1757, SupCon: 3.5963, Tri: 0.1106
2025-04-19 06:32:37,595 - INFO - [DEBUG] Loss Breakdown  ID: 4.1941, SupCon: 3.5403, Tri: 0.0493
2025-04-19 06:32:37,775 - INFO - [DEBUG] Loss Breakdown  ID: 4.1727, SupCon: 3.4799, Tri: 0.0725
2025-04-19 06:32:37,951 - INFO - [DEBUG] Loss Breakdown  ID: 4.1645, SupCon: 3.4097, Tri: 0.0224
2025-04-19 06:32:38,133 - INFO - [DEBUG] Loss Breakdown  ID: 4.1851, SupCon: 3.5030, Tri: 0.0904
2025-04-19 06:32:38,308 - INFO - [DEBUG] Loss Breakdown  ID: 4.1794, SupCon: 3.4733, Tri: 0.0442
2025-04-19 06:32:38,486 - INFO - [DEBUG] Loss Breakdown  ID: 4.1715, SupCon: 3.4862, Tri: 0.0653
2025-04-19 06:32:38,665 - INFO - [DEBUG] Loss Breakdown  ID: 4.1553, SupCon: 3.4824, Tri: 0.0697
2025-04-19 06:32:38,841 - INFO - [DEBUG] Loss Breakdown  ID: 4.1587, SupCon: 3.4405, Tri: 0.0000
2025-04-19 06:32:39,020 - INFO - [DEBUG] Loss Breakdown  ID: 4.1403, SupCon: 3.4048, Tri: 0.0075
2025-04-19 06:32:39,200 - INFO - [DEBUG] Loss Breakdown  ID: 4.1410, SupCon: 3.5681, Tri: 0.1006
2025-04-19 06:32:39,376 - INFO - [DEBUG] Loss Breakdown  ID: 4.1598, SupCon: 3.4675, Tri: 0.0378
2025-04-19 06:32:39,554 - INFO - [DEBUG] Loss Breakdown  ID: 4.1421, SupCon: 3.5824, Tri: 0.0904
2025-04-19 06:32:39,734 - INFO - [DEBUG] Loss Breakdown  ID: 4.1504, SupCon: 3.5886, Tri: 0.0878
2025-04-19 06:32:39,911 - INFO - [DEBUG] Loss Breakdown  ID: 4.1315, SupCon: 3.5304, Tri: 0.0189
2025-04-19 06:32:40,086 - INFO - [DEBUG] Loss Breakdown  ID: 4.1746, SupCon: 3.4718, Tri: 0.0961
2025-04-19 06:32:40,266 - INFO - [DEBUG] Loss Breakdown  ID: 4.1674, SupCon: 3.5690, Tri: 0.0037
2025-04-19 06:32:40,439 - INFO - [DEBUG] Loss Breakdown  ID: 4.1656, SupCon: 3.5852, Tri: 0.0714
2025-04-19 06:32:40,615 - INFO - [DEBUG] Loss Breakdown  ID: 4.1532, SupCon: 3.5699, Tri: 0.0405
2025-04-19 06:32:40,792 - INFO - [DEBUG] Loss Breakdown  ID: 4.1402, SupCon: 3.6070, Tri: 0.0111
2025-04-19 06:32:40,966 - INFO - [DEBUG] Loss Breakdown  ID: 4.1611, SupCon: 3.5343, Tri: 0.0233
2025-04-19 06:32:41,143 - INFO - [DEBUG] Loss Breakdown  ID: 4.1557, SupCon: 3.5267, Tri: 0.0248
2025-04-19 06:32:41,303 - INFO - [DEBUG] Loss Breakdown  ID: 4.1743, SupCon: 3.4169, Tri: 0.0152
2025-04-19 06:32:42,060 - INFO - [Epoch 3] Total Loss=4.2192
2025-04-19 06:32:42,060 - INFO - Validating epoch 3...
2025-04-19 06:33:11,448 - INFO - [Epoch 3] Avg Train Loss = 4.2192 | 
2025-04-19 06:33:11,448 - INFO - ==================== Epoch 3 Validation ====================
2025-04-19 06:33:11,448 - INFO - Validation rank-1    : 62.51%
2025-04-19 06:33:11,448 - INFO - Validation rank-5    : 78.99%
2025-04-19 06:33:11,448 - INFO - Validation rank-10   : 84.65%
2025-04-19 06:33:11,448 - INFO - Validation mAP      : 70.20%
2025-04-19 06:33:11,448 - INFO - ============================================================
2025-04-19 06:33:11,448 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 06:33:11,448 - INFO -  Epoch 4/20
2025-04-19 06:33:35,716 - INFO - [DEBUG] Loss Breakdown  ID: 4.1398, SupCon: 3.6420, Tri: 0.1008
2025-04-19 06:33:35,800 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:33:35,800 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:33:35,897 - INFO - [DEBUG] Loss Breakdown  ID: 4.0924, SupCon: 3.6409, Tri: 0.0231
2025-04-19 06:33:36,074 - INFO - [DEBUG] Loss Breakdown  ID: 4.1333, SupCon: 3.7602, Tri: 0.0227
2025-04-19 06:33:36,254 - INFO - [DEBUG] Loss Breakdown  ID: 4.1393, SupCon: 3.6666, Tri: 0.0220
2025-04-19 06:33:36,434 - INFO - [DEBUG] Loss Breakdown  ID: 4.1365, SupCon: 3.6558, Tri: 0.0139
2025-04-19 06:33:36,612 - INFO - [DEBUG] Loss Breakdown  ID: 4.1406, SupCon: 3.6295, Tri: 0.0202
2025-04-19 06:33:36,786 - INFO - [DEBUG] Loss Breakdown  ID: 4.1371, SupCon: 3.5905, Tri: 0.0480
2025-04-19 06:33:36,964 - INFO - [DEBUG] Loss Breakdown  ID: 4.1164, SupCon: 3.6385, Tri: 0.0771
2025-04-19 06:33:37,144 - INFO - [DEBUG] Loss Breakdown  ID: 4.1494, SupCon: 3.5483, Tri: 0.0271
2025-04-19 06:33:37,320 - INFO - [DEBUG] Loss Breakdown  ID: 4.1519, SupCon: 3.6236, Tri: 0.0563
2025-04-19 06:33:37,498 - INFO - [DEBUG] Loss Breakdown  ID: 4.1393, SupCon: 3.6008, Tri: 0.0423
2025-04-19 06:33:37,676 - INFO - [DEBUG] Loss Breakdown  ID: 4.1104, SupCon: 3.6293, Tri: 0.0770
2025-04-19 06:33:37,853 - INFO - [DEBUG] Loss Breakdown  ID: 4.1163, SupCon: 3.5404, Tri: 0.0598
2025-04-19 06:33:38,030 - INFO - [DEBUG] Loss Breakdown  ID: 4.1325, SupCon: 3.5514, Tri: 0.0180
2025-04-19 06:33:38,208 - INFO - [DEBUG] Loss Breakdown  ID: 4.0797, SupCon: 3.5204, Tri: 0.0903
2025-04-19 06:33:38,385 - INFO - [DEBUG] Loss Breakdown  ID: 4.1230, SupCon: 3.4641, Tri: 0.0048
2025-04-19 06:33:38,566 - INFO - [DEBUG] Loss Breakdown  ID: 4.1192, SupCon: 3.5861, Tri: 0.0175
2025-04-19 06:33:38,738 - INFO - [DEBUG] Loss Breakdown  ID: 4.1066, SupCon: 3.4459, Tri: 0.0423
2025-04-19 06:33:38,915 - INFO - [DEBUG] Loss Breakdown  ID: 4.1213, SupCon: 3.5657, Tri: 0.0014
2025-04-19 06:33:39,095 - INFO - [DEBUG] Loss Breakdown  ID: 4.1531, SupCon: 3.5813, Tri: 0.0118
2025-04-19 06:33:39,272 - INFO - [DEBUG] Loss Breakdown  ID: 4.0981, SupCon: 3.5003, Tri: 0.0627
2025-04-19 06:33:39,449 - INFO - [DEBUG] Loss Breakdown  ID: 4.1362, SupCon: 3.5710, Tri: 0.0403
2025-04-19 06:33:39,626 - INFO - [DEBUG] Loss Breakdown  ID: 4.0921, SupCon: 3.6817, Tri: 0.0973
2025-04-19 06:33:39,800 - INFO - [DEBUG] Loss Breakdown  ID: 4.0650, SupCon: 3.5955, Tri: 0.0150
2025-04-19 06:33:39,971 - INFO - [DEBUG] Loss Breakdown  ID: 4.0971, SupCon: 3.6528, Tri: 0.0638
2025-04-19 06:33:40,148 - INFO - [DEBUG] Loss Breakdown  ID: 4.0924, SupCon: 3.5716, Tri: 0.0231
2025-04-19 06:33:40,322 - INFO - [DEBUG] Loss Breakdown  ID: 4.0699, SupCon: 3.6369, Tri: 0.0072
2025-04-19 06:33:40,481 - INFO - [DEBUG] Loss Breakdown  ID: 4.0866, SupCon: 3.3026, Tri: 0.0069
2025-04-19 06:33:41,233 - INFO - [Epoch 4] Total Loss=4.1560
2025-04-19 06:33:41,233 - INFO - Validating epoch 4...
2025-04-19 06:34:10,586 - INFO - [Epoch 4] Avg Train Loss = 4.1560 | 
2025-04-19 06:34:10,586 - INFO - ==================== Epoch 4 Validation ====================
2025-04-19 06:34:10,589 - INFO - Validation rank-1    : 65.50%
2025-04-19 06:34:10,589 - INFO - Validation rank-5    : 82.90%
2025-04-19 06:34:10,589 - INFO - Validation rank-10   : 89.80%
2025-04-19 06:34:10,589 - INFO - Validation mAP      : 73.48%
2025-04-19 06:34:10,589 - INFO - ============================================================
2025-04-19 06:34:10,589 - INFO - Saving best model at epoch 4 (Acc@1=65.50%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 06:34:11,593 - INFO -  Epoch 5/20
2025-04-19 06:34:35,905 - INFO - [DEBUG] Loss Breakdown  ID: 4.0276, SupCon: 3.5868, Tri: 0.0040
2025-04-19 06:34:35,987 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:34:35,987 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:34:36,083 - INFO - [DEBUG] Loss Breakdown  ID: 4.0911, SupCon: 3.6938, Tri: 0.0067
2025-04-19 06:34:36,262 - INFO - [DEBUG] Loss Breakdown  ID: 4.0929, SupCon: 3.5851, Tri: 0.0076
2025-04-19 06:34:36,437 - INFO - [DEBUG] Loss Breakdown  ID: 4.0681, SupCon: 3.5910, Tri: 0.0498
2025-04-19 06:34:36,615 - INFO - [DEBUG] Loss Breakdown  ID: 4.0937, SupCon: 3.6110, Tri: 0.0569
2025-04-19 06:34:36,795 - INFO - [DEBUG] Loss Breakdown  ID: 4.0676, SupCon: 3.5644, Tri: 0.0075
2025-04-19 06:34:36,975 - INFO - [DEBUG] Loss Breakdown  ID: 4.1329, SupCon: 3.5848, Tri: 0.0442
2025-04-19 06:34:37,154 - INFO - [DEBUG] Loss Breakdown  ID: 4.0694, SupCon: 3.4426, Tri: 0.0169
2025-04-19 06:34:37,331 - INFO - [DEBUG] Loss Breakdown  ID: 4.0560, SupCon: 3.5603, Tri: 0.0508
2025-04-19 06:34:37,511 - INFO - [DEBUG] Loss Breakdown  ID: 4.1006, SupCon: 3.5526, Tri: 0.0167
2025-04-19 06:34:37,689 - INFO - [DEBUG] Loss Breakdown  ID: 4.1246, SupCon: 3.6517, Tri: 0.0399
2025-04-19 06:34:37,867 - INFO - [DEBUG] Loss Breakdown  ID: 4.0603, SupCon: 3.5422, Tri: 0.0306
2025-04-19 06:34:38,048 - INFO - [DEBUG] Loss Breakdown  ID: 4.0938, SupCon: 3.5801, Tri: 0.0348
2025-04-19 06:34:38,225 - INFO - [DEBUG] Loss Breakdown  ID: 4.1146, SupCon: 3.5273, Tri: 0.0079
2025-04-19 06:34:38,404 - INFO - [DEBUG] Loss Breakdown  ID: 4.0758, SupCon: 3.6244, Tri: 0.0566
2025-04-19 06:34:38,582 - INFO - [DEBUG] Loss Breakdown  ID: 4.0514, SupCon: 3.5567, Tri: 0.0083
2025-04-19 06:34:38,760 - INFO - [DEBUG] Loss Breakdown  ID: 4.0517, SupCon: 3.6162, Tri: 0.0000
2025-04-19 06:34:38,937 - INFO - [DEBUG] Loss Breakdown  ID: 4.0255, SupCon: 3.5164, Tri: 0.0011
2025-04-19 06:34:39,112 - INFO - [DEBUG] Loss Breakdown  ID: 4.0906, SupCon: 3.5973, Tri: 0.0101
2025-04-19 06:34:39,289 - INFO - [DEBUG] Loss Breakdown  ID: 4.0504, SupCon: 3.5283, Tri: 0.0294
2025-04-19 06:34:39,469 - INFO - [DEBUG] Loss Breakdown  ID: 4.0533, SupCon: 3.5571, Tri: 0.0009
2025-04-19 06:34:39,643 - INFO - [DEBUG] Loss Breakdown  ID: 4.0266, SupCon: 3.6008, Tri: 0.0086
2025-04-19 06:34:39,817 - INFO - [DEBUG] Loss Breakdown  ID: 4.0504, SupCon: 3.6247, Tri: 0.0000
2025-04-19 06:34:39,993 - INFO - [DEBUG] Loss Breakdown  ID: 4.0734, SupCon: 3.5288, Tri: 0.0532
2025-04-19 06:34:40,167 - INFO - [DEBUG] Loss Breakdown  ID: 4.1151, SupCon: 3.6220, Tri: 0.0309
2025-04-19 06:34:40,343 - INFO - [DEBUG] Loss Breakdown  ID: 4.0364, SupCon: 3.6311, Tri: 0.0000
2025-04-19 06:34:40,518 - INFO - [DEBUG] Loss Breakdown  ID: 4.0714, SupCon: 3.5708, Tri: 0.0215
2025-04-19 06:34:40,678 - INFO - [DEBUG] Loss Breakdown  ID: 4.0829, SupCon: 3.3781, Tri: 0.0046
2025-04-19 06:34:41,422 - INFO - [Epoch 5] Total Loss=4.0946
2025-04-19 06:34:41,422 - INFO - Validating epoch 5...
2025-04-19 06:35:10,760 - INFO - [Epoch 5] Avg Train Loss = 4.0946 | 
2025-04-19 06:35:10,760 - INFO - ==================== Epoch 5 Validation ====================
2025-04-19 06:35:10,760 - INFO - Validation rank-1    : 48.51%
2025-04-19 06:35:10,760 - INFO - Validation rank-5    : 71.47%
2025-04-19 06:35:10,760 - INFO - Validation rank-10   : 79.61%
2025-04-19 06:35:10,760 - INFO - Validation mAP      : 58.77%
2025-04-19 06:35:10,760 - INFO - ============================================================
2025-04-19 06:35:10,760 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 06:35:10,760 - INFO -  Epoch 6/20
2025-04-19 06:35:35,295 - INFO - [DEBUG] Loss Breakdown  ID: 4.0964, SupCon: 3.5660, Tri: 0.0245
2025-04-19 06:35:35,379 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:35:35,379 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:35:35,473 - INFO - [DEBUG] Loss Breakdown  ID: 4.0947, SupCon: 3.6047, Tri: 0.0159
2025-04-19 06:35:35,652 - INFO - [DEBUG] Loss Breakdown  ID: 4.0334, SupCon: 3.5836, Tri: 0.0069
2025-04-19 06:35:35,829 - INFO - [DEBUG] Loss Breakdown  ID: 4.0447, SupCon: 3.6074, Tri: 0.0049
2025-04-19 06:35:36,009 - INFO - [DEBUG] Loss Breakdown  ID: 4.0500, SupCon: 3.4107, Tri: 0.1315
2025-04-19 06:35:36,185 - INFO - [DEBUG] Loss Breakdown  ID: 4.0268, SupCon: 3.5876, Tri: 0.0166
2025-04-19 06:35:36,365 - INFO - [DEBUG] Loss Breakdown  ID: 4.0747, SupCon: 3.4149, Tri: 0.0180
2025-04-19 06:35:36,544 - INFO - [DEBUG] Loss Breakdown  ID: 4.0741, SupCon: 3.5360, Tri: 0.0279
2025-04-19 06:35:36,721 - INFO - [DEBUG] Loss Breakdown  ID: 4.0312, SupCon: 3.6368, Tri: 0.0133
2025-04-19 06:35:36,897 - INFO - [DEBUG] Loss Breakdown  ID: 4.0572, SupCon: 3.6034, Tri: 0.0000
2025-04-19 06:35:37,071 - INFO - [DEBUG] Loss Breakdown  ID: 4.0464, SupCon: 3.5203, Tri: 0.0054
2025-04-19 06:35:37,248 - INFO - [DEBUG] Loss Breakdown  ID: 4.0001, SupCon: 3.5781, Tri: 0.0168
2025-04-19 06:35:37,425 - INFO - [DEBUG] Loss Breakdown  ID: 4.0345, SupCon: 3.5749, Tri: 0.0069
2025-04-19 06:35:37,601 - INFO - [DEBUG] Loss Breakdown  ID: 4.0118, SupCon: 3.5006, Tri: 0.0041
2025-04-19 06:35:37,778 - INFO - [DEBUG] Loss Breakdown  ID: 4.0399, SupCon: 3.5303, Tri: 0.0471
2025-04-19 06:35:37,955 - INFO - [DEBUG] Loss Breakdown  ID: 4.0530, SupCon: 3.5289, Tri: 0.0373
2025-04-19 06:35:38,131 - INFO - [DEBUG] Loss Breakdown  ID: 4.0216, SupCon: 3.5249, Tri: 0.0197
2025-04-19 06:35:38,307 - INFO - [DEBUG] Loss Breakdown  ID: 4.0190, SupCon: 3.4968, Tri: 0.0117
2025-04-19 06:35:38,484 - INFO - [DEBUG] Loss Breakdown  ID: 4.0199, SupCon: 3.5387, Tri: 0.0012
2025-04-19 06:35:38,661 - INFO - [DEBUG] Loss Breakdown  ID: 4.0275, SupCon: 3.7322, Tri: 0.0024
2025-04-19 06:35:38,836 - INFO - [DEBUG] Loss Breakdown  ID: 4.0020, SupCon: 3.4756, Tri: 0.0027
2025-04-19 06:35:39,015 - INFO - [DEBUG] Loss Breakdown  ID: 4.0125, SupCon: 3.5960, Tri: 0.0346
2025-04-19 06:35:39,186 - INFO - [DEBUG] Loss Breakdown  ID: 4.0005, SupCon: 3.6286, Tri: 0.0130
2025-04-19 06:35:39,363 - INFO - [DEBUG] Loss Breakdown  ID: 4.0142, SupCon: 3.4941, Tri: 0.0035
2025-04-19 06:35:39,537 - INFO - [DEBUG] Loss Breakdown  ID: 4.0433, SupCon: 3.6579, Tri: 0.0314
2025-04-19 06:35:39,711 - INFO - [DEBUG] Loss Breakdown  ID: 4.0328, SupCon: 3.6630, Tri: 0.0069
2025-04-19 06:35:39,888 - INFO - [DEBUG] Loss Breakdown  ID: 3.9939, SupCon: 3.7489, Tri: 0.0339
2025-04-19 06:35:40,047 - INFO - [DEBUG] Loss Breakdown  ID: 4.0194, SupCon: 3.5157, Tri: 0.0172
2025-04-19 06:35:40,788 - INFO - [Epoch 6] Total Loss=4.0547
2025-04-19 06:35:40,788 - INFO - Validating epoch 6...
2025-04-19 06:36:10,112 - INFO - [Epoch 6] Avg Train Loss = 4.0547 | 
2025-04-19 06:36:10,112 - INFO - ==================== Epoch 6 Validation ====================
2025-04-19 06:36:10,112 - INFO - Validation rank-1    : 48.09%
2025-04-19 06:36:10,112 - INFO - Validation rank-5    : 64.98%
2025-04-19 06:36:10,112 - INFO - Validation rank-10   : 73.33%
2025-04-19 06:36:10,112 - INFO - Validation mAP      : 56.92%
2025-04-19 06:36:10,112 - INFO - ============================================================
2025-04-19 06:36:10,112 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 06:36:10,112 - INFO -  Epoch 7/20
2025-04-19 06:36:34,474 - INFO - [DEBUG] Loss Breakdown  ID: 4.0354, SupCon: 3.6452, Tri: 0.0014
2025-04-19 06:36:34,556 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 06:36:34,556 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 06:36:34,655 - INFO - [DEBUG] Loss Breakdown  ID: 4.0053, SupCon: 3.7216, Tri: 0.0075
2025-04-19 06:36:34,829 - INFO - [DEBUG] Loss Breakdown  ID: 3.9961, SupCon: 3.5675, Tri: 0.0000
2025-04-19 06:36:35,009 - INFO - [DEBUG] Loss Breakdown  ID: 3.9921, SupCon: 3.7392, Tri: 0.0028
2025-04-19 06:36:35,187 - INFO - [DEBUG] Loss Breakdown  ID: 4.0072, SupCon: 3.7001, Tri: 0.0185
2025-04-19 06:36:35,365 - INFO - [DEBUG] Loss Breakdown  ID: 4.0215, SupCon: 3.6205, Tri: 0.0007
2025-04-19 06:36:35,540 - INFO - [DEBUG] Loss Breakdown  ID: 4.0074, SupCon: 3.4816, Tri: 0.0000
2025-04-19 06:36:35,722 - INFO - [DEBUG] Loss Breakdown  ID: 4.0025, SupCon: 3.5779, Tri: 0.0013
2025-04-19 06:36:35,899 - INFO - [DEBUG] Loss Breakdown  ID: 4.0231, SupCon: 3.6445, Tri: 0.0063
2025-04-19 06:36:36,078 - INFO - [DEBUG] Loss Breakdown  ID: 3.9551, SupCon: 3.5172, Tri: 0.0048
2025-04-19 06:36:36,255 - INFO - [DEBUG] Loss Breakdown  ID: 4.0221, SupCon: 3.5815, Tri: 0.0000
2025-04-19 06:36:36,432 - INFO - [DEBUG] Loss Breakdown  ID: 4.0042, SupCon: 3.5563, Tri: 0.0000
2025-04-19 06:36:36,613 - INFO - [DEBUG] Loss Breakdown  ID: 3.9770, SupCon: 3.5900, Tri: 0.0036
2025-04-19 06:36:36,787 - INFO - [DEBUG] Loss Breakdown  ID: 3.9980, SupCon: 3.5988, Tri: 0.0000
2025-04-19 06:36:36,964 - INFO - [DEBUG] Loss Breakdown  ID: 4.0310, SupCon: 3.6350, Tri: 0.0698
2025-04-19 06:36:37,141 - INFO - [DEBUG] Loss Breakdown  ID: 3.9889, SupCon: 3.5348, Tri: 0.0013
2025-04-19 06:36:37,321 - INFO - [DEBUG] Loss Breakdown  ID: 4.0156, SupCon: 3.6287, Tri: 0.0000
2025-04-19 06:36:37,498 - INFO - [DEBUG] Loss Breakdown  ID: 3.9578, SupCon: 3.5947, Tri: 0.0095
2025-04-19 06:36:37,672 - INFO - [DEBUG] Loss Breakdown  ID: 3.9915, SupCon: 3.5224, Tri: 0.0412
2025-04-19 06:36:37,849 - INFO - [DEBUG] Loss Breakdown  ID: 4.0005, SupCon: 3.5218, Tri: 0.0000
2025-04-19 06:36:38,025 - INFO - [DEBUG] Loss Breakdown  ID: 3.9919, SupCon: 3.5792, Tri: 0.0000
2025-04-19 06:36:38,201 - INFO - [DEBUG] Loss Breakdown  ID: 3.9656, SupCon: 3.5073, Tri: 0.0027
2025-04-19 06:36:38,373 - INFO - [DEBUG] Loss Breakdown  ID: 4.0028, SupCon: 3.6325, Tri: 0.0649
2025-04-19 06:36:38,547 - INFO - [DEBUG] Loss Breakdown  ID: 3.9742, SupCon: 3.5592, Tri: 0.0000
2025-04-19 06:36:38,718 - INFO - [DEBUG] Loss Breakdown  ID: 3.9802, SupCon: 3.6634, Tri: 0.0268
2025-04-19 06:36:38,892 - INFO - [DEBUG] Loss Breakdown  ID: 3.9451, SupCon: 3.5868, Tri: 0.0004
2025-04-19 06:36:39,067 - INFO - [DEBUG] Loss Breakdown  ID: 3.9643, SupCon: 3.6212, Tri: 0.0007
2025-04-19 06:36:39,225 - INFO - [DEBUG] Loss Breakdown  ID: 3.9458, SupCon: 3.3544, Tri: 0.0000
2025-04-19 06:36:39,969 - INFO - [Epoch 7] Total Loss=4.0024
2025-04-19 06:36:39,969 - INFO - Validating epoch 7...
2025-04-19 06:37:09,274 - INFO - [Epoch 7] Avg Train Loss = 4.0024 | 
2025-04-19 06:37:09,274 - INFO - ==================== Epoch 7 Validation ====================
2025-04-19 06:37:09,277 - INFO - Validation rank-1    : 55.41%
2025-04-19 06:37:09,277 - INFO - Validation rank-5    : 79.09%
2025-04-19 06:37:09,277 - INFO - Validation rank-10   : 88.05%
2025-04-19 06:37:09,277 - INFO - Validation mAP      : 65.60%
2025-04-19 06:37:09,277 - INFO - ============================================================
2025-04-19 06:37:09,277 - INFO - No improvement in Acc@1. Patience counter: 3/3
2025-04-19 06:37:09,277 - INFO - Early srankping at epoch 7 due to no improvement in rank-1 accuracy.
2025-04-19 06:37:10,277 - INFO - ====== FINAL SUMMARY ======
2025-04-19 06:37:10,277 - INFO - Total epochs       : 20
2025-04-19 06:37:10,277 - INFO - Avg Loss           : 56.4955
2025-04-19 06:37:10,277 - INFO - Best Acc@1 Epoch   : 4
2025-04-19 06:37:10,277 - INFO - Best Acc@1         : 65.50%
2025-04-19 06:37:10,277 - INFO - Best mAP            : 65.60%
2025-04-19 06:37:10,277 - INFO - ============================
