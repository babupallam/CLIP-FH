2025-04-16 13:01:38,070 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:01:38,070 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:01:38,070 - INFO - [DEBUG] logits std: 0.6970
2025-04-16 13:01:38,070 - INFO - [DEBUG] CE loss: 4.6556, Triplet loss: 0.0375, Total: 4.6931
2025-04-16 13:01:48,518 - INFO - [Epoch 1] Total Loss=3.8323
2025-04-16 13:01:48,518 - INFO - [Epoch 1] Acc@1=17.53% | Acc@5=35.51% | Acc@10=46.40%
2025-04-16 13:01:48,518 - INFO - [Validation] Extracting features...
2025-04-16 13:02:16,616 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:02:17,244 - INFO - 
[ReID Validation]
2025-04-16 13:02:17,244 - INFO - RANK1: 79.09%
2025-04-16 13:02:17,244 - INFO - RANK5: 95.16%
2025-04-16 13:02:17,244 - INFO - RANK10: 97.53%
2025-04-16 13:02:17,244 - INFO - MAP: 86.45%
2025-04-16 13:02:18,401 - INFO - Saving best model at epoch 1 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e1_lr1e-05_bs32_BEST.pth
2025-04-16 13:02:42,222 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:02:42,222 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:02:42,222 - INFO - [DEBUG] logits std: 0.5816
2025-04-16 13:02:42,222 - INFO - [DEBUG] CE loss: 2.8952, Triplet loss: 0.0000, Total: 2.8952
2025-04-16 13:02:52,681 - INFO - [Epoch 2] Total Loss=1.7854
2025-04-16 13:02:52,681 - INFO - [Epoch 2] Acc@1=76.18% | Acc@5=88.20% | Acc@10=92.25%
2025-04-16 13:02:52,681 - INFO - [Validation] Extracting features...
2025-04-16 13:03:22,707 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:03:23,473 - INFO - 
[ReID Validation]
2025-04-16 13:03:23,473 - INFO - RANK1: 88.77%
2025-04-16 13:03:23,473 - INFO - RANK5: 97.63%
2025-04-16 13:03:23,473 - INFO - RANK10: 98.76%
2025-04-16 13:03:23,473 - INFO - MAP: 92.68%
2025-04-16 13:03:24,659 - INFO - Saving best model at epoch 2 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e2_lr1e-05_bs32_BEST.pth
2025-04-16 13:03:49,820 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:03:49,820 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:03:49,820 - INFO - [DEBUG] logits std: 0.8796
2025-04-16 13:03:49,820 - INFO - [DEBUG] CE loss: 0.8539, Triplet loss: 0.0000, Total: 0.8539
2025-04-16 13:04:00,362 - INFO - [Epoch 3] Total Loss=0.5412
2025-04-16 13:04:00,362 - INFO - [Epoch 3] Acc@1=96.63% | Acc@5=99.10% | Acc@10=99.55%
2025-04-16 13:04:00,367 - INFO - [Validation] Extracting features...
2025-04-16 13:04:30,563 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:04:31,290 - INFO - 
[ReID Validation]
2025-04-16 13:04:31,290 - INFO - RANK1: 89.29%
2025-04-16 13:04:31,290 - INFO - RANK5: 97.32%
2025-04-16 13:04:31,290 - INFO - RANK10: 98.66%
2025-04-16 13:04:31,290 - INFO - MAP: 92.88%
2025-04-16 13:04:32,477 - INFO - Saving best model at epoch 3 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e3_lr1e-05_bs32_BEST.pth
2025-04-16 13:04:57,577 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:04:57,577 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:04:57,577 - INFO - [DEBUG] logits std: 1.0866
2025-04-16 13:04:57,577 - INFO - [DEBUG] CE loss: 0.1834, Triplet loss: 0.0000, Total: 0.1834
2025-04-16 13:05:08,051 - INFO - [Epoch 4] Total Loss=0.1363
2025-04-16 13:05:08,051 - INFO - [Epoch 4] Acc@1=99.78% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:05:08,056 - INFO - [Validation] Extracting features...
2025-04-16 13:05:37,662 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:05:38,302 - INFO - 
[ReID Validation]
2025-04-16 13:05:38,302 - INFO - RANK1: 91.35%
2025-04-16 13:05:38,302 - INFO - RANK5: 98.15%
2025-04-16 13:05:38,302 - INFO - RANK10: 98.87%
2025-04-16 13:05:38,302 - INFO - MAP: 94.51%
2025-04-16 13:05:39,423 - INFO - Saving best model at epoch 4 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e4_lr1e-05_bs32_BEST.pth
2025-04-16 13:06:04,151 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:06:04,151 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:06:04,151 - INFO - [DEBUG] logits std: 1.1574
2025-04-16 13:06:04,151 - INFO - [DEBUG] CE loss: 0.0703, Triplet loss: 0.0000, Total: 0.0703
2025-04-16 13:06:14,721 - INFO - [Epoch 5] Total Loss=0.0407
2025-04-16 13:06:14,721 - INFO - [Epoch 5] Acc@1=100.00% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:06:14,721 - INFO - [Validation] Extracting features...
2025-04-16 13:06:44,119 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:06:44,779 - INFO - 
[ReID Validation]
2025-04-16 13:06:44,779 - INFO - RANK1: 92.07%
2025-04-16 13:06:44,779 - INFO - RANK5: 98.15%
2025-04-16 13:06:44,779 - INFO - RANK10: 98.87%
2025-04-16 13:06:44,779 - INFO - MAP: 94.73%
2025-04-16 13:06:45,877 - INFO - Saving best model at epoch 5 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e5_lr1e-05_bs32_BEST.pth
2025-04-16 13:07:11,327 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:07:11,327 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:07:11,327 - INFO - [DEBUG] logits std: 1.2686
2025-04-16 13:07:11,327 - INFO - [DEBUG] CE loss: 0.0202, Triplet loss: 0.0000, Total: 0.0202
2025-04-16 13:07:21,915 - INFO - [Epoch 6] Total Loss=0.0125
2025-04-16 13:07:21,915 - INFO - [Epoch 6] Acc@1=100.00% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:07:21,915 - INFO - [Validation] Extracting features...
2025-04-16 13:07:52,431 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:07:53,116 - INFO - 
[ReID Validation]
2025-04-16 13:07:53,116 - INFO - RANK1: 93.92%
2025-04-16 13:07:53,116 - INFO - RANK5: 97.84%
2025-04-16 13:07:53,116 - INFO - RANK10: 99.28%
2025-04-16 13:07:53,116 - INFO - MAP: 95.56%
2025-04-16 13:07:54,231 - INFO - Saving best model at epoch 6 -> saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e6_lr1e-05_bs32_BEST.pth
2025-04-16 13:08:20,112 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:08:20,112 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:08:20,112 - INFO - [DEBUG] logits std: 1.3682
2025-04-16 13:08:20,112 - INFO - [DEBUG] CE loss: 0.0055, Triplet loss: 0.0000, Total: 0.0055
2025-04-16 13:08:30,731 - INFO - [Epoch 7] Total Loss=0.0042
2025-04-16 13:08:30,731 - INFO - [Epoch 7] Acc@1=100.00% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:08:30,731 - INFO - [Validation] Extracting features...
2025-04-16 13:08:59,820 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:09:00,454 - INFO - 
[ReID Validation]
2025-04-16 13:09:00,454 - INFO - RANK1: 92.58%
2025-04-16 13:09:00,454 - INFO - RANK5: 98.25%
2025-04-16 13:09:00,454 - INFO - RANK10: 99.28%
2025-04-16 13:09:00,454 - INFO - MAP: 94.95%
2025-04-16 13:09:00,454 - INFO - [INFO] No improvement in Rank-1 (92.58%), patience = 1/3
2025-04-16 13:09:25,290 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:09:25,290 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:09:25,290 - INFO - [DEBUG] logits std: 1.4526
2025-04-16 13:09:25,290 - INFO - [DEBUG] CE loss: 0.0026, Triplet loss: 0.0000, Total: 0.0026
2025-04-16 13:09:35,825 - INFO - [Epoch 8] Total Loss=0.0023
2025-04-16 13:09:35,825 - INFO - [Epoch 8] Acc@1=100.00% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:09:35,825 - INFO - [Validation] Extracting features...
2025-04-16 13:10:05,165 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:10:05,841 - INFO - 
[ReID Validation]
2025-04-16 13:10:05,841 - INFO - RANK1: 92.28%
2025-04-16 13:10:05,841 - INFO - RANK5: 98.46%
2025-04-16 13:10:05,841 - INFO - RANK10: 99.38%
2025-04-16 13:10:05,841 - INFO - MAP: 95.00%
2025-04-16 13:10:05,841 - INFO - [INFO] No improvement in Rank-1 (92.28%), patience = 2/3
2025-04-16 13:10:31,476 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-16 13:10:31,476 - INFO - [DEBUG] img_features: torch.Size([32, 512]), prompt: N/A, pooled: torch.Size([32, 72])
2025-04-16 13:10:31,481 - INFO - [DEBUG] logits std: 1.4876
2025-04-16 13:10:31,481 - INFO - [DEBUG] CE loss: 0.0018, Triplet loss: 0.0000, Total: 0.0018
2025-04-16 13:10:42,055 - INFO - [Epoch 9] Total Loss=0.0017
2025-04-16 13:10:42,055 - INFO - [Epoch 9] Acc@1=100.00% | Acc@5=100.00% | Acc@10=100.00%
2025-04-16 13:10:42,055 - INFO - [Validation] Extracting features...
2025-04-16 13:11:11,707 - INFO - [Validation] Evaluating ranks and mAP...
2025-04-16 13:11:12,340 - INFO - 
[ReID Validation]
2025-04-16 13:11:12,340 - INFO - RANK1: 93.31%
2025-04-16 13:11:12,340 - INFO - RANK5: 98.66%
2025-04-16 13:11:12,340 - INFO - RANK10: 99.38%
2025-04-16 13:11:12,340 - INFO - MAP: 95.49%
2025-04-16 13:11:12,340 - INFO - [INFO] No improvement in Rank-1 (93.31%), patience = 3/3
2025-04-16 13:11:12,340 - INFO - [EARLY STOPPING] No improvement for 3 consecutive epochs. Stopping at epoch 9.
2025-04-16 13:11:13,490 - INFO - Model saved to: saved_models/stage1_frozen_text_vitb16_11k_dorsal_r_prompt_nctxNA_e9_lr1e-05_bs32_FINAL.pth
