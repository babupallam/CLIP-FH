Saving logs to: train_logs/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32.log
Using 72 classes | 28 training batches
======= Stage 3: PromptSG Training =======
Experiment Name : stage3_promptsg
Model & Dataset : vitb16, 11k, dorsal_r
Freeze Text Enc.: True
Loss Weights    : ID=0.2, Tri=1.0, SupCon=0
LR=2.2e-06 | Epochs=60 | BatchSize=32
 Epoch 1/60
[Epoch 1] Learning rate: 0.000002
[DEBUG] Pooled feature mean L2 norm: 1.0000
[DEBUG] ArcFace confidence: 0.2835
[DEBUG] Loss Breakdown — ID: 18.2670, SupCon: 0.9058, Tri: 0.0889
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2547
[DEBUG] Loss Breakdown — ID: 18.8168, SupCon: 1.2899, Tri: 0.0897
[DEBUG] ArcFace confidence: 0.2606
[DEBUG] Loss Breakdown — ID: 18.4284, SupCon: 1.5540, Tri: 0.1243
[DEBUG] ArcFace confidence: 0.2621
[DEBUG] Loss Breakdown — ID: 18.2171, SupCon: 0.9187, Tri: 0.0840
[DEBUG] ArcFace confidence: 0.2578
[DEBUG] Loss Breakdown — ID: 17.8204, SupCon: 2.0258, Tri: 0.1503
[DEBUG] ArcFace confidence: 0.2864
[DEBUG] Loss Breakdown — ID: 18.4118, SupCon: 1.5399, Tri: 0.1248
[DEBUG] ArcFace confidence: 0.2891
[DEBUG] Loss Breakdown — ID: 17.5859, SupCon: 1.3768, Tri: 0.1210
[DEBUG] ArcFace confidence: 0.2484
[DEBUG] Loss Breakdown — ID: 17.7542, SupCon: 2.3980, Tri: 0.2092
[DEBUG] ArcFace confidence: 0.2906
[DEBUG] Loss Breakdown — ID: 17.7536, SupCon: 1.8785, Tri: 0.1616
[DEBUG] ArcFace confidence: 0.2549
[DEBUG] Loss Breakdown — ID: 17.4514, SupCon: 1.2072, Tri: 0.1071
[DEBUG] ArcFace confidence: 0.2680
[DEBUG] Loss Breakdown — ID: 17.0241, SupCon: 1.9427, Tri: 0.1595
[DEBUG] ArcFace confidence: 0.2966
[DEBUG] Loss Breakdown — ID: 17.4333, SupCon: 1.2162, Tri: 0.0850
[DEBUG] ArcFace confidence: 0.2008
[DEBUG] Loss Breakdown — ID: 16.6654, SupCon: 1.9106, Tri: 0.1281
[DEBUG] ArcFace confidence: 0.2372
[DEBUG] Loss Breakdown — ID: 16.4204, SupCon: 1.7859, Tri: 0.1497
[DEBUG] ArcFace confidence: 0.2491
[DEBUG] Loss Breakdown — ID: 16.1473, SupCon: 1.6959, Tri: 0.0982
[DEBUG] ArcFace confidence: 0.2734
[DEBUG] Loss Breakdown — ID: 16.7019, SupCon: 1.9255, Tri: 0.1275
[DEBUG] ArcFace confidence: 0.2835
[DEBUG] Loss Breakdown — ID: 15.9295, SupCon: 1.8340, Tri: 0.1281
[DEBUG] ArcFace confidence: 0.2258
[DEBUG] Loss Breakdown — ID: 15.6269, SupCon: 1.9090, Tri: 0.1360
[DEBUG] ArcFace confidence: 0.2531
[DEBUG] Loss Breakdown — ID: 15.6828, SupCon: 1.7132, Tri: 0.1068
[DEBUG] ArcFace confidence: 0.2676
[DEBUG] Loss Breakdown — ID: 15.8506, SupCon: 0.5777, Tri: 0.0426
[DEBUG] ArcFace confidence: 0.2273
[DEBUG] Loss Breakdown — ID: 15.0658, SupCon: 1.5105, Tri: 0.0864
[DEBUG] ArcFace confidence: 0.2171
[DEBUG] Loss Breakdown — ID: 15.5296, SupCon: 1.3053, Tri: 0.0822
[DEBUG] ArcFace confidence: 0.2824
[DEBUG] Loss Breakdown — ID: 15.0957, SupCon: 1.7029, Tri: 0.1204
[DEBUG] ArcFace confidence: 0.2874
[DEBUG] Loss Breakdown — ID: 14.7998, SupCon: 1.5303, Tri: 0.0798
[DEBUG] ArcFace confidence: 0.2661
[DEBUG] Loss Breakdown — ID: 15.0061, SupCon: 1.7161, Tri: 0.1157
[DEBUG] ArcFace confidence: 0.2463
[DEBUG] Loss Breakdown — ID: 15.2145, SupCon: 1.6775, Tri: 0.0787
[DEBUG] ArcFace confidence: 0.2943
[DEBUG] Loss Breakdown — ID: 14.2021, SupCon: 1.1142, Tri: 0.0533
[DEBUG] ArcFace confidence: 0.2235
[DEBUG] Loss Breakdown — ID: 13.6563, SupCon: 1.7005, Tri: 0.1106
[Epoch 1] Total Loss=3.4165
Validating epoch 1...
[Epoch 1] Avg Train Loss = 3.4165 | 
==================== Epoch 1 Validation ====================
Validation rank-1    : 75.39%
Validation rank-5    : 92.48%
Validation rank-10   : 97.32%
Validation mAP      : 82.84%
============================================================
Saving best model at epoch 1 (Acc@1=75.39%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 2/60
[Epoch 2] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2677
[DEBUG] Loss Breakdown — ID: 13.7542, SupCon: 1.0097, Tri: 0.0496
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2469
[DEBUG] Loss Breakdown — ID: 13.2128, SupCon: 1.7160, Tri: 0.0676
[DEBUG] ArcFace confidence: 0.2263
[DEBUG] Loss Breakdown — ID: 14.3966, SupCon: 1.4399, Tri: 0.0732
[DEBUG] ArcFace confidence: 0.1979
[DEBUG] Loss Breakdown — ID: 13.2809, SupCon: 1.2368, Tri: 0.0618
[DEBUG] ArcFace confidence: 0.2997
[DEBUG] Loss Breakdown — ID: 13.9691, SupCon: 1.2986, Tri: 0.0679
[DEBUG] ArcFace confidence: 0.2537
[DEBUG] Loss Breakdown — ID: 12.5174, SupCon: 1.8715, Tri: 0.0507
[DEBUG] ArcFace confidence: 0.2779
[DEBUG] Loss Breakdown — ID: 13.1391, SupCon: 1.2706, Tri: 0.0417
[DEBUG] ArcFace confidence: 0.2233
[DEBUG] Loss Breakdown — ID: 12.6384, SupCon: 1.9705, Tri: 0.0749
[DEBUG] ArcFace confidence: 0.2764
[DEBUG] Loss Breakdown — ID: 13.0396, SupCon: 2.0410, Tri: 0.0630
[DEBUG] ArcFace confidence: 0.2481
[DEBUG] Loss Breakdown — ID: 11.8943, SupCon: 1.4655, Tri: 0.0718
[DEBUG] ArcFace confidence: 0.2178
[DEBUG] Loss Breakdown — ID: 12.1670, SupCon: 2.1476, Tri: 0.0887
[DEBUG] ArcFace confidence: 0.2520
[DEBUG] Loss Breakdown — ID: 11.5654, SupCon: 1.4400, Tri: 0.0496
[DEBUG] ArcFace confidence: 0.2400
[DEBUG] Loss Breakdown — ID: 12.7500, SupCon: 1.2307, Tri: 0.0441
[DEBUG] ArcFace confidence: 0.2521
[DEBUG] Loss Breakdown — ID: 12.6011, SupCon: 1.1181, Tri: 0.0346
[DEBUG] ArcFace confidence: 0.2506
[DEBUG] Loss Breakdown — ID: 11.6879, SupCon: 2.1241, Tri: 0.0652
[DEBUG] ArcFace confidence: 0.2546
[DEBUG] Loss Breakdown — ID: 12.0995, SupCon: 1.9250, Tri: 0.0309
[DEBUG] ArcFace confidence: 0.2067
[DEBUG] Loss Breakdown — ID: 12.1183, SupCon: 1.9809, Tri: 0.0499
[DEBUG] ArcFace confidence: 0.2374
[DEBUG] Loss Breakdown — ID: 11.8781, SupCon: 1.2499, Tri: 0.0279
[DEBUG] ArcFace confidence: 0.2677
[DEBUG] Loss Breakdown — ID: 11.0339, SupCon: 1.1999, Tri: 0.0112
[DEBUG] ArcFace confidence: 0.2246
[DEBUG] Loss Breakdown — ID: 10.2929, SupCon: 2.1441, Tri: 0.0173
[DEBUG] ArcFace confidence: 0.2376
[DEBUG] Loss Breakdown — ID: 11.3381, SupCon: 1.7316, Tri: 0.0416
[DEBUG] ArcFace confidence: 0.2460
[DEBUG] Loss Breakdown — ID: 11.0080, SupCon: 1.4201, Tri: 0.0133
[DEBUG] ArcFace confidence: 0.3080
[DEBUG] Loss Breakdown — ID: 11.3912, SupCon: 2.1172, Tri: 0.0651
[DEBUG] ArcFace confidence: 0.2577
[DEBUG] Loss Breakdown — ID: 9.9643, SupCon: 0.6956, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2156
[DEBUG] Loss Breakdown — ID: 10.2882, SupCon: 2.1765, Tri: 0.0228
[DEBUG] ArcFace confidence: 0.2200
[DEBUG] Loss Breakdown — ID: 10.1481, SupCon: 1.8748, Tri: 0.0126
[DEBUG] ArcFace confidence: 0.2360
[DEBUG] Loss Breakdown — ID: 10.4527, SupCon: 1.0681, Tri: 0.0069
[DEBUG] ArcFace confidence: 0.2616
[DEBUG] Loss Breakdown — ID: 11.4742, SupCon: 1.4224, Tri: 0.0145
[Epoch 2] Total Loss=2.4442
Validating epoch 2...
[Epoch 2] Avg Train Loss = 2.4442 | 
==================== Epoch 2 Validation ====================
Validation rank-1    : 80.84%
Validation rank-5    : 95.47%
Validation rank-10   : 97.73%
Validation mAP      : 87.27%
============================================================
Saving best model at epoch 2 (Acc@1=80.84%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 3/60
[Epoch 3] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2104
[DEBUG] Loss Breakdown — ID: 9.4027, SupCon: 1.4635, Tri: 0.0194
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2499
[DEBUG] Loss Breakdown — ID: 9.4904, SupCon: 1.7757, Tri: 0.0113
[DEBUG] ArcFace confidence: 0.2267
[DEBUG] Loss Breakdown — ID: 11.5151, SupCon: 1.5018, Tri: 0.0266
[DEBUG] ArcFace confidence: 0.2179
[DEBUG] Loss Breakdown — ID: 9.2559, SupCon: 1.4539, Tri: 0.0027
[DEBUG] ArcFace confidence: 0.2384
[DEBUG] Loss Breakdown — ID: 10.1123, SupCon: 1.3362, Tri: 0.0291
[DEBUG] ArcFace confidence: 0.2298
[DEBUG] Loss Breakdown — ID: 8.7435, SupCon: 1.1712, Tri: 0.0029
[DEBUG] ArcFace confidence: 0.2300
[DEBUG] Loss Breakdown — ID: 8.3764, SupCon: 1.7572, Tri: 0.0157
[DEBUG] ArcFace confidence: 0.2357
[DEBUG] Loss Breakdown — ID: 9.3675, SupCon: 1.7311, Tri: 0.0197
[DEBUG] ArcFace confidence: 0.2951
[DEBUG] Loss Breakdown — ID: 10.1248, SupCon: 1.4187, Tri: 0.0341
[DEBUG] ArcFace confidence: 0.1771
[DEBUG] Loss Breakdown — ID: 7.5961, SupCon: 1.6968, Tri: 0.0093
[DEBUG] ArcFace confidence: 0.1715
[DEBUG] Loss Breakdown — ID: 6.8446, SupCon: 2.4733, Tri: 0.0037
[DEBUG] ArcFace confidence: 0.2111
[DEBUG] Loss Breakdown — ID: 8.9315, SupCon: 1.3661, Tri: 0.0313
[DEBUG] ArcFace confidence: 0.2421
[DEBUG] Loss Breakdown — ID: 7.6574, SupCon: 1.3198, Tri: 0.0014
[DEBUG] ArcFace confidence: 0.2210
[DEBUG] Loss Breakdown — ID: 8.4133, SupCon: 0.9932, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2513
[DEBUG] Loss Breakdown — ID: 8.5410, SupCon: 1.7478, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2609
[DEBUG] Loss Breakdown — ID: 9.4761, SupCon: 0.9834, Tri: 0.0162
[DEBUG] ArcFace confidence: 0.2476
[DEBUG] Loss Breakdown — ID: 7.6874, SupCon: 1.6293, Tri: 0.0067
[DEBUG] ArcFace confidence: 0.2898
[DEBUG] Loss Breakdown — ID: 8.2665, SupCon: 1.4004, Tri: 0.0095
[DEBUG] ArcFace confidence: 0.2314
[DEBUG] Loss Breakdown — ID: 8.0899, SupCon: 1.9873, Tri: 0.0259
[DEBUG] ArcFace confidence: 0.2460
[DEBUG] Loss Breakdown — ID: 8.3007, SupCon: 1.5340, Tri: 0.0205
[DEBUG] ArcFace confidence: 0.2319
[DEBUG] Loss Breakdown — ID: 6.8602, SupCon: 1.1704, Tri: 0.0098
[DEBUG] ArcFace confidence: 0.2409
[DEBUG] Loss Breakdown — ID: 9.0438, SupCon: 1.5477, Tri: 0.0075
[DEBUG] ArcFace confidence: 0.2843
[DEBUG] Loss Breakdown — ID: 7.5294, SupCon: 1.7128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3043
[DEBUG] Loss Breakdown — ID: 7.5991, SupCon: 0.8015, Tri: 0.0100
[DEBUG] ArcFace confidence: 0.2242
[DEBUG] Loss Breakdown — ID: 8.5804, SupCon: 0.6573, Tri: 0.0116
[DEBUG] ArcFace confidence: 0.2658
[DEBUG] Loss Breakdown — ID: 8.2348, SupCon: 1.3004, Tri: 0.0006
[DEBUG] ArcFace confidence: 0.2648
[DEBUG] Loss Breakdown — ID: 6.8287, SupCon: 1.6623, Tri: 0.0103
[DEBUG] ArcFace confidence: 0.2558
[DEBUG] Loss Breakdown — ID: 6.5716, SupCon: 1.6988, Tri: 0.0000
[Epoch 3] Total Loss=1.7080
Validating epoch 3...
[Epoch 3] Avg Train Loss = 1.7080 | 
==================== Epoch 3 Validation ====================
Validation rank-1    : 86.41%
Validation rank-5    : 97.53%
Validation rank-10   : 98.66%
Validation mAP      : 91.14%
============================================================
Saving best model at epoch 3 (Acc@1=86.41%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 4/60
[Epoch 4] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2482
[DEBUG] Loss Breakdown — ID: 7.1102, SupCon: 1.7355, Tri: 0.0149
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2867
[DEBUG] Loss Breakdown — ID: 6.6091, SupCon: 1.0768, Tri: 0.0015
[DEBUG] ArcFace confidence: 0.2595
[DEBUG] Loss Breakdown — ID: 6.0081, SupCon: 1.2970, Tri: 0.0067
[DEBUG] ArcFace confidence: 0.2355
[DEBUG] Loss Breakdown — ID: 4.6129, SupCon: 1.9782, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2304
[DEBUG] Loss Breakdown — ID: 5.6050, SupCon: 2.1856, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2762
[DEBUG] Loss Breakdown — ID: 6.5724, SupCon: 2.2185, Tri: 0.0498
[DEBUG] ArcFace confidence: 0.3235
[DEBUG] Loss Breakdown — ID: 6.7523, SupCon: 0.9706, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3584
[DEBUG] Loss Breakdown — ID: 5.4658, SupCon: 1.9506, Tri: 0.0005
[DEBUG] ArcFace confidence: 0.2907
[DEBUG] Loss Breakdown — ID: 7.3126, SupCon: 1.5280, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3276
[DEBUG] Loss Breakdown — ID: 5.1414, SupCon: 2.6084, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3372
[DEBUG] Loss Breakdown — ID: 4.4778, SupCon: 2.3366, Tri: 0.0047
[DEBUG] ArcFace confidence: 0.3648
[DEBUG] Loss Breakdown — ID: 6.2493, SupCon: 1.7006, Tri: 0.0108
[DEBUG] ArcFace confidence: 0.2632
[DEBUG] Loss Breakdown — ID: 7.3858, SupCon: 1.5307, Tri: 0.0216
[DEBUG] ArcFace confidence: 0.3375
[DEBUG] Loss Breakdown — ID: 5.8795, SupCon: 1.7086, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3401
[DEBUG] Loss Breakdown — ID: 5.6685, SupCon: 1.3359, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3369
[DEBUG] Loss Breakdown — ID: 6.8787, SupCon: 2.1342, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3069
[DEBUG] Loss Breakdown — ID: 5.8204, SupCon: 1.2371, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3429
[DEBUG] Loss Breakdown — ID: 5.9596, SupCon: 1.1380, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2547
[DEBUG] Loss Breakdown — ID: 4.7798, SupCon: 2.2945, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3197
[DEBUG] Loss Breakdown — ID: 5.9494, SupCon: 1.6221, Tri: 0.0025
[DEBUG] ArcFace confidence: 0.3275
[DEBUG] Loss Breakdown — ID: 6.9131, SupCon: 0.2468, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3337
[DEBUG] Loss Breakdown — ID: 6.6169, SupCon: 0.8486, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3528
[DEBUG] Loss Breakdown — ID: 5.7902, SupCon: 1.5200, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3285
[DEBUG] Loss Breakdown — ID: 5.5631, SupCon: 1.4321, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3320
[DEBUG] Loss Breakdown — ID: 6.3076, SupCon: 1.5838, Tri: 0.0065
[DEBUG] ArcFace confidence: 0.3369
[DEBUG] Loss Breakdown — ID: 4.9490, SupCon: 2.2851, Tri: 0.0003
[DEBUG] ArcFace confidence: 0.3314
[DEBUG] Loss Breakdown — ID: 5.3686, SupCon: 2.1044, Tri: 0.0013
[DEBUG] ArcFace confidence: 0.3728
[DEBUG] Loss Breakdown — ID: 4.7961, SupCon: 1.0394, Tri: 0.0000
[Epoch 4] Total Loss=1.1939
Validating epoch 4...
[Epoch 4] Avg Train Loss = 1.1939 | 
==================== Epoch 4 Validation ====================
Validation rank-1    : 87.85%
Validation rank-5    : 97.63%
Validation rank-10   : 98.76%
Validation mAP      : 92.29%
============================================================
Saving best model at epoch 4 (Acc@1=87.85%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 5/60
[Epoch 5] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.3322
[DEBUG] Loss Breakdown — ID: 4.4325, SupCon: 1.9520, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.3477
[DEBUG] Loss Breakdown — ID: 4.0443, SupCon: 1.8965, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3510
[DEBUG] Loss Breakdown — ID: 4.5465, SupCon: 1.5862, Tri: 0.0081
[DEBUG] ArcFace confidence: 0.3418
[DEBUG] Loss Breakdown — ID: 4.4811, SupCon: 0.9691, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3275
[DEBUG] Loss Breakdown — ID: 5.4180, SupCon: 1.1098, Tri: 0.0112
[DEBUG] ArcFace confidence: 0.3616
[DEBUG] Loss Breakdown — ID: 3.9399, SupCon: 1.4847, Tri: 0.0107
[DEBUG] ArcFace confidence: 0.3777
[DEBUG] Loss Breakdown — ID: 5.6012, SupCon: 1.3851, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3778
[DEBUG] Loss Breakdown — ID: 4.1802, SupCon: 1.4707, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3016
[DEBUG] Loss Breakdown — ID: 4.3996, SupCon: 0.5746, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4282
[DEBUG] Loss Breakdown — ID: 3.6198, SupCon: 1.5484, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3256
[DEBUG] Loss Breakdown — ID: 5.3209, SupCon: 1.6213, Tri: 0.0019
[DEBUG] ArcFace confidence: 0.3541
[DEBUG] Loss Breakdown — ID: 4.1905, SupCon: 1.3373, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3831
[DEBUG] Loss Breakdown — ID: 4.2904, SupCon: 2.1666, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4034
[DEBUG] Loss Breakdown — ID: 4.2485, SupCon: 1.7651, Tri: 0.0021
[DEBUG] ArcFace confidence: 0.2909
[DEBUG] Loss Breakdown — ID: 4.4272, SupCon: 2.2589, Tri: 0.0016
[DEBUG] ArcFace confidence: 0.3188
[DEBUG] Loss Breakdown — ID: 4.0199, SupCon: 1.4114, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3910
[DEBUG] Loss Breakdown — ID: 3.4360, SupCon: 2.3369, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3385
[DEBUG] Loss Breakdown — ID: 3.9652, SupCon: 2.0632, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3863
[DEBUG] Loss Breakdown — ID: 4.4369, SupCon: 1.6364, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3436
[DEBUG] Loss Breakdown — ID: 3.9434, SupCon: 1.0377, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3911
[DEBUG] Loss Breakdown — ID: 4.0226, SupCon: 1.5450, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3878
[DEBUG] Loss Breakdown — ID: 3.2997, SupCon: 1.6896, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4474
[DEBUG] Loss Breakdown — ID: 4.2447, SupCon: 1.0488, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4291
[DEBUG] Loss Breakdown — ID: 3.7774, SupCon: 1.8025, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4337
[DEBUG] Loss Breakdown — ID: 3.2532, SupCon: 1.9267, Tri: 0.0045
[DEBUG] ArcFace confidence: 0.3415
[DEBUG] Loss Breakdown — ID: 4.4808, SupCon: 0.8302, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4223
[DEBUG] Loss Breakdown — ID: 3.7081, SupCon: 1.6920, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4594
[DEBUG] Loss Breakdown — ID: 3.5441, SupCon: 1.5894, Tri: 0.0007
[Epoch 5] Total Loss=0.8391
Validating epoch 5...
[Epoch 5] Avg Train Loss = 0.8391 | 
==================== Epoch 5 Validation ====================
Validation rank-1    : 87.95%
Validation rank-5    : 98.15%
Validation rank-10   : 99.07%
Validation mAP      : 92.36%
============================================================
Saving best model at epoch 5 (Acc@1=87.95%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 6/60
[Epoch 6] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.4608
[DEBUG] Loss Breakdown — ID: 2.9801, SupCon: 2.3520, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.4307
[DEBUG] Loss Breakdown — ID: 3.6476, SupCon: 1.4458, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4840
[DEBUG] Loss Breakdown — ID: 2.5736, SupCon: 1.7540, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4689
[DEBUG] Loss Breakdown — ID: 3.2329, SupCon: 1.3648, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4516
[DEBUG] Loss Breakdown — ID: 3.1706, SupCon: 1.0286, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3914
[DEBUG] Loss Breakdown — ID: 3.7534, SupCon: 1.3069, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4305
[DEBUG] Loss Breakdown — ID: 3.2766, SupCon: 1.1202, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4626
[DEBUG] Loss Breakdown — ID: 3.1662, SupCon: 1.6023, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4653
[DEBUG] Loss Breakdown — ID: 2.5872, SupCon: 1.7668, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4404
[DEBUG] Loss Breakdown — ID: 2.8783, SupCon: 1.1306, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4048
[DEBUG] Loss Breakdown — ID: 3.3345, SupCon: 1.4656, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4227
[DEBUG] Loss Breakdown — ID: 3.6267, SupCon: 1.5230, Tri: 0.0056
[DEBUG] ArcFace confidence: 0.3697
[DEBUG] Loss Breakdown — ID: 3.5661, SupCon: 1.9882, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4418
[DEBUG] Loss Breakdown — ID: 3.1238, SupCon: 1.7489, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4470
[DEBUG] Loss Breakdown — ID: 4.0388, SupCon: 1.0794, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4777
[DEBUG] Loss Breakdown — ID: 2.1636, SupCon: 1.5192, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5672
[DEBUG] Loss Breakdown — ID: 2.3522, SupCon: 1.4833, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4706
[DEBUG] Loss Breakdown — ID: 3.0897, SupCon: 1.9313, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3947
[DEBUG] Loss Breakdown — ID: 3.2492, SupCon: 2.1670, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5271
[DEBUG] Loss Breakdown — ID: 2.6012, SupCon: 1.3366, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4180
[DEBUG] Loss Breakdown — ID: 3.1203, SupCon: 1.7194, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5189
[DEBUG] Loss Breakdown — ID: 2.4217, SupCon: 2.3197, Tri: 0.0057
[DEBUG] ArcFace confidence: 0.4999
[DEBUG] Loss Breakdown — ID: 3.1576, SupCon: 1.7318, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5142
[DEBUG] Loss Breakdown — ID: 2.2166, SupCon: 2.0020, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5271
[DEBUG] Loss Breakdown — ID: 2.3641, SupCon: 1.1463, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3908
[DEBUG] Loss Breakdown — ID: 3.2834, SupCon: 1.5138, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4896
[DEBUG] Loss Breakdown — ID: 3.3067, SupCon: 0.8299, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4247
[DEBUG] Loss Breakdown — ID: 3.3604, SupCon: 1.5742, Tri: 0.0000
[Epoch 6] Total Loss=0.6121
Validating epoch 6...
[Epoch 6] Avg Train Loss = 0.6121 | 
==================== Epoch 6 Validation ====================
Validation rank-1    : 90.01%
Validation rank-5    : 98.46%
Validation rank-10   : 99.28%
Validation mAP      : 93.68%
============================================================
Saving best model at epoch 6 (Acc@1=90.01%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 7/60
[Epoch 7] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.5221
[DEBUG] Loss Breakdown — ID: 2.8209, SupCon: 1.4143, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.5321
[DEBUG] Loss Breakdown — ID: 2.5492, SupCon: 1.8632, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5498
[DEBUG] Loss Breakdown — ID: 2.5286, SupCon: 1.8378, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5384
[DEBUG] Loss Breakdown — ID: 2.0185, SupCon: 1.9859, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5214
[DEBUG] Loss Breakdown — ID: 2.7829, SupCon: 1.6114, Tri: 0.0040
[DEBUG] ArcFace confidence: 0.3801
[DEBUG] Loss Breakdown — ID: 3.3947, SupCon: 0.9445, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5712
[DEBUG] Loss Breakdown — ID: 1.8598, SupCon: 1.9828, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5159
[DEBUG] Loss Breakdown — ID: 2.5481, SupCon: 1.0203, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5704
[DEBUG] Loss Breakdown — ID: 1.6670, SupCon: 1.9825, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5149
[DEBUG] Loss Breakdown — ID: 3.0965, SupCon: 1.2314, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5293
[DEBUG] Loss Breakdown — ID: 2.0949, SupCon: 1.3304, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5349
[DEBUG] Loss Breakdown — ID: 2.2647, SupCon: 1.3418, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5189
[DEBUG] Loss Breakdown — ID: 1.7738, SupCon: 2.0035, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5540
[DEBUG] Loss Breakdown — ID: 3.3262, SupCon: 1.0701, Tri: 0.0099
[DEBUG] ArcFace confidence: 0.5793
[DEBUG] Loss Breakdown — ID: 1.6259, SupCon: 1.8740, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5221
[DEBUG] Loss Breakdown — ID: 2.4337, SupCon: 2.3301, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5612
[DEBUG] Loss Breakdown — ID: 1.8441, SupCon: 1.2444, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4868
[DEBUG] Loss Breakdown — ID: 2.0947, SupCon: 1.5533, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5034
[DEBUG] Loss Breakdown — ID: 2.6480, SupCon: 0.6707, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5141
[DEBUG] Loss Breakdown — ID: 2.4771, SupCon: 0.9146, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5792
[DEBUG] Loss Breakdown — ID: 2.5114, SupCon: 1.0650, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5614
[DEBUG] Loss Breakdown — ID: 1.7637, SupCon: 1.7050, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5399
[DEBUG] Loss Breakdown — ID: 2.0270, SupCon: 1.9818, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6094
[DEBUG] Loss Breakdown — ID: 2.2723, SupCon: 1.0392, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6984
[DEBUG] Loss Breakdown — ID: 1.2308, SupCon: 1.9706, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4648
[DEBUG] Loss Breakdown — ID: 2.2377, SupCon: 1.3602, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4865
[DEBUG] Loss Breakdown — ID: 2.3799, SupCon: 1.7212, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5695
[DEBUG] Loss Breakdown — ID: 1.8137, SupCon: 1.4150, Tri: 0.0000
[Epoch 7] Total Loss=0.4583
Validating epoch 7...
[Epoch 7] Avg Train Loss = 0.4583 | 
==================== Epoch 7 Validation ====================
Validation rank-1    : 88.77%
Validation rank-5    : 98.76%
Validation rank-10   : 99.38%
Validation mAP      : 92.99%
============================================================
No improvement in Acc@1. Patience counter: 1/3
 Epoch 8/60
[Epoch 8] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.5772
[DEBUG] Loss Breakdown — ID: 1.5998, SupCon: 1.9154, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.5081
[DEBUG] Loss Breakdown — ID: 2.7441, SupCon: 1.9614, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6358
[DEBUG] Loss Breakdown — ID: 2.2334, SupCon: 1.9979, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5859
[DEBUG] Loss Breakdown — ID: 1.8006, SupCon: 2.3626, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6375
[DEBUG] Loss Breakdown — ID: 2.0032, SupCon: 1.8276, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5011
[DEBUG] Loss Breakdown — ID: 2.4327, SupCon: 1.3020, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5713
[DEBUG] Loss Breakdown — ID: 1.4078, SupCon: 1.9211, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5607
[DEBUG] Loss Breakdown — ID: 1.7360, SupCon: 1.8402, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5976
[DEBUG] Loss Breakdown — ID: 1.7174, SupCon: 1.4803, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5646
[DEBUG] Loss Breakdown — ID: 2.0657, SupCon: 0.8287, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6189
[DEBUG] Loss Breakdown — ID: 1.9765, SupCon: 1.9608, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5282
[DEBUG] Loss Breakdown — ID: 1.8495, SupCon: 1.9708, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6891
[DEBUG] Loss Breakdown — ID: 1.2072, SupCon: 1.6932, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6963
[DEBUG] Loss Breakdown — ID: 1.2075, SupCon: 1.9437, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5400
[DEBUG] Loss Breakdown — ID: 2.6560, SupCon: 1.4608, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6003
[DEBUG] Loss Breakdown — ID: 1.7752, SupCon: 2.1482, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6141
[DEBUG] Loss Breakdown — ID: 1.8071, SupCon: 1.8682, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6292
[DEBUG] Loss Breakdown — ID: 1.4566, SupCon: 0.9718, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6667
[DEBUG] Loss Breakdown — ID: 1.6383, SupCon: 1.9916, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6805
[DEBUG] Loss Breakdown — ID: 1.2014, SupCon: 1.4304, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5562
[DEBUG] Loss Breakdown — ID: 1.8987, SupCon: 1.5994, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6027
[DEBUG] Loss Breakdown — ID: 1.5657, SupCon: 1.7020, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6545
[DEBUG] Loss Breakdown — ID: 1.7245, SupCon: 1.4374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6576
[DEBUG] Loss Breakdown — ID: 1.7106, SupCon: 1.7287, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6182
[DEBUG] Loss Breakdown — ID: 1.4486, SupCon: 1.5900, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5531
[DEBUG] Loss Breakdown — ID: 2.4545, SupCon: 0.8384, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6506
[DEBUG] Loss Breakdown — ID: 1.3482, SupCon: 1.8143, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5861
[DEBUG] Loss Breakdown — ID: 1.9072, SupCon: 0.2886, Tri: 0.0000
[Epoch 8] Total Loss=0.3612
Validating epoch 8...
[Epoch 8] Avg Train Loss = 0.3612 | 
==================== Epoch 8 Validation ====================
Validation rank-1    : 89.08%
Validation rank-5    : 98.25%
Validation rank-10   : 99.59%
Validation mAP      : 93.17%
============================================================
No improvement in Acc@1. Patience counter: 2/3
 Epoch 9/60
[Epoch 9] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.6894
[DEBUG] Loss Breakdown — ID: 1.1912, SupCon: 1.3280, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.6835
[DEBUG] Loss Breakdown — ID: 1.2069, SupCon: 1.4727, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7845
[DEBUG] Loss Breakdown — ID: 1.2285, SupCon: 2.0276, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6971
[DEBUG] Loss Breakdown — ID: 1.4181, SupCon: 0.6191, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6599
[DEBUG] Loss Breakdown — ID: 1.3577, SupCon: 1.8651, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7081
[DEBUG] Loss Breakdown — ID: 1.1370, SupCon: 1.1741, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6442
[DEBUG] Loss Breakdown — ID: 1.4315, SupCon: 1.4551, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6110
[DEBUG] Loss Breakdown — ID: 1.8917, SupCon: 1.3287, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7158
[DEBUG] Loss Breakdown — ID: 1.0719, SupCon: 1.4249, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7015
[DEBUG] Loss Breakdown — ID: 1.4190, SupCon: 1.6088, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6394
[DEBUG] Loss Breakdown — ID: 1.3436, SupCon: 1.9997, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7051
[DEBUG] Loss Breakdown — ID: 1.5769, SupCon: 1.9831, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7224
[DEBUG] Loss Breakdown — ID: 1.0627, SupCon: 1.4936, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6471
[DEBUG] Loss Breakdown — ID: 1.5253, SupCon: 1.5631, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6627
[DEBUG] Loss Breakdown — ID: 1.2610, SupCon: 1.3100, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6853
[DEBUG] Loss Breakdown — ID: 1.6541, SupCon: 1.4155, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7133
[DEBUG] Loss Breakdown — ID: 1.9410, SupCon: 0.8053, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6971
[DEBUG] Loss Breakdown — ID: 1.2762, SupCon: 1.4433, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6375
[DEBUG] Loss Breakdown — ID: 1.8221, SupCon: 1.2678, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5795
[DEBUG] Loss Breakdown — ID: 1.7913, SupCon: 1.4554, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6458
[DEBUG] Loss Breakdown — ID: 1.8825, SupCon: 1.4996, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5748
[DEBUG] Loss Breakdown — ID: 1.5968, SupCon: 1.6203, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6770
[DEBUG] Loss Breakdown — ID: 1.3858, SupCon: 1.9216, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6732
[DEBUG] Loss Breakdown — ID: 1.3974, SupCon: 1.9481, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6197
[DEBUG] Loss Breakdown — ID: 1.3738, SupCon: 2.2647, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6901
[DEBUG] Loss Breakdown — ID: 1.4994, SupCon: 1.4774, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6872
[DEBUG] Loss Breakdown — ID: 1.4917, SupCon: 1.4980, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6534
[DEBUG] Loss Breakdown — ID: 1.7758, SupCon: 1.5681, Tri: 0.0000
[Epoch 9] Total Loss=0.2929
Validating epoch 9...
[Epoch 9] Avg Train Loss = 0.2929 | 
==================== Epoch 9 Validation ====================
Validation rank-1    : 90.32%
Validation rank-5    : 98.25%
Validation rank-10   : 99.38%
Validation mAP      : 93.95%
============================================================
Saving best model at epoch 9 (Acc@1=90.32%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 10/60
[Epoch 10] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.6488
[DEBUG] Loss Breakdown — ID: 1.5413, SupCon: 1.4799, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.7906
[DEBUG] Loss Breakdown — ID: 0.9266, SupCon: 2.2478, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7176
[DEBUG] Loss Breakdown — ID: 1.1957, SupCon: 1.6084, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5998
[DEBUG] Loss Breakdown — ID: 1.4580, SupCon: 1.2564, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7167
[DEBUG] Loss Breakdown — ID: 1.1964, SupCon: 1.0115, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6802
[DEBUG] Loss Breakdown — ID: 1.4397, SupCon: 1.4550, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7841
[DEBUG] Loss Breakdown — ID: 1.0331, SupCon: 1.4979, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7654
[DEBUG] Loss Breakdown — ID: 1.2455, SupCon: 0.6238, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6452
[DEBUG] Loss Breakdown — ID: 1.2735, SupCon: 1.4162, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6795
[DEBUG] Loss Breakdown — ID: 1.1237, SupCon: 1.7139, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7178
[DEBUG] Loss Breakdown — ID: 1.0450, SupCon: 1.5252, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7872
[DEBUG] Loss Breakdown — ID: 0.9333, SupCon: 1.7441, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7051
[DEBUG] Loss Breakdown — ID: 1.6865, SupCon: 2.3106, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6889
[DEBUG] Loss Breakdown — ID: 1.3420, SupCon: 1.5939, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6824
[DEBUG] Loss Breakdown — ID: 1.4185, SupCon: 1.3399, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7492
[DEBUG] Loss Breakdown — ID: 1.1619, SupCon: 1.3635, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7627
[DEBUG] Loss Breakdown — ID: 1.0521, SupCon: 2.0849, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7051
[DEBUG] Loss Breakdown — ID: 1.2693, SupCon: 1.9073, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7398
[DEBUG] Loss Breakdown — ID: 1.3431, SupCon: 1.8174, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6715
[DEBUG] Loss Breakdown — ID: 1.2918, SupCon: 1.0526, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7338
[DEBUG] Loss Breakdown — ID: 1.4865, SupCon: 1.0376, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7355
[DEBUG] Loss Breakdown — ID: 1.0915, SupCon: 1.4066, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6945
[DEBUG] Loss Breakdown — ID: 1.2439, SupCon: 1.1167, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7450
[DEBUG] Loss Breakdown — ID: 1.4266, SupCon: 1.3661, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7646
[DEBUG] Loss Breakdown — ID: 1.0413, SupCon: 1.1140, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6681
[DEBUG] Loss Breakdown — ID: 1.2794, SupCon: 1.8696, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7328
[DEBUG] Loss Breakdown — ID: 1.2829, SupCon: 1.7324, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6552
[DEBUG] Loss Breakdown — ID: 1.9121, SupCon: 1.3535, Tri: 0.0000
[Epoch 10] Total Loss=0.2553
Validating epoch 10...
[Epoch 10] Avg Train Loss = 0.2553 | 
==================== Epoch 10 Validation ====================
Validation rank-1    : 90.42%
Validation rank-5    : 98.66%
Validation rank-10   : 99.59%
Validation mAP      : 93.95%
============================================================
Saving best model at epoch 10 (Acc@1=90.42%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 11/60
[Epoch 11] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7589
[DEBUG] Loss Breakdown — ID: 1.1439, SupCon: 1.0188, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.7749
[DEBUG] Loss Breakdown — ID: 1.0463, SupCon: 1.5267, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7569
[DEBUG] Loss Breakdown — ID: 1.0260, SupCon: 1.1356, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7778
[DEBUG] Loss Breakdown — ID: 0.9836, SupCon: 1.9075, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7893
[DEBUG] Loss Breakdown — ID: 0.9991, SupCon: 0.4301, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7228
[DEBUG] Loss Breakdown — ID: 1.2160, SupCon: 1.2633, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7674
[DEBUG] Loss Breakdown — ID: 1.0721, SupCon: 2.0908, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6964
[DEBUG] Loss Breakdown — ID: 1.3518, SupCon: 1.7752, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7933
[DEBUG] Loss Breakdown — ID: 0.9823, SupCon: 1.5112, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8106
[DEBUG] Loss Breakdown — ID: 0.9570, SupCon: 0.9517, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7714
[DEBUG] Loss Breakdown — ID: 0.9923, SupCon: 1.2246, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7629
[DEBUG] Loss Breakdown — ID: 1.0012, SupCon: 2.1632, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7630
[DEBUG] Loss Breakdown — ID: 1.1631, SupCon: 1.3864, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7607
[DEBUG] Loss Breakdown — ID: 1.2044, SupCon: 1.3523, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8285
[DEBUG] Loss Breakdown — ID: 0.9082, SupCon: 1.1595, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8123
[DEBUG] Loss Breakdown — ID: 0.9282, SupCon: 2.2178, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8097
[DEBUG] Loss Breakdown — ID: 0.9869, SupCon: 1.3687, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7557
[DEBUG] Loss Breakdown — ID: 1.0988, SupCon: 1.6764, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7894
[DEBUG] Loss Breakdown — ID: 1.0815, SupCon: 2.0274, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7501
[DEBUG] Loss Breakdown — ID: 1.0267, SupCon: 0.6373, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7655
[DEBUG] Loss Breakdown — ID: 1.3310, SupCon: 1.9879, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6752
[DEBUG] Loss Breakdown — ID: 1.5196, SupCon: 1.5128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7513
[DEBUG] Loss Breakdown — ID: 1.1882, SupCon: 1.2998, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7407
[DEBUG] Loss Breakdown — ID: 1.2239, SupCon: 1.7367, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7620
[DEBUG] Loss Breakdown — ID: 1.2648, SupCon: 1.3785, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7854
[DEBUG] Loss Breakdown — ID: 1.0930, SupCon: 1.9179, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7566
[DEBUG] Loss Breakdown — ID: 1.2358, SupCon: 1.2116, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7112
[DEBUG] Loss Breakdown — ID: 1.2973, SupCon: 1.1752, Tri: 0.0000
[Epoch 11] Total Loss=0.2237
Validating epoch 11...
[Epoch 11] Avg Train Loss = 0.2237 | 
==================== Epoch 11 Validation ====================
Validation rank-1    : 90.42%
Validation rank-5    : 98.25%
Validation rank-10   : 99.49%
Validation mAP      : 93.81%
============================================================
No improvement in Acc@1. Patience counter: 1/3
 Epoch 12/60
[Epoch 12] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7412
[DEBUG] Loss Breakdown — ID: 1.1222, SupCon: 1.6811, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8560
[DEBUG] Loss Breakdown — ID: 0.8729, SupCon: 2.1232, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7255
[DEBUG] Loss Breakdown — ID: 1.0578, SupCon: 1.3722, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7865
[DEBUG] Loss Breakdown — ID: 0.9742, SupCon: 1.3090, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7420
[DEBUG] Loss Breakdown — ID: 1.4802, SupCon: 1.2229, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7650
[DEBUG] Loss Breakdown — ID: 1.0345, SupCon: 1.3430, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7573
[DEBUG] Loss Breakdown — ID: 0.9555, SupCon: 1.8188, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8171
[DEBUG] Loss Breakdown — ID: 0.9587, SupCon: 2.1487, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8191
[DEBUG] Loss Breakdown — ID: 0.9165, SupCon: 2.2968, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8266
[DEBUG] Loss Breakdown — ID: 0.9085, SupCon: 1.1469, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7899
[DEBUG] Loss Breakdown — ID: 1.1272, SupCon: 1.4650, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8112
[DEBUG] Loss Breakdown — ID: 0.9311, SupCon: 1.5791, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7370
[DEBUG] Loss Breakdown — ID: 1.0525, SupCon: 2.0769, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7989
[DEBUG] Loss Breakdown — ID: 1.0978, SupCon: 0.5880, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8266
[DEBUG] Loss Breakdown — ID: 0.9233, SupCon: 1.4824, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7918
[DEBUG] Loss Breakdown — ID: 0.9561, SupCon: 2.1374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8148
[DEBUG] Loss Breakdown — ID: 0.9087, SupCon: 1.3497, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7778
[DEBUG] Loss Breakdown — ID: 1.0595, SupCon: 1.3257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7720
[DEBUG] Loss Breakdown — ID: 1.0769, SupCon: 1.7095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8152
[DEBUG] Loss Breakdown — ID: 1.0780, SupCon: 1.3178, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7909
[DEBUG] Loss Breakdown — ID: 1.1218, SupCon: 1.4178, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7894
[DEBUG] Loss Breakdown — ID: 0.9734, SupCon: 1.2374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8209
[DEBUG] Loss Breakdown — ID: 1.0951, SupCon: 1.9190, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7800
[DEBUG] Loss Breakdown — ID: 0.9736, SupCon: 2.3410, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8197
[DEBUG] Loss Breakdown — ID: 1.0656, SupCon: 1.9880, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7092
[DEBUG] Loss Breakdown — ID: 1.4174, SupCon: 2.2912, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7912
[DEBUG] Loss Breakdown — ID: 0.9485, SupCon: 1.3295, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8117
[DEBUG] Loss Breakdown — ID: 0.9147, SupCon: 0.8805, Tri: 0.0000
[Epoch 12] Total Loss=0.2072
Validating epoch 12...
[Epoch 12] Avg Train Loss = 0.2072 | 
==================== Epoch 12 Validation ====================
Validation rank-1    : 90.53%
Validation rank-5    : 98.46%
Validation rank-10   : 99.38%
Validation mAP      : 93.98%
============================================================
Saving best model at epoch 12 (Acc@1=90.53%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 13/60
[Epoch 13] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7492
[DEBUG] Loss Breakdown — ID: 1.0556, SupCon: 1.1264, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.7935
[DEBUG] Loss Breakdown — ID: 0.9468, SupCon: 1.6621, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8103
[DEBUG] Loss Breakdown — ID: 1.1052, SupCon: 2.2426, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8517
[DEBUG] Loss Breakdown — ID: 0.8797, SupCon: 1.4154, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7976
[DEBUG] Loss Breakdown — ID: 1.0331, SupCon: 1.9229, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8302
[DEBUG] Loss Breakdown — ID: 0.9466, SupCon: 1.3338, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8298
[DEBUG] Loss Breakdown — ID: 0.9423, SupCon: 1.2195, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8158
[DEBUG] Loss Breakdown — ID: 0.9978, SupCon: 1.2858, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7481
[DEBUG] Loss Breakdown — ID: 1.2304, SupCon: 1.4103, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8059
[DEBUG] Loss Breakdown — ID: 0.9053, SupCon: 1.6200, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8183
[DEBUG] Loss Breakdown — ID: 0.9106, SupCon: 1.9324, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8004
[DEBUG] Loss Breakdown — ID: 1.0463, SupCon: 1.8169, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8398
[DEBUG] Loss Breakdown — ID: 0.8842, SupCon: 1.1976, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8546
[DEBUG] Loss Breakdown — ID: 0.8884, SupCon: 1.6359, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7772
[DEBUG] Loss Breakdown — ID: 1.0708, SupCon: 1.7093, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7755
[DEBUG] Loss Breakdown — ID: 1.0451, SupCon: 2.3410, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8509
[DEBUG] Loss Breakdown — ID: 0.9007, SupCon: 1.5650, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8581
[DEBUG] Loss Breakdown — ID: 0.8775, SupCon: 1.3529, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8387
[DEBUG] Loss Breakdown — ID: 0.9913, SupCon: 2.0463, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8367
[DEBUG] Loss Breakdown — ID: 0.9221, SupCon: 1.7510, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7868
[DEBUG] Loss Breakdown — ID: 0.9743, SupCon: 1.1027, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7421
[DEBUG] Loss Breakdown — ID: 1.1703, SupCon: 1.7993, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8813
[DEBUG] Loss Breakdown — ID: 0.9455, SupCon: 1.5740, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7968
[DEBUG] Loss Breakdown — ID: 0.9326, SupCon: 1.8161, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8672
[DEBUG] Loss Breakdown — ID: 0.8701, SupCon: 1.1296, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8412
[DEBUG] Loss Breakdown — ID: 0.9017, SupCon: 0.4651, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8279
[DEBUG] Loss Breakdown — ID: 1.0244, SupCon: 1.4213, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8456
[DEBUG] Loss Breakdown — ID: 0.8888, SupCon: 1.4332, Tri: 0.0000
[Epoch 13] Total Loss=0.1949
Validating epoch 13...
[Epoch 13] Avg Train Loss = 0.1949 | 
==================== Epoch 13 Validation ====================
Validation rank-1    : 90.73%
Validation rank-5    : 98.46%
Validation rank-10   : 99.38%
Validation mAP      : 94.06%
============================================================
Saving best model at epoch 13 (Acc@1=90.73%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 14/60
[Epoch 14] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8487
[DEBUG] Loss Breakdown — ID: 0.9008, SupCon: 1.5135, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8608
[DEBUG] Loss Breakdown — ID: 0.8753, SupCon: 1.1065, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8523
[DEBUG] Loss Breakdown — ID: 0.8878, SupCon: 1.6521, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8438
[DEBUG] Loss Breakdown — ID: 0.8934, SupCon: 1.3266, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8559
[DEBUG] Loss Breakdown — ID: 0.9460, SupCon: 1.3231, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8183
[DEBUG] Loss Breakdown — ID: 0.9570, SupCon: 1.7982, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8458
[DEBUG] Loss Breakdown — ID: 0.9588, SupCon: 1.6993, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8336
[DEBUG] Loss Breakdown — ID: 0.9852, SupCon: 1.4612, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8030
[DEBUG] Loss Breakdown — ID: 0.9145, SupCon: 2.0910, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8176
[DEBUG] Loss Breakdown — ID: 0.9114, SupCon: 1.7021, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8242
[DEBUG] Loss Breakdown — ID: 1.0569, SupCon: 1.9652, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8245
[DEBUG] Loss Breakdown — ID: 0.9299, SupCon: 2.3610, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8873
[DEBUG] Loss Breakdown — ID: 0.9608, SupCon: 1.7897, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8275
[DEBUG] Loss Breakdown — ID: 0.9550, SupCon: 1.6548, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7859
[DEBUG] Loss Breakdown — ID: 0.9445, SupCon: 1.8490, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8329
[DEBUG] Loss Breakdown — ID: 0.9032, SupCon: 1.8783, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8057
[DEBUG] Loss Breakdown — ID: 0.9951, SupCon: 1.6002, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7649
[DEBUG] Loss Breakdown — ID: 1.0108, SupCon: 1.9658, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8246
[DEBUG] Loss Breakdown — ID: 0.8947, SupCon: 1.5834, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8666
[DEBUG] Loss Breakdown — ID: 0.8773, SupCon: 1.6022, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8060
[DEBUG] Loss Breakdown — ID: 0.9312, SupCon: 1.6558, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7988
[DEBUG] Loss Breakdown — ID: 0.9658, SupCon: 0.9749, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7600
[DEBUG] Loss Breakdown — ID: 1.0869, SupCon: 2.0336, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8085
[DEBUG] Loss Breakdown — ID: 0.9374, SupCon: 1.9303, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8689
[DEBUG] Loss Breakdown — ID: 0.8756, SupCon: 1.3444, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8583
[DEBUG] Loss Breakdown — ID: 0.9011, SupCon: 1.1444, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8396
[DEBUG] Loss Breakdown — ID: 0.8894, SupCon: 2.0278, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7621
[DEBUG] Loss Breakdown — ID: 0.9449, SupCon: 1.4168, Tri: 0.0000
[Epoch 14] Total Loss=0.1878
Validating epoch 14...
[Epoch 14] Avg Train Loss = 0.1878 | 
==================== Epoch 14 Validation ====================
Validation rank-1    : 90.73%
Validation rank-5    : 98.35%
Validation rank-10   : 99.59%
Validation mAP      : 94.18%
============================================================
No improvement in Acc@1. Patience counter: 1/3
 Epoch 15/60
[Epoch 15] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8720
[DEBUG] Loss Breakdown — ID: 0.8729, SupCon: 2.1009, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8403
[DEBUG] Loss Breakdown — ID: 0.9738, SupCon: 1.8729, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8350
[DEBUG] Loss Breakdown — ID: 0.9799, SupCon: 0.6598, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8248
[DEBUG] Loss Breakdown — ID: 0.9219, SupCon: 1.3696, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8518
[DEBUG] Loss Breakdown — ID: 0.8735, SupCon: 1.7515, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8991
[DEBUG] Loss Breakdown — ID: 0.8606, SupCon: 1.2813, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8955
[DEBUG] Loss Breakdown — ID: 0.8567, SupCon: 1.5612, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8450
[DEBUG] Loss Breakdown — ID: 0.9020, SupCon: 1.2032, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8441
[DEBUG] Loss Breakdown — ID: 0.8959, SupCon: 1.6331, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8181
[DEBUG] Loss Breakdown — ID: 0.9559, SupCon: 1.6953, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8737
[DEBUG] Loss Breakdown — ID: 0.8596, SupCon: 1.6915, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8413
[DEBUG] Loss Breakdown — ID: 0.8870, SupCon: 1.3713, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8532
[DEBUG] Loss Breakdown — ID: 0.8776, SupCon: 1.3424, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9047
[DEBUG] Loss Breakdown — ID: 0.8658, SupCon: 1.3358, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7826
[DEBUG] Loss Breakdown — ID: 0.9816, SupCon: 1.7311, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8328
[DEBUG] Loss Breakdown — ID: 0.8975, SupCon: 1.4855, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8693
[DEBUG] Loss Breakdown — ID: 0.9331, SupCon: 0.6654, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8833
[DEBUG] Loss Breakdown — ID: 0.8611, SupCon: 2.0753, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8251
[DEBUG] Loss Breakdown — ID: 0.9131, SupCon: 1.4806, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8933
[DEBUG] Loss Breakdown — ID: 0.8657, SupCon: 1.8768, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8413
[DEBUG] Loss Breakdown — ID: 0.9082, SupCon: 1.4477, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8179
[DEBUG] Loss Breakdown — ID: 0.9662, SupCon: 1.2019, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8182
[DEBUG] Loss Breakdown — ID: 0.8927, SupCon: 2.2020, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8400
[DEBUG] Loss Breakdown — ID: 0.8992, SupCon: 1.4153, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8109
[DEBUG] Loss Breakdown — ID: 1.0677, SupCon: 1.5485, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8626
[DEBUG] Loss Breakdown — ID: 0.8788, SupCon: 1.9665, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8401
[DEBUG] Loss Breakdown — ID: 0.9818, SupCon: 1.4860, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8461
[DEBUG] Loss Breakdown — ID: 0.9218, SupCon: 0.5697, Tri: 0.0000
[Epoch 15] Total Loss=0.1825
Validating epoch 15...
[Epoch 15] Avg Train Loss = 0.1825 | 
==================== Epoch 15 Validation ====================
Validation rank-1    : 90.42%
Validation rank-5    : 98.56%
Validation rank-10   : 99.38%
Validation mAP      : 94.04%
============================================================
No improvement in Acc@1. Patience counter: 2/3
 Epoch 16/60
[Epoch 16] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8780
[DEBUG] Loss Breakdown — ID: 0.8693, SupCon: 1.0993, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8591
[DEBUG] Loss Breakdown — ID: 0.8752, SupCon: 1.7190, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8489
[DEBUG] Loss Breakdown — ID: 0.8949, SupCon: 1.9318, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8741
[DEBUG] Loss Breakdown — ID: 0.8632, SupCon: 2.0813, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8207
[DEBUG] Loss Breakdown — ID: 0.9071, SupCon: 2.4261, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8387
[DEBUG] Loss Breakdown — ID: 0.8943, SupCon: 1.8428, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8765
[DEBUG] Loss Breakdown — ID: 0.8713, SupCon: 2.3748, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8016
[DEBUG] Loss Breakdown — ID: 0.9127, SupCon: 1.7819, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8636
[DEBUG] Loss Breakdown — ID: 0.8908, SupCon: 1.5939, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8733
[DEBUG] Loss Breakdown — ID: 0.8852, SupCon: 0.8844, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8429
[DEBUG] Loss Breakdown — ID: 0.8939, SupCon: 1.6852, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8646
[DEBUG] Loss Breakdown — ID: 0.8862, SupCon: 1.4786, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8824
[DEBUG] Loss Breakdown — ID: 0.8712, SupCon: 1.2570, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8693
[DEBUG] Loss Breakdown — ID: 0.8999, SupCon: 1.7876, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8547
[DEBUG] Loss Breakdown — ID: 0.8932, SupCon: 1.4992, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8317
[DEBUG] Loss Breakdown — ID: 0.8926, SupCon: 1.5270, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8660
[DEBUG] Loss Breakdown — ID: 0.9280, SupCon: 1.9970, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8732
[DEBUG] Loss Breakdown — ID: 0.9731, SupCon: 0.7856, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8943
[DEBUG] Loss Breakdown — ID: 0.8537, SupCon: 1.5537, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8762
[DEBUG] Loss Breakdown — ID: 0.8722, SupCon: 2.0799, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8396
[DEBUG] Loss Breakdown — ID: 0.8979, SupCon: 1.4240, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8716
[DEBUG] Loss Breakdown — ID: 0.8858, SupCon: 1.3915, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8164
[DEBUG] Loss Breakdown — ID: 0.9639, SupCon: 1.7491, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8598
[DEBUG] Loss Breakdown — ID: 0.8676, SupCon: 1.6427, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8225
[DEBUG] Loss Breakdown — ID: 0.9058, SupCon: 1.5619, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8146
[DEBUG] Loss Breakdown — ID: 0.8975, SupCon: 1.9804, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8352
[DEBUG] Loss Breakdown — ID: 0.9063, SupCon: 1.8574, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8390
[DEBUG] Loss Breakdown — ID: 0.8762, SupCon: 1.9006, Tri: 0.0000
[Epoch 16] Total Loss=0.1788
Validating epoch 16...
[Epoch 16] Avg Train Loss = 0.1788 | 
==================== Epoch 16 Validation ====================
Validation rank-1    : 90.32%
Validation rank-5    : 98.46%
Validation rank-10   : 99.49%
Validation mAP      : 94.00%
============================================================
No improvement in Acc@1. Patience counter: 3/3
Early srankping at epoch 16 due to no improvement in rank-1 accuracy.
Saving logs to: train_logs/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32.log
Using 72 classes | 28 training batches
======= Stage 3: PromptSG Training =======
Experiment Name : stage3_promptsg
Model & Dataset : vitb16, 11k, dorsal_r
Freeze Text Enc.: True
Loss Weights    : ID=0.2, Tri=1.0, SupCon=0
LR=2.2e-06 | Epochs=60 | BatchSize=32
 Epoch 1/60
[Epoch 1] Learning rate: 0.000002
[DEBUG] Pooled feature mean L2 norm: 1.0000
[DEBUG] ArcFace confidence: 0.2538
[DEBUG] Loss Breakdown — ID: 18.7257, SupCon: 1.5229, Tri: 0.1175
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2235
[DEBUG] Loss Breakdown — ID: 18.6404, SupCon: 1.4081, Tri: 0.1154
[DEBUG] ArcFace confidence: 0.2544
[DEBUG] Loss Breakdown — ID: 18.6986, SupCon: 1.4692, Tri: 0.1290
[DEBUG] ArcFace confidence: 0.2982
[DEBUG] Loss Breakdown — ID: 17.9082, SupCon: 1.4628, Tri: 0.1191
[DEBUG] ArcFace confidence: 0.2375
[DEBUG] Loss Breakdown — ID: 17.9035, SupCon: 1.2462, Tri: 0.1104
[DEBUG] ArcFace confidence: 0.2581
[DEBUG] Loss Breakdown — ID: 17.6246, SupCon: 1.2891, Tri: 0.1047
[DEBUG] ArcFace confidence: 0.2503
[DEBUG] Loss Breakdown — ID: 17.3015, SupCon: 1.8940, Tri: 0.1527
[DEBUG] ArcFace confidence: 0.2435
[DEBUG] Loss Breakdown — ID: 17.1506, SupCon: 1.6975, Tri: 0.1307
[DEBUG] ArcFace confidence: 0.2845
[DEBUG] Loss Breakdown — ID: 17.3342, SupCon: 1.3653, Tri: 0.1135
[DEBUG] ArcFace confidence: 0.2687
[DEBUG] Loss Breakdown — ID: 16.9515, SupCon: 1.7532, Tri: 0.1515
[DEBUG] ArcFace confidence: 0.2849
[DEBUG] Loss Breakdown — ID: 16.2502, SupCon: 2.3926, Tri: 0.1761
[DEBUG] ArcFace confidence: 0.2283
[DEBUG] Loss Breakdown — ID: 16.7192, SupCon: 2.3182, Tri: 0.1883
[DEBUG] ArcFace confidence: 0.2645
[DEBUG] Loss Breakdown — ID: 16.7837, SupCon: 1.3094, Tri: 0.0972
[DEBUG] ArcFace confidence: 0.2330
[DEBUG] Loss Breakdown — ID: 16.0082, SupCon: 1.3820, Tri: 0.1042
[DEBUG] ArcFace confidence: 0.2965
[DEBUG] Loss Breakdown — ID: 16.3127, SupCon: 1.5613, Tri: 0.1200
[DEBUG] ArcFace confidence: 0.2286
[DEBUG] Loss Breakdown — ID: 16.1832, SupCon: 0.6354, Tri: 0.0319
[DEBUG] ArcFace confidence: 0.2863
[DEBUG] Loss Breakdown — ID: 15.4039, SupCon: 1.9309, Tri: 0.1409
[DEBUG] ArcFace confidence: 0.2604
[DEBUG] Loss Breakdown — ID: 15.1149, SupCon: 1.4747, Tri: 0.1088
[DEBUG] ArcFace confidence: 0.2657
[DEBUG] Loss Breakdown — ID: 14.5476, SupCon: 1.8607, Tri: 0.1312
[DEBUG] ArcFace confidence: 0.2333
[DEBUG] Loss Breakdown — ID: 15.2999, SupCon: 1.7001, Tri: 0.1065
[DEBUG] ArcFace confidence: 0.2607
[DEBUG] Loss Breakdown — ID: 15.3323, SupCon: 2.0486, Tri: 0.1797
[DEBUG] ArcFace confidence: 0.2798
[DEBUG] Loss Breakdown — ID: 15.3969, SupCon: 1.4635, Tri: 0.0859
[DEBUG] ArcFace confidence: 0.2464
[DEBUG] Loss Breakdown — ID: 15.1194, SupCon: 1.4833, Tri: 0.0863
[DEBUG] ArcFace confidence: 0.2502
[DEBUG] Loss Breakdown — ID: 14.9298, SupCon: 1.5153, Tri: 0.0891
[DEBUG] ArcFace confidence: 0.1851
[DEBUG] Loss Breakdown — ID: 15.2786, SupCon: 1.6282, Tri: 0.1193
[DEBUG] ArcFace confidence: 0.2719
[DEBUG] Loss Breakdown — ID: 14.4458, SupCon: 1.8385, Tri: 0.1157
[DEBUG] ArcFace confidence: 0.2352
[DEBUG] Loss Breakdown — ID: 13.8364, SupCon: 1.1879, Tri: 0.0411
[DEBUG] ArcFace confidence: 0.2201
[DEBUG] Loss Breakdown — ID: 13.9365, SupCon: 1.5598, Tri: 0.1078
[Epoch 1] Total Loss=3.3679
Validating epoch 1...
[Epoch 1] Avg Train Loss = 3.3679 | 
==================== Epoch 1 Validation ====================
Validation rank-1    : 79.92%
Validation rank-5    : 93.92%
Validation rank-10   : 96.70%
Validation mAP      : 85.95%
============================================================
Saving best model at epoch 1 (Acc@1=79.92%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 2/60
[Epoch 2] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2466
[DEBUG] Loss Breakdown — ID: 13.6595, SupCon: 1.6157, Tri: 0.0697
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2440
[DEBUG] Loss Breakdown — ID: 13.6580, SupCon: 1.5658, Tri: 0.0645
[DEBUG] ArcFace confidence: 0.2232
[DEBUG] Loss Breakdown — ID: 13.2021, SupCon: 1.5788, Tri: 0.0472
[DEBUG] ArcFace confidence: 0.2777
[DEBUG] Loss Breakdown — ID: 13.4120, SupCon: 1.6626, Tri: 0.0717
[DEBUG] ArcFace confidence: 0.2167
[DEBUG] Loss Breakdown — ID: 12.5417, SupCon: 1.7839, Tri: 0.0543
[DEBUG] ArcFace confidence: 0.2390
[DEBUG] Loss Breakdown — ID: 12.8909, SupCon: 1.3570, Tri: 0.0493
[DEBUG] ArcFace confidence: 0.2243
[DEBUG] Loss Breakdown — ID: 13.4434, SupCon: 1.6768, Tri: 0.0543
[DEBUG] ArcFace confidence: 0.2401
[DEBUG] Loss Breakdown — ID: 12.6825, SupCon: 1.6871, Tri: 0.0662
[DEBUG] ArcFace confidence: 0.2478
[DEBUG] Loss Breakdown — ID: 12.7240, SupCon: 1.1244, Tri: 0.0311
[DEBUG] ArcFace confidence: 0.2504
[DEBUG] Loss Breakdown — ID: 12.2430, SupCon: 1.2891, Tri: 0.0223
[DEBUG] ArcFace confidence: 0.2999
[DEBUG] Loss Breakdown — ID: 13.0390, SupCon: 1.4929, Tri: 0.0619
[DEBUG] ArcFace confidence: 0.2681
[DEBUG] Loss Breakdown — ID: 13.1711, SupCon: 1.2381, Tri: 0.0274
[DEBUG] ArcFace confidence: 0.2564
[DEBUG] Loss Breakdown — ID: 13.0731, SupCon: 0.8320, Tri: 0.0188
[DEBUG] ArcFace confidence: 0.2576
[DEBUG] Loss Breakdown — ID: 11.5495, SupCon: 1.4153, Tri: 0.0622
[DEBUG] ArcFace confidence: 0.2372
[DEBUG] Loss Breakdown — ID: 11.6694, SupCon: 1.8072, Tri: 0.0486
[DEBUG] ArcFace confidence: 0.2412
[DEBUG] Loss Breakdown — ID: 12.0889, SupCon: 1.8590, Tri: 0.0717
[DEBUG] ArcFace confidence: 0.1972
[DEBUG] Loss Breakdown — ID: 11.6484, SupCon: 1.6039, Tri: 0.0553
[DEBUG] ArcFace confidence: 0.2415
[DEBUG] Loss Breakdown — ID: 11.5323, SupCon: 1.9844, Tri: 0.0275
[DEBUG] ArcFace confidence: 0.2146
[DEBUG] Loss Breakdown — ID: 11.7442, SupCon: 1.6772, Tri: 0.0476
[DEBUG] ArcFace confidence: 0.2048
[DEBUG] Loss Breakdown — ID: 11.1450, SupCon: 1.1235, Tri: 0.0268
[DEBUG] ArcFace confidence: 0.2184
[DEBUG] Loss Breakdown — ID: 11.3650, SupCon: 1.4178, Tri: 0.0161
[DEBUG] ArcFace confidence: 0.2633
[DEBUG] Loss Breakdown — ID: 11.4461, SupCon: 1.8342, Tri: 0.0454
[DEBUG] ArcFace confidence: 0.2046
[DEBUG] Loss Breakdown — ID: 10.3848, SupCon: 2.3517, Tri: 0.0433
[DEBUG] ArcFace confidence: 0.2482
[DEBUG] Loss Breakdown — ID: 11.5088, SupCon: 1.3031, Tri: 0.0185
[DEBUG] ArcFace confidence: 0.2209
[DEBUG] Loss Breakdown — ID: 11.3842, SupCon: 1.7619, Tri: 0.0349
[DEBUG] ArcFace confidence: 0.2367
[DEBUG] Loss Breakdown — ID: 10.1640, SupCon: 1.3037, Tri: 0.0091
[DEBUG] ArcFace confidence: 0.2564
[DEBUG] Loss Breakdown — ID: 10.5911, SupCon: 1.6689, Tri: 0.0688
[DEBUG] ArcFace confidence: 0.2103
[DEBUG] Loss Breakdown — ID: 9.5328, SupCon: 1.9463, Tri: 0.0561
[Epoch 2] Total Loss=2.4560
Validating epoch 2...
[Epoch 2] Avg Train Loss = 2.4560 | 
==================== Epoch 2 Validation ====================
Validation rank-1    : 84.76%
Validation rank-5    : 95.67%
Validation rank-10   : 97.53%
Validation mAP      : 89.58%
============================================================
Saving best model at epoch 2 (Acc@1=84.76%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 3/60
[Epoch 3] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2826
[DEBUG] Loss Breakdown — ID: 10.4046, SupCon: 1.5956, Tri: 0.0103
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.2429
[DEBUG] Loss Breakdown — ID: 9.7093, SupCon: 1.1555, Tri: 0.0003
[DEBUG] ArcFace confidence: 0.2093
[DEBUG] Loss Breakdown — ID: 10.8890, SupCon: 0.5690, Tri: 0.0022
[DEBUG] ArcFace confidence: 0.2416
[DEBUG] Loss Breakdown — ID: 9.1807, SupCon: 1.7801, Tri: 0.0492
[DEBUG] ArcFace confidence: 0.2201
[DEBUG] Loss Breakdown — ID: 10.0103, SupCon: 0.9683, Tri: 0.0133
[DEBUG] ArcFace confidence: 0.2133
[DEBUG] Loss Breakdown — ID: 9.1439, SupCon: 1.9962, Tri: 0.0201
[DEBUG] ArcFace confidence: 0.2381
[DEBUG] Loss Breakdown — ID: 8.7722, SupCon: 1.9983, Tri: 0.0145
[DEBUG] ArcFace confidence: 0.2305
[DEBUG] Loss Breakdown — ID: 8.9651, SupCon: 0.9709, Tri: 0.0068
[DEBUG] ArcFace confidence: 0.2381
[DEBUG] Loss Breakdown — ID: 8.6884, SupCon: 1.4824, Tri: 0.0090
[DEBUG] ArcFace confidence: 0.2509
[DEBUG] Loss Breakdown — ID: 8.6707, SupCon: 1.1037, Tri: 0.0063
[DEBUG] ArcFace confidence: 0.2720
[DEBUG] Loss Breakdown — ID: 8.5822, SupCon: 1.3831, Tri: 0.0150
[DEBUG] ArcFace confidence: 0.2920
[DEBUG] Loss Breakdown — ID: 8.2534, SupCon: 1.2172, Tri: 0.0193
[DEBUG] ArcFace confidence: 0.2394
[DEBUG] Loss Breakdown — ID: 9.2542, SupCon: 1.5967, Tri: 0.0213
[DEBUG] ArcFace confidence: 0.2253
[DEBUG] Loss Breakdown — ID: 8.4972, SupCon: 1.6625, Tri: 0.0113
[DEBUG] ArcFace confidence: 0.2490
[DEBUG] Loss Breakdown — ID: 7.3480, SupCon: 1.4178, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2192
[DEBUG] Loss Breakdown — ID: 8.0821, SupCon: 1.0691, Tri: 0.0004
[DEBUG] ArcFace confidence: 0.2270
[DEBUG] Loss Breakdown — ID: 7.2566, SupCon: 1.6788, Tri: 0.0009
[DEBUG] ArcFace confidence: 0.2417
[DEBUG] Loss Breakdown — ID: 8.2821, SupCon: 0.8635, Tri: 0.0005
[DEBUG] ArcFace confidence: 0.2254
[DEBUG] Loss Breakdown — ID: 9.5779, SupCon: 1.2289, Tri: 0.0160
[DEBUG] ArcFace confidence: 0.2309
[DEBUG] Loss Breakdown — ID: 8.8592, SupCon: 2.4293, Tri: 0.0444
[DEBUG] ArcFace confidence: 0.3134
[DEBUG] Loss Breakdown — ID: 8.5814, SupCon: 0.8265, Tri: 0.0036
[DEBUG] ArcFace confidence: 0.2890
[DEBUG] Loss Breakdown — ID: 8.4815, SupCon: 1.4232, Tri: 0.0063
[DEBUG] ArcFace confidence: 0.2409
[DEBUG] Loss Breakdown — ID: 8.7053, SupCon: 1.1113, Tri: 0.0024
[DEBUG] ArcFace confidence: 0.2844
[DEBUG] Loss Breakdown — ID: 8.2397, SupCon: 2.0895, Tri: 0.0203
[DEBUG] ArcFace confidence: 0.2842
[DEBUG] Loss Breakdown — ID: 7.0485, SupCon: 1.4561, Tri: 0.0056
[DEBUG] ArcFace confidence: 0.2398
[DEBUG] Loss Breakdown — ID: 7.1796, SupCon: 0.9523, Tri: 0.0052
[DEBUG] ArcFace confidence: 0.3228
[DEBUG] Loss Breakdown — ID: 7.0350, SupCon: 1.8808, Tri: 0.0001
[DEBUG] ArcFace confidence: 0.2804
[DEBUG] Loss Breakdown — ID: 7.9577, SupCon: 0.9986, Tri: 0.0106
[Epoch 3] Total Loss=1.7374
Validating epoch 3...
[Epoch 3] Avg Train Loss = 1.7374 | 
==================== Epoch 3 Validation ====================
Validation rank-1    : 87.64%
Validation rank-5    : 97.01%
Validation rank-10   : 98.56%
Validation mAP      : 91.99%
============================================================
Saving best model at epoch 3 (Acc@1=87.64%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 4/60
[Epoch 4] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.2521
[DEBUG] Loss Breakdown — ID: 6.8301, SupCon: 2.1288, Tri: 0.0072
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.3348
[DEBUG] Loss Breakdown — ID: 7.0775, SupCon: 1.9242, Tri: 0.0118
[DEBUG] ArcFace confidence: 0.3002
[DEBUG] Loss Breakdown — ID: 6.8122, SupCon: 1.2230, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2777
[DEBUG] Loss Breakdown — ID: 8.3258, SupCon: 1.0899, Tri: 0.0116
[DEBUG] ArcFace confidence: 0.3049
[DEBUG] Loss Breakdown — ID: 6.6875, SupCon: 2.2387, Tri: 0.0046
[DEBUG] ArcFace confidence: 0.3066
[DEBUG] Loss Breakdown — ID: 6.5563, SupCon: 1.4957, Tri: 0.0023
[DEBUG] ArcFace confidence: 0.3022
[DEBUG] Loss Breakdown — ID: 7.6774, SupCon: 1.6927, Tri: 0.0069
[DEBUG] ArcFace confidence: 0.2610
[DEBUG] Loss Breakdown — ID: 5.8502, SupCon: 1.7804, Tri: 0.0041
[DEBUG] ArcFace confidence: 0.2991
[DEBUG] Loss Breakdown — ID: 6.7761, SupCon: 1.4918, Tri: 0.0003
[DEBUG] ArcFace confidence: 0.2948
[DEBUG] Loss Breakdown — ID: 5.5219, SupCon: 1.9260, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3057
[DEBUG] Loss Breakdown — ID: 6.4871, SupCon: 1.7783, Tri: 0.0137
[DEBUG] ArcFace confidence: 0.3226
[DEBUG] Loss Breakdown — ID: 5.3750, SupCon: 1.8528, Tri: 0.0010
[DEBUG] ArcFace confidence: 0.3149
[DEBUG] Loss Breakdown — ID: 6.0785, SupCon: 1.4843, Tri: 0.0018
[DEBUG] ArcFace confidence: 0.2852
[DEBUG] Loss Breakdown — ID: 6.6222, SupCon: 1.2235, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2888
[DEBUG] Loss Breakdown — ID: 6.4596, SupCon: 2.1096, Tri: 0.0053
[DEBUG] ArcFace confidence: 0.2941
[DEBUG] Loss Breakdown — ID: 8.1376, SupCon: 0.9817, Tri: 0.0007
[DEBUG] ArcFace confidence: 0.2812
[DEBUG] Loss Breakdown — ID: 5.5676, SupCon: 1.2330, Tri: 0.0014
[DEBUG] ArcFace confidence: 0.2967
[DEBUG] Loss Breakdown — ID: 6.5722, SupCon: 0.9663, Tri: 0.0068
[DEBUG] ArcFace confidence: 0.3237
[DEBUG] Loss Breakdown — ID: 5.6885, SupCon: 2.1334, Tri: 0.0150
[DEBUG] ArcFace confidence: 0.3404
[DEBUG] Loss Breakdown — ID: 5.9356, SupCon: 1.2540, Tri: 0.0024
[DEBUG] ArcFace confidence: 0.3119
[DEBUG] Loss Breakdown — ID: 6.6610, SupCon: 1.3865, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.2909
[DEBUG] Loss Breakdown — ID: 5.9185, SupCon: 1.3322, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3521
[DEBUG] Loss Breakdown — ID: 4.5519, SupCon: 2.0329, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3224
[DEBUG] Loss Breakdown — ID: 5.2383, SupCon: 1.2338, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3288
[DEBUG] Loss Breakdown — ID: 4.8403, SupCon: 1.7516, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3438
[DEBUG] Loss Breakdown — ID: 6.7626, SupCon: 2.0034, Tri: 0.0055
[DEBUG] ArcFace confidence: 0.3913
[DEBUG] Loss Breakdown — ID: 5.1045, SupCon: 1.1538, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3880
[DEBUG] Loss Breakdown — ID: 5.6084, SupCon: 0.8322, Tri: 0.0000
[Epoch 4] Total Loss=1.2588
Validating epoch 4...
[Epoch 4] Avg Train Loss = 1.2588 | 
==================== Epoch 4 Validation ====================
Validation rank-1    : 90.22%
Validation rank-5    : 97.63%
Validation rank-10   : 98.76%
Validation mAP      : 93.74%
============================================================
Saving best model at epoch 4 (Acc@1=90.22%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 5/60
[Epoch 5] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.3397
[DEBUG] Loss Breakdown — ID: 6.2568, SupCon: 1.3656, Tri: 0.0012
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.3360
[DEBUG] Loss Breakdown — ID: 5.0380, SupCon: 1.8793, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3265
[DEBUG] Loss Breakdown — ID: 5.0095, SupCon: 1.5928, Tri: 0.0010
[DEBUG] ArcFace confidence: 0.3720
[DEBUG] Loss Breakdown — ID: 4.4571, SupCon: 1.6285, Tri: 0.0014
[DEBUG] ArcFace confidence: 0.3591
[DEBUG] Loss Breakdown — ID: 4.0784, SupCon: 1.6351, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3948
[DEBUG] Loss Breakdown — ID: 4.4394, SupCon: 1.2183, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4079
[DEBUG] Loss Breakdown — ID: 4.7875, SupCon: 1.8196, Tri: 0.0039
[DEBUG] ArcFace confidence: 0.4068
[DEBUG] Loss Breakdown — ID: 4.6829, SupCon: 1.1000, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3589
[DEBUG] Loss Breakdown — ID: 5.1774, SupCon: 1.5798, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3791
[DEBUG] Loss Breakdown — ID: 4.5973, SupCon: 1.5678, Tri: 0.0060
[DEBUG] ArcFace confidence: 0.3255
[DEBUG] Loss Breakdown — ID: 4.7757, SupCon: 1.4108, Tri: 0.0002
[DEBUG] ArcFace confidence: 0.3586
[DEBUG] Loss Breakdown — ID: 4.4076, SupCon: 1.5726, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3465
[DEBUG] Loss Breakdown — ID: 3.9925, SupCon: 1.4242, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3789
[DEBUG] Loss Breakdown — ID: 4.0603, SupCon: 1.4084, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3405
[DEBUG] Loss Breakdown — ID: 5.5675, SupCon: 1.2615, Tri: 0.0072
[DEBUG] ArcFace confidence: 0.3776
[DEBUG] Loss Breakdown — ID: 4.7479, SupCon: 1.5608, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4145
[DEBUG] Loss Breakdown — ID: 3.8667, SupCon: 1.6099, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3063
[DEBUG] Loss Breakdown — ID: 4.7614, SupCon: 1.4552, Tri: 0.0012
[DEBUG] ArcFace confidence: 0.4093
[DEBUG] Loss Breakdown — ID: 4.7169, SupCon: 1.1615, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3702
[DEBUG] Loss Breakdown — ID: 4.4842, SupCon: 1.0465, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3621
[DEBUG] Loss Breakdown — ID: 3.9069, SupCon: 1.9873, Tri: 0.0106
[DEBUG] ArcFace confidence: 0.4569
[DEBUG] Loss Breakdown — ID: 3.9149, SupCon: 1.4563, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4105
[DEBUG] Loss Breakdown — ID: 4.1576, SupCon: 1.4135, Tri: 0.0013
[DEBUG] ArcFace confidence: 0.3504
[DEBUG] Loss Breakdown — ID: 3.5407, SupCon: 1.0108, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3317
[DEBUG] Loss Breakdown — ID: 3.7875, SupCon: 2.0161, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4118
[DEBUG] Loss Breakdown — ID: 3.9365, SupCon: 1.5923, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3616
[DEBUG] Loss Breakdown — ID: 3.5260, SupCon: 2.0694, Tri: 0.0031
[DEBUG] ArcFace confidence: 0.3860
[DEBUG] Loss Breakdown — ID: 4.4311, SupCon: 1.7773, Tri: 0.0036
[Epoch 5] Total Loss=0.8951
Validating epoch 5...
[Epoch 5] Avg Train Loss = 0.8951 | 
==================== Epoch 5 Validation ====================
Validation rank-1    : 88.36%
Validation rank-5    : 97.32%
Validation rank-10   : 98.87%
Validation mAP      : 92.57%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 6/60
[Epoch 6] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.3955
[DEBUG] Loss Breakdown — ID: 3.1110, SupCon: 1.7952, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.4189
[DEBUG] Loss Breakdown — ID: 3.0855, SupCon: 1.9743, Tri: 0.0046
[DEBUG] ArcFace confidence: 0.3689
[DEBUG] Loss Breakdown — ID: 3.5466, SupCon: 1.2311, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4359
[DEBUG] Loss Breakdown — ID: 2.8535, SupCon: 2.2794, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4621
[DEBUG] Loss Breakdown — ID: 3.5750, SupCon: 1.3740, Tri: 0.0064
[DEBUG] ArcFace confidence: 0.3810
[DEBUG] Loss Breakdown — ID: 2.8490, SupCon: 1.8830, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4155
[DEBUG] Loss Breakdown — ID: 4.0565, SupCon: 0.9257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4195
[DEBUG] Loss Breakdown — ID: 4.0020, SupCon: 1.4873, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4518
[DEBUG] Loss Breakdown — ID: 3.4082, SupCon: 1.3811, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4163
[DEBUG] Loss Breakdown — ID: 3.3950, SupCon: 1.0138, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4399
[DEBUG] Loss Breakdown — ID: 3.5966, SupCon: 1.4163, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4023
[DEBUG] Loss Breakdown — ID: 3.3234, SupCon: 1.6732, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4171
[DEBUG] Loss Breakdown — ID: 4.4159, SupCon: 1.1648, Tri: 0.0002
[DEBUG] ArcFace confidence: 0.4608
[DEBUG] Loss Breakdown — ID: 3.1184, SupCon: 1.2338, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4997
[DEBUG] Loss Breakdown — ID: 2.5672, SupCon: 1.7992, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4669
[DEBUG] Loss Breakdown — ID: 3.5182, SupCon: 1.5386, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4521
[DEBUG] Loss Breakdown — ID: 2.5706, SupCon: 1.5952, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3922
[DEBUG] Loss Breakdown — ID: 4.3752, SupCon: 0.7678, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4204
[DEBUG] Loss Breakdown — ID: 3.3417, SupCon: 1.6694, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5264
[DEBUG] Loss Breakdown — ID: 2.8461, SupCon: 1.6705, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4801
[DEBUG] Loss Breakdown — ID: 3.5699, SupCon: 1.2747, Tri: 0.0042
[DEBUG] ArcFace confidence: 0.3441
[DEBUG] Loss Breakdown — ID: 3.9138, SupCon: 1.4052, Tri: 0.0047
[DEBUG] ArcFace confidence: 0.4627
[DEBUG] Loss Breakdown — ID: 2.6590, SupCon: 1.4748, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4837
[DEBUG] Loss Breakdown — ID: 3.0709, SupCon: 1.2959, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4981
[DEBUG] Loss Breakdown — ID: 3.2197, SupCon: 0.8949, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.3905
[DEBUG] Loss Breakdown — ID: 3.0768, SupCon: 1.1558, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4614
[DEBUG] Loss Breakdown — ID: 2.2981, SupCon: 1.8331, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4658
[DEBUG] Loss Breakdown — ID: 2.3284, SupCon: 1.5012, Tri: 0.0000
[Epoch 6] Total Loss=0.6557
Validating epoch 6...
[Epoch 6] Avg Train Loss = 0.6557 | 
==================== Epoch 6 Validation ====================
Validation rank-1    : 90.32%
Validation rank-5    : 97.22%
Validation rank-10   : 98.46%
Validation mAP      : 93.75%
============================================================
Saving best model at epoch 6 (Acc@1=90.32%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 7/60
[Epoch 7] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.5168
[DEBUG] Loss Breakdown — ID: 1.7781, SupCon: 2.2249, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.4580
[DEBUG] Loss Breakdown — ID: 2.5603, SupCon: 1.5644, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5207
[DEBUG] Loss Breakdown — ID: 2.1814, SupCon: 1.4102, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4883
[DEBUG] Loss Breakdown — ID: 2.3683, SupCon: 2.0607, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4436
[DEBUG] Loss Breakdown — ID: 2.8988, SupCon: 1.2747, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6054
[DEBUG] Loss Breakdown — ID: 1.7698, SupCon: 1.7233, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5620
[DEBUG] Loss Breakdown — ID: 2.6724, SupCon: 1.6861, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4578
[DEBUG] Loss Breakdown — ID: 2.9282, SupCon: 2.0122, Tri: 0.0103
[DEBUG] ArcFace confidence: 0.5518
[DEBUG] Loss Breakdown — ID: 2.4157, SupCon: 1.1761, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5481
[DEBUG] Loss Breakdown — ID: 2.2314, SupCon: 0.7997, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5560
[DEBUG] Loss Breakdown — ID: 2.5485, SupCon: 0.6727, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4120
[DEBUG] Loss Breakdown — ID: 2.1616, SupCon: 1.1328, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4228
[DEBUG] Loss Breakdown — ID: 3.0858, SupCon: 1.4334, Tri: 0.0016
[DEBUG] ArcFace confidence: 0.5028
[DEBUG] Loss Breakdown — ID: 2.5398, SupCon: 1.7405, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4321
[DEBUG] Loss Breakdown — ID: 3.0848, SupCon: 1.5529, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4929
[DEBUG] Loss Breakdown — ID: 2.6554, SupCon: 1.8194, Tri: 0.0011
[DEBUG] ArcFace confidence: 0.5380
[DEBUG] Loss Breakdown — ID: 2.7837, SupCon: 1.3585, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5549
[DEBUG] Loss Breakdown — ID: 1.6507, SupCon: 1.8667, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5442
[DEBUG] Loss Breakdown — ID: 2.4495, SupCon: 0.7649, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5333
[DEBUG] Loss Breakdown — ID: 3.4138, SupCon: 1.3844, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5702
[DEBUG] Loss Breakdown — ID: 1.4968, SupCon: 1.4183, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5107
[DEBUG] Loss Breakdown — ID: 2.1269, SupCon: 1.5511, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5157
[DEBUG] Loss Breakdown — ID: 1.9474, SupCon: 1.5353, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5066
[DEBUG] Loss Breakdown — ID: 3.0359, SupCon: 1.1812, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5472
[DEBUG] Loss Breakdown — ID: 2.4558, SupCon: 1.3462, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5012
[DEBUG] Loss Breakdown — ID: 2.2508, SupCon: 1.0403, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.4663
[DEBUG] Loss Breakdown — ID: 2.9919, SupCon: 1.5191, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5323
[DEBUG] Loss Breakdown — ID: 2.2610, SupCon: 1.1455, Tri: 0.0000
[Epoch 7] Total Loss=0.4915
Validating epoch 7...
[Epoch 7] Avg Train Loss = 0.4915 | 
==================== Epoch 7 Validation ====================
Validation rank-1    : 91.14%
Validation rank-5    : 98.15%
Validation rank-10   : 98.97%
Validation mAP      : 94.36%
============================================================
Saving best model at epoch 7 (Acc@1=91.14%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 8/60
[Epoch 8] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.5322
[DEBUG] Loss Breakdown — ID: 1.7018, SupCon: 1.8431, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.6050
[DEBUG] Loss Breakdown — ID: 1.8659, SupCon: 1.2667, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6111
[DEBUG] Loss Breakdown — ID: 1.4630, SupCon: 1.7864, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5878
[DEBUG] Loss Breakdown — ID: 1.7623, SupCon: 1.6019, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6601
[DEBUG] Loss Breakdown — ID: 1.4685, SupCon: 1.6069, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5189
[DEBUG] Loss Breakdown — ID: 1.9481, SupCon: 0.9415, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5404
[DEBUG] Loss Breakdown — ID: 2.4977, SupCon: 0.8379, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5861
[DEBUG] Loss Breakdown — ID: 1.8351, SupCon: 1.7863, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5967
[DEBUG] Loss Breakdown — ID: 1.8385, SupCon: 1.7289, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6332
[DEBUG] Loss Breakdown — ID: 1.8087, SupCon: 1.2087, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5706
[DEBUG] Loss Breakdown — ID: 1.9553, SupCon: 1.4999, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5264
[DEBUG] Loss Breakdown — ID: 3.4197, SupCon: 1.2463, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5608
[DEBUG] Loss Breakdown — ID: 2.3613, SupCon: 1.6070, Tri: 0.0060
[DEBUG] ArcFace confidence: 0.5892
[DEBUG] Loss Breakdown — ID: 1.5780, SupCon: 1.4122, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5988
[DEBUG] Loss Breakdown — ID: 1.8439, SupCon: 1.2624, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5861
[DEBUG] Loss Breakdown — ID: 1.8967, SupCon: 1.1758, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5747
[DEBUG] Loss Breakdown — ID: 1.9702, SupCon: 1.4014, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5908
[DEBUG] Loss Breakdown — ID: 1.6966, SupCon: 2.1692, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5386
[DEBUG] Loss Breakdown — ID: 2.0530, SupCon: 2.3944, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6238
[DEBUG] Loss Breakdown — ID: 1.5286, SupCon: 2.1388, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5255
[DEBUG] Loss Breakdown — ID: 2.1624, SupCon: 1.2215, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6304
[DEBUG] Loss Breakdown — ID: 1.7499, SupCon: 1.3337, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5676
[DEBUG] Loss Breakdown — ID: 1.8090, SupCon: 1.0527, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6569
[DEBUG] Loss Breakdown — ID: 2.0308, SupCon: 1.9480, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6686
[DEBUG] Loss Breakdown — ID: 1.3755, SupCon: 1.6386, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5858
[DEBUG] Loss Breakdown — ID: 2.3668, SupCon: 1.3818, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5524
[DEBUG] Loss Breakdown — ID: 2.3441, SupCon: 1.2135, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6815
[DEBUG] Loss Breakdown — ID: 1.2538, SupCon: 0.4565, Tri: 0.0000
[Epoch 8] Total Loss=0.3830
Validating epoch 8...
[Epoch 8] Avg Train Loss = 0.3830 | 
==================== Epoch 8 Validation ====================
Validation rank-1    : 91.35%
Validation rank-5    : 98.25%
Validation rank-10   : 99.38%
Validation mAP      : 94.58%
============================================================
Saving best model at epoch 8 (Acc@1=91.35%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 9/60
[Epoch 9] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.6586
[DEBUG] Loss Breakdown — ID: 1.6072, SupCon: 1.6635, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.6083
[DEBUG] Loss Breakdown — ID: 1.8405, SupCon: 1.4868, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6232
[DEBUG] Loss Breakdown — ID: 1.8733, SupCon: 1.1647, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6334
[DEBUG] Loss Breakdown — ID: 1.5785, SupCon: 2.0368, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6693
[DEBUG] Loss Breakdown — ID: 1.7491, SupCon: 1.3263, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6672
[DEBUG] Loss Breakdown — ID: 1.7780, SupCon: 1.9124, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6777
[DEBUG] Loss Breakdown — ID: 1.8436, SupCon: 1.8991, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6211
[DEBUG] Loss Breakdown — ID: 1.6687, SupCon: 1.2608, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7294
[DEBUG] Loss Breakdown — ID: 1.5754, SupCon: 1.6372, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7166
[DEBUG] Loss Breakdown — ID: 1.0882, SupCon: 1.5117, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6257
[DEBUG] Loss Breakdown — ID: 1.3359, SupCon: 2.5160, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6084
[DEBUG] Loss Breakdown — ID: 1.4824, SupCon: 1.3887, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6284
[DEBUG] Loss Breakdown — ID: 1.4292, SupCon: 1.2365, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5844
[DEBUG] Loss Breakdown — ID: 2.0042, SupCon: 1.6257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6903
[DEBUG] Loss Breakdown — ID: 1.2890, SupCon: 1.6159, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6957
[DEBUG] Loss Breakdown — ID: 1.5519, SupCon: 1.9525, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7482
[DEBUG] Loss Breakdown — ID: 1.2134, SupCon: 1.4423, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6053
[DEBUG] Loss Breakdown — ID: 1.9274, SupCon: 1.6788, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6479
[DEBUG] Loss Breakdown — ID: 1.8061, SupCon: 1.1369, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6380
[DEBUG] Loss Breakdown — ID: 1.8745, SupCon: 1.6342, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6987
[DEBUG] Loss Breakdown — ID: 1.1597, SupCon: 1.5743, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6167
[DEBUG] Loss Breakdown — ID: 1.3502, SupCon: 1.4733, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6861
[DEBUG] Loss Breakdown — ID: 1.2626, SupCon: 1.7597, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6080
[DEBUG] Loss Breakdown — ID: 1.6677, SupCon: 1.6137, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.5964
[DEBUG] Loss Breakdown — ID: 1.4363, SupCon: 1.6969, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6410
[DEBUG] Loss Breakdown — ID: 1.8159, SupCon: 1.3432, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7418
[DEBUG] Loss Breakdown — ID: 1.2170, SupCon: 1.6189, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6723
[DEBUG] Loss Breakdown — ID: 1.4129, SupCon: 1.2037, Tri: 0.0000
[Epoch 9] Total Loss=0.3131
Validating epoch 9...
[Epoch 9] Avg Train Loss = 0.3131 | 
==================== Epoch 9 Validation ====================
Validation rank-1    : 91.04%
Validation rank-5    : 98.35%
Validation rank-10   : 99.18%
Validation mAP      : 94.35%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 10/60
[Epoch 10] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7091
[DEBUG] Loss Breakdown — ID: 1.4418, SupCon: 1.6842, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.6140
[DEBUG] Loss Breakdown — ID: 1.4806, SupCon: 1.6349, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6973
[DEBUG] Loss Breakdown — ID: 1.1356, SupCon: 1.4210, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6548
[DEBUG] Loss Breakdown — ID: 1.2637, SupCon: 1.8305, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7456
[DEBUG] Loss Breakdown — ID: 1.1214, SupCon: 1.5716, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7127
[DEBUG] Loss Breakdown — ID: 1.4398, SupCon: 1.9086, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7322
[DEBUG] Loss Breakdown — ID: 1.2160, SupCon: 1.4845, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7605
[DEBUG] Loss Breakdown — ID: 1.0439, SupCon: 1.3786, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7016
[DEBUG] Loss Breakdown — ID: 1.1775, SupCon: 1.3979, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6905
[DEBUG] Loss Breakdown — ID: 1.3528, SupCon: 1.9316, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7164
[DEBUG] Loss Breakdown — ID: 1.1001, SupCon: 1.3165, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6785
[DEBUG] Loss Breakdown — ID: 1.8986, SupCon: 1.9924, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7055
[DEBUG] Loss Breakdown — ID: 1.3653, SupCon: 1.0781, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7621
[DEBUG] Loss Breakdown — ID: 1.0411, SupCon: 2.4848, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6521
[DEBUG] Loss Breakdown — ID: 1.7116, SupCon: 1.7462, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6621
[DEBUG] Loss Breakdown — ID: 1.7129, SupCon: 1.5753, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6361
[DEBUG] Loss Breakdown — ID: 1.5317, SupCon: 0.9316, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7267
[DEBUG] Loss Breakdown — ID: 1.3299, SupCon: 1.2494, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6944
[DEBUG] Loss Breakdown — ID: 1.4320, SupCon: 2.2876, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7086
[DEBUG] Loss Breakdown — ID: 1.2431, SupCon: 1.6210, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7032
[DEBUG] Loss Breakdown — ID: 1.3052, SupCon: 1.2651, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6825
[DEBUG] Loss Breakdown — ID: 1.5237, SupCon: 0.9001, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7854
[DEBUG] Loss Breakdown — ID: 0.9773, SupCon: 1.3507, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7100
[DEBUG] Loss Breakdown — ID: 1.1487, SupCon: 1.5052, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6564
[DEBUG] Loss Breakdown — ID: 1.4933, SupCon: 1.5559, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7566
[DEBUG] Loss Breakdown — ID: 0.9781, SupCon: 1.0811, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7113
[DEBUG] Loss Breakdown — ID: 1.1032, SupCon: 1.9753, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6558
[DEBUG] Loss Breakdown — ID: 1.2736, SupCon: 1.1926, Tri: 0.0000
[Epoch 10] Total Loss=0.2632
Validating epoch 10...
[Epoch 10] Avg Train Loss = 0.2632 | 
==================== Epoch 10 Validation ====================
Validation rank-1    : 90.83%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 94.41%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 11/60
[Epoch 11] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7086
[DEBUG] Loss Breakdown — ID: 1.0832, SupCon: 1.8116, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.6970
[DEBUG] Loss Breakdown — ID: 1.0990, SupCon: 1.6317, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6912
[DEBUG] Loss Breakdown — ID: 1.1270, SupCon: 2.1304, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7631
[DEBUG] Loss Breakdown — ID: 1.2471, SupCon: 2.1541, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7476
[DEBUG] Loss Breakdown — ID: 1.1097, SupCon: 0.9307, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7139
[DEBUG] Loss Breakdown — ID: 1.1984, SupCon: 1.3623, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7094
[DEBUG] Loss Breakdown — ID: 1.1550, SupCon: 1.7758, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7639
[DEBUG] Loss Breakdown — ID: 1.0372, SupCon: 1.6420, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7598
[DEBUG] Loss Breakdown — ID: 1.2448, SupCon: 1.7782, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7675
[DEBUG] Loss Breakdown — ID: 1.0395, SupCon: 1.4268, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8240
[DEBUG] Loss Breakdown — ID: 1.0175, SupCon: 1.6562, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7276
[DEBUG] Loss Breakdown — ID: 1.2195, SupCon: 1.1144, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8028
[DEBUG] Loss Breakdown — ID: 0.9357, SupCon: 1.9677, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6974
[DEBUG] Loss Breakdown — ID: 1.2235, SupCon: 1.7189, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8108
[DEBUG] Loss Breakdown — ID: 0.9425, SupCon: 1.2919, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7266
[DEBUG] Loss Breakdown — ID: 1.2214, SupCon: 2.0707, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7784
[DEBUG] Loss Breakdown — ID: 0.9706, SupCon: 1.5722, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7929
[DEBUG] Loss Breakdown — ID: 1.1100, SupCon: 1.7049, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7803
[DEBUG] Loss Breakdown — ID: 0.9890, SupCon: 1.4967, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8179
[DEBUG] Loss Breakdown — ID: 1.3573, SupCon: 1.4151, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7567
[DEBUG] Loss Breakdown — ID: 1.2967, SupCon: 1.3376, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6707
[DEBUG] Loss Breakdown — ID: 1.9778, SupCon: 1.4342, Tri: 0.0087
[DEBUG] ArcFace confidence: 0.7926
[DEBUG] Loss Breakdown — ID: 1.0232, SupCon: 1.1886, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7746
[DEBUG] Loss Breakdown — ID: 1.0051, SupCon: 1.4868, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6781
[DEBUG] Loss Breakdown — ID: 1.4142, SupCon: 1.5730, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7179
[DEBUG] Loss Breakdown — ID: 1.2240, SupCon: 1.9609, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7897
[DEBUG] Loss Breakdown — ID: 1.2217, SupCon: 1.7635, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7459
[DEBUG] Loss Breakdown — ID: 1.0411, SupCon: 1.1015, Tri: 0.0000
[Epoch 11] Total Loss=0.2327
Validating epoch 11...
[Epoch 11] Avg Train Loss = 0.2327 | 
==================== Epoch 11 Validation ====================
Validation rank-1    : 91.14%
Validation rank-5    : 98.35%
Validation rank-10   : 99.28%
Validation mAP      : 94.56%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 12/60
[Epoch 12] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7771
[DEBUG] Loss Breakdown — ID: 0.9667, SupCon: 1.3155, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.7418
[DEBUG] Loss Breakdown — ID: 1.0833, SupCon: 1.4303, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7545
[DEBUG] Loss Breakdown — ID: 1.0557, SupCon: 1.6140, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.6894
[DEBUG] Loss Breakdown — ID: 1.4613, SupCon: 1.4081, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7774
[DEBUG] Loss Breakdown — ID: 0.9686, SupCon: 1.7374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7684
[DEBUG] Loss Breakdown — ID: 0.9744, SupCon: 1.6460, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7466
[DEBUG] Loss Breakdown — ID: 1.1235, SupCon: 1.5439, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7703
[DEBUG] Loss Breakdown — ID: 0.9721, SupCon: 1.8331, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7862
[DEBUG] Loss Breakdown — ID: 1.0337, SupCon: 2.3480, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7903
[DEBUG] Loss Breakdown — ID: 1.0981, SupCon: 1.2242, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7852
[DEBUG] Loss Breakdown — ID: 1.0546, SupCon: 1.7565, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7752
[DEBUG] Loss Breakdown — ID: 0.9672, SupCon: 1.8302, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7154
[DEBUG] Loss Breakdown — ID: 1.2973, SupCon: 1.4167, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8664
[DEBUG] Loss Breakdown — ID: 0.9157, SupCon: 1.2455, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7405
[DEBUG] Loss Breakdown — ID: 1.0736, SupCon: 1.2716, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7961
[DEBUG] Loss Breakdown — ID: 1.1416, SupCon: 1.6286, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8258
[DEBUG] Loss Breakdown — ID: 0.9594, SupCon: 1.8883, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7722
[DEBUG] Loss Breakdown — ID: 1.0068, SupCon: 1.4737, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7559
[DEBUG] Loss Breakdown — ID: 1.3734, SupCon: 1.5442, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7839
[DEBUG] Loss Breakdown — ID: 1.4729, SupCon: 1.7376, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7745
[DEBUG] Loss Breakdown — ID: 0.9993, SupCon: 1.3292, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8263
[DEBUG] Loss Breakdown — ID: 0.9491, SupCon: 1.3407, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7761
[DEBUG] Loss Breakdown — ID: 1.1116, SupCon: 1.1358, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7334
[DEBUG] Loss Breakdown — ID: 1.0348, SupCon: 1.3062, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7631
[DEBUG] Loss Breakdown — ID: 0.9933, SupCon: 1.7081, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7910
[DEBUG] Loss Breakdown — ID: 0.9623, SupCon: 1.5953, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7609
[DEBUG] Loss Breakdown — ID: 0.9785, SupCon: 1.6136, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7641
[DEBUG] Loss Breakdown — ID: 1.0267, SupCon: 0.9409, Tri: 0.0000
[Epoch 12] Total Loss=0.2147
Validating epoch 12...
[Epoch 12] Avg Train Loss = 0.2147 | 
==================== Epoch 12 Validation ====================
Validation rank-1    : 92.07%
Validation rank-5    : 98.56%
Validation rank-10   : 99.28%
Validation mAP      : 95.17%
============================================================
Saving best model at epoch 12 (Acc@1=92.07%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 13/60
[Epoch 13] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8308
[DEBUG] Loss Breakdown — ID: 1.1649, SupCon: 0.7336, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.7858
[DEBUG] Loss Breakdown — ID: 1.0195, SupCon: 1.9710, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8664
[DEBUG] Loss Breakdown — ID: 0.8804, SupCon: 1.4634, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8036
[DEBUG] Loss Breakdown — ID: 1.0882, SupCon: 1.4302, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8105
[DEBUG] Loss Breakdown — ID: 1.0749, SupCon: 1.6236, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8214
[DEBUG] Loss Breakdown — ID: 0.9298, SupCon: 1.6576, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7926
[DEBUG] Loss Breakdown — ID: 1.0384, SupCon: 1.0996, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8333
[DEBUG] Loss Breakdown — ID: 0.9812, SupCon: 1.5523, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8276
[DEBUG] Loss Breakdown — ID: 0.9345, SupCon: 0.9398, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8766
[DEBUG] Loss Breakdown — ID: 0.8809, SupCon: 1.4292, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8243
[DEBUG] Loss Breakdown — ID: 0.9074, SupCon: 2.0867, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8068
[DEBUG] Loss Breakdown — ID: 0.9545, SupCon: 1.2940, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8382
[DEBUG] Loss Breakdown — ID: 0.9784, SupCon: 1.7021, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7063
[DEBUG] Loss Breakdown — ID: 1.3122, SupCon: 1.7538, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8236
[DEBUG] Loss Breakdown — ID: 0.9187, SupCon: 1.6754, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8603
[DEBUG] Loss Breakdown — ID: 0.8878, SupCon: 1.9032, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8382
[DEBUG] Loss Breakdown — ID: 1.0747, SupCon: 1.0894, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8332
[DEBUG] Loss Breakdown — ID: 0.9215, SupCon: 0.9639, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7770
[DEBUG] Loss Breakdown — ID: 1.0233, SupCon: 1.0997, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8356
[DEBUG] Loss Breakdown — ID: 0.9232, SupCon: 1.4057, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7887
[DEBUG] Loss Breakdown — ID: 1.0608, SupCon: 1.4009, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8429
[DEBUG] Loss Breakdown — ID: 0.9175, SupCon: 1.0639, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8168
[DEBUG] Loss Breakdown — ID: 1.1441, SupCon: 1.0159, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8189
[DEBUG] Loss Breakdown — ID: 0.9250, SupCon: 1.9618, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8420
[DEBUG] Loss Breakdown — ID: 0.8919, SupCon: 1.8677, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8155
[DEBUG] Loss Breakdown — ID: 0.9374, SupCon: 1.1899, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7606
[DEBUG] Loss Breakdown — ID: 0.9631, SupCon: 2.1032, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7223
[DEBUG] Loss Breakdown — ID: 1.2456, SupCon: 1.2366, Tri: 0.0000
[Epoch 13] Total Loss=0.1999
Validating epoch 13...
[Epoch 13] Avg Train Loss = 0.1999 | 
==================== Epoch 13 Validation ====================
Validation rank-1    : 90.63%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 94.22%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 14/60
[Epoch 14] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8208
[DEBUG] Loss Breakdown — ID: 1.0356, SupCon: 1.2989, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8609
[DEBUG] Loss Breakdown — ID: 0.8803, SupCon: 1.2081, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8003
[DEBUG] Loss Breakdown — ID: 0.9540, SupCon: 0.3549, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8561
[DEBUG] Loss Breakdown — ID: 0.9206, SupCon: 1.8095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8542
[DEBUG] Loss Breakdown — ID: 0.9427, SupCon: 1.1738, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8595
[DEBUG] Loss Breakdown — ID: 0.8929, SupCon: 1.6224, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8215
[DEBUG] Loss Breakdown — ID: 1.1099, SupCon: 2.2531, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8374
[DEBUG] Loss Breakdown — ID: 1.0409, SupCon: 0.9594, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8837
[DEBUG] Loss Breakdown — ID: 0.8788, SupCon: 1.5128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8427
[DEBUG] Loss Breakdown — ID: 0.8966, SupCon: 1.4930, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8655
[DEBUG] Loss Breakdown — ID: 0.8846, SupCon: 1.6257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7884
[DEBUG] Loss Breakdown — ID: 0.9598, SupCon: 1.8299, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8715
[DEBUG] Loss Breakdown — ID: 0.8854, SupCon: 1.6772, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8007
[DEBUG] Loss Breakdown — ID: 0.9270, SupCon: 2.0592, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8054
[DEBUG] Loss Breakdown — ID: 0.9225, SupCon: 1.4257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8726
[DEBUG] Loss Breakdown — ID: 0.8816, SupCon: 1.9072, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8521
[DEBUG] Loss Breakdown — ID: 0.8836, SupCon: 1.1400, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8369
[DEBUG] Loss Breakdown — ID: 1.0934, SupCon: 1.4976, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7983
[DEBUG] Loss Breakdown — ID: 0.9779, SupCon: 1.4484, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8591
[DEBUG] Loss Breakdown — ID: 0.8817, SupCon: 1.5990, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8652
[DEBUG] Loss Breakdown — ID: 0.8827, SupCon: 1.5819, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7804
[DEBUG] Loss Breakdown — ID: 0.9730, SupCon: 2.4373, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8120
[DEBUG] Loss Breakdown — ID: 0.9899, SupCon: 1.3014, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8492
[DEBUG] Loss Breakdown — ID: 0.8909, SupCon: 2.2447, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8395
[DEBUG] Loss Breakdown — ID: 0.9824, SupCon: 0.8051, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7699
[DEBUG] Loss Breakdown — ID: 1.2008, SupCon: 1.7732, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8118
[DEBUG] Loss Breakdown — ID: 0.9240, SupCon: 0.9337, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8072
[DEBUG] Loss Breakdown — ID: 0.9248, SupCon: 1.1436, Tri: 0.0000
[Epoch 14] Total Loss=0.1901
Validating epoch 14...
[Epoch 14] Avg Train Loss = 0.1901 | 
==================== Epoch 14 Validation ====================
Validation rank-1    : 91.45%
Validation rank-5    : 98.25%
Validation rank-10   : 98.97%
Validation mAP      : 94.64%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 15/60
[Epoch 15] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8094
[DEBUG] Loss Breakdown — ID: 0.9279, SupCon: 1.3984, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8181
[DEBUG] Loss Breakdown — ID: 0.9876, SupCon: 1.7487, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8690
[DEBUG] Loss Breakdown — ID: 0.8888, SupCon: 0.5824, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8537
[DEBUG] Loss Breakdown — ID: 0.8853, SupCon: 1.5137, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8384
[DEBUG] Loss Breakdown — ID: 0.9107, SupCon: 1.6729, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8390
[DEBUG] Loss Breakdown — ID: 0.9740, SupCon: 0.8491, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8492
[DEBUG] Loss Breakdown — ID: 0.9124, SupCon: 1.6459, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8268
[DEBUG] Loss Breakdown — ID: 0.9555, SupCon: 1.5585, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8405
[DEBUG] Loss Breakdown — ID: 0.8926, SupCon: 2.0482, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8670
[DEBUG] Loss Breakdown — ID: 0.8776, SupCon: 1.6798, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8256
[DEBUG] Loss Breakdown — ID: 0.9180, SupCon: 1.6317, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8504
[DEBUG] Loss Breakdown — ID: 0.8794, SupCon: 1.9240, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8167
[DEBUG] Loss Breakdown — ID: 0.9414, SupCon: 1.8692, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8485
[DEBUG] Loss Breakdown — ID: 0.8894, SupCon: 1.6615, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8602
[DEBUG] Loss Breakdown — ID: 1.0284, SupCon: 1.6455, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8145
[DEBUG] Loss Breakdown — ID: 1.0327, SupCon: 1.1653, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8324
[DEBUG] Loss Breakdown — ID: 0.8950, SupCon: 2.2031, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8521
[DEBUG] Loss Breakdown — ID: 0.8826, SupCon: 1.9004, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8874
[DEBUG] Loss Breakdown — ID: 0.8678, SupCon: 1.6922, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8602
[DEBUG] Loss Breakdown — ID: 0.8949, SupCon: 1.3911, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8693
[DEBUG] Loss Breakdown — ID: 0.8884, SupCon: 0.9907, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8358
[DEBUG] Loss Breakdown — ID: 1.0255, SupCon: 1.0911, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9054
[DEBUG] Loss Breakdown — ID: 0.8619, SupCon: 1.4710, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8592
[DEBUG] Loss Breakdown — ID: 0.8899, SupCon: 1.1035, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8880
[DEBUG] Loss Breakdown — ID: 0.8646, SupCon: 1.0654, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8424
[DEBUG] Loss Breakdown — ID: 1.0373, SupCon: 1.6307, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8503
[DEBUG] Loss Breakdown — ID: 0.9156, SupCon: 1.2705, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8451
[DEBUG] Loss Breakdown — ID: 0.9172, SupCon: 0.4905, Tri: 0.0000
[Epoch 15] Total Loss=0.1846
Validating epoch 15...
[Epoch 15] Avg Train Loss = 0.1846 | 
==================== Epoch 15 Validation ====================
Validation rank-1    : 91.14%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 94.49%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 16/60
[Epoch 16] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8272
[DEBUG] Loss Breakdown — ID: 0.9333, SupCon: 1.9345, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8619
[DEBUG] Loss Breakdown — ID: 0.8703, SupCon: 1.9889, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8686
[DEBUG] Loss Breakdown — ID: 0.8662, SupCon: 2.0415, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8606
[DEBUG] Loss Breakdown — ID: 0.8965, SupCon: 0.8607, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8488
[DEBUG] Loss Breakdown — ID: 0.9402, SupCon: 1.7128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8898
[DEBUG] Loss Breakdown — ID: 0.8817, SupCon: 1.7909, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8514
[DEBUG] Loss Breakdown — ID: 0.8809, SupCon: 2.0391, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8481
[DEBUG] Loss Breakdown — ID: 0.8873, SupCon: 2.0964, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8950
[DEBUG] Loss Breakdown — ID: 0.8669, SupCon: 1.1607, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8609
[DEBUG] Loss Breakdown — ID: 0.8861, SupCon: 1.9458, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8491
[DEBUG] Loss Breakdown — ID: 0.8940, SupCon: 1.3382, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8576
[DEBUG] Loss Breakdown — ID: 0.8791, SupCon: 2.2292, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8486
[DEBUG] Loss Breakdown — ID: 0.8762, SupCon: 1.5115, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8861
[DEBUG] Loss Breakdown — ID: 0.8733, SupCon: 1.6614, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8764
[DEBUG] Loss Breakdown — ID: 0.9593, SupCon: 1.3415, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7968
[DEBUG] Loss Breakdown — ID: 0.9235, SupCon: 1.6096, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8841
[DEBUG] Loss Breakdown — ID: 0.8653, SupCon: 1.3450, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8731
[DEBUG] Loss Breakdown — ID: 0.8700, SupCon: 0.7480, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8801
[DEBUG] Loss Breakdown — ID: 0.8618, SupCon: 2.1170, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8596
[DEBUG] Loss Breakdown — ID: 0.9654, SupCon: 1.9019, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8592
[DEBUG] Loss Breakdown — ID: 0.8756, SupCon: 1.4280, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8620
[DEBUG] Loss Breakdown — ID: 0.9939, SupCon: 1.2268, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8397
[DEBUG] Loss Breakdown — ID: 0.8904, SupCon: 1.9072, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8746
[DEBUG] Loss Breakdown — ID: 0.8656, SupCon: 0.9537, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8554
[DEBUG] Loss Breakdown — ID: 0.8837, SupCon: 2.1859, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8379
[DEBUG] Loss Breakdown — ID: 0.9614, SupCon: 1.7128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8393
[DEBUG] Loss Breakdown — ID: 0.9004, SupCon: 1.5506, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8437
[DEBUG] Loss Breakdown — ID: 0.8773, SupCon: 2.1286, Tri: 0.0000
[Epoch 16] Total Loss=0.1795
Validating epoch 16...
[Epoch 16] Avg Train Loss = 0.1795 | 
==================== Epoch 16 Validation ====================
Validation rank-1    : 91.14%
Validation rank-5    : 98.25%
Validation rank-10   : 99.28%
Validation mAP      : 94.47%
============================================================
No improvement in Acc@1. Patience counter: 4/10
 Epoch 17/60
[Epoch 17] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8778
[DEBUG] Loss Breakdown — ID: 0.8654, SupCon: 1.5923, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8523
[DEBUG] Loss Breakdown — ID: 0.8885, SupCon: 1.4473, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9023
[DEBUG] Loss Breakdown — ID: 0.8535, SupCon: 1.8935, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8450
[DEBUG] Loss Breakdown — ID: 0.8705, SupCon: 1.3505, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8354
[DEBUG] Loss Breakdown — ID: 0.8835, SupCon: 2.1288, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8628
[DEBUG] Loss Breakdown — ID: 0.8798, SupCon: 1.1312, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9093
[DEBUG] Loss Breakdown — ID: 0.8653, SupCon: 0.7579, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8812
[DEBUG] Loss Breakdown — ID: 0.8688, SupCon: 1.4578, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8928
[DEBUG] Loss Breakdown — ID: 0.8730, SupCon: 1.4508, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8666
[DEBUG] Loss Breakdown — ID: 0.8773, SupCon: 1.4235, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8893
[DEBUG] Loss Breakdown — ID: 0.8719, SupCon: 0.8137, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8761
[DEBUG] Loss Breakdown — ID: 0.8659, SupCon: 2.2491, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8559
[DEBUG] Loss Breakdown — ID: 0.8940, SupCon: 1.2781, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8511
[DEBUG] Loss Breakdown — ID: 0.9618, SupCon: 2.0370, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8576
[DEBUG] Loss Breakdown — ID: 0.8902, SupCon: 1.2159, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8909
[DEBUG] Loss Breakdown — ID: 0.8595, SupCon: 1.8085, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8666
[DEBUG] Loss Breakdown — ID: 0.9210, SupCon: 1.3485, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8746
[DEBUG] Loss Breakdown — ID: 0.8775, SupCon: 1.3200, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8351
[DEBUG] Loss Breakdown — ID: 0.9451, SupCon: 1.0452, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8459
[DEBUG] Loss Breakdown — ID: 0.9109, SupCon: 1.7693, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8294
[DEBUG] Loss Breakdown — ID: 0.9200, SupCon: 1.8628, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8829
[DEBUG] Loss Breakdown — ID: 0.8650, SupCon: 1.5012, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8507
[DEBUG] Loss Breakdown — ID: 0.8714, SupCon: 1.6456, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8729
[DEBUG] Loss Breakdown — ID: 0.8687, SupCon: 1.8022, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8239
[DEBUG] Loss Breakdown — ID: 0.9032, SupCon: 1.9612, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8733
[DEBUG] Loss Breakdown — ID: 0.8623, SupCon: 1.8408, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8291
[DEBUG] Loss Breakdown — ID: 0.9172, SupCon: 1.2011, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8045
[DEBUG] Loss Breakdown — ID: 0.9129, SupCon: 1.2920, Tri: 0.0000
[Epoch 17] Total Loss=0.1775
Validating epoch 17...
[Epoch 17] Avg Train Loss = 0.1775 | 
==================== Epoch 17 Validation ====================
Validation rank-1    : 90.73%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 94.28%
============================================================
No improvement in Acc@1. Patience counter: 5/10
 Epoch 18/60
[Epoch 18] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8063
[DEBUG] Loss Breakdown — ID: 0.9466, SupCon: 1.1228, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8795
[DEBUG] Loss Breakdown — ID: 0.8814, SupCon: 1.4491, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9067
[DEBUG] Loss Breakdown — ID: 0.8543, SupCon: 1.6565, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8905
[DEBUG] Loss Breakdown — ID: 0.8566, SupCon: 1.2513, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8597
[DEBUG] Loss Breakdown — ID: 0.8761, SupCon: 2.2459, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8610
[DEBUG] Loss Breakdown — ID: 0.8977, SupCon: 1.2702, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8847
[DEBUG] Loss Breakdown — ID: 0.8631, SupCon: 1.3092, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8710
[DEBUG] Loss Breakdown — ID: 0.8733, SupCon: 1.6066, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8689
[DEBUG] Loss Breakdown — ID: 0.8589, SupCon: 1.9694, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8626
[DEBUG] Loss Breakdown — ID: 0.8996, SupCon: 1.3348, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8702
[DEBUG] Loss Breakdown — ID: 0.8631, SupCon: 1.9295, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8209
[DEBUG] Loss Breakdown — ID: 0.8955, SupCon: 1.8004, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9099
[DEBUG] Loss Breakdown — ID: 0.8487, SupCon: 0.8160, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8728
[DEBUG] Loss Breakdown — ID: 0.8677, SupCon: 1.4496, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8785
[DEBUG] Loss Breakdown — ID: 0.8780, SupCon: 1.5413, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8652
[DEBUG] Loss Breakdown — ID: 0.8826, SupCon: 1.5925, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8605
[DEBUG] Loss Breakdown — ID: 0.8686, SupCon: 2.0621, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8795
[DEBUG] Loss Breakdown — ID: 0.8641, SupCon: 1.1950, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8640
[DEBUG] Loss Breakdown — ID: 0.8659, SupCon: 1.3168, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8801
[DEBUG] Loss Breakdown — ID: 0.8623, SupCon: 1.4262, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9057
[DEBUG] Loss Breakdown — ID: 0.8518, SupCon: 1.5338, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8363
[DEBUG] Loss Breakdown — ID: 0.8828, SupCon: 1.4850, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8812
[DEBUG] Loss Breakdown — ID: 0.8591, SupCon: 1.7495, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8669
[DEBUG] Loss Breakdown — ID: 0.8720, SupCon: 1.4382, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8979
[DEBUG] Loss Breakdown — ID: 0.8593, SupCon: 1.0714, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8719
[DEBUG] Loss Breakdown — ID: 0.8771, SupCon: 1.5069, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8425
[DEBUG] Loss Breakdown — ID: 0.9262, SupCon: 1.5598, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8176
[DEBUG] Loss Breakdown — ID: 0.8875, SupCon: 1.5945, Tri: 0.0000
[Epoch 18] Total Loss=0.1751
Validating epoch 18...
[Epoch 18] Avg Train Loss = 0.1751 | 
==================== Epoch 18 Validation ====================
Validation rank-1    : 92.17%
Validation rank-5    : 98.25%
Validation rank-10   : 99.28%
Validation mAP      : 95.11%
============================================================
Saving best model at epoch 18 (Acc@1=92.17%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 19/60
[Epoch 19] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8442
[DEBUG] Loss Breakdown — ID: 0.8965, SupCon: 2.1735, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8813
[DEBUG] Loss Breakdown — ID: 0.8632, SupCon: 1.7574, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8798
[DEBUG] Loss Breakdown — ID: 0.8564, SupCon: 2.1767, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8841
[DEBUG] Loss Breakdown — ID: 0.8685, SupCon: 1.3938, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8869
[DEBUG] Loss Breakdown — ID: 0.8657, SupCon: 1.0791, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8812
[DEBUG] Loss Breakdown — ID: 0.8608, SupCon: 1.1812, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8736
[DEBUG] Loss Breakdown — ID: 0.8780, SupCon: 1.0928, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8750
[DEBUG] Loss Breakdown — ID: 0.8656, SupCon: 1.3175, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8972
[DEBUG] Loss Breakdown — ID: 0.8510, SupCon: 0.9530, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8509, SupCon: 1.3348, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7813
[DEBUG] Loss Breakdown — ID: 0.9706, SupCon: 1.5204, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8761
[DEBUG] Loss Breakdown — ID: 0.8587, SupCon: 1.8067, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8659
[DEBUG] Loss Breakdown — ID: 0.8620, SupCon: 1.7027, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8703
[DEBUG] Loss Breakdown — ID: 0.8585, SupCon: 1.0704, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8714
[DEBUG] Loss Breakdown — ID: 0.8751, SupCon: 1.6015, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8648
[DEBUG] Loss Breakdown — ID: 0.8705, SupCon: 1.4974, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9011
[DEBUG] Loss Breakdown — ID: 0.8586, SupCon: 1.3691, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8682
[DEBUG] Loss Breakdown — ID: 0.8687, SupCon: 1.5162, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8838
[DEBUG] Loss Breakdown — ID: 0.8574, SupCon: 1.7958, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8623
[DEBUG] Loss Breakdown — ID: 0.8728, SupCon: 1.3820, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8662
[DEBUG] Loss Breakdown — ID: 0.8683, SupCon: 1.2724, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8876
[DEBUG] Loss Breakdown — ID: 0.8482, SupCon: 1.4061, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8338
[DEBUG] Loss Breakdown — ID: 0.8855, SupCon: 1.8478, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8896
[DEBUG] Loss Breakdown — ID: 0.8555, SupCon: 1.2754, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8720
[DEBUG] Loss Breakdown — ID: 0.8733, SupCon: 1.4853, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8968
[DEBUG] Loss Breakdown — ID: 0.8630, SupCon: 1.5133, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8940
[DEBUG] Loss Breakdown — ID: 0.8588, SupCon: 1.1935, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8697
[DEBUG] Loss Breakdown — ID: 0.8648, SupCon: 1.5862, Tri: 0.0000
[Epoch 19] Total Loss=0.1738
Validating epoch 19...
[Epoch 19] Avg Train Loss = 0.1738 | 
==================== Epoch 19 Validation ====================
Validation rank-1    : 91.76%
Validation rank-5    : 98.35%
Validation rank-10   : 99.28%
Validation mAP      : 94.88%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 20/60
[Epoch 20] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8714
[DEBUG] Loss Breakdown — ID: 0.8586, SupCon: 1.4399, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8583, SupCon: 1.3444, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9072
[DEBUG] Loss Breakdown — ID: 0.8440, SupCon: 1.7298, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8965
[DEBUG] Loss Breakdown — ID: 0.8556, SupCon: 1.6338, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8595
[DEBUG] Loss Breakdown — ID: 0.8806, SupCon: 1.4779, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8849
[DEBUG] Loss Breakdown — ID: 0.8473, SupCon: 1.5583, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8989
[DEBUG] Loss Breakdown — ID: 0.8508, SupCon: 1.1064, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8981
[DEBUG] Loss Breakdown — ID: 0.8498, SupCon: 0.9416, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9075
[DEBUG] Loss Breakdown — ID: 0.8521, SupCon: 1.7391, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8424
[DEBUG] Loss Breakdown — ID: 0.8924, SupCon: 1.4701, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8819
[DEBUG] Loss Breakdown — ID: 0.8571, SupCon: 1.2253, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8986
[DEBUG] Loss Breakdown — ID: 0.8556, SupCon: 1.3753, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8843
[DEBUG] Loss Breakdown — ID: 0.8535, SupCon: 1.4468, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8762
[DEBUG] Loss Breakdown — ID: 0.8764, SupCon: 1.4236, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8881
[DEBUG] Loss Breakdown — ID: 0.8499, SupCon: 0.9800, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8964
[DEBUG] Loss Breakdown — ID: 0.8507, SupCon: 1.2141, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8802
[DEBUG] Loss Breakdown — ID: 0.8558, SupCon: 1.3109, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8535, SupCon: 1.7221, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8893
[DEBUG] Loss Breakdown — ID: 0.8465, SupCon: 1.4189, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8657
[DEBUG] Loss Breakdown — ID: 0.8637, SupCon: 2.2874, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8719
[DEBUG] Loss Breakdown — ID: 0.8614, SupCon: 1.3337, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8643
[DEBUG] Loss Breakdown — ID: 0.8660, SupCon: 1.1820, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8845
[DEBUG] Loss Breakdown — ID: 0.8643, SupCon: 1.2578, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8517, SupCon: 0.9870, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8624
[DEBUG] Loss Breakdown — ID: 0.8774, SupCon: 1.2130, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8418
[DEBUG] Loss Breakdown — ID: 0.8765, SupCon: 1.3822, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8934
[DEBUG] Loss Breakdown — ID: 0.8465, SupCon: 1.3306, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8748
[DEBUG] Loss Breakdown — ID: 0.8605, SupCon: 1.5847, Tri: 0.0000
[Epoch 20] Total Loss=0.1718
Validating epoch 20...
[Epoch 20] Avg Train Loss = 0.1718 | 
==================== Epoch 20 Validation ====================
Validation rank-1    : 91.25%
Validation rank-5    : 98.46%
Validation rank-10   : 99.28%
Validation mAP      : 94.57%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 21/60
[Epoch 21] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8747
[DEBUG] Loss Breakdown — ID: 0.8650, SupCon: 1.2741, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8902
[DEBUG] Loss Breakdown — ID: 0.8518, SupCon: 1.1522, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8235
[DEBUG] Loss Breakdown — ID: 0.8898, SupCon: 2.2468, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8538, SupCon: 1.2336, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8912
[DEBUG] Loss Breakdown — ID: 0.8598, SupCon: 1.2175, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9149
[DEBUG] Loss Breakdown — ID: 0.8442, SupCon: 2.1054, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8686
[DEBUG] Loss Breakdown — ID: 0.8699, SupCon: 1.3642, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9093
[DEBUG] Loss Breakdown — ID: 0.8486, SupCon: 1.2791, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8880
[DEBUG] Loss Breakdown — ID: 0.8540, SupCon: 1.6793, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8851
[DEBUG] Loss Breakdown — ID: 0.8502, SupCon: 1.5088, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8604
[DEBUG] Loss Breakdown — ID: 0.8621, SupCon: 1.4973, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8334
[DEBUG] Loss Breakdown — ID: 0.8748, SupCon: 1.8516, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8500
[DEBUG] Loss Breakdown — ID: 0.8580, SupCon: 2.1864, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8509, SupCon: 1.5048, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9127
[DEBUG] Loss Breakdown — ID: 0.8475, SupCon: 1.6347, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8524, SupCon: 1.8848, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8944
[DEBUG] Loss Breakdown — ID: 0.8483, SupCon: 1.6594, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8576
[DEBUG] Loss Breakdown — ID: 0.8683, SupCon: 2.0764, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8970
[DEBUG] Loss Breakdown — ID: 0.8626, SupCon: 1.0620, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9032
[DEBUG] Loss Breakdown — ID: 0.8533, SupCon: 1.7910, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8838
[DEBUG] Loss Breakdown — ID: 0.8541, SupCon: 1.2502, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8726
[DEBUG] Loss Breakdown — ID: 0.8460, SupCon: 1.5182, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8593
[DEBUG] Loss Breakdown — ID: 0.8562, SupCon: 2.2612, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8263
[DEBUG] Loss Breakdown — ID: 0.8852, SupCon: 1.5870, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8528, SupCon: 0.9684, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9075
[DEBUG] Loss Breakdown — ID: 0.8498, SupCon: 0.8571, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8842
[DEBUG] Loss Breakdown — ID: 0.8501, SupCon: 1.2639, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9047
[DEBUG] Loss Breakdown — ID: 0.8382, SupCon: 1.4622, Tri: 0.0000
[Epoch 21] Total Loss=0.1714
Validating epoch 21...
[Epoch 21] Avg Train Loss = 0.1714 | 
==================== Epoch 21 Validation ====================
Validation rank-1    : 91.56%
Validation rank-5    : 98.35%
Validation rank-10   : 99.07%
Validation mAP      : 94.68%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 22/60
[Epoch 22] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8888
[DEBUG] Loss Breakdown — ID: 0.8513, SupCon: 1.5646, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8802
[DEBUG] Loss Breakdown — ID: 0.8511, SupCon: 1.3374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8632
[DEBUG] Loss Breakdown — ID: 0.8825, SupCon: 1.6946, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8843
[DEBUG] Loss Breakdown — ID: 0.8444, SupCon: 1.0889, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8694
[DEBUG] Loss Breakdown — ID: 0.8537, SupCon: 2.1356, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8972
[DEBUG] Loss Breakdown — ID: 0.8457, SupCon: 2.0152, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8838
[DEBUG] Loss Breakdown — ID: 0.8498, SupCon: 1.7503, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8699
[DEBUG] Loss Breakdown — ID: 0.8573, SupCon: 1.3526, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9206
[DEBUG] Loss Breakdown — ID: 0.8499, SupCon: 0.8516, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8653
[DEBUG] Loss Breakdown — ID: 0.8569, SupCon: 1.8836, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9058
[DEBUG] Loss Breakdown — ID: 0.8421, SupCon: 1.7167, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8659
[DEBUG] Loss Breakdown — ID: 0.8719, SupCon: 1.0079, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8935
[DEBUG] Loss Breakdown — ID: 0.8506, SupCon: 1.8395, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8859
[DEBUG] Loss Breakdown — ID: 0.8458, SupCon: 1.4931, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8837
[DEBUG] Loss Breakdown — ID: 0.8494, SupCon: 1.3957, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9008
[DEBUG] Loss Breakdown — ID: 0.8415, SupCon: 1.1841, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8739
[DEBUG] Loss Breakdown — ID: 0.8641, SupCon: 1.5280, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8465, SupCon: 1.3685, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8909
[DEBUG] Loss Breakdown — ID: 0.8494, SupCon: 1.5188, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9064
[DEBUG] Loss Breakdown — ID: 0.8460, SupCon: 1.2187, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8605
[DEBUG] Loss Breakdown — ID: 0.8550, SupCon: 1.8828, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8626
[DEBUG] Loss Breakdown — ID: 0.8555, SupCon: 1.7413, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9090
[DEBUG] Loss Breakdown — ID: 0.8436, SupCon: 1.1913, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8805
[DEBUG] Loss Breakdown — ID: 0.8503, SupCon: 1.4725, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8935
[DEBUG] Loss Breakdown — ID: 0.8499, SupCon: 1.2584, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8683
[DEBUG] Loss Breakdown — ID: 0.8462, SupCon: 1.5557, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8770
[DEBUG] Loss Breakdown — ID: 0.8478, SupCon: 1.6611, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8724
[DEBUG] Loss Breakdown — ID: 0.8545, SupCon: 1.2381, Tri: 0.0000
[Epoch 22] Total Loss=0.1704
Validating epoch 22...
[Epoch 22] Avg Train Loss = 0.1704 | 
==================== Epoch 22 Validation ====================
Validation rank-1    : 91.25%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 94.68%
============================================================
No improvement in Acc@1. Patience counter: 4/10
 Epoch 23/60
[Epoch 23] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8769
[DEBUG] Loss Breakdown — ID: 0.8491, SupCon: 2.2216, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8421, SupCon: 1.5375, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9046
[DEBUG] Loss Breakdown — ID: 0.8395, SupCon: 1.1448, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9095
[DEBUG] Loss Breakdown — ID: 0.8425, SupCon: 1.0796, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8958
[DEBUG] Loss Breakdown — ID: 0.8520, SupCon: 1.3173, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8732
[DEBUG] Loss Breakdown — ID: 0.8461, SupCon: 1.6026, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8910
[DEBUG] Loss Breakdown — ID: 0.8408, SupCon: 1.1525, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8977
[DEBUG] Loss Breakdown — ID: 0.8468, SupCon: 1.5236, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8932
[DEBUG] Loss Breakdown — ID: 0.8387, SupCon: 1.5570, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9042
[DEBUG] Loss Breakdown — ID: 0.8549, SupCon: 0.8158, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8704
[DEBUG] Loss Breakdown — ID: 0.8531, SupCon: 1.9032, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8972
[DEBUG] Loss Breakdown — ID: 0.8430, SupCon: 1.8226, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8850
[DEBUG] Loss Breakdown — ID: 0.8488, SupCon: 1.9164, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8886
[DEBUG] Loss Breakdown — ID: 0.8381, SupCon: 1.2818, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9034
[DEBUG] Loss Breakdown — ID: 0.8385, SupCon: 1.4029, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8945
[DEBUG] Loss Breakdown — ID: 0.8404, SupCon: 1.8877, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8954
[DEBUG] Loss Breakdown — ID: 0.8468, SupCon: 0.8565, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9013
[DEBUG] Loss Breakdown — ID: 0.8379, SupCon: 1.7979, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8762
[DEBUG] Loss Breakdown — ID: 0.8532, SupCon: 1.4551, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8923
[DEBUG] Loss Breakdown — ID: 0.8430, SupCon: 1.2806, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9062
[DEBUG] Loss Breakdown — ID: 0.8498, SupCon: 1.0711, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8960
[DEBUG] Loss Breakdown — ID: 0.8385, SupCon: 2.1654, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8769
[DEBUG] Loss Breakdown — ID: 0.8455, SupCon: 0.8907, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8657
[DEBUG] Loss Breakdown — ID: 0.8469, SupCon: 1.3959, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8887
[DEBUG] Loss Breakdown — ID: 0.8490, SupCon: 1.7703, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8719
[DEBUG] Loss Breakdown — ID: 0.8505, SupCon: 1.9611, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8787
[DEBUG] Loss Breakdown — ID: 0.8579, SupCon: 1.5167, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8792
[DEBUG] Loss Breakdown — ID: 0.8575, SupCon: 0.7283, Tri: 0.0000
[Epoch 23] Total Loss=0.1692
Validating epoch 23...
[Epoch 23] Avg Train Loss = 0.1692 | 
==================== Epoch 23 Validation ====================
Validation rank-1    : 91.66%
Validation rank-5    : 98.15%
Validation rank-10   : 99.28%
Validation mAP      : 94.80%
============================================================
No improvement in Acc@1. Patience counter: 5/10
 Epoch 24/60
[Epoch 24] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8775
[DEBUG] Loss Breakdown — ID: 0.8493, SupCon: 1.4795, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8850
[DEBUG] Loss Breakdown — ID: 0.8450, SupCon: 1.7175, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8653
[DEBUG] Loss Breakdown — ID: 0.8477, SupCon: 2.0672, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8650
[DEBUG] Loss Breakdown — ID: 0.8515, SupCon: 1.6178, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8794
[DEBUG] Loss Breakdown — ID: 0.8625, SupCon: 0.9048, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8909
[DEBUG] Loss Breakdown — ID: 0.8433, SupCon: 1.8773, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8752
[DEBUG] Loss Breakdown — ID: 0.8438, SupCon: 1.8532, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8509, SupCon: 1.6230, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8840
[DEBUG] Loss Breakdown — ID: 0.8403, SupCon: 2.0283, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9005
[DEBUG] Loss Breakdown — ID: 0.8464, SupCon: 0.7733, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8725
[DEBUG] Loss Breakdown — ID: 0.8445, SupCon: 1.1535, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8977
[DEBUG] Loss Breakdown — ID: 0.8355, SupCon: 1.1751, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9073
[DEBUG] Loss Breakdown — ID: 0.8398, SupCon: 1.0862, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8858
[DEBUG] Loss Breakdown — ID: 0.8462, SupCon: 1.4541, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8713
[DEBUG] Loss Breakdown — ID: 0.8537, SupCon: 1.5335, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8993
[DEBUG] Loss Breakdown — ID: 0.8452, SupCon: 1.7150, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9121
[DEBUG] Loss Breakdown — ID: 0.8347, SupCon: 1.3715, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8611
[DEBUG] Loss Breakdown — ID: 0.8497, SupCon: 1.9062, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9106
[DEBUG] Loss Breakdown — ID: 0.8381, SupCon: 1.1633, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8782
[DEBUG] Loss Breakdown — ID: 0.8452, SupCon: 1.2207, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8761
[DEBUG] Loss Breakdown — ID: 0.8477, SupCon: 1.7775, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8369, SupCon: 1.4871, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9027
[DEBUG] Loss Breakdown — ID: 0.8399, SupCon: 0.6789, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8995
[DEBUG] Loss Breakdown — ID: 0.8507, SupCon: 1.3378, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8738
[DEBUG] Loss Breakdown — ID: 0.8440, SupCon: 1.2247, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8777
[DEBUG] Loss Breakdown — ID: 0.8483, SupCon: 1.7335, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8953
[DEBUG] Loss Breakdown — ID: 0.8430, SupCon: 0.6831, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8573
[DEBUG] Loss Breakdown — ID: 0.8640, SupCon: 0.7633, Tri: 0.0000
[Epoch 24] Total Loss=0.1692
Validating epoch 24...
[Epoch 24] Avg Train Loss = 0.1692 | 
==================== Epoch 24 Validation ====================
Validation rank-1    : 91.86%
Validation rank-5    : 98.15%
Validation rank-10   : 99.49%
Validation mAP      : 94.83%
============================================================
No improvement in Acc@1. Patience counter: 6/10
 Epoch 25/60
[Epoch 25] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8662
[DEBUG] Loss Breakdown — ID: 0.8404, SupCon: 2.0449, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9058
[DEBUG] Loss Breakdown — ID: 0.8384, SupCon: 1.5866, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9008
[DEBUG] Loss Breakdown — ID: 0.8403, SupCon: 1.2629, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8717
[DEBUG] Loss Breakdown — ID: 0.8575, SupCon: 1.6944, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8961
[DEBUG] Loss Breakdown — ID: 0.8367, SupCon: 1.6615, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9081
[DEBUG] Loss Breakdown — ID: 0.8360, SupCon: 1.0207, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7821
[DEBUG] Loss Breakdown — ID: 0.9055, SupCon: 1.4923, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8920
[DEBUG] Loss Breakdown — ID: 0.8330, SupCon: 2.0614, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9024
[DEBUG] Loss Breakdown — ID: 0.8349, SupCon: 1.2609, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8786
[DEBUG] Loss Breakdown — ID: 0.8430, SupCon: 1.5029, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8620
[DEBUG] Loss Breakdown — ID: 0.8486, SupCon: 1.7653, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9003
[DEBUG] Loss Breakdown — ID: 0.8379, SupCon: 1.5573, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8858
[DEBUG] Loss Breakdown — ID: 0.8567, SupCon: 1.3149, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8865
[DEBUG] Loss Breakdown — ID: 0.8530, SupCon: 1.4347, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8683
[DEBUG] Loss Breakdown — ID: 0.8493, SupCon: 2.4738, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8970
[DEBUG] Loss Breakdown — ID: 0.8478, SupCon: 1.3307, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8587
[DEBUG] Loss Breakdown — ID: 0.8532, SupCon: 1.5039, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8671
[DEBUG] Loss Breakdown — ID: 0.8473, SupCon: 1.9234, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9004
[DEBUG] Loss Breakdown — ID: 0.8436, SupCon: 1.0948, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9009
[DEBUG] Loss Breakdown — ID: 0.8470, SupCon: 0.8442, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9158
[DEBUG] Loss Breakdown — ID: 0.8364, SupCon: 0.9332, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9029
[DEBUG] Loss Breakdown — ID: 0.8434, SupCon: 1.3442, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8976
[DEBUG] Loss Breakdown — ID: 0.8490, SupCon: 1.1114, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8691
[DEBUG] Loss Breakdown — ID: 0.8603, SupCon: 2.1874, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8815
[DEBUG] Loss Breakdown — ID: 0.8448, SupCon: 2.0129, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8730
[DEBUG] Loss Breakdown — ID: 0.8523, SupCon: 1.9410, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9075
[DEBUG] Loss Breakdown — ID: 0.8385, SupCon: 1.5812, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8873
[DEBUG] Loss Breakdown — ID: 0.8500, SupCon: 0.7670, Tri: 0.0000
[Epoch 25] Total Loss=0.1695
Validating epoch 25...
[Epoch 25] Avg Train Loss = 0.1695 | 
==================== Epoch 25 Validation ====================
Validation rank-1    : 91.86%
Validation rank-5    : 98.35%
Validation rank-10   : 99.28%
Validation mAP      : 94.92%
============================================================
No improvement in Acc@1. Patience counter: 7/10
 Epoch 26/60
[Epoch 26] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9087
[DEBUG] Loss Breakdown — ID: 0.8349, SupCon: 1.9725, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8437, SupCon: 1.7022, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9156
[DEBUG] Loss Breakdown — ID: 0.8455, SupCon: 1.0483, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8909
[DEBUG] Loss Breakdown — ID: 0.8386, SupCon: 2.0420, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8640
[DEBUG] Loss Breakdown — ID: 0.8407, SupCon: 2.2189, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8749
[DEBUG] Loss Breakdown — ID: 0.8417, SupCon: 1.8570, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8903
[DEBUG] Loss Breakdown — ID: 0.8385, SupCon: 1.6256, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9006
[DEBUG] Loss Breakdown — ID: 0.8427, SupCon: 1.4893, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9062
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.1366, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8999
[DEBUG] Loss Breakdown — ID: 0.8410, SupCon: 1.2371, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8962
[DEBUG] Loss Breakdown — ID: 0.8420, SupCon: 1.4866, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8855
[DEBUG] Loss Breakdown — ID: 0.8441, SupCon: 1.3067, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8980
[DEBUG] Loss Breakdown — ID: 0.8358, SupCon: 1.1489, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8819
[DEBUG] Loss Breakdown — ID: 0.8440, SupCon: 1.4228, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8823
[DEBUG] Loss Breakdown — ID: 0.8423, SupCon: 1.0534, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8710
[DEBUG] Loss Breakdown — ID: 0.8455, SupCon: 1.6355, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8841
[DEBUG] Loss Breakdown — ID: 0.8402, SupCon: 1.6227, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8744
[DEBUG] Loss Breakdown — ID: 0.8456, SupCon: 1.2175, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8879
[DEBUG] Loss Breakdown — ID: 0.8344, SupCon: 1.7423, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8952
[DEBUG] Loss Breakdown — ID: 0.8393, SupCon: 1.3887, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8311, SupCon: 1.5484, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9093
[DEBUG] Loss Breakdown — ID: 0.8333, SupCon: 1.2504, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8525
[DEBUG] Loss Breakdown — ID: 0.8577, SupCon: 1.5762, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9057
[DEBUG] Loss Breakdown — ID: 0.8346, SupCon: 1.9659, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8418
[DEBUG] Loss Breakdown — ID: 0.8647, SupCon: 1.7614, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9208
[DEBUG] Loss Breakdown — ID: 0.8341, SupCon: 0.7934, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9039
[DEBUG] Loss Breakdown — ID: 0.8398, SupCon: 1.1463, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8209
[DEBUG] Loss Breakdown — ID: 0.8882, SupCon: 1.4868, Tri: 0.0000
[Epoch 26] Total Loss=0.1686
Validating epoch 26...
[Epoch 26] Avg Train Loss = 0.1686 | 
==================== Epoch 26 Validation ====================
Validation rank-1    : 91.66%
Validation rank-5    : 98.35%
Validation rank-10   : 99.28%
Validation mAP      : 94.74%
============================================================
No improvement in Acc@1. Patience counter: 8/10
 Epoch 27/60
[Epoch 27] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8813
[DEBUG] Loss Breakdown — ID: 0.8399, SupCon: 1.6877, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8869
[DEBUG] Loss Breakdown — ID: 0.8432, SupCon: 1.4289, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9140
[DEBUG] Loss Breakdown — ID: 0.8336, SupCon: 1.0713, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8910
[DEBUG] Loss Breakdown — ID: 0.8419, SupCon: 1.8197, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8867
[DEBUG] Loss Breakdown — ID: 0.8415, SupCon: 1.5643, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8920
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 2.2106, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8775
[DEBUG] Loss Breakdown — ID: 0.8433, SupCon: 1.6425, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9033
[DEBUG] Loss Breakdown — ID: 0.8419, SupCon: 1.2725, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9118
[DEBUG] Loss Breakdown — ID: 0.8362, SupCon: 1.7561, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8805
[DEBUG] Loss Breakdown — ID: 0.8393, SupCon: 1.4422, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8329, SupCon: 1.4103, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9012
[DEBUG] Loss Breakdown — ID: 0.8339, SupCon: 1.3938, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8884
[DEBUG] Loss Breakdown — ID: 0.8406, SupCon: 1.0297, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.7868
[DEBUG] Loss Breakdown — ID: 0.9108, SupCon: 1.9974, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8955
[DEBUG] Loss Breakdown — ID: 0.8383, SupCon: 1.4866, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8534
[DEBUG] Loss Breakdown — ID: 0.8548, SupCon: 1.8990, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8979
[DEBUG] Loss Breakdown — ID: 0.8379, SupCon: 0.9429, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8720
[DEBUG] Loss Breakdown — ID: 0.8527, SupCon: 1.7008, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8503, SupCon: 1.2990, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8812
[DEBUG] Loss Breakdown — ID: 0.8434, SupCon: 1.3832, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8889
[DEBUG] Loss Breakdown — ID: 0.8452, SupCon: 1.3145, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8901
[DEBUG] Loss Breakdown — ID: 0.8327, SupCon: 0.8832, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8381, SupCon: 1.1581, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8882
[DEBUG] Loss Breakdown — ID: 0.8323, SupCon: 1.9740, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8829
[DEBUG] Loss Breakdown — ID: 0.8425, SupCon: 1.7558, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8917
[DEBUG] Loss Breakdown — ID: 0.8391, SupCon: 2.0108, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8740
[DEBUG] Loss Breakdown — ID: 0.8458, SupCon: 1.2478, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8889
[DEBUG] Loss Breakdown — ID: 0.8442, SupCon: 0.7634, Tri: 0.0000
[Epoch 27] Total Loss=0.1686
Validating epoch 27...
[Epoch 27] Avg Train Loss = 0.1686 | 
==================== Epoch 27 Validation ====================
Validation rank-1    : 92.58%
Validation rank-5    : 98.35%
Validation rank-10   : 99.38%
Validation mAP      : 95.29%
============================================================
Saving best model at epoch 27 (Acc@1=92.58%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 28/60
[Epoch 28] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8838
[DEBUG] Loss Breakdown — ID: 0.8367, SupCon: 1.9634, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8898
[DEBUG] Loss Breakdown — ID: 0.8384, SupCon: 1.9198, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9003
[DEBUG] Loss Breakdown — ID: 0.8413, SupCon: 1.0361, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9077
[DEBUG] Loss Breakdown — ID: 0.8358, SupCon: 1.4859, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8462
[DEBUG] Loss Breakdown — ID: 0.8731, SupCon: 1.7987, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8897
[DEBUG] Loss Breakdown — ID: 0.8392, SupCon: 1.7814, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8993
[DEBUG] Loss Breakdown — ID: 0.8370, SupCon: 1.7854, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9022
[DEBUG] Loss Breakdown — ID: 0.8452, SupCon: 1.6737, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9056
[DEBUG] Loss Breakdown — ID: 0.8282, SupCon: 0.9421, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8802
[DEBUG] Loss Breakdown — ID: 0.8478, SupCon: 1.4261, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8898
[DEBUG] Loss Breakdown — ID: 0.8424, SupCon: 1.8767, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8827
[DEBUG] Loss Breakdown — ID: 0.8444, SupCon: 1.3488, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8668
[DEBUG] Loss Breakdown — ID: 0.8340, SupCon: 1.4134, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8427, SupCon: 1.0134, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8730
[DEBUG] Loss Breakdown — ID: 0.8357, SupCon: 1.6011, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8917
[DEBUG] Loss Breakdown — ID: 0.8471, SupCon: 1.2940, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9012
[DEBUG] Loss Breakdown — ID: 0.8398, SupCon: 1.1114, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9028
[DEBUG] Loss Breakdown — ID: 0.8366, SupCon: 1.2993, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8797
[DEBUG] Loss Breakdown — ID: 0.8415, SupCon: 1.3613, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8788
[DEBUG] Loss Breakdown — ID: 0.8396, SupCon: 1.6344, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9021
[DEBUG] Loss Breakdown — ID: 0.8349, SupCon: 1.1728, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8921
[DEBUG] Loss Breakdown — ID: 0.8373, SupCon: 1.7827, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8795
[DEBUG] Loss Breakdown — ID: 0.8368, SupCon: 1.6529, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8718
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.3972, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8816
[DEBUG] Loss Breakdown — ID: 0.8419, SupCon: 1.8180, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9021
[DEBUG] Loss Breakdown — ID: 0.8361, SupCon: 1.6967, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8843
[DEBUG] Loss Breakdown — ID: 0.8390, SupCon: 1.5050, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8657
[DEBUG] Loss Breakdown — ID: 0.8456, SupCon: 1.5419, Tri: 0.0000
[Epoch 28] Total Loss=0.1681
Validating epoch 28...
[Epoch 28] Avg Train Loss = 0.1681 | 
==================== Epoch 28 Validation ====================
Validation rank-1    : 92.17%
Validation rank-5    : 98.35%
Validation rank-10   : 99.38%
Validation mAP      : 95.03%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 29/60
[Epoch 29] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8823
[DEBUG] Loss Breakdown — ID: 0.8484, SupCon: 1.7681, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9146
[DEBUG] Loss Breakdown — ID: 0.8326, SupCon: 1.3627, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8901
[DEBUG] Loss Breakdown — ID: 0.8354, SupCon: 1.4656, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8661
[DEBUG] Loss Breakdown — ID: 0.8487, SupCon: 1.8300, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8658
[DEBUG] Loss Breakdown — ID: 0.8449, SupCon: 1.4063, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9107
[DEBUG] Loss Breakdown — ID: 0.8312, SupCon: 1.5390, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9229
[DEBUG] Loss Breakdown — ID: 0.8354, SupCon: 1.1154, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8791
[DEBUG] Loss Breakdown — ID: 0.8535, SupCon: 1.3468, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8866
[DEBUG] Loss Breakdown — ID: 0.8332, SupCon: 1.5694, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8941
[DEBUG] Loss Breakdown — ID: 0.8393, SupCon: 1.4601, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8954
[DEBUG] Loss Breakdown — ID: 0.8301, SupCon: 1.1366, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8903
[DEBUG] Loss Breakdown — ID: 0.8331, SupCon: 1.5044, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8987
[DEBUG] Loss Breakdown — ID: 0.8347, SupCon: 0.7101, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9127
[DEBUG] Loss Breakdown — ID: 0.8270, SupCon: 1.6452, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9058
[DEBUG] Loss Breakdown — ID: 0.8347, SupCon: 1.1905, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8744
[DEBUG] Loss Breakdown — ID: 0.8458, SupCon: 1.9980, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8738
[DEBUG] Loss Breakdown — ID: 0.8392, SupCon: 1.5090, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8697
[DEBUG] Loss Breakdown — ID: 0.8371, SupCon: 2.2168, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8941
[DEBUG] Loss Breakdown — ID: 0.8372, SupCon: 1.9320, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9132
[DEBUG] Loss Breakdown — ID: 0.8273, SupCon: 1.4344, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8987
[DEBUG] Loss Breakdown — ID: 0.8336, SupCon: 1.4552, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8748
[DEBUG] Loss Breakdown — ID: 0.8386, SupCon: 2.0125, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9073
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.8598, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8631
[DEBUG] Loss Breakdown — ID: 0.8482, SupCon: 1.9618, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8815
[DEBUG] Loss Breakdown — ID: 0.8384, SupCon: 1.5897, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8978
[DEBUG] Loss Breakdown — ID: 0.8391, SupCon: 1.3561, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8761
[DEBUG] Loss Breakdown — ID: 0.8351, SupCon: 1.6201, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8712
[DEBUG] Loss Breakdown — ID: 0.8468, SupCon: 0.9663, Tri: 0.0000
[Epoch 29] Total Loss=0.1676
Validating epoch 29...
[Epoch 29] Avg Train Loss = 0.1676 | 
==================== Epoch 29 Validation ====================
Validation rank-1    : 92.48%
Validation rank-5    : 98.35%
Validation rank-10   : 99.38%
Validation mAP      : 95.31%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 30/60
[Epoch 30] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8555
[DEBUG] Loss Breakdown — ID: 0.8445, SupCon: 1.9075, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8991
[DEBUG] Loss Breakdown — ID: 0.8347, SupCon: 1.4356, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9063
[DEBUG] Loss Breakdown — ID: 0.8287, SupCon: 1.1699, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8719
[DEBUG] Loss Breakdown — ID: 0.8373, SupCon: 1.6011, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9002
[DEBUG] Loss Breakdown — ID: 0.8326, SupCon: 0.9597, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8919
[DEBUG] Loss Breakdown — ID: 0.8346, SupCon: 1.8242, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9083
[DEBUG] Loss Breakdown — ID: 0.8373, SupCon: 0.9427, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9047
[DEBUG] Loss Breakdown — ID: 0.8335, SupCon: 0.9405, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8874
[DEBUG] Loss Breakdown — ID: 0.8371, SupCon: 1.1494, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9096
[DEBUG] Loss Breakdown — ID: 0.8309, SupCon: 1.1942, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8641
[DEBUG] Loss Breakdown — ID: 0.8460, SupCon: 1.6711, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8542
[DEBUG] Loss Breakdown — ID: 0.8537, SupCon: 1.6605, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8621
[DEBUG] Loss Breakdown — ID: 0.8355, SupCon: 2.0519, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9181
[DEBUG] Loss Breakdown — ID: 0.8382, SupCon: 1.2708, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9031
[DEBUG] Loss Breakdown — ID: 0.8328, SupCon: 1.4509, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8922
[DEBUG] Loss Breakdown — ID: 0.8421, SupCon: 1.7938, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9098
[DEBUG] Loss Breakdown — ID: 0.8272, SupCon: 1.1114, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8912
[DEBUG] Loss Breakdown — ID: 0.8367, SupCon: 1.5011, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8932
[DEBUG] Loss Breakdown — ID: 0.8316, SupCon: 1.6152, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8865
[DEBUG] Loss Breakdown — ID: 0.8448, SupCon: 1.2446, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8885
[DEBUG] Loss Breakdown — ID: 0.8369, SupCon: 1.6867, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8310, SupCon: 1.5656, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8766
[DEBUG] Loss Breakdown — ID: 0.8342, SupCon: 1.5910, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8957
[DEBUG] Loss Breakdown — ID: 0.8363, SupCon: 1.3046, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9096
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.8709, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8831
[DEBUG] Loss Breakdown — ID: 0.8368, SupCon: 1.4250, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8915
[DEBUG] Loss Breakdown — ID: 0.8269, SupCon: 1.6705, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8889
[DEBUG] Loss Breakdown — ID: 0.8334, SupCon: 0.8990, Tri: 0.0000
[Epoch 30] Total Loss=0.1672
Validating epoch 30...
[Epoch 30] Avg Train Loss = 0.1672 | 
==================== Epoch 30 Validation ====================
Validation rank-1    : 91.56%
Validation rank-5    : 98.35%
Validation rank-10   : 99.07%
Validation mAP      : 94.77%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 31/60
[Epoch 31] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8861
[DEBUG] Loss Breakdown — ID: 0.8403, SupCon: 2.1414, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8856
[DEBUG] Loss Breakdown — ID: 0.8420, SupCon: 1.7883, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8945
[DEBUG] Loss Breakdown — ID: 0.8330, SupCon: 1.8071, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8957
[DEBUG] Loss Breakdown — ID: 0.8289, SupCon: 1.4693, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9202
[DEBUG] Loss Breakdown — ID: 0.8247, SupCon: 1.2621, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9262
[DEBUG] Loss Breakdown — ID: 0.8283, SupCon: 1.0186, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9170
[DEBUG] Loss Breakdown — ID: 0.8279, SupCon: 1.3977, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9067
[DEBUG] Loss Breakdown — ID: 0.8298, SupCon: 1.3384, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8640
[DEBUG] Loss Breakdown — ID: 0.8504, SupCon: 1.8918, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8880
[DEBUG] Loss Breakdown — ID: 0.8309, SupCon: 1.5075, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8889
[DEBUG] Loss Breakdown — ID: 0.8388, SupCon: 1.5781, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9092
[DEBUG] Loss Breakdown — ID: 0.8283, SupCon: 1.2789, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8761
[DEBUG] Loss Breakdown — ID: 0.8373, SupCon: 1.7903, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8824
[DEBUG] Loss Breakdown — ID: 0.8409, SupCon: 1.3204, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8354, SupCon: 2.2153, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8715
[DEBUG] Loss Breakdown — ID: 0.8442, SupCon: 1.8329, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8968
[DEBUG] Loss Breakdown — ID: 0.8300, SupCon: 0.8235, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8609
[DEBUG] Loss Breakdown — ID: 0.8403, SupCon: 1.4909, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9099
[DEBUG] Loss Breakdown — ID: 0.8282, SupCon: 1.3999, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9063
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 1.2434, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8890
[DEBUG] Loss Breakdown — ID: 0.8378, SupCon: 1.7204, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8639
[DEBUG] Loss Breakdown — ID: 0.8380, SupCon: 1.3935, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9006
[DEBUG] Loss Breakdown — ID: 0.8279, SupCon: 1.3101, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8243
[DEBUG] Loss Breakdown — ID: 0.8680, SupCon: 2.0242, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8577
[DEBUG] Loss Breakdown — ID: 0.8342, SupCon: 2.0131, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8840
[DEBUG] Loss Breakdown — ID: 0.8365, SupCon: 1.9244, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8860
[DEBUG] Loss Breakdown — ID: 0.8267, SupCon: 1.7193, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8997
[DEBUG] Loss Breakdown — ID: 0.8381, SupCon: 0.4682, Tri: 0.0000
[Epoch 31] Total Loss=0.1671
Validating epoch 31...
[Epoch 31] Avg Train Loss = 0.1671 | 
==================== Epoch 31 Validation ====================
Validation rank-1    : 92.38%
Validation rank-5    : 98.46%
Validation rank-10   : 99.28%
Validation mAP      : 95.16%
============================================================
No improvement in Acc@1. Patience counter: 4/10
 Epoch 32/60
[Epoch 32] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9007
[DEBUG] Loss Breakdown — ID: 0.8247, SupCon: 1.5719, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9148
[DEBUG] Loss Breakdown — ID: 0.8291, SupCon: 1.4186, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9132
[DEBUG] Loss Breakdown — ID: 0.8284, SupCon: 1.0227, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9111
[DEBUG] Loss Breakdown — ID: 0.8278, SupCon: 2.1273, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9120
[DEBUG] Loss Breakdown — ID: 0.8242, SupCon: 1.0804, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8923
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.4395, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9054
[DEBUG] Loss Breakdown — ID: 0.8292, SupCon: 1.1258, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8844
[DEBUG] Loss Breakdown — ID: 0.8338, SupCon: 1.9736, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8980
[DEBUG] Loss Breakdown — ID: 0.8324, SupCon: 2.1436, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8781
[DEBUG] Loss Breakdown — ID: 0.8348, SupCon: 1.7156, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8762
[DEBUG] Loss Breakdown — ID: 0.8429, SupCon: 1.4651, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9001
[DEBUG] Loss Breakdown — ID: 0.8257, SupCon: 1.2010, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8689
[DEBUG] Loss Breakdown — ID: 0.8383, SupCon: 1.9636, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9027
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.1176, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8985
[DEBUG] Loss Breakdown — ID: 0.8291, SupCon: 1.7897, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9125
[DEBUG] Loss Breakdown — ID: 0.8264, SupCon: 1.0846, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8881
[DEBUG] Loss Breakdown — ID: 0.8305, SupCon: 1.9257, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8940
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.2805, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9022
[DEBUG] Loss Breakdown — ID: 0.8285, SupCon: 1.4715, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9025
[DEBUG] Loss Breakdown — ID: 0.8288, SupCon: 1.2014, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8802
[DEBUG] Loss Breakdown — ID: 0.8304, SupCon: 1.7244, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8728
[DEBUG] Loss Breakdown — ID: 0.8409, SupCon: 1.9852, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8428
[DEBUG] Loss Breakdown — ID: 0.8527, SupCon: 1.6858, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8756
[DEBUG] Loss Breakdown — ID: 0.8330, SupCon: 1.1696, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8900
[DEBUG] Loss Breakdown — ID: 0.8364, SupCon: 1.1681, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8974
[DEBUG] Loss Breakdown — ID: 0.8368, SupCon: 1.5455, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8960
[DEBUG] Loss Breakdown — ID: 0.8375, SupCon: 1.2535, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8660
[DEBUG] Loss Breakdown — ID: 0.8386, SupCon: 1.4232, Tri: 0.0000
[Epoch 32] Total Loss=0.1665
Validating epoch 32...
[Epoch 32] Avg Train Loss = 0.1665 | 
==================== Epoch 32 Validation ====================
Validation rank-1    : 92.89%
Validation rank-5    : 98.46%
Validation rank-10   : 99.07%
Validation mAP      : 95.51%
============================================================
Saving best model at epoch 32 (Acc@1=92.89%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 33/60
[Epoch 33] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9123
[DEBUG] Loss Breakdown — ID: 0.8232, SupCon: 1.5966, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9043
[DEBUG] Loss Breakdown — ID: 0.8307, SupCon: 1.2209, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9128
[DEBUG] Loss Breakdown — ID: 0.8273, SupCon: 0.8894, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8556
[DEBUG] Loss Breakdown — ID: 0.8386, SupCon: 2.0769, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8823
[DEBUG] Loss Breakdown — ID: 0.8286, SupCon: 1.8855, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8738
[DEBUG] Loss Breakdown — ID: 0.8397, SupCon: 2.2306, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8778
[DEBUG] Loss Breakdown — ID: 0.8352, SupCon: 1.6899, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8893
[DEBUG] Loss Breakdown — ID: 0.8316, SupCon: 1.9380, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8839
[DEBUG] Loss Breakdown — ID: 0.8243, SupCon: 1.3526, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8895
[DEBUG] Loss Breakdown — ID: 0.8365, SupCon: 1.2873, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8735
[DEBUG] Loss Breakdown — ID: 0.8338, SupCon: 2.3095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9194
[DEBUG] Loss Breakdown — ID: 0.8303, SupCon: 1.5390, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9010
[DEBUG] Loss Breakdown — ID: 0.8288, SupCon: 1.3591, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8570
[DEBUG] Loss Breakdown — ID: 0.8477, SupCon: 2.0796, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9105
[DEBUG] Loss Breakdown — ID: 0.8257, SupCon: 1.1316, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9051
[DEBUG] Loss Breakdown — ID: 0.8300, SupCon: 0.7973, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9226
[DEBUG] Loss Breakdown — ID: 0.8246, SupCon: 0.6393, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9224
[DEBUG] Loss Breakdown — ID: 0.8309, SupCon: 0.6760, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9058
[DEBUG] Loss Breakdown — ID: 0.8261, SupCon: 0.7452, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9017
[DEBUG] Loss Breakdown — ID: 0.8298, SupCon: 1.0128, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8987
[DEBUG] Loss Breakdown — ID: 0.8286, SupCon: 1.9377, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8979
[DEBUG] Loss Breakdown — ID: 0.8308, SupCon: 1.4951, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8891
[DEBUG] Loss Breakdown — ID: 0.8401, SupCon: 1.0434, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8174
[DEBUG] Loss Breakdown — ID: 0.8674, SupCon: 1.7735, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8553
[DEBUG] Loss Breakdown — ID: 0.8424, SupCon: 1.5239, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9009
[DEBUG] Loss Breakdown — ID: 0.8264, SupCon: 1.4170, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8816
[DEBUG] Loss Breakdown — ID: 0.8389, SupCon: 2.0407, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8738
[DEBUG] Loss Breakdown — ID: 0.8329, SupCon: 1.5721, Tri: 0.0000
[Epoch 33] Total Loss=0.1666
Validating epoch 33...
[Epoch 33] Avg Train Loss = 0.1666 | 
==================== Epoch 33 Validation ====================
Validation rank-1    : 92.79%
Validation rank-5    : 98.35%
Validation rank-10   : 99.59%
Validation mAP      : 95.40%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 34/60
[Epoch 34] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.7930
[DEBUG] Loss Breakdown — ID: 0.8759, SupCon: 2.3391, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9216
[DEBUG] Loss Breakdown — ID: 0.8278, SupCon: 1.0976, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9127
[DEBUG] Loss Breakdown — ID: 0.8343, SupCon: 1.6932, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9120
[DEBUG] Loss Breakdown — ID: 0.8373, SupCon: 1.1962, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9125
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 0.9738, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8712
[DEBUG] Loss Breakdown — ID: 0.8423, SupCon: 2.0817, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8640
[DEBUG] Loss Breakdown — ID: 0.8520, SupCon: 2.1686, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8440
[DEBUG] Loss Breakdown — ID: 0.8568, SupCon: 1.7824, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9158
[DEBUG] Loss Breakdown — ID: 0.8254, SupCon: 1.1762, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9007
[DEBUG] Loss Breakdown — ID: 0.8266, SupCon: 1.4281, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8744
[DEBUG] Loss Breakdown — ID: 0.8370, SupCon: 1.3206, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9016
[DEBUG] Loss Breakdown — ID: 0.8275, SupCon: 1.2618, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8841
[DEBUG] Loss Breakdown — ID: 0.8407, SupCon: 1.0443, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8376, SupCon: 1.2884, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8347
[DEBUG] Loss Breakdown — ID: 0.8560, SupCon: 2.1399, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8792
[DEBUG] Loss Breakdown — ID: 0.8394, SupCon: 1.3307, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8722
[DEBUG] Loss Breakdown — ID: 0.8349, SupCon: 1.9679, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8803
[DEBUG] Loss Breakdown — ID: 0.8308, SupCon: 1.4708, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9148
[DEBUG] Loss Breakdown — ID: 0.8350, SupCon: 0.6619, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8878
[DEBUG] Loss Breakdown — ID: 0.8340, SupCon: 1.6143, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9068
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 1.5337, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8463
[DEBUG] Loss Breakdown — ID: 0.8521, SupCon: 1.8557, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9060
[DEBUG] Loss Breakdown — ID: 0.8312, SupCon: 1.7059, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9107
[DEBUG] Loss Breakdown — ID: 0.8268, SupCon: 0.8036, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8291, SupCon: 1.9505, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8817
[DEBUG] Loss Breakdown — ID: 0.8332, SupCon: 1.6497, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8983
[DEBUG] Loss Breakdown — ID: 0.8346, SupCon: 0.9489, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9076
[DEBUG] Loss Breakdown — ID: 0.8293, SupCon: 0.6946, Tri: 0.0000
[Epoch 34] Total Loss=0.1675
Validating epoch 34...
[Epoch 34] Avg Train Loss = 0.1675 | 
==================== Epoch 34 Validation ====================
Validation rank-1    : 91.97%
Validation rank-5    : 98.25%
Validation rank-10   : 99.28%
Validation mAP      : 95.05%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 35/60
[Epoch 35] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9121
[DEBUG] Loss Breakdown — ID: 0.8308, SupCon: 1.3113, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9171
[DEBUG] Loss Breakdown — ID: 0.8332, SupCon: 0.8646, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9112
[DEBUG] Loss Breakdown — ID: 0.8315, SupCon: 0.8798, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8746
[DEBUG] Loss Breakdown — ID: 0.8375, SupCon: 1.7802, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9168
[DEBUG] Loss Breakdown — ID: 0.8223, SupCon: 1.0011, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8869
[DEBUG] Loss Breakdown — ID: 0.8334, SupCon: 0.9531, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8664
[DEBUG] Loss Breakdown — ID: 0.8312, SupCon: 1.5438, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8487
[DEBUG] Loss Breakdown — ID: 0.8465, SupCon: 1.9542, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8890
[DEBUG] Loss Breakdown — ID: 0.8475, SupCon: 1.4230, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9022
[DEBUG] Loss Breakdown — ID: 0.8328, SupCon: 1.4675, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9230
[DEBUG] Loss Breakdown — ID: 0.8273, SupCon: 0.8552, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8987
[DEBUG] Loss Breakdown — ID: 0.8245, SupCon: 1.6360, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8941
[DEBUG] Loss Breakdown — ID: 0.8293, SupCon: 1.3497, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8623
[DEBUG] Loss Breakdown — ID: 0.8422, SupCon: 2.1886, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8822
[DEBUG] Loss Breakdown — ID: 0.8355, SupCon: 2.5055, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8960
[DEBUG] Loss Breakdown — ID: 0.8321, SupCon: 1.3889, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9098
[DEBUG] Loss Breakdown — ID: 0.8319, SupCon: 1.3531, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8847
[DEBUG] Loss Breakdown — ID: 0.8331, SupCon: 1.2955, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8937
[DEBUG] Loss Breakdown — ID: 0.8324, SupCon: 1.3054, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8813
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 2.1902, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8687
[DEBUG] Loss Breakdown — ID: 0.8304, SupCon: 1.9487, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8608
[DEBUG] Loss Breakdown — ID: 0.8370, SupCon: 1.7811, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8878
[DEBUG] Loss Breakdown — ID: 0.8307, SupCon: 1.2801, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9110
[DEBUG] Loss Breakdown — ID: 0.8358, SupCon: 1.5113, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8990
[DEBUG] Loss Breakdown — ID: 0.8321, SupCon: 1.4726, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8866
[DEBUG] Loss Breakdown — ID: 0.8335, SupCon: 1.6030, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8929
[DEBUG] Loss Breakdown — ID: 0.8353, SupCon: 1.7551, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8818
[DEBUG] Loss Breakdown — ID: 0.8302, SupCon: 1.0271, Tri: 0.0000
[Epoch 35] Total Loss=0.1666
Validating epoch 35...
[Epoch 35] Avg Train Loss = 0.1666 | 
==================== Epoch 35 Validation ====================
Validation rank-1    : 91.76%
Validation rank-5    : 98.15%
Validation rank-10   : 99.18%
Validation mAP      : 94.86%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 36/60
[Epoch 36] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8997
[DEBUG] Loss Breakdown — ID: 0.8214, SupCon: 1.4901, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8818
[DEBUG] Loss Breakdown — ID: 0.8439, SupCon: 2.1561, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8871
[DEBUG] Loss Breakdown — ID: 0.8260, SupCon: 1.6420, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8565
[DEBUG] Loss Breakdown — ID: 0.8356, SupCon: 2.4170, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9018
[DEBUG] Loss Breakdown — ID: 0.8255, SupCon: 1.2940, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9129
[DEBUG] Loss Breakdown — ID: 0.8223, SupCon: 1.3629, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8773
[DEBUG] Loss Breakdown — ID: 0.8292, SupCon: 1.9346, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9051
[DEBUG] Loss Breakdown — ID: 0.8285, SupCon: 1.0886, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8955
[DEBUG] Loss Breakdown — ID: 0.8304, SupCon: 0.9835, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9050
[DEBUG] Loss Breakdown — ID: 0.8257, SupCon: 1.1095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8967
[DEBUG] Loss Breakdown — ID: 0.8280, SupCon: 1.7660, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8775
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.6339, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9095
[DEBUG] Loss Breakdown — ID: 0.8280, SupCon: 0.8444, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9079
[DEBUG] Loss Breakdown — ID: 0.8267, SupCon: 0.8886, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8739
[DEBUG] Loss Breakdown — ID: 0.8298, SupCon: 1.5293, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8641
[DEBUG] Loss Breakdown — ID: 0.8405, SupCon: 2.4694, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8907
[DEBUG] Loss Breakdown — ID: 0.8325, SupCon: 1.5950, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9005
[DEBUG] Loss Breakdown — ID: 0.8268, SupCon: 1.7161, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9097
[DEBUG] Loss Breakdown — ID: 0.8306, SupCon: 0.7056, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9167
[DEBUG] Loss Breakdown — ID: 0.8275, SupCon: 1.3416, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8269, SupCon: 1.5132, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8991
[DEBUG] Loss Breakdown — ID: 0.8255, SupCon: 1.3945, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8904
[DEBUG] Loss Breakdown — ID: 0.8323, SupCon: 1.5637, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8745
[DEBUG] Loss Breakdown — ID: 0.8292, SupCon: 1.3455, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8721
[DEBUG] Loss Breakdown — ID: 0.8269, SupCon: 1.8297, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9131
[DEBUG] Loss Breakdown — ID: 0.8231, SupCon: 1.8095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9030
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 1.6913, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8874
[DEBUG] Loss Breakdown — ID: 0.8265, SupCon: 1.2773, Tri: 0.0000
[Epoch 36] Total Loss=0.1658
Validating epoch 36...
[Epoch 36] Avg Train Loss = 0.1658 | 
==================== Epoch 36 Validation ====================
Validation rank-1    : 92.48%
Validation rank-5    : 98.35%
Validation rank-10   : 98.97%
Validation mAP      : 95.22%
============================================================
No improvement in Acc@1. Patience counter: 4/10
 Epoch 37/60
[Epoch 37] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9201
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.0994, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9070
[DEBUG] Loss Breakdown — ID: 0.8297, SupCon: 1.5989, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8745
[DEBUG] Loss Breakdown — ID: 0.8377, SupCon: 2.0124, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9252
[DEBUG] Loss Breakdown — ID: 0.8221, SupCon: 1.1484, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8977
[DEBUG] Loss Breakdown — ID: 0.8186, SupCon: 1.1135, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8985
[DEBUG] Loss Breakdown — ID: 0.8193, SupCon: 1.3662, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8808
[DEBUG] Loss Breakdown — ID: 0.8367, SupCon: 1.3963, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8991
[DEBUG] Loss Breakdown — ID: 0.8207, SupCon: 1.3572, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8899
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.2734, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8744
[DEBUG] Loss Breakdown — ID: 0.8268, SupCon: 1.9016, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9099
[DEBUG] Loss Breakdown — ID: 0.8177, SupCon: 1.4293, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9051
[DEBUG] Loss Breakdown — ID: 0.8162, SupCon: 1.4797, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9006
[DEBUG] Loss Breakdown — ID: 0.8197, SupCon: 1.3249, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8876
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 1.3539, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8786
[DEBUG] Loss Breakdown — ID: 0.8278, SupCon: 0.9008, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9072
[DEBUG] Loss Breakdown — ID: 0.8210, SupCon: 1.3876, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8932
[DEBUG] Loss Breakdown — ID: 0.8324, SupCon: 1.3989, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8246, SupCon: 1.7458, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8751
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 2.1328, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8883
[DEBUG] Loss Breakdown — ID: 0.8229, SupCon: 1.7007, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8762
[DEBUG] Loss Breakdown — ID: 0.8285, SupCon: 1.6296, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8250, SupCon: 1.4521, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8957
[DEBUG] Loss Breakdown — ID: 0.8258, SupCon: 1.2480, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8973
[DEBUG] Loss Breakdown — ID: 0.8194, SupCon: 1.6393, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8518
[DEBUG] Loss Breakdown — ID: 0.8391, SupCon: 1.7076, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8802
[DEBUG] Loss Breakdown — ID: 0.8173, SupCon: 1.6434, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8081
[DEBUG] Loss Breakdown — ID: 0.8612, SupCon: 2.3090, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8597
[DEBUG] Loss Breakdown — ID: 0.8383, SupCon: 1.6704, Tri: 0.0000
[Epoch 37] Total Loss=0.1654
Validating epoch 37...
[Epoch 37] Avg Train Loss = 0.1654 | 
==================== Epoch 37 Validation ====================
Validation rank-1    : 93.20%
Validation rank-5    : 98.56%
Validation rank-10   : 99.07%
Validation mAP      : 95.65%
============================================================
Saving best model at epoch 37 (Acc@1=93.20%)  saved_models/stage3_promptsg_vitb16_11k_dorsal_r_promptsg_e60_lrNA_bs32_BEST.pth
 Epoch 38/60
[Epoch 38] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8935
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 1.8497, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8878
[DEBUG] Loss Breakdown — ID: 0.8266, SupCon: 1.9618, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9001
[DEBUG] Loss Breakdown — ID: 0.8248, SupCon: 1.5625, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8984
[DEBUG] Loss Breakdown — ID: 0.8317, SupCon: 1.8224, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9044
[DEBUG] Loss Breakdown — ID: 0.8262, SupCon: 1.7041, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8687
[DEBUG] Loss Breakdown — ID: 0.8406, SupCon: 1.9010, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9000
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.4449, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9036
[DEBUG] Loss Breakdown — ID: 0.8225, SupCon: 1.6665, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9124
[DEBUG] Loss Breakdown — ID: 0.8333, SupCon: 1.0273, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9098
[DEBUG] Loss Breakdown — ID: 0.8255, SupCon: 1.3859, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8877
[DEBUG] Loss Breakdown — ID: 0.8380, SupCon: 2.0307, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8948
[DEBUG] Loss Breakdown — ID: 0.8344, SupCon: 1.6940, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9110
[DEBUG] Loss Breakdown — ID: 0.8318, SupCon: 1.4095, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9099
[DEBUG] Loss Breakdown — ID: 0.8331, SupCon: 1.5592, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8844
[DEBUG] Loss Breakdown — ID: 0.8274, SupCon: 1.7452, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8766
[DEBUG] Loss Breakdown — ID: 0.8301, SupCon: 1.3495, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9040
[DEBUG] Loss Breakdown — ID: 0.8192, SupCon: 1.5808, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8598
[DEBUG] Loss Breakdown — ID: 0.8360, SupCon: 1.8751, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8919
[DEBUG] Loss Breakdown — ID: 0.8260, SupCon: 1.0105, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8608
[DEBUG] Loss Breakdown — ID: 0.8354, SupCon: 1.7903, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8729
[DEBUG] Loss Breakdown — ID: 0.8365, SupCon: 2.0027, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9070
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 1.4731, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9071
[DEBUG] Loss Breakdown — ID: 0.8299, SupCon: 1.1177, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9029
[DEBUG] Loss Breakdown — ID: 0.8296, SupCon: 1.0804, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9130
[DEBUG] Loss Breakdown — ID: 0.8220, SupCon: 1.0475, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9089
[DEBUG] Loss Breakdown — ID: 0.8232, SupCon: 1.8617, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8758
[DEBUG] Loss Breakdown — ID: 0.8308, SupCon: 1.4992, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8628
[DEBUG] Loss Breakdown — ID: 0.8278, SupCon: 1.5525, Tri: 0.0000
[Epoch 38] Total Loss=0.1659
Validating epoch 38...
[Epoch 38] Avg Train Loss = 0.1659 | 
==================== Epoch 38 Validation ====================
Validation rank-1    : 91.04%
Validation rank-5    : 98.76%
Validation rank-10   : 99.18%
Validation mAP      : 94.57%
============================================================
No improvement in Acc@1. Patience counter: 1/10
 Epoch 39/60
[Epoch 39] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8429
[DEBUG] Loss Breakdown — ID: 0.8577, SupCon: 1.9308, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9291
[DEBUG] Loss Breakdown — ID: 0.8207, SupCon: 1.2613, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9170
[DEBUG] Loss Breakdown — ID: 0.8230, SupCon: 1.6273, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8923
[DEBUG] Loss Breakdown — ID: 0.8192, SupCon: 1.8415, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8886
[DEBUG] Loss Breakdown — ID: 0.8215, SupCon: 1.3525, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9024
[DEBUG] Loss Breakdown — ID: 0.8236, SupCon: 1.0799, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8886
[DEBUG] Loss Breakdown — ID: 0.8288, SupCon: 1.0829, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8787
[DEBUG] Loss Breakdown — ID: 0.8285, SupCon: 2.2676, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9074
[DEBUG] Loss Breakdown — ID: 0.8211, SupCon: 1.5126, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9071
[DEBUG] Loss Breakdown — ID: 0.8183, SupCon: 1.1599, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9012
[DEBUG] Loss Breakdown — ID: 0.8235, SupCon: 2.0310, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9007
[DEBUG] Loss Breakdown — ID: 0.8226, SupCon: 1.1335, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8863
[DEBUG] Loss Breakdown — ID: 0.8261, SupCon: 1.8167, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9033
[DEBUG] Loss Breakdown — ID: 0.8184, SupCon: 1.7898, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9301
[DEBUG] Loss Breakdown — ID: 0.8231, SupCon: 0.8332, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8590
[DEBUG] Loss Breakdown — ID: 0.8295, SupCon: 1.1501, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9136
[DEBUG] Loss Breakdown — ID: 0.8249, SupCon: 1.0111, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8679
[DEBUG] Loss Breakdown — ID: 0.8400, SupCon: 1.6346, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8519
[DEBUG] Loss Breakdown — ID: 0.8457, SupCon: 1.6218, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9071
[DEBUG] Loss Breakdown — ID: 0.8164, SupCon: 1.7175, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9156
[DEBUG] Loss Breakdown — ID: 0.8176, SupCon: 0.2109, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8185, SupCon: 1.7445, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8930
[DEBUG] Loss Breakdown — ID: 0.8204, SupCon: 1.2299, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8987
[DEBUG] Loss Breakdown — ID: 0.8231, SupCon: 1.7618, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8521
[DEBUG] Loss Breakdown — ID: 0.8389, SupCon: 1.8049, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8878
[DEBUG] Loss Breakdown — ID: 0.8156, SupCon: 1.6884, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8972
[DEBUG] Loss Breakdown — ID: 0.8183, SupCon: 1.5292, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8992
[DEBUG] Loss Breakdown — ID: 0.8232, SupCon: 1.7481, Tri: 0.0000
[Epoch 39] Total Loss=0.1651
Validating epoch 39...
[Epoch 39] Avg Train Loss = 0.1651 | 
==================== Epoch 39 Validation ====================
Validation rank-1    : 92.07%
Validation rank-5    : 98.66%
Validation rank-10   : 99.18%
Validation mAP      : 95.14%
============================================================
No improvement in Acc@1. Patience counter: 2/10
 Epoch 40/60
[Epoch 40] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8728
[DEBUG] Loss Breakdown — ID: 0.8326, SupCon: 1.6170, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8927
[DEBUG] Loss Breakdown — ID: 0.8153, SupCon: 1.7343, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8859
[DEBUG] Loss Breakdown — ID: 0.8249, SupCon: 1.5015, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9060
[DEBUG] Loss Breakdown — ID: 0.8230, SupCon: 1.0563, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8683
[DEBUG] Loss Breakdown — ID: 0.8275, SupCon: 1.4139, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9043
[DEBUG] Loss Breakdown — ID: 0.8230, SupCon: 0.9288, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8985
[DEBUG] Loss Breakdown — ID: 0.8341, SupCon: 1.4556, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9125
[DEBUG] Loss Breakdown — ID: 0.8240, SupCon: 1.3842, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8941
[DEBUG] Loss Breakdown — ID: 0.8209, SupCon: 1.7205, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9244
[DEBUG] Loss Breakdown — ID: 0.8226, SupCon: 1.3091, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8804
[DEBUG] Loss Breakdown — ID: 0.8207, SupCon: 1.8419, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8685
[DEBUG] Loss Breakdown — ID: 0.8351, SupCon: 2.2319, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8757
[DEBUG] Loss Breakdown — ID: 0.8249, SupCon: 2.1146, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9004
[DEBUG] Loss Breakdown — ID: 0.8307, SupCon: 1.0284, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8786
[DEBUG] Loss Breakdown — ID: 0.8302, SupCon: 1.8737, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9004
[DEBUG] Loss Breakdown — ID: 0.8290, SupCon: 1.7126, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9040
[DEBUG] Loss Breakdown — ID: 0.8278, SupCon: 1.3810, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9152
[DEBUG] Loss Breakdown — ID: 0.8202, SupCon: 1.5746, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9119
[DEBUG] Loss Breakdown — ID: 0.8218, SupCon: 0.6666, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9035
[DEBUG] Loss Breakdown — ID: 0.8195, SupCon: 1.3009, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8793
[DEBUG] Loss Breakdown — ID: 0.8324, SupCon: 1.0010, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8856
[DEBUG] Loss Breakdown — ID: 0.8271, SupCon: 1.0765, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8582
[DEBUG] Loss Breakdown — ID: 0.8361, SupCon: 1.9319, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9030
[DEBUG] Loss Breakdown — ID: 0.8160, SupCon: 1.1769, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8693
[DEBUG] Loss Breakdown — ID: 0.8247, SupCon: 1.2808, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8672
[DEBUG] Loss Breakdown — ID: 0.8328, SupCon: 1.4105, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8663
[DEBUG] Loss Breakdown — ID: 0.8199, SupCon: 1.8975, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8924
[DEBUG] Loss Breakdown — ID: 0.8223, SupCon: 0.9568, Tri: 0.0000
[Epoch 40] Total Loss=0.1651
Validating epoch 40...
[Epoch 40] Avg Train Loss = 0.1651 | 
==================== Epoch 40 Validation ====================
Validation rank-1    : 91.66%
Validation rank-5    : 98.56%
Validation rank-10   : 99.07%
Validation mAP      : 94.80%
============================================================
No improvement in Acc@1. Patience counter: 3/10
 Epoch 41/60
[Epoch 41] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8943
[DEBUG] Loss Breakdown — ID: 0.8244, SupCon: 1.3145, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9003
[DEBUG] Loss Breakdown — ID: 0.8270, SupCon: 1.0527, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8957
[DEBUG] Loss Breakdown — ID: 0.8259, SupCon: 0.8650, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9118
[DEBUG] Loss Breakdown — ID: 0.8151, SupCon: 1.5703, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8939
[DEBUG] Loss Breakdown — ID: 0.8292, SupCon: 1.1356, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8814
[DEBUG] Loss Breakdown — ID: 0.8329, SupCon: 1.4749, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8931
[DEBUG] Loss Breakdown — ID: 0.8223, SupCon: 1.4669, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9135
[DEBUG] Loss Breakdown — ID: 0.8241, SupCon: 1.6863, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8832
[DEBUG] Loss Breakdown — ID: 0.8321, SupCon: 1.8867, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8900
[DEBUG] Loss Breakdown — ID: 0.8319, SupCon: 0.8698, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8961
[DEBUG] Loss Breakdown — ID: 0.8259, SupCon: 1.5543, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8898
[DEBUG] Loss Breakdown — ID: 0.8153, SupCon: 1.2179, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8825
[DEBUG] Loss Breakdown — ID: 0.8285, SupCon: 1.6147, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9059
[DEBUG] Loss Breakdown — ID: 0.8239, SupCon: 1.2829, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8671
[DEBUG] Loss Breakdown — ID: 0.8350, SupCon: 1.3447, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8983
[DEBUG] Loss Breakdown — ID: 0.8233, SupCon: 1.8083, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8520
[DEBUG] Loss Breakdown — ID: 0.8316, SupCon: 1.9806, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8981
[DEBUG] Loss Breakdown — ID: 0.8212, SupCon: 1.7442, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9163
[DEBUG] Loss Breakdown — ID: 0.8195, SupCon: 0.9899, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8878
[DEBUG] Loss Breakdown — ID: 0.8215, SupCon: 1.3499, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9075
[DEBUG] Loss Breakdown — ID: 0.8141, SupCon: 1.4861, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9034
[DEBUG] Loss Breakdown — ID: 0.8284, SupCon: 1.9663, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9078
[DEBUG] Loss Breakdown — ID: 0.8162, SupCon: 1.6027, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8479
[DEBUG] Loss Breakdown — ID: 0.8423, SupCon: 2.0712, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9162
[DEBUG] Loss Breakdown — ID: 0.8234, SupCon: 0.7841, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8274
[DEBUG] Loss Breakdown — ID: 0.8445, SupCon: 2.2840, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8985
[DEBUG] Loss Breakdown — ID: 0.8217, SupCon: 1.6017, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9061
[DEBUG] Loss Breakdown — ID: 0.8221, SupCon: 0.5478, Tri: 0.0000
[Epoch 41] Total Loss=0.1652
Validating epoch 41...
[Epoch 41] Avg Train Loss = 0.1652 | 
==================== Epoch 41 Validation ====================
Validation rank-1    : 92.69%
Validation rank-5    : 98.66%
Validation rank-10   : 99.28%
Validation mAP      : 95.42%
============================================================
No improvement in Acc@1. Patience counter: 4/10
 Epoch 42/60
[Epoch 42] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9017
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.1627, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8965
[DEBUG] Loss Breakdown — ID: 0.8237, SupCon: 2.0707, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9080
[DEBUG] Loss Breakdown — ID: 0.8220, SupCon: 0.8557, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8944
[DEBUG] Loss Breakdown — ID: 0.8208, SupCon: 1.3933, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9017
[DEBUG] Loss Breakdown — ID: 0.8274, SupCon: 1.5640, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8982
[DEBUG] Loss Breakdown — ID: 0.8197, SupCon: 1.2205, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8782
[DEBUG] Loss Breakdown — ID: 0.8254, SupCon: 2.0357, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8241, SupCon: 1.6343, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9026
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.3118, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9163
[DEBUG] Loss Breakdown — ID: 0.8154, SupCon: 1.5397, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8810
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 2.0809, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8884
[DEBUG] Loss Breakdown — ID: 0.8306, SupCon: 1.7690, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8995
[DEBUG] Loss Breakdown — ID: 0.8280, SupCon: 1.8253, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8984
[DEBUG] Loss Breakdown — ID: 0.8249, SupCon: 1.1142, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8902
[DEBUG] Loss Breakdown — ID: 0.8205, SupCon: 1.7115, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9180
[DEBUG] Loss Breakdown — ID: 0.8150, SupCon: 1.2397, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9107
[DEBUG] Loss Breakdown — ID: 0.8192, SupCon: 1.1484, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8828
[DEBUG] Loss Breakdown — ID: 0.8175, SupCon: 1.5652, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9003
[DEBUG] Loss Breakdown — ID: 0.8155, SupCon: 1.0817, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8822
[DEBUG] Loss Breakdown — ID: 0.8197, SupCon: 1.6357, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8917
[DEBUG] Loss Breakdown — ID: 0.8244, SupCon: 1.3491, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8768
[DEBUG] Loss Breakdown — ID: 0.8242, SupCon: 1.8208, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8782
[DEBUG] Loss Breakdown — ID: 0.8228, SupCon: 1.4720, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8882
[DEBUG] Loss Breakdown — ID: 0.8211, SupCon: 1.9246, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8965
[DEBUG] Loss Breakdown — ID: 0.8209, SupCon: 1.4374, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9124
[DEBUG] Loss Breakdown — ID: 0.8120, SupCon: 1.0843, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9070
[DEBUG] Loss Breakdown — ID: 0.8202, SupCon: 1.3370, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8598
[DEBUG] Loss Breakdown — ID: 0.8448, SupCon: 1.0216, Tri: 0.0000
[Epoch 42] Total Loss=0.1645
Validating epoch 42...
[Epoch 42] Avg Train Loss = 0.1645 | 
==================== Epoch 42 Validation ====================
Validation rank-1    : 92.07%
Validation rank-5    : 98.46%
Validation rank-10   : 99.07%
Validation mAP      : 95.02%
============================================================
No improvement in Acc@1. Patience counter: 5/10
 Epoch 43/60
[Epoch 43] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8994
[DEBUG] Loss Breakdown — ID: 0.8185, SupCon: 1.0845, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8946
[DEBUG] Loss Breakdown — ID: 0.8195, SupCon: 1.6545, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8917
[DEBUG] Loss Breakdown — ID: 0.8212, SupCon: 1.5681, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9106
[DEBUG] Loss Breakdown — ID: 0.8230, SupCon: 1.0562, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9131
[DEBUG] Loss Breakdown — ID: 0.8206, SupCon: 1.0150, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8912
[DEBUG] Loss Breakdown — ID: 0.8174, SupCon: 0.9973, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8599
[DEBUG] Loss Breakdown — ID: 0.8254, SupCon: 1.7652, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8786
[DEBUG] Loss Breakdown — ID: 0.8227, SupCon: 1.2463, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8875
[DEBUG] Loss Breakdown — ID: 0.8183, SupCon: 1.3396, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8867
[DEBUG] Loss Breakdown — ID: 0.8244, SupCon: 1.5391, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8927
[DEBUG] Loss Breakdown — ID: 0.8224, SupCon: 1.4089, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8822
[DEBUG] Loss Breakdown — ID: 0.8358, SupCon: 1.0737, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9129
[DEBUG] Loss Breakdown — ID: 0.8217, SupCon: 1.3472, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8269, SupCon: 1.6294, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8783
[DEBUG] Loss Breakdown — ID: 0.8224, SupCon: 1.6068, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8607
[DEBUG] Loss Breakdown — ID: 0.8258, SupCon: 2.1668, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9108
[DEBUG] Loss Breakdown — ID: 0.8220, SupCon: 1.4460, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9032
[DEBUG] Loss Breakdown — ID: 0.8170, SupCon: 1.1218, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9098
[DEBUG] Loss Breakdown — ID: 0.8231, SupCon: 0.9313, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8910
[DEBUG] Loss Breakdown — ID: 0.8252, SupCon: 1.9199, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8798
[DEBUG] Loss Breakdown — ID: 0.8258, SupCon: 1.6324, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8221, SupCon: 1.4839, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8617
[DEBUG] Loss Breakdown — ID: 0.8198, SupCon: 2.0376, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9018
[DEBUG] Loss Breakdown — ID: 0.8140, SupCon: 1.1874, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8855
[DEBUG] Loss Breakdown — ID: 0.8284, SupCon: 1.4131, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8943
[DEBUG] Loss Breakdown — ID: 0.8240, SupCon: 1.4709, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8822
[DEBUG] Loss Breakdown — ID: 0.8253, SupCon: 2.0654, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8823
[DEBUG] Loss Breakdown — ID: 0.8242, SupCon: 1.2648, Tri: 0.0000
[Epoch 43] Total Loss=0.1645
Validating epoch 43...
[Epoch 43] Avg Train Loss = 0.1645 | 
==================== Epoch 43 Validation ====================
Validation rank-1    : 92.48%
Validation rank-5    : 98.56%
Validation rank-10   : 99.18%
Validation mAP      : 95.35%
============================================================
No improvement in Acc@1. Patience counter: 6/10
 Epoch 44/60
[Epoch 44] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8498
[DEBUG] Loss Breakdown — ID: 0.8304, SupCon: 2.5012, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9028
[DEBUG] Loss Breakdown — ID: 0.8224, SupCon: 1.9094, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9082
[DEBUG] Loss Breakdown — ID: 0.8117, SupCon: 1.4303, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9133
[DEBUG] Loss Breakdown — ID: 0.8160, SupCon: 1.3209, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9086
[DEBUG] Loss Breakdown — ID: 0.8173, SupCon: 1.4343, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9072
[DEBUG] Loss Breakdown — ID: 0.8244, SupCon: 1.1973, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9076
[DEBUG] Loss Breakdown — ID: 0.8200, SupCon: 1.4058, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8864
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.5554, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8767
[DEBUG] Loss Breakdown — ID: 0.8207, SupCon: 1.4083, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8845
[DEBUG] Loss Breakdown — ID: 0.8268, SupCon: 1.4689, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9059
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 1.5341, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8969
[DEBUG] Loss Breakdown — ID: 0.8174, SupCon: 1.1255, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8902
[DEBUG] Loss Breakdown — ID: 0.8242, SupCon: 1.4357, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8950
[DEBUG] Loss Breakdown — ID: 0.8148, SupCon: 1.5222, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8838
[DEBUG] Loss Breakdown — ID: 0.8289, SupCon: 1.9768, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8967
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.7439, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8948
[DEBUG] Loss Breakdown — ID: 0.8134, SupCon: 1.4555, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9067
[DEBUG] Loss Breakdown — ID: 0.8191, SupCon: 1.2437, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9004
[DEBUG] Loss Breakdown — ID: 0.8140, SupCon: 1.9045, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8793
[DEBUG] Loss Breakdown — ID: 0.8216, SupCon: 1.6537, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8983
[DEBUG] Loss Breakdown — ID: 0.8103, SupCon: 1.7732, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8887
[DEBUG] Loss Breakdown — ID: 0.8201, SupCon: 1.2815, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8689
[DEBUG] Loss Breakdown — ID: 0.8281, SupCon: 1.4457, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8781
[DEBUG] Loss Breakdown — ID: 0.8222, SupCon: 1.5845, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8656
[DEBUG] Loss Breakdown — ID: 0.8303, SupCon: 1.7510, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8949
[DEBUG] Loss Breakdown — ID: 0.8232, SupCon: 1.5397, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8824
[DEBUG] Loss Breakdown — ID: 0.8376, SupCon: 1.9430, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9101
[DEBUG] Loss Breakdown — ID: 0.8221, SupCon: 1.1428, Tri: 0.0000
[Epoch 44] Total Loss=0.1643
Validating epoch 44...
[Epoch 44] Avg Train Loss = 0.1643 | 
==================== Epoch 44 Validation ====================
Validation rank-1    : 92.48%
Validation rank-5    : 98.46%
Validation rank-10   : 99.18%
Validation mAP      : 95.25%
============================================================
No improvement in Acc@1. Patience counter: 7/10
 Epoch 45/60
[Epoch 45] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9202
[DEBUG] Loss Breakdown — ID: 0.8205, SupCon: 1.4739, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8685
[DEBUG] Loss Breakdown — ID: 0.8334, SupCon: 2.0276, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8968
[DEBUG] Loss Breakdown — ID: 0.8203, SupCon: 1.5547, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8898
[DEBUG] Loss Breakdown — ID: 0.8159, SupCon: 1.2201, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9006
[DEBUG] Loss Breakdown — ID: 0.8254, SupCon: 1.2256, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8643
[DEBUG] Loss Breakdown — ID: 0.8332, SupCon: 2.0120, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8194, SupCon: 1.9448, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9038
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.0123, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8876
[DEBUG] Loss Breakdown — ID: 0.8187, SupCon: 1.8655, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8934
[DEBUG] Loss Breakdown — ID: 0.8145, SupCon: 1.7418, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8966
[DEBUG] Loss Breakdown — ID: 0.8151, SupCon: 2.1485, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8974
[DEBUG] Loss Breakdown — ID: 0.8192, SupCon: 1.6263, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8799
[DEBUG] Loss Breakdown — ID: 0.8262, SupCon: 1.5105, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9218
[DEBUG] Loss Breakdown — ID: 0.8165, SupCon: 1.0385, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8903
[DEBUG] Loss Breakdown — ID: 0.8196, SupCon: 1.3125, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9118
[DEBUG] Loss Breakdown — ID: 0.8223, SupCon: 1.3118, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8721
[DEBUG] Loss Breakdown — ID: 0.8330, SupCon: 1.9425, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8926
[DEBUG] Loss Breakdown — ID: 0.8171, SupCon: 1.4084, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8999
[DEBUG] Loss Breakdown — ID: 0.8173, SupCon: 1.2501, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9037
[DEBUG] Loss Breakdown — ID: 0.8134, SupCon: 1.5989, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8863
[DEBUG] Loss Breakdown — ID: 0.8281, SupCon: 0.8560, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9048
[DEBUG] Loss Breakdown — ID: 0.8205, SupCon: 1.1066, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8905
[DEBUG] Loss Breakdown — ID: 0.8213, SupCon: 1.8171, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8224, SupCon: 1.2300, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9088
[DEBUG] Loss Breakdown — ID: 0.8175, SupCon: 1.5550, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8879
[DEBUG] Loss Breakdown — ID: 0.8241, SupCon: 1.3666, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8719
[DEBUG] Loss Breakdown — ID: 0.8254, SupCon: 2.4186, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8735
[DEBUG] Loss Breakdown — ID: 0.8302, SupCon: 1.6597, Tri: 0.0000
[Epoch 45] Total Loss=0.1644
Validating epoch 45...
[Epoch 45] Avg Train Loss = 0.1644 | 
==================== Epoch 45 Validation ====================
Validation rank-1    : 92.69%
Validation rank-5    : 98.56%
Validation rank-10   : 98.97%
Validation mAP      : 95.48%
============================================================
No improvement in Acc@1. Patience counter: 8/10
 Epoch 46/60
[Epoch 46] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.8902
[DEBUG] Loss Breakdown — ID: 0.8247, SupCon: 1.5381, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.9063
[DEBUG] Loss Breakdown — ID: 0.8200, SupCon: 2.0598, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8413
[DEBUG] Loss Breakdown — ID: 0.8342, SupCon: 1.9834, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9188
[DEBUG] Loss Breakdown — ID: 0.8154, SupCon: 1.0541, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9091
[DEBUG] Loss Breakdown — ID: 0.8160, SupCon: 0.8696, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9074
[DEBUG] Loss Breakdown — ID: 0.8181, SupCon: 0.8161, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8780
[DEBUG] Loss Breakdown — ID: 0.8226, SupCon: 1.1788, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9098
[DEBUG] Loss Breakdown — ID: 0.8133, SupCon: 0.9462, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8822
[DEBUG] Loss Breakdown — ID: 0.8176, SupCon: 1.5009, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8933
[DEBUG] Loss Breakdown — ID: 0.8162, SupCon: 1.1909, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8956
[DEBUG] Loss Breakdown — ID: 0.8192, SupCon: 2.1107, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8831
[DEBUG] Loss Breakdown — ID: 0.8275, SupCon: 1.3956, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9160
[DEBUG] Loss Breakdown — ID: 0.8162, SupCon: 1.3298, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9134
[DEBUG] Loss Breakdown — ID: 0.8116, SupCon: 1.7692, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8985
[DEBUG] Loss Breakdown — ID: 0.8153, SupCon: 2.0242, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8915
[DEBUG] Loss Breakdown — ID: 0.8178, SupCon: 1.0390, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9011
[DEBUG] Loss Breakdown — ID: 0.8155, SupCon: 1.0679, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8752
[DEBUG] Loss Breakdown — ID: 0.8241, SupCon: 1.5447, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8666
[DEBUG] Loss Breakdown — ID: 0.8331, SupCon: 1.9891, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9068
[DEBUG] Loss Breakdown — ID: 0.8182, SupCon: 1.0669, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8908
[DEBUG] Loss Breakdown — ID: 0.8243, SupCon: 1.8918, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8756
[DEBUG] Loss Breakdown — ID: 0.8169, SupCon: 1.4926, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8751
[DEBUG] Loss Breakdown — ID: 0.8219, SupCon: 1.9687, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9146
[DEBUG] Loss Breakdown — ID: 0.8139, SupCon: 0.8337, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8930
[DEBUG] Loss Breakdown — ID: 0.8190, SupCon: 2.1073, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9066
[DEBUG] Loss Breakdown — ID: 0.8097, SupCon: 1.2005, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8814
[DEBUG] Loss Breakdown — ID: 0.8180, SupCon: 1.4416, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8683
[DEBUG] Loss Breakdown — ID: 0.8210, SupCon: 1.3649, Tri: 0.0000
[Epoch 46] Total Loss=0.1639
Validating epoch 46...
[Epoch 46] Avg Train Loss = 0.1639 | 
==================== Epoch 46 Validation ====================
Validation rank-1    : 92.89%
Validation rank-5    : 98.25%
Validation rank-10   : 99.38%
Validation mAP      : 95.52%
============================================================
No improvement in Acc@1. Patience counter: 9/10
 Epoch 47/60
[Epoch 47] Learning rate: 0.000002
[DEBUG] ArcFace confidence: 0.9045
[DEBUG] Loss Breakdown — ID: 0.8210, SupCon: 1.3001, Tri: 0.0000
[DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
[DEBUG] img_features: torch.Size([32, 512]), prompt: torch.Size([32, 3, 512]), pooled: torch.Size([32, 512])
[DEBUG] ArcFace confidence: 0.8872
[DEBUG] Loss Breakdown — ID: 0.8191, SupCon: 1.5848, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9137
[DEBUG] Loss Breakdown — ID: 0.8083, SupCon: 0.9699, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9007
[DEBUG] Loss Breakdown — ID: 0.8116, SupCon: 1.0482, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9092
[DEBUG] Loss Breakdown — ID: 0.8206, SupCon: 1.0233, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8980
[DEBUG] Loss Breakdown — ID: 0.8119, SupCon: 1.4368, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8869
[DEBUG] Loss Breakdown — ID: 0.8197, SupCon: 2.0263, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8587
[DEBUG] Loss Breakdown — ID: 0.8306, SupCon: 1.8134, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8886
[DEBUG] Loss Breakdown — ID: 0.8180, SupCon: 1.3873, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9046
[DEBUG] Loss Breakdown — ID: 0.8149, SupCon: 1.0254, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8732
[DEBUG] Loss Breakdown — ID: 0.8255, SupCon: 1.7706, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9118
[DEBUG] Loss Breakdown — ID: 0.8175, SupCon: 1.1716, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8986
[DEBUG] Loss Breakdown — ID: 0.8148, SupCon: 1.2426, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9110
[DEBUG] Loss Breakdown — ID: 0.8161, SupCon: 1.2873, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9080
[DEBUG] Loss Breakdown — ID: 0.8201, SupCon: 1.5436, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9045
[DEBUG] Loss Breakdown — ID: 0.8098, SupCon: 1.1073, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9069
[DEBUG] Loss Breakdown — ID: 0.8109, SupCon: 1.5045, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8632
[DEBUG] Loss Breakdown — ID: 0.8387, SupCon: 2.0019, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8858
[DEBUG] Loss Breakdown — ID: 0.8194, SupCon: 1.0929, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8862
[DEBUG] Loss Breakdown — ID: 0.8145, SupCon: 1.6140, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8888
[DEBUG] Loss Breakdown — ID: 0.8142, SupCon: 1.8207, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9024
[DEBUG] Loss Breakdown — ID: 0.8106, SupCon: 1.5063, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8981
[DEBUG] Loss Breakdown — ID: 0.8154, SupCon: 1.6639, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.9131
[DEBUG] Loss Breakdown — ID: 0.8210, SupCon: 1.3102, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8936
[DEBUG] Loss Breakdown — ID: 0.8219, SupCon: 0.8827, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8934
[DEBUG] Loss Breakdown — ID: 0.8174, SupCon: 1.0515, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8520
[DEBUG] Loss Breakdown — ID: 0.8263, SupCon: 1.4722, Tri: 0.0000
[DEBUG] ArcFace confidence: 0.8647
[DEBUG] Loss Breakdown — ID: 0.8276, SupCon: 1.3707, Tri: 0.0000
[Epoch 47] Total Loss=0.1637
Validating epoch 47...
[Epoch 47] Avg Train Loss = 0.1637 | 
==================== Epoch 47 Validation ====================
Validation rank-1    : 92.48%
Validation rank-5    : 98.76%
Validation rank-10   : 99.49%
Validation mAP      : 95.37%
============================================================
No improvement in Acc@1. Patience counter: 10/10
Early srankping at epoch 47 due to no improvement in rank-1 accuracy.
