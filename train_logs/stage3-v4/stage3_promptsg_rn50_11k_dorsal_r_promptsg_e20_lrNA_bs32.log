2025-04-19 08:50:20,897 - INFO - Saving logs to: train_logs/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32.log
2025-04-19 08:50:20,897 - INFO - Using 72 classes | 28 training batches
2025-04-19 08:50:20,897 - INFO - ======= Stage 3: PromptSG Training =======
2025-04-19 08:50:20,897 - INFO - Experiment Name : stage3_promptsg
2025-04-19 08:50:20,897 - INFO - Model & Dataset : rn50, 11k, dorsal_r
2025-04-19 08:50:20,900 - INFO - Freeze Text Enc.: True
2025-04-19 08:50:20,900 - INFO - Loss Weights    : ID=1.0, Tri=1.0, SupCon=0
2025-04-19 08:50:20,900 - INFO - LR=1e-05 | Epochs=20 | BatchSize=32
2025-04-19 08:50:20,900 - INFO -  Epoch 1/20
2025-04-19 08:50:20,903 - INFO - [Epoch 1] Learning rate: 0.000010
2025-04-19 08:50:47,489 - INFO - [DEBUG] Pooled feature mean L2 norm: 1.0000
2025-04-19 08:50:47,489 - INFO - [DEBUG] ArcFace confidence: 0.2585
2025-04-19 08:50:47,495 - INFO - [DEBUG] Loss Breakdown — ID: 18.6211, SupCon: 3.5312, Tri: 0.1694
2025-04-19 08:50:47,586 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:50:47,589 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:50:47,685 - INFO - [DEBUG] ArcFace confidence: 0.3134
2025-04-19 08:50:47,688 - INFO - [DEBUG] Loss Breakdown — ID: 19.1654, SupCon: 3.5237, Tri: 0.0934
2025-04-19 08:50:47,862 - INFO - [DEBUG] ArcFace confidence: 0.2571
2025-04-19 08:50:47,865 - INFO - [DEBUG] Loss Breakdown — ID: 18.9438, SupCon: 3.5109, Tri: 0.1952
2025-04-19 08:50:48,036 - INFO - [DEBUG] ArcFace confidence: 0.2532
2025-04-19 08:50:48,039 - INFO - [DEBUG] Loss Breakdown — ID: 18.7809, SupCon: 3.5127, Tri: 0.1572
2025-04-19 08:50:48,214 - INFO - [DEBUG] ArcFace confidence: 0.3417
2025-04-19 08:50:48,217 - INFO - [DEBUG] Loss Breakdown — ID: 18.9572, SupCon: 3.5309, Tri: 0.1323
2025-04-19 08:50:48,390 - INFO - [DEBUG] ArcFace confidence: 0.2757
2025-04-19 08:50:48,396 - INFO - [DEBUG] Loss Breakdown — ID: 19.3523, SupCon: 3.5178, Tri: 0.1101
2025-04-19 08:50:48,567 - INFO - [DEBUG] ArcFace confidence: 0.2995
2025-04-19 08:50:48,573 - INFO - [DEBUG] Loss Breakdown — ID: 18.7902, SupCon: 3.5087, Tri: 0.0546
2025-04-19 08:50:48,745 - INFO - [DEBUG] ArcFace confidence: 0.2515
2025-04-19 08:50:48,748 - INFO - [DEBUG] Loss Breakdown — ID: 19.1245, SupCon: 3.4976, Tri: 0.0633
2025-04-19 08:50:48,922 - INFO - [DEBUG] ArcFace confidence: 0.2662
2025-04-19 08:50:48,925 - INFO - [DEBUG] Loss Breakdown — ID: 18.4591, SupCon: 3.5059, Tri: 0.1891
2025-04-19 08:50:49,101 - INFO - [DEBUG] ArcFace confidence: 0.2754
2025-04-19 08:50:49,104 - INFO - [DEBUG] Loss Breakdown — ID: 18.8696, SupCon: 3.4938, Tri: 0.0911
2025-04-19 08:50:49,275 - INFO - [DEBUG] ArcFace confidence: 0.2269
2025-04-19 08:50:49,280 - INFO - [DEBUG] Loss Breakdown — ID: 18.9870, SupCon: 3.5080, Tri: 0.0879
2025-04-19 08:50:49,455 - INFO - [DEBUG] ArcFace confidence: 0.3123
2025-04-19 08:50:49,458 - INFO - [DEBUG] Loss Breakdown — ID: 19.1822, SupCon: 3.5523, Tri: 0.1182
2025-04-19 08:50:49,630 - INFO - [DEBUG] ArcFace confidence: 0.2961
2025-04-19 08:50:49,633 - INFO - [DEBUG] Loss Breakdown — ID: 18.9162, SupCon: 3.4992, Tri: 0.0670
2025-04-19 08:50:49,806 - INFO - [DEBUG] ArcFace confidence: 0.2090
2025-04-19 08:50:49,812 - INFO - [DEBUG] Loss Breakdown — ID: 18.4308, SupCon: 3.5445, Tri: 0.1585
2025-04-19 08:50:49,985 - INFO - [DEBUG] ArcFace confidence: 0.2762
2025-04-19 08:50:49,991 - INFO - [DEBUG] Loss Breakdown — ID: 18.9975, SupCon: 3.5507, Tri: 0.1490
2025-04-19 08:50:50,163 - INFO - [DEBUG] ArcFace confidence: 0.2149
2025-04-19 08:50:50,166 - INFO - [DEBUG] Loss Breakdown — ID: 19.0474, SupCon: 3.5624, Tri: 0.0736
2025-04-19 08:50:50,340 - INFO - [DEBUG] ArcFace confidence: 0.2020
2025-04-19 08:50:50,343 - INFO - [DEBUG] Loss Breakdown — ID: 18.4739, SupCon: 3.5310, Tri: 0.1116
2025-04-19 08:50:50,518 - INFO - [DEBUG] ArcFace confidence: 0.2510
2025-04-19 08:50:50,524 - INFO - [DEBUG] Loss Breakdown — ID: 18.6710, SupCon: 3.5741, Tri: 0.1172
2025-04-19 08:50:50,698 - INFO - [DEBUG] ArcFace confidence: 0.2737
2025-04-19 08:50:50,701 - INFO - [DEBUG] Loss Breakdown — ID: 18.6926, SupCon: 3.5747, Tri: 0.1132
2025-04-19 08:50:50,877 - INFO - [DEBUG] ArcFace confidence: 0.2218
2025-04-19 08:50:50,880 - INFO - [DEBUG] Loss Breakdown — ID: 18.6513, SupCon: 3.5069, Tri: 0.0698
2025-04-19 08:50:51,055 - INFO - [DEBUG] ArcFace confidence: 0.2536
2025-04-19 08:50:51,058 - INFO - [DEBUG] Loss Breakdown — ID: 19.1610, SupCon: 3.5173, Tri: 0.0566
2025-04-19 08:50:51,229 - INFO - [DEBUG] ArcFace confidence: 0.2430
2025-04-19 08:50:51,232 - INFO - [DEBUG] Loss Breakdown — ID: 18.7705, SupCon: 3.4890, Tri: 0.0807
2025-04-19 08:50:51,406 - INFO - [DEBUG] ArcFace confidence: 0.2493
2025-04-19 08:50:51,409 - INFO - [DEBUG] Loss Breakdown — ID: 19.4849, SupCon: 3.4776, Tri: 0.0335
2025-04-19 08:50:51,580 - INFO - [DEBUG] ArcFace confidence: 0.2806
2025-04-19 08:50:51,583 - INFO - [DEBUG] Loss Breakdown — ID: 18.6311, SupCon: 3.5167, Tri: 0.0405
2025-04-19 08:50:51,752 - INFO - [DEBUG] ArcFace confidence: 0.2602
2025-04-19 08:50:51,758 - INFO - [DEBUG] Loss Breakdown — ID: 18.9396, SupCon: 3.4747, Tri: 0.0352
2025-04-19 08:50:51,928 - INFO - [DEBUG] ArcFace confidence: 0.2493
2025-04-19 08:50:51,931 - INFO - [DEBUG] Loss Breakdown — ID: 19.5967, SupCon: 3.4187, Tri: 0.0523
2025-04-19 08:50:52,105 - INFO - [DEBUG] ArcFace confidence: 0.2780
2025-04-19 08:50:52,107 - INFO - [DEBUG] Loss Breakdown — ID: 19.3032, SupCon: 3.5120, Tri: 0.0888
2025-04-19 08:50:52,279 - INFO - [DEBUG] ArcFace confidence: 0.2869
2025-04-19 08:50:52,282 - INFO - [DEBUG] Loss Breakdown — ID: 19.1536, SupCon: 3.3652, Tri: 0.0103
2025-04-19 08:50:53,025 - INFO - [Epoch 1] Total Loss=0.0971
2025-04-19 08:50:53,025 - INFO - Validating epoch 1...
2025-04-19 08:51:22,146 - INFO - [Epoch 1] Avg Train Loss = 0.0971 | 
2025-04-19 08:51:22,146 - INFO - ==================== Epoch 1 Validation ====================
2025-04-19 08:51:22,146 - INFO - Validation rank-1    : 65.50%
2025-04-19 08:51:22,146 - INFO - Validation rank-5    : 81.98%
2025-04-19 08:51:22,146 - INFO - Validation rank-10   : 87.85%
2025-04-19 08:51:22,149 - INFO - Validation mAP      : 73.05%
2025-04-19 08:51:22,149 - INFO - ============================================================
2025-04-19 08:51:22,149 - INFO - Saving best model at epoch 1 (Acc@1=65.50%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 08:51:23,051 - INFO -  Epoch 2/20
2025-04-19 08:51:23,054 - INFO - [Epoch 2] Learning rate: 0.000010
2025-04-19 08:51:47,497 - INFO - [DEBUG] ArcFace confidence: 0.2203
2025-04-19 08:51:47,500 - INFO - [DEBUG] Loss Breakdown — ID: 18.9536, SupCon: 3.5460, Tri: 0.1340
2025-04-19 08:51:47,578 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:51:47,578 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:51:47,675 - INFO - [DEBUG] ArcFace confidence: 0.2181
2025-04-19 08:51:47,678 - INFO - [DEBUG] Loss Breakdown — ID: 18.7556, SupCon: 3.4814, Tri: 0.1343
2025-04-19 08:51:47,852 - INFO - [DEBUG] ArcFace confidence: 0.2389
2025-04-19 08:51:47,858 - INFO - [DEBUG] Loss Breakdown — ID: 19.1931, SupCon: 3.5109, Tri: 0.0621
2025-04-19 08:51:48,031 - INFO - [DEBUG] ArcFace confidence: 0.2742
2025-04-19 08:51:48,037 - INFO - [DEBUG] Loss Breakdown — ID: 18.9382, SupCon: 3.5605, Tri: 0.0589
2025-04-19 08:51:48,211 - INFO - [DEBUG] ArcFace confidence: 0.2557
2025-04-19 08:51:48,214 - INFO - [DEBUG] Loss Breakdown — ID: 19.0457, SupCon: 3.5429, Tri: 0.0510
2025-04-19 08:51:48,390 - INFO - [DEBUG] ArcFace confidence: 0.2242
2025-04-19 08:51:48,393 - INFO - [DEBUG] Loss Breakdown — ID: 19.0623, SupCon: 3.4678, Tri: 0.0436
2025-04-19 08:51:48,567 - INFO - [DEBUG] ArcFace confidence: 0.2394
2025-04-19 08:51:48,573 - INFO - [DEBUG] Loss Breakdown — ID: 18.6748, SupCon: 3.5133, Tri: 0.0326
2025-04-19 08:51:48,745 - INFO - [DEBUG] ArcFace confidence: 0.2416
2025-04-19 08:51:48,748 - INFO - [DEBUG] Loss Breakdown — ID: 18.5259, SupCon: 3.4431, Tri: 0.0761
2025-04-19 08:51:48,924 - INFO - [DEBUG] ArcFace confidence: 0.2385
2025-04-19 08:51:48,930 - INFO - [DEBUG] Loss Breakdown — ID: 18.9985, SupCon: 3.4626, Tri: 0.0449
2025-04-19 08:51:49,102 - INFO - [DEBUG] ArcFace confidence: 0.2379
2025-04-19 08:51:49,105 - INFO - [DEBUG] Loss Breakdown — ID: 19.2251, SupCon: 3.4807, Tri: 0.0330
2025-04-19 08:51:49,279 - INFO - [DEBUG] ArcFace confidence: 0.2431
2025-04-19 08:51:49,282 - INFO - [DEBUG] Loss Breakdown — ID: 18.6422, SupCon: 3.4144, Tri: 0.0382
2025-04-19 08:51:49,457 - INFO - [DEBUG] ArcFace confidence: 0.2656
2025-04-19 08:51:49,463 - INFO - [DEBUG] Loss Breakdown — ID: 19.0590, SupCon: 3.5066, Tri: 0.1333
2025-04-19 08:51:49,636 - INFO - [DEBUG] ArcFace confidence: 0.2663
2025-04-19 08:51:49,639 - INFO - [DEBUG] Loss Breakdown — ID: 19.4342, SupCon: 3.4232, Tri: 0.1621
2025-04-19 08:51:49,814 - INFO - [DEBUG] ArcFace confidence: 0.2388
2025-04-19 08:51:49,820 - INFO - [DEBUG] Loss Breakdown — ID: 18.8619, SupCon: 3.4528, Tri: 0.0361
2025-04-19 08:51:49,991 - INFO - [DEBUG] ArcFace confidence: 0.2055
2025-04-19 08:51:49,994 - INFO - [DEBUG] Loss Breakdown — ID: 19.3191, SupCon: 3.5882, Tri: 0.0857
2025-04-19 08:51:50,170 - INFO - [DEBUG] ArcFace confidence: 0.2364
2025-04-19 08:51:50,176 - INFO - [DEBUG] Loss Breakdown — ID: 19.5505, SupCon: 3.4699, Tri: 0.1177
2025-04-19 08:51:50,351 - INFO - [DEBUG] ArcFace confidence: 0.2480
2025-04-19 08:51:50,354 - INFO - [DEBUG] Loss Breakdown — ID: 19.2892, SupCon: 3.5171, Tri: 0.0334
2025-04-19 08:51:50,527 - INFO - [DEBUG] ArcFace confidence: 0.2744
2025-04-19 08:51:50,530 - INFO - [DEBUG] Loss Breakdown — ID: 19.0810, SupCon: 3.4995, Tri: 0.0763
2025-04-19 08:51:50,704 - INFO - [DEBUG] ArcFace confidence: 0.2569
2025-04-19 08:51:50,707 - INFO - [DEBUG] Loss Breakdown — ID: 18.5860, SupCon: 3.5432, Tri: 0.0652
2025-04-19 08:51:50,879 - INFO - [DEBUG] ArcFace confidence: 0.2307
2025-04-19 08:51:50,885 - INFO - [DEBUG] Loss Breakdown — ID: 18.9969, SupCon: 3.5101, Tri: 0.0755
2025-04-19 08:51:51,055 - INFO - [DEBUG] ArcFace confidence: 0.2873
2025-04-19 08:51:51,058 - INFO - [DEBUG] Loss Breakdown — ID: 19.1574, SupCon: 3.5476, Tri: 0.0451
2025-04-19 08:51:51,231 - INFO - [DEBUG] ArcFace confidence: 0.2468
2025-04-19 08:51:51,234 - INFO - [DEBUG] Loss Breakdown — ID: 19.3162, SupCon: 3.5519, Tri: 0.0413
2025-04-19 08:51:51,404 - INFO - [DEBUG] ArcFace confidence: 0.2637
2025-04-19 08:51:51,410 - INFO - [DEBUG] Loss Breakdown — ID: 18.9046, SupCon: 3.6008, Tri: 0.0428
2025-04-19 08:51:51,581 - INFO - [DEBUG] ArcFace confidence: 0.2285
2025-04-19 08:51:51,586 - INFO - [DEBUG] Loss Breakdown — ID: 19.2565, SupCon: 3.5141, Tri: 0.0075
2025-04-19 08:51:51,757 - INFO - [DEBUG] ArcFace confidence: 0.2587
2025-04-19 08:51:51,760 - INFO - [DEBUG] Loss Breakdown — ID: 18.9545, SupCon: 3.5339, Tri: 0.0114
2025-04-19 08:51:51,932 - INFO - [DEBUG] ArcFace confidence: 0.2728
2025-04-19 08:51:51,935 - INFO - [DEBUG] Loss Breakdown — ID: 18.9275, SupCon: 3.5551, Tri: 0.0888
2025-04-19 08:51:52,107 - INFO - [DEBUG] ArcFace confidence: 0.2499
2025-04-19 08:51:52,113 - INFO - [DEBUG] Loss Breakdown — ID: 18.7685, SupCon: 3.5543, Tri: 0.0048
2025-04-19 08:51:52,268 - INFO - [DEBUG] ArcFace confidence: 0.2055
2025-04-19 08:51:52,271 - INFO - [DEBUG] Loss Breakdown — ID: 18.7286, SupCon: 3.2224, Tri: 0.0509
2025-04-19 08:51:53,010 - INFO - [Epoch 2] Total Loss=0.0638
2025-04-19 08:51:53,010 - INFO - Validating epoch 2...
2025-04-19 08:52:22,172 - INFO - [Epoch 2] Avg Train Loss = 0.0638 | 
2025-04-19 08:52:22,172 - INFO - ==================== Epoch 2 Validation ====================
2025-04-19 08:52:22,172 - INFO - Validation rank-1    : 66.22%
2025-04-19 08:52:22,175 - INFO - Validation rank-5    : 83.52%
2025-04-19 08:52:22,175 - INFO - Validation rank-10   : 89.60%
2025-04-19 08:52:22,175 - INFO - Validation mAP      : 74.67%
2025-04-19 08:52:22,175 - INFO - ============================================================
2025-04-19 08:52:22,175 - INFO - Saving best model at epoch 2 (Acc@1=66.22%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 08:52:23,170 - INFO -  Epoch 3/20
2025-04-19 08:52:23,173 - INFO - [Epoch 3] Learning rate: 0.000010
2025-04-19 08:52:47,491 - INFO - [DEBUG] ArcFace confidence: 0.2371
2025-04-19 08:52:47,497 - INFO - [DEBUG] Loss Breakdown — ID: 17.9498, SupCon: 3.5412, Tri: 0.1173
2025-04-19 08:52:47,578 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:52:47,578 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:52:47,671 - INFO - [DEBUG] ArcFace confidence: 0.2385
2025-04-19 08:52:47,677 - INFO - [DEBUG] Loss Breakdown — ID: 18.8324, SupCon: 3.4940, Tri: 0.0335
2025-04-19 08:52:47,852 - INFO - [DEBUG] ArcFace confidence: 0.2284
2025-04-19 08:52:47,855 - INFO - [DEBUG] Loss Breakdown — ID: 18.8299, SupCon: 3.5828, Tri: 0.0233
2025-04-19 08:52:48,030 - INFO - [DEBUG] ArcFace confidence: 0.2678
2025-04-19 08:52:48,033 - INFO - [DEBUG] Loss Breakdown — ID: 18.8278, SupCon: 3.5344, Tri: 0.0302
2025-04-19 08:52:48,207 - INFO - [DEBUG] ArcFace confidence: 0.2686
2025-04-19 08:52:48,210 - INFO - [DEBUG] Loss Breakdown — ID: 19.0542, SupCon: 3.5285, Tri: 0.0149
2025-04-19 08:52:48,388 - INFO - [DEBUG] ArcFace confidence: 0.2700
2025-04-19 08:52:48,391 - INFO - [DEBUG] Loss Breakdown — ID: 18.7390, SupCon: 3.5724, Tri: 0.0087
2025-04-19 08:52:48,562 - INFO - [DEBUG] ArcFace confidence: 0.2154
2025-04-19 08:52:48,568 - INFO - [DEBUG] Loss Breakdown — ID: 19.0074, SupCon: 3.5927, Tri: 0.0654
2025-04-19 08:52:48,743 - INFO - [DEBUG] ArcFace confidence: 0.2742
2025-04-19 08:52:48,746 - INFO - [DEBUG] Loss Breakdown — ID: 19.2111, SupCon: 3.5069, Tri: 0.0103
2025-04-19 08:52:48,922 - INFO - [DEBUG] ArcFace confidence: 0.2555
2025-04-19 08:52:48,926 - INFO - [DEBUG] Loss Breakdown — ID: 19.2556, SupCon: 3.5982, Tri: 0.0905
2025-04-19 08:52:49,097 - INFO - [DEBUG] ArcFace confidence: 0.2785
2025-04-19 08:52:49,103 - INFO - [DEBUG] Loss Breakdown — ID: 19.0485, SupCon: 3.6328, Tri: 0.0835
2025-04-19 08:52:49,277 - INFO - [DEBUG] ArcFace confidence: 0.2701
2025-04-19 08:52:49,280 - INFO - [DEBUG] Loss Breakdown — ID: 18.7884, SupCon: 3.4968, Tri: 0.0978
2025-04-19 08:52:49,454 - INFO - [DEBUG] ArcFace confidence: 0.2376
2025-04-19 08:52:49,460 - INFO - [DEBUG] Loss Breakdown — ID: 18.4760, SupCon: 3.6029, Tri: 0.0342
2025-04-19 08:52:49,634 - INFO - [DEBUG] ArcFace confidence: 0.2643
2025-04-19 08:52:49,637 - INFO - [DEBUG] Loss Breakdown — ID: 18.6590, SupCon: 3.5959, Tri: 0.1151
2025-04-19 08:52:49,810 - INFO - [DEBUG] ArcFace confidence: 0.2211
2025-04-19 08:52:49,813 - INFO - [DEBUG] Loss Breakdown — ID: 18.6952, SupCon: 3.5277, Tri: 0.0401
2025-04-19 08:52:49,992 - INFO - [DEBUG] ArcFace confidence: 0.2207
2025-04-19 08:52:49,995 - INFO - [DEBUG] Loss Breakdown — ID: 18.6848, SupCon: 3.5086, Tri: 0.0548
2025-04-19 08:52:50,167 - INFO - [DEBUG] ArcFace confidence: 0.2250
2025-04-19 08:52:50,170 - INFO - [DEBUG] Loss Breakdown — ID: 19.4655, SupCon: 3.5729, Tri: 0.0600
2025-04-19 08:52:50,347 - INFO - [DEBUG] ArcFace confidence: 0.2621
2025-04-19 08:52:50,349 - INFO - [DEBUG] Loss Breakdown — ID: 18.9214, SupCon: 3.4477, Tri: 0.0289
2025-04-19 08:52:50,525 - INFO - [DEBUG] ArcFace confidence: 0.2342
2025-04-19 08:52:50,528 - INFO - [DEBUG] Loss Breakdown — ID: 18.8987, SupCon: 3.6290, Tri: 0.0513
2025-04-19 08:52:50,700 - INFO - [DEBUG] ArcFace confidence: 0.2350
2025-04-19 08:52:50,706 - INFO - [DEBUG] Loss Breakdown — ID: 18.8051, SupCon: 3.5910, Tri: 0.0472
2025-04-19 08:52:50,877 - INFO - [DEBUG] ArcFace confidence: 0.2606
2025-04-19 08:52:50,883 - INFO - [DEBUG] Loss Breakdown — ID: 19.1002, SupCon: 3.5557, Tri: 0.0638
2025-04-19 08:52:51,056 - INFO - [DEBUG] ArcFace confidence: 0.2500
2025-04-19 08:52:51,059 - INFO - [DEBUG] Loss Breakdown — ID: 18.4422, SupCon: 3.5610, Tri: 0.0045
2025-04-19 08:52:51,231 - INFO - [DEBUG] ArcFace confidence: 0.2616
2025-04-19 08:52:51,234 - INFO - [DEBUG] Loss Breakdown — ID: 18.6460, SupCon: 3.5242, Tri: 0.1739
2025-04-19 08:52:51,405 - INFO - [DEBUG] ArcFace confidence: 0.2640
2025-04-19 08:52:51,408 - INFO - [DEBUG] Loss Breakdown — ID: 18.4530, SupCon: 3.6900, Tri: 0.0346
2025-04-19 08:52:51,579 - INFO - [DEBUG] ArcFace confidence: 0.2276
2025-04-19 08:52:51,582 - INFO - [DEBUG] Loss Breakdown — ID: 18.9978, SupCon: 3.5922, Tri: 0.0529
2025-04-19 08:52:51,758 - INFO - [DEBUG] ArcFace confidence: 0.2512
2025-04-19 08:52:51,761 - INFO - [DEBUG] Loss Breakdown — ID: 18.5059, SupCon: 3.5207, Tri: 0.1101
2025-04-19 08:52:51,934 - INFO - [DEBUG] ArcFace confidence: 0.2501
2025-04-19 08:52:51,937 - INFO - [DEBUG] Loss Breakdown — ID: 18.7085, SupCon: 3.5597, Tri: 0.0309
2025-04-19 08:52:52,106 - INFO - [DEBUG] ArcFace confidence: 0.2598
2025-04-19 08:52:52,112 - INFO - [DEBUG] Loss Breakdown — ID: 18.9001, SupCon: 3.5925, Tri: 0.0246
2025-04-19 08:52:52,267 - INFO - [DEBUG] ArcFace confidence: 0.2428
2025-04-19 08:52:52,271 - INFO - [DEBUG] Loss Breakdown — ID: 18.5772, SupCon: 3.4315, Tri: 0.0000
2025-04-19 08:52:53,023 - INFO - [Epoch 3] Total Loss=0.0536
2025-04-19 08:52:53,023 - INFO - Validating epoch 3...
2025-04-19 08:53:22,177 - INFO - [Epoch 3] Avg Train Loss = 0.0536 | 
2025-04-19 08:53:22,177 - INFO - ==================== Epoch 3 Validation ====================
2025-04-19 08:53:22,177 - INFO - Validation rank-1    : 73.94%
2025-04-19 08:53:22,177 - INFO - Validation rank-5    : 85.79%
2025-04-19 08:53:22,177 - INFO - Validation rank-10   : 88.05%
2025-04-19 08:53:22,177 - INFO - Validation mAP      : 79.73%
2025-04-19 08:53:22,177 - INFO - ============================================================
2025-04-19 08:53:22,177 - INFO - Saving best model at epoch 3 (Acc@1=73.94%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e20_lrNA_bs32_BEST.pth
2025-04-19 08:53:23,183 - INFO -  Epoch 4/20
2025-04-19 08:53:23,186 - INFO - [Epoch 4] Learning rate: 0.000009
2025-04-19 08:53:48,677 - INFO - [DEBUG] ArcFace confidence: 0.2534
2025-04-19 08:53:48,680 - INFO - [DEBUG] Loss Breakdown — ID: 18.9773, SupCon: 3.5902, Tri: 0.0314
2025-04-19 08:53:48,760 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:53:48,760 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:53:48,854 - INFO - [DEBUG] ArcFace confidence: 0.2306
2025-04-19 08:53:48,860 - INFO - [DEBUG] Loss Breakdown — ID: 18.5549, SupCon: 3.6120, Tri: 0.0931
2025-04-19 08:53:49,033 - INFO - [DEBUG] ArcFace confidence: 0.2770
2025-04-19 08:53:49,036 - INFO - [DEBUG] Loss Breakdown — ID: 18.6305, SupCon: 3.5908, Tri: 0.0047
2025-04-19 08:53:49,213 - INFO - [DEBUG] ArcFace confidence: 0.2820
2025-04-19 08:53:49,216 - INFO - [DEBUG] Loss Breakdown — ID: 18.6950, SupCon: 3.7129, Tri: 0.0143
2025-04-19 08:53:49,392 - INFO - [DEBUG] ArcFace confidence: 0.2461
2025-04-19 08:53:49,394 - INFO - [DEBUG] Loss Breakdown — ID: 19.2163, SupCon: 3.6061, Tri: 0.0656
2025-04-19 08:53:49,568 - INFO - [DEBUG] ArcFace confidence: 0.2388
2025-04-19 08:53:49,574 - INFO - [DEBUG] Loss Breakdown — ID: 19.4803, SupCon: 3.5583, Tri: 0.0448
2025-04-19 08:53:49,748 - INFO - [DEBUG] ArcFace confidence: 0.2928
2025-04-19 08:53:49,751 - INFO - [DEBUG] Loss Breakdown — ID: 19.1696, SupCon: 3.4344, Tri: 0.0152
2025-04-19 08:53:49,926 - INFO - [DEBUG] ArcFace confidence: 0.2791
2025-04-19 08:53:49,932 - INFO - [DEBUG] Loss Breakdown — ID: 18.7152, SupCon: 3.5108, Tri: 0.1022
2025-04-19 08:53:50,108 - INFO - [DEBUG] ArcFace confidence: 0.2991
2025-04-19 08:53:50,111 - INFO - [DEBUG] Loss Breakdown — ID: 18.4822, SupCon: 3.5404, Tri: 0.0557
2025-04-19 08:53:50,283 - INFO - [DEBUG] ArcFace confidence: 0.3092
2025-04-19 08:53:50,289 - INFO - [DEBUG] Loss Breakdown — ID: 18.9946, SupCon: 3.6147, Tri: 0.1521
2025-04-19 08:53:50,461 - INFO - [DEBUG] ArcFace confidence: 0.2564
2025-04-19 08:53:50,464 - INFO - [DEBUG] Loss Breakdown — ID: 18.7023, SupCon: 3.5509, Tri: 0.0253
2025-04-19 08:53:50,639 - INFO - [DEBUG] ArcFace confidence: 0.2656
2025-04-19 08:53:50,642 - INFO - [DEBUG] Loss Breakdown — ID: 18.9177, SupCon: 3.5268, Tri: 0.0611
2025-04-19 08:53:50,814 - INFO - [DEBUG] ArcFace confidence: 0.2743
2025-04-19 08:53:50,820 - INFO - [DEBUG] Loss Breakdown — ID: 18.6914, SupCon: 3.6436, Tri: 0.0740
2025-04-19 08:53:50,991 - INFO - [DEBUG] ArcFace confidence: 0.2746
2025-04-19 08:53:50,997 - INFO - [DEBUG] Loss Breakdown — ID: 18.4155, SupCon: 3.5976, Tri: 0.0051
2025-04-19 08:53:51,170 - INFO - [DEBUG] ArcFace confidence: 0.2924
2025-04-19 08:53:51,173 - INFO - [DEBUG] Loss Breakdown — ID: 19.1620, SupCon: 3.6041, Tri: 0.0895
2025-04-19 08:53:51,349 - INFO - [DEBUG] ArcFace confidence: 0.2912
2025-04-19 08:53:51,352 - INFO - [DEBUG] Loss Breakdown — ID: 18.4240, SupCon: 3.6104, Tri: 0.0359
2025-04-19 08:53:51,526 - INFO - [DEBUG] ArcFace confidence: 0.2543
2025-04-19 08:53:51,532 - INFO - [DEBUG] Loss Breakdown — ID: 19.0610, SupCon: 3.5704, Tri: 0.0074
2025-04-19 08:53:51,703 - INFO - [DEBUG] ArcFace confidence: 0.2969
2025-04-19 08:53:51,706 - INFO - [DEBUG] Loss Breakdown — ID: 18.9817, SupCon: 3.6641, Tri: 0.0598
2025-04-19 08:53:51,883 - INFO - [DEBUG] ArcFace confidence: 0.2688
2025-04-19 08:53:51,886 - INFO - [DEBUG] Loss Breakdown — ID: 18.8465, SupCon: 3.6508, Tri: 0.0258
2025-04-19 08:53:52,060 - INFO - [DEBUG] ArcFace confidence: 0.2515
2025-04-19 08:53:52,064 - INFO - [DEBUG] Loss Breakdown — ID: 18.7894, SupCon: 3.5572, Tri: 0.0896
2025-04-19 08:53:52,237 - INFO - [DEBUG] ArcFace confidence: 0.2732
2025-04-19 08:53:52,241 - INFO - [DEBUG] Loss Breakdown — ID: 19.1631, SupCon: 3.6774, Tri: 0.0711
2025-04-19 08:53:52,412 - INFO - [DEBUG] ArcFace confidence: 0.2931
2025-04-19 08:53:52,418 - INFO - [DEBUG] Loss Breakdown — ID: 18.9705, SupCon: 3.6904, Tri: 0.1274
2025-04-19 08:53:52,589 - INFO - [DEBUG] ArcFace confidence: 0.3030
2025-04-19 08:53:52,592 - INFO - [DEBUG] Loss Breakdown — ID: 19.2829, SupCon: 3.6677, Tri: 0.0096
2025-04-19 08:53:52,763 - INFO - [DEBUG] ArcFace confidence: 0.2197
2025-04-19 08:53:52,769 - INFO - [DEBUG] Loss Breakdown — ID: 18.5999, SupCon: 3.7593, Tri: 0.0595
2025-04-19 08:53:52,942 - INFO - [DEBUG] ArcFace confidence: 0.2447
2025-04-19 08:53:52,945 - INFO - [DEBUG] Loss Breakdown — ID: 19.6563, SupCon: 3.6157, Tri: 0.1060
2025-04-19 08:53:53,120 - INFO - [DEBUG] ArcFace confidence: 0.2445
2025-04-19 08:53:53,126 - INFO - [DEBUG] Loss Breakdown — ID: 19.1925, SupCon: 3.5971, Tri: 0.0223
2025-04-19 08:53:53,297 - INFO - [DEBUG] ArcFace confidence: 0.2468
2025-04-19 08:53:53,300 - INFO - [DEBUG] Loss Breakdown — ID: 18.5566, SupCon: 3.5979, Tri: 0.0262
2025-04-19 08:53:53,461 - INFO - [DEBUG] ArcFace confidence: 0.2530
2025-04-19 08:53:53,464 - INFO - [DEBUG] Loss Breakdown — ID: 19.3145, SupCon: 3.3411, Tri: 0.0034
2025-04-19 08:53:54,196 - INFO - [Epoch 4] Total Loss=0.0528
2025-04-19 08:53:54,199 - INFO - Validating epoch 4...
2025-04-19 08:54:25,343 - INFO - [Epoch 4] Avg Train Loss = 0.0528 | 
2025-04-19 08:54:25,343 - INFO - ==================== Epoch 4 Validation ====================
2025-04-19 08:54:25,343 - INFO - Validation rank-1    : 62.41%
2025-04-19 08:54:25,343 - INFO - Validation rank-5    : 80.02%
2025-04-19 08:54:25,343 - INFO - Validation rank-10   : 87.23%
2025-04-19 08:54:25,343 - INFO - Validation mAP      : 70.64%
2025-04-19 08:54:25,343 - INFO - ============================================================
2025-04-19 08:54:25,343 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 08:54:25,343 - INFO -  Epoch 5/20
2025-04-19 08:54:25,345 - INFO - [Epoch 5] Learning rate: 0.000009
2025-04-19 08:54:49,433 - INFO - [DEBUG] ArcFace confidence: 0.2770
2025-04-19 08:54:49,439 - INFO - [DEBUG] Loss Breakdown — ID: 18.9582, SupCon: 3.6900, Tri: 0.0957
2025-04-19 08:54:49,520 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:54:49,520 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:54:49,612 - INFO - [DEBUG] ArcFace confidence: 0.2625
2025-04-19 08:54:49,618 - INFO - [DEBUG] Loss Breakdown — ID: 19.1802, SupCon: 3.5826, Tri: 0.0232
2025-04-19 08:54:49,791 - INFO - [DEBUG] ArcFace confidence: 0.2261
2025-04-19 08:54:49,794 - INFO - [DEBUG] Loss Breakdown — ID: 18.7642, SupCon: 3.5743, Tri: 0.0425
2025-04-19 08:54:49,969 - INFO - [DEBUG] ArcFace confidence: 0.2523
2025-04-19 08:54:49,972 - INFO - [DEBUG] Loss Breakdown — ID: 19.0680, SupCon: 3.6549, Tri: 0.1441
2025-04-19 08:54:50,149 - INFO - [DEBUG] ArcFace confidence: 0.2061
2025-04-19 08:54:50,152 - INFO - [DEBUG] Loss Breakdown — ID: 18.8367, SupCon: 3.4954, Tri: 0.0978
2025-04-19 08:54:50,328 - INFO - [DEBUG] ArcFace confidence: 0.2351
2025-04-19 08:54:50,331 - INFO - [DEBUG] Loss Breakdown — ID: 19.2040, SupCon: 3.5978, Tri: 0.0840
2025-04-19 08:54:50,507 - INFO - [DEBUG] ArcFace confidence: 0.2547
2025-04-19 08:54:50,510 - INFO - [DEBUG] Loss Breakdown — ID: 19.2048, SupCon: 3.5324, Tri: 0.1299
2025-04-19 08:54:50,682 - INFO - [DEBUG] ArcFace confidence: 0.2557
2025-04-19 08:54:50,688 - INFO - [DEBUG] Loss Breakdown — ID: 18.6190, SupCon: 3.5653, Tri: 0.0669
2025-04-19 08:54:50,861 - INFO - [DEBUG] ArcFace confidence: 0.2508
2025-04-19 08:54:50,864 - INFO - [DEBUG] Loss Breakdown — ID: 19.0676, SupCon: 3.5352, Tri: 0.0341
2025-04-19 08:54:51,037 - INFO - [DEBUG] ArcFace confidence: 0.2315
2025-04-19 08:54:51,040 - INFO - [DEBUG] Loss Breakdown — ID: 19.0999, SupCon: 3.5558, Tri: 0.0789
2025-04-19 08:54:51,210 - INFO - [DEBUG] ArcFace confidence: 0.2709
2025-04-19 08:54:51,216 - INFO - [DEBUG] Loss Breakdown — ID: 19.3208, SupCon: 3.5682, Tri: 0.0132
2025-04-19 08:54:51,390 - INFO - [DEBUG] ArcFace confidence: 0.2231
2025-04-19 08:54:51,393 - INFO - [DEBUG] Loss Breakdown — ID: 18.8155, SupCon: 3.4793, Tri: 0.0487
2025-04-19 08:54:51,567 - INFO - [DEBUG] ArcFace confidence: 0.2159
2025-04-19 08:54:51,570 - INFO - [DEBUG] Loss Breakdown — ID: 19.0854, SupCon: 3.6446, Tri: 0.0780
2025-04-19 08:54:51,746 - INFO - [DEBUG] ArcFace confidence: 0.2246
2025-04-19 08:54:51,749 - INFO - [DEBUG] Loss Breakdown — ID: 18.5515, SupCon: 3.6527, Tri: 0.0342
2025-04-19 08:54:51,923 - INFO - [DEBUG] ArcFace confidence: 0.2262
2025-04-19 08:54:51,929 - INFO - [DEBUG] Loss Breakdown — ID: 19.1332, SupCon: 3.6947, Tri: 0.0976
2025-04-19 08:54:52,101 - INFO - [DEBUG] ArcFace confidence: 0.2395
2025-04-19 08:54:52,107 - INFO - [DEBUG] Loss Breakdown — ID: 19.0583, SupCon: 3.5573, Tri: 0.0105
2025-04-19 08:54:52,280 - INFO - [DEBUG] ArcFace confidence: 0.2271
2025-04-19 08:54:52,286 - INFO - [DEBUG] Loss Breakdown — ID: 18.9221, SupCon: 3.6539, Tri: 0.0128
2025-04-19 08:54:52,459 - INFO - [DEBUG] ArcFace confidence: 0.2220
2025-04-19 08:54:52,462 - INFO - [DEBUG] Loss Breakdown — ID: 18.8282, SupCon: 3.6164, Tri: 0.0664
2025-04-19 08:54:52,636 - INFO - [DEBUG] ArcFace confidence: 0.2592
2025-04-19 08:54:52,639 - INFO - [DEBUG] Loss Breakdown — ID: 18.7268, SupCon: 3.6158, Tri: 0.0422
2025-04-19 08:54:52,812 - INFO - [DEBUG] ArcFace confidence: 0.2570
2025-04-19 08:54:52,815 - INFO - [DEBUG] Loss Breakdown — ID: 19.2050, SupCon: 3.6486, Tri: 0.0039
2025-04-19 08:54:52,992 - INFO - [DEBUG] ArcFace confidence: 0.2754
2025-04-19 08:54:52,995 - INFO - [DEBUG] Loss Breakdown — ID: 19.2770, SupCon: 3.6512, Tri: 0.1213
2025-04-19 08:54:53,167 - INFO - [DEBUG] ArcFace confidence: 0.2615
2025-04-19 08:54:53,170 - INFO - [DEBUG] Loss Breakdown — ID: 18.8954, SupCon: 3.6063, Tri: 0.0237
2025-04-19 08:54:53,343 - INFO - [DEBUG] ArcFace confidence: 0.2429
2025-04-19 08:54:53,346 - INFO - [DEBUG] Loss Breakdown — ID: 18.8743, SupCon: 3.6491, Tri: 0.0586
2025-04-19 08:54:53,517 - INFO - [DEBUG] ArcFace confidence: 0.2809
2025-04-19 08:54:53,520 - INFO - [DEBUG] Loss Breakdown — ID: 18.4628, SupCon: 3.6887, Tri: 0.0546
2025-04-19 08:54:53,689 - INFO - [DEBUG] ArcFace confidence: 0.2415
2025-04-19 08:54:53,692 - INFO - [DEBUG] Loss Breakdown — ID: 18.9098, SupCon: 3.5966, Tri: 0.0902
2025-04-19 08:54:53,866 - INFO - [DEBUG] ArcFace confidence: 0.2298
2025-04-19 08:54:53,869 - INFO - [DEBUG] Loss Breakdown — ID: 19.2961, SupCon: 3.5869, Tri: 0.0740
2025-04-19 08:54:54,043 - INFO - [DEBUG] ArcFace confidence: 0.2370
2025-04-19 08:54:54,046 - INFO - [DEBUG] Loss Breakdown — ID: 18.8093, SupCon: 3.5769, Tri: 0.0202
2025-04-19 08:54:54,201 - INFO - [DEBUG] ArcFace confidence: 0.2290
2025-04-19 08:54:54,204 - INFO - [DEBUG] Loss Breakdown — ID: 18.8856, SupCon: 3.4135, Tri: 0.1269
2025-04-19 08:54:54,934 - INFO - [Epoch 5] Total Loss=0.0634
2025-04-19 08:54:54,937 - INFO - Validating epoch 5...
2025-04-19 08:55:24,011 - INFO - [Epoch 5] Avg Train Loss = 0.0634 | 
2025-04-19 08:55:24,011 - INFO - ==================== Epoch 5 Validation ====================
2025-04-19 08:55:24,011 - INFO - Validation rank-1    : 69.72%
2025-04-19 08:55:24,014 - INFO - Validation rank-5    : 83.52%
2025-04-19 08:55:24,014 - INFO - Validation rank-10   : 89.60%
2025-04-19 08:55:24,014 - INFO - Validation mAP      : 76.52%
2025-04-19 08:55:24,014 - INFO - ============================================================
2025-04-19 08:55:24,014 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 08:55:24,014 - INFO -  Epoch 6/20
2025-04-19 08:55:24,014 - INFO - [Epoch 6] Learning rate: 0.000008
2025-04-19 08:55:48,823 - INFO - [DEBUG] ArcFace confidence: 0.2361
2025-04-19 08:55:48,829 - INFO - [DEBUG] Loss Breakdown — ID: 18.6785, SupCon: 3.4938, Tri: 0.0426
2025-04-19 08:55:48,907 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 08:55:48,910 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 08:55:49,004 - INFO - [DEBUG] ArcFace confidence: 0.2428
2025-04-19 08:55:49,007 - INFO - [DEBUG] Loss Breakdown — ID: 18.6306, SupCon: 3.5131, Tri: 0.0370
2025-04-19 08:55:49,178 - INFO - [DEBUG] ArcFace confidence: 0.2388
2025-04-19 08:55:49,184 - INFO - [DEBUG] Loss Breakdown — ID: 18.8742, SupCon: 3.5078, Tri: 0.0701
2025-04-19 08:55:49,358 - INFO - [DEBUG] ArcFace confidence: 0.2355
2025-04-19 08:55:49,363 - INFO - [DEBUG] Loss Breakdown — ID: 19.0297, SupCon: 3.5407, Tri: 0.0247
2025-04-19 08:55:49,536 - INFO - [DEBUG] ArcFace confidence: 0.2568
2025-04-19 08:55:49,539 - INFO - [DEBUG] Loss Breakdown — ID: 19.0195, SupCon: 3.4772, Tri: 0.0494
2025-04-19 08:55:49,712 - INFO - [DEBUG] ArcFace confidence: 0.2482
2025-04-19 08:55:49,715 - INFO - [DEBUG] Loss Breakdown — ID: 18.8433, SupCon: 3.3982, Tri: 0.0472
2025-04-19 08:55:49,890 - INFO - [DEBUG] ArcFace confidence: 0.2524
2025-04-19 08:55:49,896 - INFO - [DEBUG] Loss Breakdown — ID: 18.6782, SupCon: 3.4476, Tri: 0.0218
2025-04-19 08:55:50,069 - INFO - [DEBUG] ArcFace confidence: 0.2194
2025-04-19 08:55:50,072 - INFO - [DEBUG] Loss Breakdown — ID: 19.0653, SupCon: 3.3549, Tri: 0.0516
2025-04-19 08:55:50,245 - INFO - [DEBUG] ArcFace confidence: 0.2558
2025-04-19 08:55:50,248 - INFO - [DEBUG] Loss Breakdown — ID: 18.7443, SupCon: 3.3877, Tri: 0.0178
2025-04-19 08:55:50,421 - INFO - [DEBUG] ArcFace confidence: 0.2663
2025-04-19 08:55:50,427 - INFO - [DEBUG] Loss Breakdown — ID: 19.0480, SupCon: 3.3711, Tri: 0.0586
2025-04-19 08:55:50,598 - INFO - [DEBUG] ArcFace confidence: 0.2202
2025-04-19 08:55:50,604 - INFO - [DEBUG] Loss Breakdown — ID: 18.6385, SupCon: 3.3444, Tri: 0.0058
2025-04-19 08:55:50,775 - INFO - [DEBUG] ArcFace confidence: 0.2461
2025-04-19 08:55:50,781 - INFO - [DEBUG] Loss Breakdown — ID: 18.6703, SupCon: 3.4646, Tri: 0.0140
2025-04-19 08:55:50,955 - INFO - [DEBUG] ArcFace confidence: 0.2391
2025-04-19 08:55:50,958 - INFO - [DEBUG] Loss Breakdown — ID: 19.2007, SupCon: 3.4145, Tri: 0.0925
2025-04-19 08:55:51,128 - INFO - [DEBUG] ArcFace confidence: 0.2413
2025-04-19 08:55:51,134 - INFO - [DEBUG] Loss Breakdown — ID: 18.8558, SupCon: 3.4464, Tri: 0.0579
2025-04-19 08:55:51,308 - INFO - [DEBUG] ArcFace confidence: 0.2341
2025-04-19 08:55:51,311 - INFO - [DEBUG] Loss Breakdown — ID: 18.9795, SupCon: 3.3855, Tri: 0.0194
2025-04-19 08:55:51,488 - INFO - [DEBUG] ArcFace confidence: 0.2206
2025-04-19 08:55:51,491 - INFO - [DEBUG] Loss Breakdown — ID: 18.5114, SupCon: 3.4586, Tri: 0.0203
2025-04-19 08:55:51,665 - INFO - [DEBUG] ArcFace confidence: 0.2442
2025-04-19 08:55:51,668 - INFO - [DEBUG] Loss Breakdown — ID: 19.2278, SupCon: 3.4204, Tri: 0.0061
2025-04-19 08:55:51,845 - INFO - [DEBUG] ArcFace confidence: 0.2735
2025-04-19 08:55:51,848 - INFO - [DEBUG] Loss Breakdown — ID: 18.6125, SupCon: 3.5167, Tri: 0.0207
2025-04-19 08:55:52,025 - INFO - [DEBUG] ArcFace confidence: 0.2675
2025-04-19 08:55:52,028 - INFO - [DEBUG] Loss Breakdown — ID: 18.8507, SupCon: 3.3835, Tri: 0.0102
2025-04-19 08:55:52,202 - INFO - [DEBUG] ArcFace confidence: 0.2279
2025-04-19 08:55:52,205 - INFO - [DEBUG] Loss Breakdown — ID: 18.6501, SupCon: 3.4614, Tri: 0.0846
2025-04-19 08:55:52,381 - INFO - [DEBUG] ArcFace confidence: 0.2479
2025-04-19 08:55:52,384 - INFO - [DEBUG] Loss Breakdown — ID: 18.8913, SupCon: 3.4709, Tri: 0.0691
2025-04-19 08:55:52,556 - INFO - [DEBUG] ArcFace confidence: 0.2156
2025-04-19 08:55:52,559 - INFO - [DEBUG] Loss Breakdown — ID: 18.9174, SupCon: 3.4457, Tri: 0.0273
2025-04-19 08:55:52,730 - INFO - [DEBUG] ArcFace confidence: 0.2733
2025-04-19 08:55:52,733 - INFO - [DEBUG] Loss Breakdown — ID: 19.1908, SupCon: 3.5251, Tri: 0.0027
2025-04-19 08:55:52,904 - INFO - [DEBUG] ArcFace confidence: 0.2620
2025-04-19 08:55:52,907 - INFO - [DEBUG] Loss Breakdown — ID: 18.8679, SupCon: 3.5696, Tri: 0.0383
2025-04-19 08:55:53,080 - INFO - [DEBUG] ArcFace confidence: 0.2522
2025-04-19 08:55:53,083 - INFO - [DEBUG] Loss Breakdown — ID: 19.0883, SupCon: 3.5374, Tri: 0.0279
2025-04-19 08:55:53,254 - INFO - [DEBUG] ArcFace confidence: 0.3151
2025-04-19 08:55:53,257 - INFO - [DEBUG] Loss Breakdown — ID: 19.1220, SupCon: 3.7166, Tri: 0.1001
2025-04-19 08:55:53,429 - INFO - [DEBUG] ArcFace confidence: 0.2478
2025-04-19 08:55:53,432 - INFO - [DEBUG] Loss Breakdown — ID: 19.1969, SupCon: 3.6618, Tri: 0.0127
2025-04-19 08:55:53,594 - INFO - [DEBUG] ArcFace confidence: 0.2365
2025-04-19 08:55:53,597 - INFO - [DEBUG] Loss Breakdown — ID: 19.0105, SupCon: 3.3785, Tri: 0.0030
2025-04-19 08:55:54,337 - INFO - [Epoch 6] Total Loss=0.0369
2025-04-19 08:55:54,337 - INFO - Validating epoch 6...
2025-04-19 08:56:23,599 - INFO - [Epoch 6] Avg Train Loss = 0.0369 | 
2025-04-19 08:56:23,599 - INFO - ==================== Epoch 6 Validation ====================
2025-04-19 08:56:23,599 - INFO - Validation rank-1    : 65.29%
2025-04-19 08:56:23,599 - INFO - Validation rank-5    : 83.01%
2025-04-19 08:56:23,599 - INFO - Validation rank-10   : 91.45%
2025-04-19 08:56:23,599 - INFO - Validation mAP      : 73.87%
2025-04-19 08:56:23,599 - INFO - ============================================================
2025-04-19 08:56:23,599 - INFO - No improvement in Acc@1. Patience counter: 3/3
2025-04-19 08:56:23,599 - INFO - Early srankping at epoch 6 due to no improvement in rank-1 accuracy.
2025-04-19 08:56:24,492 - INFO - ====== FINAL SUMMARY ======
2025-04-19 08:56:24,492 - INFO - Total epochs       : 20
2025-04-19 08:56:24,492 - INFO - Avg Loss           : 67.1816
2025-04-19 08:56:24,492 - INFO - Best Acc@1 Epoch   : 3
2025-04-19 08:56:24,492 - INFO - Best Acc@1         : 73.94%
2025-04-19 08:56:24,492 - INFO - Best mAP            : 73.87%
2025-04-19 08:56:24,492 - INFO - ============================
