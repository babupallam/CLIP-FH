2025-04-19 12:36:31,507 - INFO - Saving logs to: train_logs/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32.log
2025-04-19 12:36:31,507 - INFO - Using 72 classes | 28 training batches
2025-04-19 12:36:31,507 - INFO - ======= Stage 3: PromptSG Training =======
2025-04-19 12:36:31,507 - INFO - Experiment Name : stage3_promptsg
2025-04-19 12:36:31,510 - INFO - Model & Dataset : rn50, 11k, dorsal_r
2025-04-19 12:36:31,510 - INFO - Freeze Text Enc.: True
2025-04-19 12:36:31,510 - INFO - Loss Weights    : ID=0.1, Tri=1.0, SupCon=0
2025-04-19 12:36:31,510 - INFO - LR=1e-06 | Epochs=30 | BatchSize=32
2025-04-19 12:36:31,510 - INFO -  Epoch 1/30
2025-04-19 12:36:31,510 - INFO - [Epoch 1] Learning rate: 0.000001
2025-04-19 12:36:58,819 - INFO - [DEBUG] Pooled feature mean L2 norm: 1.0000
2025-04-19 12:36:58,822 - INFO - [DEBUG] ArcFace confidence: 0.2482
2025-04-19 12:36:58,825 - INFO - [DEBUG] Loss Breakdown  ID: 18.5464, SupCon: 3.5293, Tri: 0.1285
2025-04-19 12:36:58,921 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:36:58,921 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:36:59,014 - INFO - [DEBUG] ArcFace confidence: 0.2507
2025-04-19 12:36:59,020 - INFO - [DEBUG] Loss Breakdown  ID: 18.2219, SupCon: 3.4281, Tri: 0.1418
2025-04-19 12:36:59,199 - INFO - [DEBUG] ArcFace confidence: 0.2612
2025-04-19 12:36:59,202 - INFO - [DEBUG] Loss Breakdown  ID: 18.4016, SupCon: 3.5172, Tri: 0.1402
2025-04-19 12:36:59,384 - INFO - [DEBUG] ArcFace confidence: 0.2290
2025-04-19 12:36:59,387 - INFO - [DEBUG] Loss Breakdown  ID: 18.5959, SupCon: 3.4778, Tri: 0.0968
2025-04-19 12:36:59,569 - INFO - [DEBUG] ArcFace confidence: 0.2494
2025-04-19 12:36:59,572 - INFO - [DEBUG] Loss Breakdown  ID: 18.6199, SupCon: 3.4105, Tri: 0.1122
2025-04-19 12:36:59,752 - INFO - [DEBUG] ArcFace confidence: 0.2454
2025-04-19 12:36:59,755 - INFO - [DEBUG] Loss Breakdown  ID: 18.7200, SupCon: 3.4908, Tri: 0.1399
2025-04-19 12:36:59,938 - INFO - [DEBUG] ArcFace confidence: 0.2317
2025-04-19 12:36:59,941 - INFO - [DEBUG] Loss Breakdown  ID: 18.6292, SupCon: 3.4935, Tri: 0.1530
2025-04-19 12:37:00,120 - INFO - [DEBUG] ArcFace confidence: 0.2597
2025-04-19 12:37:00,126 - INFO - [DEBUG] Loss Breakdown  ID: 18.7017, SupCon: 3.4575, Tri: 0.1673
2025-04-19 12:37:00,301 - INFO - [DEBUG] ArcFace confidence: 0.2067
2025-04-19 12:37:00,304 - INFO - [DEBUG] Loss Breakdown  ID: 18.4148, SupCon: 3.5147, Tri: 0.2092
2025-04-19 12:37:00,484 - INFO - [DEBUG] ArcFace confidence: 0.2280
2025-04-19 12:37:00,487 - INFO - [DEBUG] Loss Breakdown  ID: 18.3900, SupCon: 3.5057, Tri: 0.0944
2025-04-19 12:37:00,667 - INFO - [DEBUG] ArcFace confidence: 0.2645
2025-04-19 12:37:00,673 - INFO - [DEBUG] Loss Breakdown  ID: 18.7186, SupCon: 3.4418, Tri: 0.1419
2025-04-19 12:37:00,849 - INFO - [DEBUG] ArcFace confidence: 0.2758
2025-04-19 12:37:00,852 - INFO - [DEBUG] Loss Breakdown  ID: 18.6155, SupCon: 3.4768, Tri: 0.1490
2025-04-19 12:37:01,033 - INFO - [DEBUG] ArcFace confidence: 0.2164
2025-04-19 12:37:01,036 - INFO - [DEBUG] Loss Breakdown  ID: 18.6584, SupCon: 3.5098, Tri: 0.1457
2025-04-19 12:37:01,216 - INFO - [DEBUG] ArcFace confidence: 0.2496
2025-04-19 12:37:01,219 - INFO - [DEBUG] Loss Breakdown  ID: 18.4613, SupCon: 3.4584, Tri: 0.1270
2025-04-19 12:37:01,399 - INFO - [DEBUG] ArcFace confidence: 0.2647
2025-04-19 12:37:01,405 - INFO - [DEBUG] Loss Breakdown  ID: 18.5052, SupCon: 3.4587, Tri: 0.1463
2025-04-19 12:37:01,585 - INFO - [DEBUG] ArcFace confidence: 0.2103
2025-04-19 12:37:01,588 - INFO - [DEBUG] Loss Breakdown  ID: 18.0832, SupCon: 3.4323, Tri: 0.1783
2025-04-19 12:37:01,768 - INFO - [DEBUG] ArcFace confidence: 0.2469
2025-04-19 12:37:01,774 - INFO - [DEBUG] Loss Breakdown  ID: 18.7655, SupCon: 3.5037, Tri: 0.1019
2025-04-19 12:37:01,955 - INFO - [DEBUG] ArcFace confidence: 0.2633
2025-04-19 12:37:01,958 - INFO - [DEBUG] Loss Breakdown  ID: 18.5019, SupCon: 3.5091, Tri: 0.1544
2025-04-19 12:37:02,135 - INFO - [DEBUG] ArcFace confidence: 0.2781
2025-04-19 12:37:02,138 - INFO - [DEBUG] Loss Breakdown  ID: 18.9377, SupCon: 3.4355, Tri: 0.1010
2025-04-19 12:37:02,314 - INFO - [DEBUG] ArcFace confidence: 0.2748
2025-04-19 12:37:02,320 - INFO - [DEBUG] Loss Breakdown  ID: 18.8149, SupCon: 3.5254, Tri: 0.0856
2025-04-19 12:37:02,496 - INFO - [DEBUG] ArcFace confidence: 0.2684
2025-04-19 12:37:02,499 - INFO - [DEBUG] Loss Breakdown  ID: 18.2969, SupCon: 3.4748, Tri: 0.1486
2025-04-19 12:37:02,675 - INFO - [DEBUG] ArcFace confidence: 0.2395
2025-04-19 12:37:02,678 - INFO - [DEBUG] Loss Breakdown  ID: 18.5460, SupCon: 3.5164, Tri: 0.1518
2025-04-19 12:37:02,856 - INFO - [DEBUG] ArcFace confidence: 0.3019
2025-04-19 12:37:02,859 - INFO - [DEBUG] Loss Breakdown  ID: 18.4193, SupCon: 3.4862, Tri: 0.1270
2025-04-19 12:37:03,038 - INFO - [DEBUG] ArcFace confidence: 0.2399
2025-04-19 12:37:03,044 - INFO - [DEBUG] Loss Breakdown  ID: 18.3394, SupCon: 3.4678, Tri: 0.1187
2025-04-19 12:37:03,219 - INFO - [DEBUG] ArcFace confidence: 0.2369
2025-04-19 12:37:03,222 - INFO - [DEBUG] Loss Breakdown  ID: 18.0822, SupCon: 3.4759, Tri: 0.1166
2025-04-19 12:37:03,395 - INFO - [DEBUG] ArcFace confidence: 0.2638
2025-04-19 12:37:03,401 - INFO - [DEBUG] Loss Breakdown  ID: 18.3212, SupCon: 3.4370, Tri: 0.1143
2025-04-19 12:37:03,575 - INFO - [DEBUG] ArcFace confidence: 0.2264
2025-04-19 12:37:03,578 - INFO - [DEBUG] Loss Breakdown  ID: 18.2138, SupCon: 3.4529, Tri: 0.1501
2025-04-19 12:37:03,787 - INFO - [DEBUG] ArcFace confidence: 0.2233
2025-04-19 12:37:03,790 - INFO - [DEBUG] Loss Breakdown  ID: 17.3934, SupCon: 3.2465, Tri: 0.1219
2025-04-19 12:37:04,556 - INFO - [Epoch 1] Total Loss=1.9805
2025-04-19 12:37:04,556 - INFO - Validating epoch 1...
2025-04-19 12:37:34,147 - INFO - [Epoch 1] Avg Train Loss = 1.9805 | 
2025-04-19 12:37:34,147 - INFO - ==================== Epoch 1 Validation ====================
2025-04-19 12:37:34,147 - INFO - Validation rank-1    : 41.81%
2025-04-19 12:37:34,147 - INFO - Validation rank-5    : 66.01%
2025-04-19 12:37:34,147 - INFO - Validation rank-10   : 75.70%
2025-04-19 12:37:34,147 - INFO - Validation mAP      : 53.25%
2025-04-19 12:37:34,147 - INFO - ============================================================
2025-04-19 12:37:34,147 - INFO - Saving best model at epoch 1 (Acc@1=41.81%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:37:35,142 - INFO -  Epoch 2/30
2025-04-19 12:37:35,142 - INFO - [Epoch 2] Learning rate: 0.000001
2025-04-19 12:37:59,812 - INFO - [DEBUG] ArcFace confidence: 0.2400
2025-04-19 12:37:59,815 - INFO - [DEBUG] Loss Breakdown  ID: 17.7270, SupCon: 3.4341, Tri: 0.1111
2025-04-19 12:37:59,902 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:37:59,902 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:37:59,997 - INFO - [DEBUG] ArcFace confidence: 0.2735
2025-04-19 12:38:00,003 - INFO - [DEBUG] Loss Breakdown  ID: 17.9181, SupCon: 3.4611, Tri: 0.1757
2025-04-19 12:38:00,183 - INFO - [DEBUG] ArcFace confidence: 0.2839
2025-04-19 12:38:00,186 - INFO - [DEBUG] Loss Breakdown  ID: 18.0903, SupCon: 3.4635, Tri: 0.0932
2025-04-19 12:38:00,365 - INFO - [DEBUG] ArcFace confidence: 0.2571
2025-04-19 12:38:00,368 - INFO - [DEBUG] Loss Breakdown  ID: 17.2739, SupCon: 3.4882, Tri: 0.1695
2025-04-19 12:38:00,550 - INFO - [DEBUG] ArcFace confidence: 0.2023
2025-04-19 12:38:00,553 - INFO - [DEBUG] Loss Breakdown  ID: 17.8373, SupCon: 3.4707, Tri: 0.1320
2025-04-19 12:38:00,728 - INFO - [DEBUG] ArcFace confidence: 0.2492
2025-04-19 12:38:00,731 - INFO - [DEBUG] Loss Breakdown  ID: 17.7185, SupCon: 3.4911, Tri: 0.1678
2025-04-19 12:38:00,910 - INFO - [DEBUG] ArcFace confidence: 0.1975
2025-04-19 12:38:00,913 - INFO - [DEBUG] Loss Breakdown  ID: 17.7919, SupCon: 3.4710, Tri: 0.1633
2025-04-19 12:38:01,093 - INFO - [DEBUG] ArcFace confidence: 0.2426
2025-04-19 12:38:01,099 - INFO - [DEBUG] Loss Breakdown  ID: 18.0764, SupCon: 3.5003, Tri: 0.1598
2025-04-19 12:38:01,279 - INFO - [DEBUG] ArcFace confidence: 0.2066
2025-04-19 12:38:01,282 - INFO - [DEBUG] Loss Breakdown  ID: 18.0059, SupCon: 3.4495, Tri: 0.1251
2025-04-19 12:38:01,457 - INFO - [DEBUG] ArcFace confidence: 0.2614
2025-04-19 12:38:01,460 - INFO - [DEBUG] Loss Breakdown  ID: 17.8175, SupCon: 3.4878, Tri: 0.1674
2025-04-19 12:38:01,637 - INFO - [DEBUG] ArcFace confidence: 0.3088
2025-04-19 12:38:01,640 - INFO - [DEBUG] Loss Breakdown  ID: 18.2123, SupCon: 3.4694, Tri: 0.0579
2025-04-19 12:38:01,819 - INFO - [DEBUG] ArcFace confidence: 0.2196
2025-04-19 12:38:01,822 - INFO - [DEBUG] Loss Breakdown  ID: 17.9978, SupCon: 3.4941, Tri: 0.1574
2025-04-19 12:38:01,999 - INFO - [DEBUG] ArcFace confidence: 0.2403
2025-04-19 12:38:02,005 - INFO - [DEBUG] Loss Breakdown  ID: 17.7379, SupCon: 3.4853, Tri: 0.0754
2025-04-19 12:38:02,183 - INFO - [DEBUG] ArcFace confidence: 0.2108
2025-04-19 12:38:02,186 - INFO - [DEBUG] Loss Breakdown  ID: 17.5087, SupCon: 3.4527, Tri: 0.1703
2025-04-19 12:38:02,363 - INFO - [DEBUG] ArcFace confidence: 0.2235
2025-04-19 12:38:02,366 - INFO - [DEBUG] Loss Breakdown  ID: 17.3977, SupCon: 3.4336, Tri: 0.1273
2025-04-19 12:38:02,546 - INFO - [DEBUG] ArcFace confidence: 0.2139
2025-04-19 12:38:02,552 - INFO - [DEBUG] Loss Breakdown  ID: 17.5474, SupCon: 3.4732, Tri: 0.1921
2025-04-19 12:38:02,726 - INFO - [DEBUG] ArcFace confidence: 0.2252
2025-04-19 12:38:02,729 - INFO - [DEBUG] Loss Breakdown  ID: 17.8346, SupCon: 3.4637, Tri: 0.1702
2025-04-19 12:38:02,907 - INFO - [DEBUG] ArcFace confidence: 0.2438
2025-04-19 12:38:02,910 - INFO - [DEBUG] Loss Breakdown  ID: 18.4961, SupCon: 3.4920, Tri: 0.1767
2025-04-19 12:38:03,088 - INFO - [DEBUG] ArcFace confidence: 0.2522
2025-04-19 12:38:03,091 - INFO - [DEBUG] Loss Breakdown  ID: 17.4543, SupCon: 3.4924, Tri: 0.1612
2025-04-19 12:38:03,271 - INFO - [DEBUG] ArcFace confidence: 0.2407
2025-04-19 12:38:03,274 - INFO - [DEBUG] Loss Breakdown  ID: 17.8576, SupCon: 3.5184, Tri: 0.1155
2025-04-19 12:38:03,453 - INFO - [DEBUG] ArcFace confidence: 0.2136
2025-04-19 12:38:03,456 - INFO - [DEBUG] Loss Breakdown  ID: 17.3163, SupCon: 3.4662, Tri: 0.1462
2025-04-19 12:38:03,632 - INFO - [DEBUG] ArcFace confidence: 0.2464
2025-04-19 12:38:03,635 - INFO - [DEBUG] Loss Breakdown  ID: 17.3025, SupCon: 3.4706, Tri: 0.1005
2025-04-19 12:38:03,810 - INFO - [DEBUG] ArcFace confidence: 0.2455
2025-04-19 12:38:03,813 - INFO - [DEBUG] Loss Breakdown  ID: 17.8538, SupCon: 3.4945, Tri: 0.2044
2025-04-19 12:38:03,989 - INFO - [DEBUG] ArcFace confidence: 0.2267
2025-04-19 12:38:03,992 - INFO - [DEBUG] Loss Breakdown  ID: 18.1374, SupCon: 3.4429, Tri: 0.1434
2025-04-19 12:38:04,172 - INFO - [DEBUG] ArcFace confidence: 0.2166
2025-04-19 12:38:04,175 - INFO - [DEBUG] Loss Breakdown  ID: 17.6557, SupCon: 3.5060, Tri: 0.1592
2025-04-19 12:38:04,351 - INFO - [DEBUG] ArcFace confidence: 0.2893
2025-04-19 12:38:04,354 - INFO - [DEBUG] Loss Breakdown  ID: 17.7375, SupCon: 3.4612, Tri: 0.1478
2025-04-19 12:38:04,531 - INFO - [DEBUG] ArcFace confidence: 0.2423
2025-04-19 12:38:04,534 - INFO - [DEBUG] Loss Breakdown  ID: 17.9130, SupCon: 3.4905, Tri: 0.1165
2025-04-19 12:38:04,698 - INFO - [DEBUG] ArcFace confidence: 0.2444
2025-04-19 12:38:04,701 - INFO - [DEBUG] Loss Breakdown  ID: 17.2420, SupCon: 3.2740, Tri: 0.0885
2025-04-19 12:38:05,481 - INFO - [Epoch 2] Total Loss=1.9186
2025-04-19 12:38:05,481 - INFO - Validating epoch 2...
2025-04-19 12:38:35,309 - INFO - [Epoch 2] Avg Train Loss = 1.9186 | 
2025-04-19 12:38:35,309 - INFO - ==================== Epoch 2 Validation ====================
2025-04-19 12:38:35,309 - INFO - Validation rank-1    : 39.34%
2025-04-19 12:38:35,309 - INFO - Validation rank-5    : 64.78%
2025-04-19 12:38:35,309 - INFO - Validation rank-10   : 77.24%
2025-04-19 12:38:35,309 - INFO - Validation mAP      : 51.58%
2025-04-19 12:38:35,309 - INFO - ============================================================
2025-04-19 12:38:35,309 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 12:38:35,309 - INFO -  Epoch 3/30
2025-04-19 12:38:35,309 - INFO - [Epoch 3] Learning rate: 0.000001
2025-04-19 12:38:59,616 - INFO - [DEBUG] ArcFace confidence: 0.2162
2025-04-19 12:38:59,622 - INFO - [DEBUG] Loss Breakdown  ID: 17.6524, SupCon: 3.4574, Tri: 0.1207
2025-04-19 12:38:59,704 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:38:59,704 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:38:59,801 - INFO - [DEBUG] ArcFace confidence: 0.2947
2025-04-19 12:38:59,804 - INFO - [DEBUG] Loss Breakdown  ID: 16.7959, SupCon: 3.5070, Tri: 0.1754
2025-04-19 12:38:59,984 - INFO - [DEBUG] ArcFace confidence: 0.2266
2025-04-19 12:38:59,987 - INFO - [DEBUG] Loss Breakdown  ID: 17.6517, SupCon: 3.5174, Tri: 0.1350
2025-04-19 12:39:00,164 - INFO - [DEBUG] ArcFace confidence: 0.2404
2025-04-19 12:39:00,167 - INFO - [DEBUG] Loss Breakdown  ID: 17.7790, SupCon: 3.4962, Tri: 0.1385
2025-04-19 12:39:00,344 - INFO - [DEBUG] ArcFace confidence: 0.2648
2025-04-19 12:39:00,350 - INFO - [DEBUG] Loss Breakdown  ID: 16.4899, SupCon: 3.5319, Tri: 0.1241
2025-04-19 12:39:00,527 - INFO - [DEBUG] ArcFace confidence: 0.2573
2025-04-19 12:39:00,531 - INFO - [DEBUG] Loss Breakdown  ID: 17.3638, SupCon: 3.4767, Tri: 0.1493
2025-04-19 12:39:00,704 - INFO - [DEBUG] ArcFace confidence: 0.2502
2025-04-19 12:39:00,707 - INFO - [DEBUG] Loss Breakdown  ID: 17.4529, SupCon: 3.4555, Tri: 0.1306
2025-04-19 12:39:00,887 - INFO - [DEBUG] ArcFace confidence: 0.2610
2025-04-19 12:39:00,890 - INFO - [DEBUG] Loss Breakdown  ID: 17.1378, SupCon: 3.5014, Tri: 0.1284
2025-04-19 12:39:01,065 - INFO - [DEBUG] ArcFace confidence: 0.2174
2025-04-19 12:39:01,071 - INFO - [DEBUG] Loss Breakdown  ID: 16.5566, SupCon: 3.4660, Tri: 0.1443
2025-04-19 12:39:01,248 - INFO - [DEBUG] ArcFace confidence: 0.2646
2025-04-19 12:39:01,251 - INFO - [DEBUG] Loss Breakdown  ID: 16.5370, SupCon: 3.5038, Tri: 0.1781
2025-04-19 12:39:01,430 - INFO - [DEBUG] ArcFace confidence: 0.2541
2025-04-19 12:39:01,433 - INFO - [DEBUG] Loss Breakdown  ID: 17.4095, SupCon: 3.4741, Tri: 0.1434
2025-04-19 12:39:01,610 - INFO - [DEBUG] ArcFace confidence: 0.2301
2025-04-19 12:39:01,614 - INFO - [DEBUG] Loss Breakdown  ID: 16.8161, SupCon: 3.4924, Tri: 0.0929
2025-04-19 12:39:01,793 - INFO - [DEBUG] ArcFace confidence: 0.2777
2025-04-19 12:39:01,795 - INFO - [DEBUG] Loss Breakdown  ID: 17.1748, SupCon: 3.4763, Tri: 0.2035
2025-04-19 12:39:01,971 - INFO - [DEBUG] ArcFace confidence: 0.2714
2025-04-19 12:39:01,977 - INFO - [DEBUG] Loss Breakdown  ID: 17.4235, SupCon: 3.4659, Tri: 0.0987
2025-04-19 12:39:02,154 - INFO - [DEBUG] ArcFace confidence: 0.2343
2025-04-19 12:39:02,157 - INFO - [DEBUG] Loss Breakdown  ID: 16.6515, SupCon: 3.5071, Tri: 0.0731
2025-04-19 12:39:02,334 - INFO - [DEBUG] ArcFace confidence: 0.2278
2025-04-19 12:39:02,337 - INFO - [DEBUG] Loss Breakdown  ID: 16.8654, SupCon: 3.5039, Tri: 0.1103
2025-04-19 12:39:02,512 - INFO - [DEBUG] ArcFace confidence: 0.2588
2025-04-19 12:39:02,518 - INFO - [DEBUG] Loss Breakdown  ID: 17.9467, SupCon: 3.4270, Tri: 0.1395
2025-04-19 12:39:02,692 - INFO - [DEBUG] ArcFace confidence: 0.2382
2025-04-19 12:39:02,695 - INFO - [DEBUG] Loss Breakdown  ID: 17.1467, SupCon: 3.4748, Tri: 0.1829
2025-04-19 12:39:02,874 - INFO - [DEBUG] ArcFace confidence: 0.2497
2025-04-19 12:39:02,877 - INFO - [DEBUG] Loss Breakdown  ID: 17.1097, SupCon: 3.4808, Tri: 0.0522
2025-04-19 12:39:03,055 - INFO - [DEBUG] ArcFace confidence: 0.2333
2025-04-19 12:39:03,058 - INFO - [DEBUG] Loss Breakdown  ID: 17.2597, SupCon: 3.4369, Tri: 0.1647
2025-04-19 12:39:03,233 - INFO - [DEBUG] ArcFace confidence: 0.2616
2025-04-19 12:39:03,238 - INFO - [DEBUG] Loss Breakdown  ID: 16.7499, SupCon: 3.5071, Tri: 0.1037
2025-04-19 12:39:03,414 - INFO - [DEBUG] ArcFace confidence: 0.2303
2025-04-19 12:39:03,417 - INFO - [DEBUG] Loss Breakdown  ID: 17.1445, SupCon: 3.4825, Tri: 0.1466
2025-04-19 12:39:03,588 - INFO - [DEBUG] ArcFace confidence: 0.2477
2025-04-19 12:39:03,591 - INFO - [DEBUG] Loss Breakdown  ID: 16.5588, SupCon: 3.4651, Tri: 0.1390
2025-04-19 12:39:03,766 - INFO - [DEBUG] ArcFace confidence: 0.2256
2025-04-19 12:39:03,769 - INFO - [DEBUG] Loss Breakdown  ID: 16.5363, SupCon: 3.4641, Tri: 0.1390
2025-04-19 12:39:03,943 - INFO - [DEBUG] ArcFace confidence: 0.2076
2025-04-19 12:39:03,949 - INFO - [DEBUG] Loss Breakdown  ID: 16.1244, SupCon: 3.4466, Tri: 0.1435
2025-04-19 12:39:04,121 - INFO - [DEBUG] ArcFace confidence: 0.2317
2025-04-19 12:39:04,124 - INFO - [DEBUG] Loss Breakdown  ID: 16.9536, SupCon: 3.4671, Tri: 0.1078
2025-04-19 12:39:04,302 - INFO - [DEBUG] ArcFace confidence: 0.2785
2025-04-19 12:39:04,305 - INFO - [DEBUG] Loss Breakdown  ID: 16.7091, SupCon: 3.4839, Tri: 0.1463
2025-04-19 12:39:04,464 - INFO - [DEBUG] ArcFace confidence: 0.2347
2025-04-19 12:39:04,467 - INFO - [DEBUG] Loss Breakdown  ID: 15.9453, SupCon: 3.2524, Tri: 0.0901
2025-04-19 12:39:05,209 - INFO - [Epoch 3] Total Loss=1.8320
2025-04-19 12:39:05,209 - INFO - Validating epoch 3...
2025-04-19 12:39:35,856 - INFO - [Epoch 3] Avg Train Loss = 1.8320 | 
2025-04-19 12:39:35,856 - INFO - ==================== Epoch 3 Validation ====================
2025-04-19 12:39:35,856 - INFO - Validation rank-1    : 44.08%
2025-04-19 12:39:35,856 - INFO - Validation rank-5    : 67.46%
2025-04-19 12:39:35,856 - INFO - Validation rank-10   : 77.96%
2025-04-19 12:39:35,856 - INFO - Validation mAP      : 55.41%
2025-04-19 12:39:35,856 - INFO - ============================================================
2025-04-19 12:39:35,856 - INFO - Saving best model at epoch 3 (Acc@1=44.08%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:39:36,940 - INFO -  Epoch 4/30
2025-04-19 12:39:36,940 - INFO - [Epoch 4] Learning rate: 0.000001
2025-04-19 12:40:01,997 - INFO - [DEBUG] ArcFace confidence: 0.2653
2025-04-19 12:40:02,000 - INFO - [DEBUG] Loss Breakdown  ID: 16.8631, SupCon: 3.4646, Tri: 0.1277
2025-04-19 12:40:02,087 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:40:02,087 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:40:02,185 - INFO - [DEBUG] ArcFace confidence: 0.2326
2025-04-19 12:40:02,187 - INFO - [DEBUG] Loss Breakdown  ID: 17.2182, SupCon: 3.4758, Tri: 0.0843
2025-04-19 12:40:02,364 - INFO - [DEBUG] ArcFace confidence: 0.2651
2025-04-19 12:40:02,370 - INFO - [DEBUG] Loss Breakdown  ID: 16.1587, SupCon: 3.5066, Tri: 0.1054
2025-04-19 12:40:02,550 - INFO - [DEBUG] ArcFace confidence: 0.2796
2025-04-19 12:40:02,553 - INFO - [DEBUG] Loss Breakdown  ID: 16.8440, SupCon: 3.5161, Tri: 0.1379
2025-04-19 12:40:02,731 - INFO - [DEBUG] ArcFace confidence: 0.2484
2025-04-19 12:40:02,734 - INFO - [DEBUG] Loss Breakdown  ID: 16.7155, SupCon: 3.4448, Tri: 0.0734
2025-04-19 12:40:02,916 - INFO - [DEBUG] ArcFace confidence: 0.2662
2025-04-19 12:40:02,919 - INFO - [DEBUG] Loss Breakdown  ID: 16.5535, SupCon: 3.4636, Tri: 0.1498
2025-04-19 12:40:03,096 - INFO - [DEBUG] ArcFace confidence: 0.2314
2025-04-19 12:40:03,102 - INFO - [DEBUG] Loss Breakdown  ID: 16.5153, SupCon: 3.4986, Tri: 0.1327
2025-04-19 12:40:03,279 - INFO - [DEBUG] ArcFace confidence: 0.2383
2025-04-19 12:40:03,285 - INFO - [DEBUG] Loss Breakdown  ID: 15.9358, SupCon: 3.4297, Tri: 0.1796
2025-04-19 12:40:03,464 - INFO - [DEBUG] ArcFace confidence: 0.2637
2025-04-19 12:40:03,467 - INFO - [DEBUG] Loss Breakdown  ID: 16.1089, SupCon: 3.5252, Tri: 0.1133
2025-04-19 12:40:03,647 - INFO - [DEBUG] ArcFace confidence: 0.2621
2025-04-19 12:40:03,650 - INFO - [DEBUG] Loss Breakdown  ID: 16.4480, SupCon: 3.4557, Tri: 0.1463
2025-04-19 12:40:03,828 - INFO - [DEBUG] ArcFace confidence: 0.2499
2025-04-19 12:40:03,831 - INFO - [DEBUG] Loss Breakdown  ID: 16.2286, SupCon: 3.4870, Tri: 0.0872
2025-04-19 12:40:04,012 - INFO - [DEBUG] ArcFace confidence: 0.1814
2025-04-19 12:40:04,015 - INFO - [DEBUG] Loss Breakdown  ID: 15.8209, SupCon: 3.4886, Tri: 0.0883
2025-04-19 12:40:04,198 - INFO - [DEBUG] ArcFace confidence: 0.2655
2025-04-19 12:40:04,201 - INFO - [DEBUG] Loss Breakdown  ID: 17.0433, SupCon: 3.4963, Tri: 0.2039
2025-04-19 12:40:04,378 - INFO - [DEBUG] ArcFace confidence: 0.3198
2025-04-19 12:40:04,384 - INFO - [DEBUG] Loss Breakdown  ID: 16.6068, SupCon: 3.4903, Tri: 0.1930
2025-04-19 12:40:04,558 - INFO - [DEBUG] ArcFace confidence: 0.2421
2025-04-19 12:40:04,561 - INFO - [DEBUG] Loss Breakdown  ID: 15.6494, SupCon: 3.4887, Tri: 0.1738
2025-04-19 12:40:04,740 - INFO - [DEBUG] ArcFace confidence: 0.2325
2025-04-19 12:40:04,746 - INFO - [DEBUG] Loss Breakdown  ID: 16.6650, SupCon: 3.4417, Tri: 0.0881
2025-04-19 12:40:04,924 - INFO - [DEBUG] ArcFace confidence: 0.2815
2025-04-19 12:40:04,930 - INFO - [DEBUG] Loss Breakdown  ID: 15.8840, SupCon: 3.4630, Tri: 0.1606
2025-04-19 12:40:05,105 - INFO - [DEBUG] ArcFace confidence: 0.2363
2025-04-19 12:40:05,111 - INFO - [DEBUG] Loss Breakdown  ID: 16.7084, SupCon: 3.5100, Tri: 0.1130
2025-04-19 12:40:05,286 - INFO - [DEBUG] ArcFace confidence: 0.2381
2025-04-19 12:40:05,289 - INFO - [DEBUG] Loss Breakdown  ID: 15.8056, SupCon: 3.4509, Tri: 0.0874
2025-04-19 12:40:05,470 - INFO - [DEBUG] ArcFace confidence: 0.2470
2025-04-19 12:40:05,473 - INFO - [DEBUG] Loss Breakdown  ID: 16.3485, SupCon: 3.4903, Tri: 0.0911
2025-04-19 12:40:05,649 - INFO - [DEBUG] ArcFace confidence: 0.2491
2025-04-19 12:40:05,655 - INFO - [DEBUG] Loss Breakdown  ID: 15.7689, SupCon: 3.4698, Tri: 0.1800
2025-04-19 12:40:05,831 - INFO - [DEBUG] ArcFace confidence: 0.2542
2025-04-19 12:40:05,837 - INFO - [DEBUG] Loss Breakdown  ID: 16.7848, SupCon: 3.4742, Tri: 0.1017
2025-04-19 12:40:06,012 - INFO - [DEBUG] ArcFace confidence: 0.2353
2025-04-19 12:40:06,015 - INFO - [DEBUG] Loss Breakdown  ID: 16.3507, SupCon: 3.5275, Tri: 0.1822
2025-04-19 12:40:06,192 - INFO - [DEBUG] ArcFace confidence: 0.2202
2025-04-19 12:40:06,198 - INFO - [DEBUG] Loss Breakdown  ID: 15.8086, SupCon: 3.4931, Tri: 0.1663
2025-04-19 12:40:06,377 - INFO - [DEBUG] ArcFace confidence: 0.2235
2025-04-19 12:40:06,380 - INFO - [DEBUG] Loss Breakdown  ID: 16.2577, SupCon: 3.5181, Tri: 0.1114
2025-04-19 12:40:06,553 - INFO - [DEBUG] ArcFace confidence: 0.2354
2025-04-19 12:40:06,558 - INFO - [DEBUG] Loss Breakdown  ID: 15.7612, SupCon: 3.4854, Tri: 0.1071
2025-04-19 12:40:06,732 - INFO - [DEBUG] ArcFace confidence: 0.2379
2025-04-19 12:40:06,735 - INFO - [DEBUG] Loss Breakdown  ID: 15.7553, SupCon: 3.4755, Tri: 0.1143
2025-04-19 12:40:06,897 - INFO - [DEBUG] ArcFace confidence: 0.2375
2025-04-19 12:40:06,903 - INFO - [DEBUG] Loss Breakdown  ID: 16.6395, SupCon: 3.2615, Tri: 0.0986
2025-04-19 12:40:07,653 - INFO - [Epoch 4] Total Loss=1.7615
2025-04-19 12:40:07,653 - INFO - Validating epoch 4...
2025-04-19 12:40:37,613 - INFO - [Epoch 4] Avg Train Loss = 1.7615 | 
2025-04-19 12:40:37,613 - INFO - ==================== Epoch 4 Validation ====================
2025-04-19 12:40:37,613 - INFO - Validation rank-1    : 42.43%
2025-04-19 12:40:37,613 - INFO - Validation rank-5    : 68.49%
2025-04-19 12:40:37,613 - INFO - Validation rank-10   : 79.92%
2025-04-19 12:40:37,613 - INFO - Validation mAP      : 54.64%
2025-04-19 12:40:37,616 - INFO - ============================================================
2025-04-19 12:40:37,616 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 12:40:37,616 - INFO -  Epoch 5/30
2025-04-19 12:40:37,616 - INFO - [Epoch 5] Learning rate: 0.000001
2025-04-19 12:41:02,356 - INFO - [DEBUG] ArcFace confidence: 0.2183
2025-04-19 12:41:02,359 - INFO - [DEBUG] Loss Breakdown  ID: 16.0112, SupCon: 3.4965, Tri: 0.1321
2025-04-19 12:41:02,443 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:41:02,443 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:41:02,536 - INFO - [DEBUG] ArcFace confidence: 0.2480
2025-04-19 12:41:02,539 - INFO - [DEBUG] Loss Breakdown  ID: 15.3767, SupCon: 3.4766, Tri: 0.1577
2025-04-19 12:41:02,721 - INFO - [DEBUG] ArcFace confidence: 0.2250
2025-04-19 12:41:02,724 - INFO - [DEBUG] Loss Breakdown  ID: 16.4774, SupCon: 3.4460, Tri: 0.1475
2025-04-19 12:41:02,905 - INFO - [DEBUG] ArcFace confidence: 0.2589
2025-04-19 12:41:02,908 - INFO - [DEBUG] Loss Breakdown  ID: 16.4988, SupCon: 3.4896, Tri: 0.1914
2025-04-19 12:41:03,088 - INFO - [DEBUG] ArcFace confidence: 0.2365
2025-04-19 12:41:03,091 - INFO - [DEBUG] Loss Breakdown  ID: 15.4005, SupCon: 3.4423, Tri: 0.1748
2025-04-19 12:41:03,269 - INFO - [DEBUG] ArcFace confidence: 0.2489
2025-04-19 12:41:03,275 - INFO - [DEBUG] Loss Breakdown  ID: 16.1510, SupCon: 3.4608, Tri: 0.1440
2025-04-19 12:41:03,455 - INFO - [DEBUG] ArcFace confidence: 0.1998
2025-04-19 12:41:03,458 - INFO - [DEBUG] Loss Breakdown  ID: 16.2301, SupCon: 3.4609, Tri: 0.1686
2025-04-19 12:41:03,641 - INFO - [DEBUG] ArcFace confidence: 0.2844
2025-04-19 12:41:03,644 - INFO - [DEBUG] Loss Breakdown  ID: 16.5184, SupCon: 3.4933, Tri: 0.0696
2025-04-19 12:41:03,825 - INFO - [DEBUG] ArcFace confidence: 0.2541
2025-04-19 12:41:03,828 - INFO - [DEBUG] Loss Breakdown  ID: 15.9655, SupCon: 3.5043, Tri: 0.0864
2025-04-19 12:41:04,008 - INFO - [DEBUG] ArcFace confidence: 0.2341
2025-04-19 12:41:04,014 - INFO - [DEBUG] Loss Breakdown  ID: 15.2582, SupCon: 3.4484, Tri: 0.1115
2025-04-19 12:41:04,192 - INFO - [DEBUG] ArcFace confidence: 0.2578
2025-04-19 12:41:04,198 - INFO - [DEBUG] Loss Breakdown  ID: 15.8345, SupCon: 3.4722, Tri: 0.2147
2025-04-19 12:41:04,379 - INFO - [DEBUG] ArcFace confidence: 0.2718
2025-04-19 12:41:04,382 - INFO - [DEBUG] Loss Breakdown  ID: 16.2766, SupCon: 3.4748, Tri: 0.1736
2025-04-19 12:41:04,558 - INFO - [DEBUG] ArcFace confidence: 0.2434
2025-04-19 12:41:04,561 - INFO - [DEBUG] Loss Breakdown  ID: 15.1571, SupCon: 3.5020, Tri: 0.1878
2025-04-19 12:41:04,740 - INFO - [DEBUG] ArcFace confidence: 0.2400
2025-04-19 12:41:04,743 - INFO - [DEBUG] Loss Breakdown  ID: 15.6139, SupCon: 3.4373, Tri: 0.1006
2025-04-19 12:41:04,924 - INFO - [DEBUG] ArcFace confidence: 0.2272
2025-04-19 12:41:04,927 - INFO - [DEBUG] Loss Breakdown  ID: 15.7548, SupCon: 3.4242, Tri: 0.1164
2025-04-19 12:41:05,104 - INFO - [DEBUG] ArcFace confidence: 0.2544
2025-04-19 12:41:05,107 - INFO - [DEBUG] Loss Breakdown  ID: 15.1390, SupCon: 3.5010, Tri: 0.1295
2025-04-19 12:41:05,284 - INFO - [DEBUG] ArcFace confidence: 0.2658
2025-04-19 12:41:05,290 - INFO - [DEBUG] Loss Breakdown  ID: 16.1431, SupCon: 3.4824, Tri: 0.1041
2025-04-19 12:41:05,463 - INFO - [DEBUG] ArcFace confidence: 0.2067
2025-04-19 12:41:05,469 - INFO - [DEBUG] Loss Breakdown  ID: 15.6314, SupCon: 3.4137, Tri: 0.1454
2025-04-19 12:41:05,644 - INFO - [DEBUG] ArcFace confidence: 0.2752
2025-04-19 12:41:05,647 - INFO - [DEBUG] Loss Breakdown  ID: 15.8471, SupCon: 3.4524, Tri: 0.0854
2025-04-19 12:41:05,825 - INFO - [DEBUG] ArcFace confidence: 0.2313
2025-04-19 12:41:05,828 - INFO - [DEBUG] Loss Breakdown  ID: 16.0695, SupCon: 3.4626, Tri: 0.1790
2025-04-19 12:41:06,006 - INFO - [DEBUG] ArcFace confidence: 0.2668
2025-04-19 12:41:06,009 - INFO - [DEBUG] Loss Breakdown  ID: 15.3780, SupCon: 3.4886, Tri: 0.1279
2025-04-19 12:41:06,182 - INFO - [DEBUG] ArcFace confidence: 0.2361
2025-04-19 12:41:06,188 - INFO - [DEBUG] Loss Breakdown  ID: 15.8825, SupCon: 3.5083, Tri: 0.1128
2025-04-19 12:41:06,362 - INFO - [DEBUG] ArcFace confidence: 0.2834
2025-04-19 12:41:06,368 - INFO - [DEBUG] Loss Breakdown  ID: 15.7247, SupCon: 3.4698, Tri: 0.1439
2025-04-19 12:41:06,545 - INFO - [DEBUG] ArcFace confidence: 0.2161
2025-04-19 12:41:06,548 - INFO - [DEBUG] Loss Breakdown  ID: 15.3105, SupCon: 3.5351, Tri: 0.1119
2025-04-19 12:41:06,725 - INFO - [DEBUG] ArcFace confidence: 0.2965
2025-04-19 12:41:06,728 - INFO - [DEBUG] Loss Breakdown  ID: 15.1314, SupCon: 3.5064, Tri: 0.1386
2025-04-19 12:41:06,900 - INFO - [DEBUG] ArcFace confidence: 0.2560
2025-04-19 12:41:06,906 - INFO - [DEBUG] Loss Breakdown  ID: 15.0690, SupCon: 3.4648, Tri: 0.1415
2025-04-19 12:41:07,078 - INFO - [DEBUG] ArcFace confidence: 0.2368
2025-04-19 12:41:07,084 - INFO - [DEBUG] Loss Breakdown  ID: 14.9465, SupCon: 3.4511, Tri: 0.1543
2025-04-19 12:41:07,243 - INFO - [DEBUG] ArcFace confidence: 0.2483
2025-04-19 12:41:07,246 - INFO - [DEBUG] Loss Breakdown  ID: 15.2944, SupCon: 3.2781, Tri: 0.1796
2025-04-19 12:41:08,000 - INFO - [Epoch 5] Total Loss=1.7121
2025-04-19 12:41:08,000 - INFO - Validating epoch 5...
2025-04-19 12:41:37,677 - INFO - [Epoch 5] Avg Train Loss = 1.7121 | 
2025-04-19 12:41:37,677 - INFO - ==================== Epoch 5 Validation ====================
2025-04-19 12:41:37,677 - INFO - Validation rank-1    : 44.08%
2025-04-19 12:41:37,677 - INFO - Validation rank-5    : 73.94%
2025-04-19 12:41:37,677 - INFO - Validation rank-10   : 84.24%
2025-04-19 12:41:37,677 - INFO - Validation mAP      : 57.56%
2025-04-19 12:41:37,677 - INFO - ============================================================
2025-04-19 12:41:37,677 - INFO - No improvement in Acc@1. Patience counter: 2/3
2025-04-19 12:41:37,680 - INFO -  Epoch 6/30
2025-04-19 12:41:37,680 - INFO - [Epoch 6] Learning rate: 0.000001
2025-04-19 12:42:02,341 - INFO - [DEBUG] ArcFace confidence: 0.2188
2025-04-19 12:42:02,345 - INFO - [DEBUG] Loss Breakdown  ID: 15.1666, SupCon: 3.4679, Tri: 0.0971
2025-04-19 12:42:02,430 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:42:02,430 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:42:02,524 - INFO - [DEBUG] ArcFace confidence: 0.2282
2025-04-19 12:42:02,528 - INFO - [DEBUG] Loss Breakdown  ID: 14.5955, SupCon: 3.4795, Tri: 0.1190
2025-04-19 12:42:02,705 - INFO - [DEBUG] ArcFace confidence: 0.2621
2025-04-19 12:42:02,709 - INFO - [DEBUG] Loss Breakdown  ID: 15.8080, SupCon: 3.4963, Tri: 0.1076
2025-04-19 12:42:02,885 - INFO - [DEBUG] ArcFace confidence: 0.2894
2025-04-19 12:42:02,889 - INFO - [DEBUG] Loss Breakdown  ID: 16.0803, SupCon: 3.4283, Tri: 0.1645
2025-04-19 12:42:03,068 - INFO - [DEBUG] ArcFace confidence: 0.2241
2025-04-19 12:42:03,071 - INFO - [DEBUG] Loss Breakdown  ID: 14.1319, SupCon: 3.5063, Tri: 0.1182
2025-04-19 12:42:03,247 - INFO - [DEBUG] ArcFace confidence: 0.2560
2025-04-19 12:42:03,251 - INFO - [DEBUG] Loss Breakdown  ID: 15.2988, SupCon: 3.4372, Tri: 0.0694
2025-04-19 12:42:03,431 - INFO - [DEBUG] ArcFace confidence: 0.2580
2025-04-19 12:42:03,437 - INFO - [DEBUG] Loss Breakdown  ID: 15.1371, SupCon: 3.5099, Tri: 0.1618
2025-04-19 12:42:03,611 - INFO - [DEBUG] ArcFace confidence: 0.2440
2025-04-19 12:42:03,614 - INFO - [DEBUG] Loss Breakdown  ID: 14.8050, SupCon: 3.4736, Tri: 0.0902
2025-04-19 12:42:03,793 - INFO - [DEBUG] ArcFace confidence: 0.2697
2025-04-19 12:42:03,796 - INFO - [DEBUG] Loss Breakdown  ID: 15.4653, SupCon: 3.4659, Tri: 0.1259
2025-04-19 12:42:03,976 - INFO - [DEBUG] ArcFace confidence: 0.2600
2025-04-19 12:42:03,979 - INFO - [DEBUG] Loss Breakdown  ID: 16.2797, SupCon: 3.4531, Tri: 0.1815
2025-04-19 12:42:04,159 - INFO - [DEBUG] ArcFace confidence: 0.2306
2025-04-19 12:42:04,162 - INFO - [DEBUG] Loss Breakdown  ID: 14.5783, SupCon: 3.4471, Tri: 0.1222
2025-04-19 12:42:04,339 - INFO - [DEBUG] ArcFace confidence: 0.2540
2025-04-19 12:42:04,342 - INFO - [DEBUG] Loss Breakdown  ID: 15.0190, SupCon: 3.5031, Tri: 0.1383
2025-04-19 12:42:04,521 - INFO - [DEBUG] ArcFace confidence: 0.2056
2025-04-19 12:42:04,524 - INFO - [DEBUG] Loss Breakdown  ID: 14.8259, SupCon: 3.5067, Tri: 0.1320
2025-04-19 12:42:04,700 - INFO - [DEBUG] ArcFace confidence: 0.2775
2025-04-19 12:42:04,705 - INFO - [DEBUG] Loss Breakdown  ID: 15.0188, SupCon: 3.4577, Tri: 0.0985
2025-04-19 12:42:04,880 - INFO - [DEBUG] ArcFace confidence: 0.2420
2025-04-19 12:42:04,883 - INFO - [DEBUG] Loss Breakdown  ID: 14.5957, SupCon: 3.4792, Tri: 0.1522
2025-04-19 12:42:05,061 - INFO - [DEBUG] ArcFace confidence: 0.2620
2025-04-19 12:42:05,065 - INFO - [DEBUG] Loss Breakdown  ID: 15.5226, SupCon: 3.4700, Tri: 0.1297
2025-04-19 12:42:05,240 - INFO - [DEBUG] ArcFace confidence: 0.2429
2025-04-19 12:42:05,244 - INFO - [DEBUG] Loss Breakdown  ID: 14.8512, SupCon: 3.4876, Tri: 0.0797
2025-04-19 12:42:05,423 - INFO - [DEBUG] ArcFace confidence: 0.2506
2025-04-19 12:42:05,429 - INFO - [DEBUG] Loss Breakdown  ID: 14.6973, SupCon: 3.4874, Tri: 0.1510
2025-04-19 12:42:05,606 - INFO - [DEBUG] ArcFace confidence: 0.2461
2025-04-19 12:42:05,609 - INFO - [DEBUG] Loss Breakdown  ID: 14.3726, SupCon: 3.4762, Tri: 0.1533
2025-04-19 12:42:05,784 - INFO - [DEBUG] ArcFace confidence: 0.2579
2025-04-19 12:42:05,790 - INFO - [DEBUG] Loss Breakdown  ID: 15.3128, SupCon: 3.4584, Tri: 0.1523
2025-04-19 12:42:05,965 - INFO - [DEBUG] ArcFace confidence: 0.2625
2025-04-19 12:42:05,970 - INFO - [DEBUG] Loss Breakdown  ID: 14.7387, SupCon: 3.5080, Tri: 0.0983
2025-04-19 12:42:06,143 - INFO - [DEBUG] ArcFace confidence: 0.2102
2025-04-19 12:42:06,146 - INFO - [DEBUG] Loss Breakdown  ID: 14.6393, SupCon: 3.4398, Tri: 0.1453
2025-04-19 12:42:06,320 - INFO - [DEBUG] ArcFace confidence: 0.2350
2025-04-19 12:42:06,323 - INFO - [DEBUG] Loss Breakdown  ID: 14.6083, SupCon: 3.4601, Tri: 0.0729
2025-04-19 12:42:06,500 - INFO - [DEBUG] ArcFace confidence: 0.2311
2025-04-19 12:42:06,503 - INFO - [DEBUG] Loss Breakdown  ID: 15.3451, SupCon: 3.5167, Tri: 0.1254
2025-04-19 12:42:06,680 - INFO - [DEBUG] ArcFace confidence: 0.2588
2025-04-19 12:42:06,684 - INFO - [DEBUG] Loss Breakdown  ID: 14.9056, SupCon: 3.4389, Tri: 0.0914
2025-04-19 12:42:06,856 - INFO - [DEBUG] ArcFace confidence: 0.2536
2025-04-19 12:42:06,860 - INFO - [DEBUG] Loss Breakdown  ID: 15.1316, SupCon: 3.4194, Tri: 0.1393
2025-04-19 12:42:07,037 - INFO - [DEBUG] ArcFace confidence: 0.2069
2025-04-19 12:42:07,041 - INFO - [DEBUG] Loss Breakdown  ID: 14.2728, SupCon: 3.4601, Tri: 0.1266
2025-04-19 12:42:07,197 - INFO - [DEBUG] ArcFace confidence: 0.2825
2025-04-19 12:42:07,200 - INFO - [DEBUG] Loss Breakdown  ID: 14.9091, SupCon: 3.3000, Tri: 0.0823
2025-04-19 12:42:07,951 - INFO - [Epoch 6] Total Loss=1.6228
2025-04-19 12:42:07,952 - INFO - Validating epoch 6...
2025-04-19 12:42:36,797 - INFO - [Epoch 6] Avg Train Loss = 1.6228 | 
2025-04-19 12:42:36,797 - INFO - ==================== Epoch 6 Validation ====================
2025-04-19 12:42:36,797 - INFO - Validation rank-1    : 45.11%
2025-04-19 12:42:36,797 - INFO - Validation rank-5    : 73.02%
2025-04-19 12:42:36,797 - INFO - Validation rank-10   : 83.42%
2025-04-19 12:42:36,797 - INFO - Validation mAP      : 57.81%
2025-04-19 12:42:36,797 - INFO - ============================================================
2025-04-19 12:42:36,797 - INFO - Saving best model at epoch 6 (Acc@1=45.11%)  saved_models/stage3_promptsg_rn50_11k_dorsal_r_promptsg_e30_lrNA_bs32_BEST.pth
2025-04-19 12:42:38,101 - INFO -  Epoch 7/30
2025-04-19 12:42:38,101 - INFO - [Epoch 7] Learning rate: 0.000001
2025-04-19 12:43:02,331 - INFO - [DEBUG] ArcFace confidence: 0.2835
2025-04-19 12:43:02,334 - INFO - [DEBUG] Loss Breakdown  ID: 14.7954, SupCon: 3.4901, Tri: 0.1100
2025-04-19 12:43:02,421 - INFO - [DEBUG] Batch 0 - image shape: torch.Size([32, 3, 224, 224]), labels: torch.Size([32])
2025-04-19 12:43:02,421 - INFO - [DEBUG] img_features: torch.Size([32, 1024]), prompt: torch.Size([32, 3, 1024]), pooled: torch.Size([32, 1024])
2025-04-19 12:43:02,514 - INFO - [DEBUG] ArcFace confidence: 0.2905
2025-04-19 12:43:02,517 - INFO - [DEBUG] Loss Breakdown  ID: 14.5646, SupCon: 3.5072, Tri: 0.1221
2025-04-19 12:43:02,695 - INFO - [DEBUG] ArcFace confidence: 0.1968
2025-04-19 12:43:02,698 - INFO - [DEBUG] Loss Breakdown  ID: 14.4007, SupCon: 3.4456, Tri: 0.1100
2025-04-19 12:43:02,875 - INFO - [DEBUG] ArcFace confidence: 0.2976
2025-04-19 12:43:02,878 - INFO - [DEBUG] Loss Breakdown  ID: 15.2644, SupCon: 3.5206, Tri: 0.1700
2025-04-19 12:43:03,054 - INFO - [DEBUG] ArcFace confidence: 0.2456
2025-04-19 12:43:03,057 - INFO - [DEBUG] Loss Breakdown  ID: 13.9224, SupCon: 3.5153, Tri: 0.1348
2025-04-19 12:43:03,234 - INFO - [DEBUG] ArcFace confidence: 0.2372
2025-04-19 12:43:03,237 - INFO - [DEBUG] Loss Breakdown  ID: 14.2695, SupCon: 3.5606, Tri: 0.1465
2025-04-19 12:43:03,414 - INFO - [DEBUG] ArcFace confidence: 0.3370
2025-04-19 12:43:03,417 - INFO - [DEBUG] Loss Breakdown  ID: 15.1416, SupCon: 3.5179, Tri: 0.1140
2025-04-19 12:43:03,595 - INFO - [DEBUG] ArcFace confidence: 0.2444
2025-04-19 12:43:03,598 - INFO - [DEBUG] Loss Breakdown  ID: 14.1801, SupCon: 3.4771, Tri: 0.1382
2025-04-19 12:43:03,777 - INFO - [DEBUG] ArcFace confidence: 0.2716
2025-04-19 12:43:03,780 - INFO - [DEBUG] Loss Breakdown  ID: 14.2717, SupCon: 3.4739, Tri: 0.0987
2025-04-19 12:43:03,956 - INFO - [DEBUG] ArcFace confidence: 0.2630
2025-04-19 12:43:03,959 - INFO - [DEBUG] Loss Breakdown  ID: 14.6044, SupCon: 3.4732, Tri: 0.1696
2025-04-19 12:43:04,135 - INFO - [DEBUG] ArcFace confidence: 0.3060
2025-04-19 12:43:04,141 - INFO - [DEBUG] Loss Breakdown  ID: 14.1877, SupCon: 3.4955, Tri: 0.0918
2025-04-19 12:43:04,315 - INFO - [DEBUG] ArcFace confidence: 0.2406
2025-04-19 12:43:04,321 - INFO - [DEBUG] Loss Breakdown  ID: 14.5325, SupCon: 3.5047, Tri: 0.0650
2025-04-19 12:43:04,496 - INFO - [DEBUG] ArcFace confidence: 0.2603
2025-04-19 12:43:04,499 - INFO - [DEBUG] Loss Breakdown  ID: 14.3448, SupCon: 3.4685, Tri: 0.1504
2025-04-19 12:43:04,675 - INFO - [DEBUG] ArcFace confidence: 0.2528
2025-04-19 12:43:04,678 - INFO - [DEBUG] Loss Breakdown  ID: 14.2162, SupCon: 3.4773, Tri: 0.1005
2025-04-19 12:43:04,856 - INFO - [DEBUG] ArcFace confidence: 0.2612
2025-04-19 12:43:04,859 - INFO - [DEBUG] Loss Breakdown  ID: 14.1123, SupCon: 3.4966, Tri: 0.1813
2025-04-19 12:43:05,044 - INFO - [DEBUG] ArcFace confidence: 0.2550
2025-04-19 12:43:05,048 - INFO - [DEBUG] Loss Breakdown  ID: 14.6193, SupCon: 3.4455, Tri: 0.1125
2025-04-19 12:43:05,226 - INFO - [DEBUG] ArcFace confidence: 0.2499
2025-04-19 12:43:05,229 - INFO - [DEBUG] Loss Breakdown  ID: 14.3734, SupCon: 3.4600, Tri: 0.0768
2025-04-19 12:43:05,409 - INFO - [DEBUG] ArcFace confidence: 0.2573
2025-04-19 12:43:05,415 - INFO - [DEBUG] Loss Breakdown  ID: 13.8954, SupCon: 3.4699, Tri: 0.1269
2025-04-19 12:43:05,589 - INFO - [DEBUG] ArcFace confidence: 0.2876
2025-04-19 12:43:05,592 - INFO - [DEBUG] Loss Breakdown  ID: 14.3847, SupCon: 3.4333, Tri: 0.0965
2025-04-19 12:43:05,766 - INFO - [DEBUG] ArcFace confidence: 0.2734
2025-04-19 12:43:05,769 - INFO - [DEBUG] Loss Breakdown  ID: 14.5827, SupCon: 3.4666, Tri: 0.0970
2025-04-19 12:43:05,945 - INFO - [DEBUG] ArcFace confidence: 0.2285
2025-04-19 12:43:05,948 - INFO - [DEBUG] Loss Breakdown  ID: 15.0377, SupCon: 3.4631, Tri: 0.1254
2025-04-19 12:43:06,122 - INFO - [DEBUG] ArcFace confidence: 0.2659
2025-04-19 12:43:06,125 - INFO - [DEBUG] Loss Breakdown  ID: 14.4396, SupCon: 3.4441, Tri: 0.1292
2025-04-19 12:43:06,299 - INFO - [DEBUG] ArcFace confidence: 0.3066
2025-04-19 12:43:06,302 - INFO - [DEBUG] Loss Breakdown  ID: 14.9509, SupCon: 3.4885, Tri: 0.1466
2025-04-19 12:43:06,475 - INFO - [DEBUG] ArcFace confidence: 0.2506
2025-04-19 12:43:06,478 - INFO - [DEBUG] Loss Breakdown  ID: 14.7559, SupCon: 3.4724, Tri: 0.1702
2025-04-19 12:43:06,654 - INFO - [DEBUG] ArcFace confidence: 0.2535
2025-04-19 12:43:06,657 - INFO - [DEBUG] Loss Breakdown  ID: 14.3073, SupCon: 3.4444, Tri: 0.1228
2025-04-19 12:43:06,831 - INFO - [DEBUG] ArcFace confidence: 0.2890
2025-04-19 12:43:06,834 - INFO - [DEBUG] Loss Breakdown  ID: 14.8303, SupCon: 3.4613, Tri: 0.1276
2025-04-19 12:43:07,006 - INFO - [DEBUG] ArcFace confidence: 0.2833
2025-04-19 12:43:07,012 - INFO - [DEBUG] Loss Breakdown  ID: 13.9026, SupCon: 3.4896, Tri: 0.1230
2025-04-19 12:43:07,170 - INFO - [DEBUG] ArcFace confidence: 0.2592
2025-04-19 12:43:07,173 - INFO - [DEBUG] Loss Breakdown  ID: 14.5957, SupCon: 3.2908, Tri: 0.0982
2025-04-19 12:43:07,900 - INFO - [Epoch 7] Total Loss=1.5716
2025-04-19 12:43:07,900 - INFO - Validating epoch 7...
2025-04-19 12:43:37,131 - INFO - [Epoch 7] Avg Train Loss = 1.5716 | 
2025-04-19 12:43:37,131 - INFO - ==================== Epoch 7 Validation ====================
2025-04-19 12:43:37,134 - INFO - Validation rank-1    : 43.36%
2025-04-19 12:43:37,134 - INFO - Validation rank-5    : 71.68%
2025-04-19 12:43:37,134 - INFO - Validation rank-10   : 83.32%
2025-04-19 12:43:37,134 - INFO - Validation mAP      : 56.32%
2025-04-19 12:43:37,134 - INFO - ============================================================
2025-04-19 12:43:37,134 - INFO - No improvement in Acc@1. Patience counter: 1/3
2025-04-19 12:43:37,134 - INFO -  Epoch 8/30
2025-04-19 12:43:37,134 - INFO - [Epoch 8] Learning rate: 0.000001
